# Shard allocation, relocation, and recovery 分片分配、迁移和恢复

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

Each [index](https://www.elastic.co/guide/en/elasticsearch/reference/current/documents-indices.html) in Elasticsearch is divided into one or more [shards](https://www.elastic.co/guide/en/elasticsearch/reference/current/scalability.html). Each document in an index belongs to a single shard.
Elasticsearch 中的每个[索引](https://www.elastic.co/guide/en/elasticsearch/reference/current/documents-indices.html)都分为一个或多个[分片](https://www.elastic.co/guide/en/elasticsearch/reference/current/scalability.html)。索引中的每个文档都属于单个分片。

A cluster can contain multiple copies of a shard. Each shard has one distinguished shard copy called the *primary*, and zero or more non-primary copies called *replicas*. The primary shard copy serves as the main entry point for all indexing  operations. The operations on the primary shard copy are then forwarded  to its replicas.
一个集群可以包含一个分片的多个副本。每个分片都有一个独特的分片副本（称为*主副本*）和零个或多个非主副本（称为*副本）* 。主分片副本充当所有索引操作的主要入口点。然后，主分片副本上的操作将转发到其副本。

Replicas maintain redundant copies of your data across the [nodes](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html) in your cluster, protecting against hardware failure and increasing  capacity to serve read requests like searching or retrieving a document. If the primary shard copy fails, then a replica is promoted to primary  and takes over the primary’s responsibilities.
副本在集群中的[节点](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html)上维护数据的冗余副本，防止硬件故障并增加服务读取请求（例如搜索或检索文档）的能力。如果主分片副本失败，则副本将提升为主分片并接管主分片的职责。

Over the course of normal operation, Elasticsearch allocates shard copies to nodes, relocates shard copies across nodes to balance the cluster or  satisfy new allocation constraints, and recovers shards to initialize  new copies. In this topic, you’ll learn how these operations work and  how you can control them.
在正常操作过程中，Elasticsearch 会将分片副本分配给节点，跨节点重新定位分片副本以平衡集群或满足新的分配约束，并恢复分片以初始化新副本。在本主题中，您将了解这些操作的工作原理以及如何控制它们。

To learn about optimizing the number and size of shards in your cluster, refer to [Size your shards](https://www.elastic.co/guide/en/elasticsearch/reference/current/size-your-shards.html). To learn about how read and write operations are replicated across shards and shard copies, refer to [Reading and writing documents](https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-replication.html).
要了解如何优化集群中分片的数量和大小，请参阅[调整分片大小](https://www.elastic.co/guide/en/elasticsearch/reference/current/size-your-shards.html)。要了解如何跨分片和分片副本复制读写操作，请参[阅读写文档](https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-replication.html)。

## Shard allocation 分片分配

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

Shard allocation is the process of assigning shard copies to nodes. This can happen during initial recovery, replica allocation, rebalancing, when  nodes are added to or removed from the cluster, or when cluster or index settings that impact allocation are updated.
分片分配是将分片副本分配给节点的过程。在初始恢复、副本分配、重新平衡期间、在集群中添加或删除节点时，或者影响分配的集群或索引设置更新时，可能会发生这种情况。

By default, the primary and replica shard copies for an index can be  allocated to any node in the cluster, and may be relocated to rebalance  the cluster.
默认情况下，索引的主分片和副本分片副本可以分配到集群中的任何节点，并且可以重新定位以重新平衡集群。

### Adjust shard allocation settings 调整分片分配设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

You can control how shard copies are allocated using the following settings:
您可以使用以下设置控制分片副本的分配方式：

- [Cluster-level shard allocation settings](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-cluster.html): Use these settings to control how shard copies are allocated and  balanced across the entire cluster. For example, you might want to  allocate nodes availability zones, or prevent certain nodes from being  used so you can perform maintenance. 
  [集群级分片分配设置](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-cluster.html)：使用这些设置来控制分片副本在整个集群中的分配和平衡方式。例如，您可能希望分配节点可用区域，或阻止使用某些节点以便执行维护。
- [Index-level shard allocation settings](https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-allocation.html): Use these settings to control how the shard copies for a specific index are allocated. For example, you might want to allocate an index to a  node in a specific data tier, or to an node with specific attributes. 
  [索引级分片分配设置](https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-allocation.html)：使用这些设置来控制如何分配特定索引的分片副本。例如，您可能希望将索引分配给特定数据层中的节点或具有特定属性的节点。

### Monitor shard allocation 监控分片分配

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

If a shard copy is unassigned, it means that the shard copy is not  allocated to any node in the cluster. This can happen if there are not  enough nodes in the cluster to allocate the shard copy, or if the shard  copy can’t be allocated to any node that satisfies the shard allocation  filtering rules. When a shard copy is unassigned, your cluster is  considered unhealthy and returns a yellow or red cluster health status.
如果某个分片副本未分配，则意味着该分片副本没有分配给集群中的任何节点。如果集群中没有足够的节点来分配分片副本，或者分片副本无法分配给任何满足分片分配过滤规则的节点，则可能会发生这种情况。当分片副本未分配时，您的集群被视为不健康，并返回黄色或红色集群健康状态。

You can use the following APIs to monitor shard allocation:
您可以使用以下 API 来监控分片分配：

- [Cluster allocation explain
  集群分配说明](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-allocation-explain.html)
- [cat allocation 猫分配](https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-allocation.html)
- [cluster health 集群健康状况](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-health.html)

[Learn more about troubleshooting unassigned shard copies and recovering your cluster health](https://www.elastic.co/guide/en/elasticsearch/reference/current/red-yellow-cluster-status.html).
[了解有关对未分配的分片副本进行故障排除和恢复集群运行状况的更多信息](https://www.elastic.co/guide/en/elasticsearch/reference/current/red-yellow-cluster-status.html)。

## Shard recovery 碎片恢复

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

Shard recovery is the process of initializing a shard copy, such as restoring a primary shard from a snapshot or creating a replica shard from a primary shard. When a shard recovery completes, the recovered shard is available for search and indexing.
分片恢复是初始化分片副本的过程，例如从快照恢复主分片或从主分片创建副本分片。分片恢复完成后，恢复的分片可用于搜索和索引。

Recovery automatically occurs during the following processes:
恢复会在以下过程中自动发生：

- When creating an index for the first time. 
  第一次创建索引时。
- When a node rejoins the cluster and starts up any missing primary shard copies using the data that it holds in its data path. 
  当节点重新加入集群并使用其数据路径中保存的数据启动任何丢失的主分片副本时。
- Creation of new replica shard copies from the primary. 
  从主分片创建新的副本分片副本。
- Relocation of a shard copy to a different node in the same cluster. 
  将分片副本重新定位到同一集群中的不同节点。
- A [snapshot restore](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-restore-snapshot.html) operation. 
  [快照恢复](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-restore-snapshot.html)操作。
- A [clone](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-clone-index.html), [shrink](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-shrink-index.html), or [split](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-split-index.html) operation. 
  [克隆](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-clone-index.html)、[收缩](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-shrink-index.html)或[拆分](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-split-index.html)操作。

You can determine the cause of a shard recovery using the [recovery](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-recovery.html) or  [cat recovery](https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-recovery.html) APIs.
您可以使用[recovery](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-recovery.html)或[cat recovery](https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-recovery.html) API 确定分片恢复的原因。

### Adjust shard recovery settings 调整碎片恢复设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

To control how shards are recovered, for example the resources that can be used by recovery operations, and which indices should be prioritized  for recovery, you can adjust the following settings:
要控制分片的恢复方式，例如恢复操作可以使用的资源以及应优先恢复哪些索引，您可以调整以下设置：

- [Index recovery settings 索引恢复设置](https://www.elastic.co/guide/en/elasticsearch/reference/current/recovery.html)
- [Cluster-level shard allocation settings
  集群级分片分配设置](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-cluster.html)
- [Index-level shard allocation settings](https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-allocation.html), including [delayed allocation](https://www.elastic.co/guide/en/elasticsearch/reference/current/delayed-allocation.html) and [index recovery prioritization](https://www.elastic.co/guide/en/elasticsearch/reference/current/recovery-prioritization.html)
  [索引级分片分配设置](https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-allocation.html)，包括[延迟分配](https://www.elastic.co/guide/en/elasticsearch/reference/current/delayed-allocation.html)和[索引恢复优先级](https://www.elastic.co/guide/en/elasticsearch/reference/current/recovery-prioritization.html)

Shard recovery operations also respect general shard allocation settings.
分片恢复操作也遵循一般分片分配设置。

### Monitor shard recovery 监控碎片恢复

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

You can use the following APIs to monitor shard allocation:
您可以使用以下 API 来监控分片分配：

- View a list of in-progress and completed recoveries using the [cat recovery API](https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-recovery.html)
  使用[cat 恢复 API](https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-recovery.html)查看正在进行和已完成的恢复列表
- View detailed information about a specific recovery using the [index recovery API](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-recovery.html)
  使用[索引恢复 API](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-recovery.html)查看有关特定恢复的详细信息

## Shard relocation 分片迁移

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

Shard relocation is the process of moving shard copies from one node to  another. This can happen when a node joins or leaves the cluster, or  when the cluster is rebalancing.
分片迁移是将分片副本从一个节点移动到另一个节点的过程。当节点加入或离开集群，或者集群重新平衡时，可能会发生这种情况。

When a shard copy is relocated, it is created as a new shard copy on the  target node. When the shard copy is fully allocated and recovered, the  old shard copy is deleted. If the shard copy being relocated is a  primary, then the new shard copy is marked as primary before the old  shard copy is deleted.
重新定位分片副本时，它会在目标节点上创建为新的分片副本。当分片副本完全分配并恢复时，旧的分片副本将被删除。如果要重新定位的分片副本是主分片副本，则在删除旧分片副本之前，新分片副本将被标记为主分片副本。

### Adjust shard relocation settings 调整分片重定位设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/shard-ops.asciidoc)

You can control how and when shard copies are relocated. For example, you  can adjust the rebalancing settings that control when shard copies are  relocated to balance the cluster, or the high watermark for disk-based  shard allocation that can trigger relocation. These settings are part of the [cluster-level shard allocation settings](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-cluster.html).
您可以控制重新定位分片副本的方式和时间。例如，您可以调整控制何时重新定位分片副本以平衡集群的重新平衡设置，或者调整可触发重新定位的基于磁盘的分片分配的高水位线。这些设置是[集群级分片分配设置](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-cluster.html)的一部分。

Shard relocation operations also respect shard allocation and recovery settings.
分片重定位操作也尊重分片分配和恢复设置。

# Shard request cache settings 分片请求缓存设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/indices/request_cache.asciidoc)

When a search request is run against an index or against many indices, each involved shard executes the search locally and returns its local results to the *coordinating node*, which combines these shard-level results into a “global” result set.
当针对一个索引或多个索引运行搜索请求时，每个涉及的分片都会在本地执行搜索并将其本地结果返回到*协调节点*，协调节点将这些分片级结果组合成“全局”结果集。

The shard-level request cache module caches the local results on each  shard. This allows frequently used (and potentially heavy) search requests to  return results almost instantly. The requests cache is a very good fit for the  logging use case, where only the most recent index is being actively  updated — results from older indices will be served directly from the  cache.
分片级请求缓存模块将本地结果缓存在每个分片上。这允许频繁使用（并且可能很重）的搜索请求几乎立即返回结果。请求缓存非常适合日志记录用例，其中仅主动更新最新的索引 - 旧索引的结果将直接从缓存提供。

By default, the requests cache will only cache the results of search requests where `size=0`, so it will not cache `hits`, but it will cache `hits.total`,  [aggregations](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html), and [suggestions](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-suggesters.html).
默认情况下，requests 缓存只会缓存`size=0`搜索请求的结果，因此不会缓存`hits` ，但会缓存`hits.total` 、 [aggregations](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html)和[suggest](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-suggesters.html) 。

Most queries that use `now` (see [Date Math](https://www.elastic.co/guide/en/elasticsearch/reference/current/common-options.html#date-math)) cannot be cached.
`now`使用的大多数查询（请参阅[日期数学](https://www.elastic.co/guide/en/elasticsearch/reference/current/common-options.html#date-math)）无法缓存。

Scripted queries that use the API calls which are non-deterministic, such as `Math.random()` or `new Date()` are not cached.
使用非确定性 API 调用（例如`Math.random()`或`new Date()`的脚本化查询不会被缓存。

## Cache invalidation 缓存失效

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/indices/request_cache.asciidoc)

The cache is smart — it keeps the same *near real-time* promise as uncached search.
缓存是智能的——它保持了与未缓存搜索相同的*近乎实时的*承诺。

Cached results are invalidated automatically whenever the shard refreshes to pick up changes to the documents or when you update the mapping. In other words you will always get the same results from the cache as you would for an uncached search request.
每当分片刷新以获取文档更改或更新映射时，缓存结果都会自动失效。换句话说，您始终会从缓存中获得与未缓存的搜索请求相同的结果。

The longer the refresh interval, the longer that cached entries will remain valid even if there are changes to the documents. If the cache is full, the least recently used cache keys will be evicted.
刷新间隔越长，缓存条目保持有效的时间就越长，即使文档发生更改也是如此。如果缓存已满，最近最少使用的缓存键将被逐出。

The cache can be expired manually with the [`clear-cache` API](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-clearcache.html):
可以使用[`clear-cache` API](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-clearcache.html)手动使缓存过期：



```console
POST /my-index-000001,my-index-000002/_cache/clear?request=true
```

Copy as curl 复制为卷曲[Try in Elastic 尝试使用弹性](http://localhost:5601/zzz/app/kibana#/dev_tools/console?load_from=https://www.elastic.co/guide/en/elasticsearch/reference/current/snippets/25.console) 

## Enabling and disabling caching 启用和禁用缓存

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/indices/request_cache.asciidoc)

The cache is enabled by default, but can be disabled when creating a new index as follows:
默认情况下启用缓存，但可以在创建新索引时禁用缓存，如下所示：



```console
PUT /my-index-000001
{
  "settings": {
    "index.requests.cache.enable": false
  }
}
```

Copy as curl 复制为卷曲[Try in Elastic 尝试使用弹性](http://localhost:5601/zzz/app/kibana#/dev_tools/console?load_from=https://www.elastic.co/guide/en/elasticsearch/reference/current/snippets/26.console) 

It can also be enabled or disabled dynamically on an existing index with the [`update-settings`](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-update-settings.html) API:
还可以使用[`update-settings`](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-update-settings.html) API 在现有索引上动态启用或禁用它：



```console
PUT /my-index-000001/_settings
{ "index.requests.cache.enable": true }
```

Copy as curl 复制为卷曲[Try in Elastic 尝试使用弹性](http://localhost:5601/zzz/app/kibana#/dev_tools/console?load_from=https://www.elastic.co/guide/en/elasticsearch/reference/current/snippets/27.console) 

## Enabling and disabling caching per request 针对每个请求启用和禁用缓存

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/indices/request_cache.asciidoc)

The `request_cache` query-string parameter can be used to enable or disable caching on a **per-request** basis. If set, it overrides the index-level setting:
`request_cache`查询字符串参数可用于根据**每个请求**启用或禁用缓存。如果设置，它将覆盖索引级别设置：



```console
GET /my-index-000001/_search?request_cache=true
{
  "size": 0,
  "aggs": {
    "popular_colors": {
      "terms": {
        "field": "colors"
      }
    }
  }
}
```

Copy as curl 复制为卷曲[Try in Elastic 尝试使用弹性](http://localhost:5601/zzz/app/kibana#/dev_tools/console?load_from=https://www.elastic.co/guide/en/elasticsearch/reference/current/snippets/28.console) 

Requests where `size` is greater than 0 will not be cached even if the request cache is enabled in the index settings. To cache these requests you will need to use the query-string parameter detailed here.
即使在索引设置中启用了请求缓存， `size`大于 0 的请求也不会被缓存。要缓存这些请求，您将需要使用此处详细介绍的查询字符串参数。

## Cache key 缓存键

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/indices/request_cache.asciidoc)

A hash of the whole JSON body is used as the cache key. This means that if the JSON changes — for instance if keys are output in a different order — then the cache key will not be recognised.
整个 JSON 主体的哈希值用作缓存键。这意味着如果 JSON 发生更改（例如，如果密钥以不同的顺序输出），则缓存密钥将无法被识别。

Most JSON libraries support a *canonical* mode which ensures that JSON keys are always emitted in the same order. This canonical mode can be used in the application to ensure that a request is always serialized in the same way.
大多数 JSON 库支持*规范*模式，确保 JSON 键始终以相同的顺序发出。这种规范模式可以在应用程序中使用，以确保请求始终以相同的方式序列化。

## Cache settings 缓存设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/indices/request_cache.asciidoc)

The cache is managed at the node level, and has a default maximum size of `1%` of the heap. This can be changed in the `config/elasticsearch.yml` file with:
缓存在节点级别进行管理，默认最大大小为堆的`1%` 。这可以在`config/elasticsearch.yml`文件中更改：

```yaml
indices.requests.cache.size: 2%
```

Also, you can use the `indices.requests.cache.expire` setting to specify a TTL for cached results, but there should be no reason to do so. Remember that stale results are automatically invalidated when the index is refreshed. This setting is provided for completeness' sake only.
另外，您可以使用`indices.requests.cache.expire`设置来指定缓存结果的TTL，但没有理由这样做。请记住，刷新索引时，过时的结果会自动失效。提供此设置只是为了完整性。

## Monitoring cache usage 监控缓存使用情况

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/indices/request_cache.asciidoc)

The size of the cache (in bytes) and the number of evictions can be viewed by index, with the [`indices-stats`](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-stats.html) API:
缓存的大小（以字节为单位）和逐出的数量可以通过索引查看，使用[`indices-stats`](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-stats.html) API：



```console
GET /_stats/request_cache?human
```

Copy as curl 复制为卷曲[Try in Elastic 尝试使用弹性](http://localhost:5601/zzz/app/kibana#/dev_tools/console?load_from=https://www.elastic.co/guide/en/elasticsearch/reference/current/snippets/29.console) 

or by node with the [`nodes-stats`](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html) API:
或使用[`nodes-stats`](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html) API 按节点：



```console
GET /_nodes/stats/indices/request_cache?human
```

Copy as curl 复制为卷曲[Try in Elastic 尝试使用弹性](http://localhost:5601/zzz/app/kibana#/dev_tools/console?load_from=https://www.elastic.co/guide/en/elasticsearch/reference/current/snippets/30.console)

# Snapshot and restore settings 快照和恢复设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/snapshot-settings.asciidoc)

The following cluster settings configure [snapshot and restore](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html).
以下集群设置配置[快照和恢复](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html)。



- `snapshot.max_concurrent_operations`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting), integer) Maximum number of concurrent snapshot operations. Defaults to `1000`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)，整数）并发快照操作的最大数量。默认为`1000` 。 This limit applies in total to all ongoing snapshot creation, cloning, and deletion operations. Elasticsearch will reject any operations that would exceed this limit. 此限制总共适用于所有正在进行的快照创建、克隆和删除操作。 Elasticsearch 将拒绝任何超出此限制的操作。

## SLM settings SLM 设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/snapshot-settings.asciidoc)

The following cluster settings configure [snapshot lifecycle management (SLM)](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-take-snapshot.html#automate-snapshots-slm).
以下集群设置配置[快照生命周期管理 (SLM)](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-take-snapshot.html#automate-snapshots-slm) 。



- `slm.history_index_enabled`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting), Boolean) Controls whether SLM records the history of actions taken as part of SLM policies to the `slm-history-*` indices. Defaults to `true`.  （ [Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting) 、 Boolean）控制 SLM 是否将作为 SLM 策略一部分所采取的操作历史记录记录到`slm-history-*`索引。默认为`true` 。



- `slm.retention_schedule`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting), [cron scheduler value](https://www.elastic.co/guide/en/elasticsearch/reference/current/trigger-schedule.html#schedule-cron)) Controls when the [retention task](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-take-snapshot.html#slm-retention-task) runs. Can be a periodic or absolute time schedule. Supports all values supported by the [cron scheduler](https://www.elastic.co/guide/en/elasticsearch/reference/current/trigger-schedule.html#schedule-cron). Defaults to daily at 1:30am UTC: `0 30 1 * * ?`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)、 [cron 调度程序值](https://www.elastic.co/guide/en/elasticsearch/reference/current/trigger-schedule.html#schedule-cron)）控制[保留任务](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-take-snapshot.html#slm-retention-task)运行的时间。可以是周期性的或绝对的时间表。支持[cron 调度程序](https://www.elastic.co/guide/en/elasticsearch/reference/current/trigger-schedule.html#schedule-cron)支持的所有值。默认为每天凌晨 1:30 UTC： `0 30 1 * * ?` 。



- `slm.retention_duration`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting), [time value](https://www.elastic.co/guide/en/elasticsearch/reference/current/api-conventions.html#time-units)) Limits how long SLM should spend deleting old snapshots. Defaults to one hour: `1h`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)、[时间值](https://www.elastic.co/guide/en/elasticsearch/reference/current/api-conventions.html#time-units)）限制 SLM 删除旧快照所需的时间。默认为一小时： `1h` 。



- `slm.health.failed_snapshot_warn_threshold`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting), Long) The number of failed invocations since last successful snapshot that indicate a problem with the policy in the health api. Defaults to a health api warning after five repeated failures: `5L`.  （ [Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting) 、 Long）自上次成功快照以来指示运行状况 api 中的策略存在问题的失败调用次数。五次重复失败后默认发出健康 api 警告： `5L` 。



- `repositories.url.allowed_urls` [![logo cloud](https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg)](https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&placement=docs-body)

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Specifies the [read-only URL repositories](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-read-only-repository.html) that snapshots can be restored from.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）指定可以从中恢复快照的[只读 URL 存储库](https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-read-only-repository.html)。

# Transforms settings in Elasticsearch 转换 Elasticsearch 中的设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/transform-settings.asciidoc)

You do not need to configure any settings to use transforms. It is enabled by default.
您无需配置任何设置即可使用转换。默认情况下它是启用的。

## General transforms settings 常规变换设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/transform-settings.asciidoc)

- `node.roles: [ transform ]`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Set `node.roles` to contain `transform` to identify the node as a *transform node*. If you want to run transforms, there must be at least one transform node in your cluster.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）设置`node.roles`以包含`transform` ，以将该节点标识为*变换节点*。如果要运行转换，集群中必须至少有一个转换节点。 If you set `node.roles`, you must explicitly specify all the required roles for the node. To learn more, refer to [Nodes](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html). 如果设置`node.roles` ，则必须显式指定节点所需的所有角色。要了解更多信息，请参阅[节点](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html)。  It is strongly recommended that dedicated transform nodes also have the `remote_cluster_client` role; otherwise, cross-cluster search fails when used in transforms. See [Remote-eligible node](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html#remote-node). 强烈建议专用转换节点也具有`remote_cluster_client`角色；否则，在转换中使用跨集群搜索时会失败。请参阅[远程合格节点](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html#remote-node)。

- `xpack.transform.enabled`

  [7.8.0]  [ 7.8.0 ] Deprecated in 7.8.0. Basic License features should always be enabled  7.8.0 中已弃用。应始终启用基本许可证功能 ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) This deprecated setting no longer has any effect.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）此已弃用的设置不再有任何作用 影响。

- `xpack.transform.num_transform_failure_retries`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-update-settings.html)) The number of times that a transform retries when it experiences a non-fatal error. Once the number of retries is exhausted, the transform task is marked as `failed`. The default value is `10` with a valid minimum of `0` and maximum of `100`. If a transform is already running, it has to be restarted to use the changed setting. The `num_failure_retries` setting can also be specified on an individual transform level. Specifying this setting for each transform individually is recommended.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-update-settings.html)）转换遇到非致命错误时重试的次数。一旦重试次数用尽，转换任务将被标记为`failed` 。默认值为`10` ，有效最小值为`0` ，最大值为`100` 。如果转换已在运行，则必须重新启动才能使用更改后的设置。 `num_failure_retries`设置也可以在单独的转换级别上指定。建议为每个转换单独指定此设置。

# Thread pools 线程池

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/threadpool.asciidoc)

A node uses several thread pools to manage memory consumption. Queues associated with many of the thread pools enable pending requests to be held instead of discarded.
一个节点使用多个线程池来管理内存消耗。与许多线程池关联的队列使得挂起的请求能够被保留而不是被丢弃。

There are several thread pools, but the important ones include:
有几个线程池，但重要的包括：

- `generic`

  For generic operations (for example, background node discovery). Thread pool type is `scaling`.  用于通用操作（例如，后台节点发现）。线程池类型是`scaling` 。



- `search`

  For coordination of count/search operations at the shard level whose computation is offloaded to the search_worker thread pool. Used also by fetch and other search related operations  Thread pool type is `fixed` with a size of `int((`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)` * 3) / 2) + 1`, and queue_size of `1000`.  用于协调分片级别的计数/搜索操作，其计算被卸载到 search_worker 线程池。也由 fetch 和其他搜索相关操作使用。 线程池类型的大小`fixed`为`int((` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `* 3) / 2) + 1` ，并且 queue_size 为`1000` 。

- `search_worker`

  For the heavy workload of count/search operations that may be executed concurrently across segments within the same shard when possible. Thread pool type is `fixed` with a size of `int((`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)` * 3) / 2) + 1`, and unbounded queue_size .  对于可能在同一分片内的多个段之间并发执行的计数/搜索操作的繁重工作负载。线程池类型的大小`fixed`为`int((` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `* 3) / 2) + 1`和无界的 queue_size 。

- `search_throttled`

  For count/search/suggest/get operations on `search_throttled indices`. Thread pool type is `fixed` with a size of `1`, and queue_size of `100`.  用于对`search_throttled indices`进行计数/搜索/建议/获取操作。线程池类型`fixed`大小为`1` ，queue_size 为`100` 。

- `search_coordination`

  For lightweight search-related coordination operations. Thread pool type is `fixed` with a size of `(`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2`, and queue_size of `1000`.  用于轻量级搜索相关的协调操作。线程池类型`fixed`大小为`(` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2` ，queue_size 为`1000` 。

- `get`

  For get operations. Thread pool type is `fixed` with a size of `int((`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)` * 3) / 2) + 1`, and queue_size of `1000`.  用于获取操作。线程池类型的大小`fixed`为`int((` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `* 3) / 2) + 1` ，并且 queue_size 为`1000` 。

- `analyze`

  For analyze requests. Thread pool type is `fixed` with a size of `1`, queue size of `16`.  用于分析请求。线程池类型`fixed`大小为`1` ，队列大小为`16` 。

- `write`

  For single-document index/delete/update, ingest processors, and bulk requests. Thread pool type is `fixed` with a size of [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors), queue_size of `10000`. The maximum size for this pool is `1 + `[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors).  用于单文档索引/删除/更新、摄取处理器和批量请求。线程池类型`fixed`为[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)大小，queue_size 为`10000` 。该池的最大大小是`1 +` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) 。

- `snapshot`

  For snapshot/restore operations. Thread pool type is `scaling` with a keep-alive of `5m`. On nodes with at least 750MB of heap the maximum size of this pool is `10` by default. On nodes with less than 750MB of heap the maximum size of this pool is `min(5, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2)` by default.  用于快照/恢复操作。线程池类型可`scaling` ，保持活动时间为`5m` 。在具有至少 750MB 堆的节点上，该池的最大大小默认为`10` 。在堆小于 750MB 的节点上，默认情况下该池的最大大小为`min(5, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2)` 。

- `snapshot_meta`

  For snapshot repository metadata read operations. Thread pool type is `scaling` with a keep-alive of `5m` and a max of `min(50, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`* 3))`.  用于快照存储库元数据读取操作。线程池类型可`scaling` ，保持活动时间为`5m` ，最大值为`min(50, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `* 3))` 。

- `warmer`

  For segment warm-up operations. Thread pool type is `scaling` with a keep-alive of `5m` and a max of `min(5, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2)`.  用于分段预热操作。线程池类型可`scaling` ，保持活动时间为`5m` ，最大值为`min(5, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2)` 。

- `refresh`

  For refresh operations. Thread pool type is `scaling` with a keep-alive of `5m` and a max of `min(10, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2)`.  用于刷新操作。线程池类型可`scaling` ，保持活动时间为`5m` ，最大值为`min(10, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2)` 。

- `fetch_shard_started`

  For listing shard states. Thread pool type is `scaling` with keep-alive of `5m` and a default maximum size of `2 * `[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors).  用于列出分片状态。线程池类型可`scaling` ，保持活动长度为`5m` ，默认最大大小为`2 *` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) 。

- `fetch_shard_store`

  For listing shard stores. Thread pool type is `scaling` with keep-alive of `5m` and a default maximum size of `2 * `[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors).  用于列出分片商店。线程池类型可`scaling` ，保持活动长度为`5m` ，默认最大大小为`2 *` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) 。

- `flush`

  For [flush](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-flush.html) and [translog](https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-translog.html) `fsync` operations. Thread pool type is `scaling` with a keep-alive of `5m` and a default maximum size of `min(5, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2)`.  用于[刷新](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-flush.html)和[translog](https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-translog.html) `fsync`操作。线程池类型可`scaling` ，保持活动长度为`5m` ，默认最大大小为`min(5, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2)` 。

- `force_merge`

  ​    For [force merge](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-forcemerge.html) operations.    Thread pool type is `fixed` with a size of `max(1, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 8)` and an unbounded queue size.  用于[强制合并](https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-forcemerge.html)操作。线程池类型的大小`fixed`为`max(1, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 8)`和无界队列大小。

- `management`

  For cluster management. Thread pool type is `scaling` with a keep-alive of `5m` and a default maximum size of `5`.  用于集群管理。线程池类型可`scaling` ，保持活动长度为`5m` ，默认最大大小为`5` 。

- `system_read`

  For read operations on system indices. Thread pool type is `fixed` with a default maximum size of `min(5, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2)`.  用于系统索引的读取操作。线程池类型`fixed`为默认最大大小`min(5, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2)` 。

- `system_write`

  For write operations on system indices. Thread pool type is `fixed` with a default maximum size of `min(5, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2)`.  用于系统索引的写操作。线程池类型`fixed`为默认最大大小`min(5, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2)` 。

- `system_critical_read`

  For critical read operations on system indices. Thread pool type is `fixed` with a default maximum size of `min(5, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2)`.  用于系统索引的关键读取操作。线程池类型`fixed`为默认最大大小`min(5, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2)` 。

- `system_critical_write`

  For critical write operations on system indices. Thread pool type is `fixed` with a default maximum size of `min(5, (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`) / 2)`.  用于系统索引上的关键写入操作。线程池类型`fixed`为默认最大大小`min(5, (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `) / 2)` 。

- `watcher`

  For [watch executions](https://www.elastic.co/guide/en/elasticsearch/reference/current/xpack-alerting.html). Thread pool type is `fixed` with a default maximum size of `min(5 * (`[`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors)`), 50)` and queue_size of `1000`.  用于[观看处决](https://www.elastic.co/guide/en/elasticsearch/reference/current/xpack-alerting.html)。线程池类型`fixed` ，默认最大大小为`min(5 * (` [`# of allocated processors`](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-threadpool.html#node.processors) `), 50)` ，queue_size 为`1000` 。

Thread pool settings are [static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting) and can be changed by editing `elasticsearch.yml`. Changing a specific thread pool can be done by setting its type-specific parameters; for example, changing the number of threads in the `write` thread pool:
线程池设置是[静态的](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)，可以通过编辑`elasticsearch.yml`进行更改。可以通过设置特定于类型的参数来更改特定的线程池；例如，更改`write`线程池中的线程数：

```yaml
thread_pool:
    write:
        size: 30
```

## Thread pool types 线程池类型

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/threadpool.asciidoc)

The following are the types of thread pools and their respective parameters:
以下是线程池的类型及其各自的参数：

### `fixed`

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/threadpool.asciidoc)

The `fixed` thread pool holds a fixed size of threads to handle the requests with a queue (optionally bounded) for pending requests that have no threads to service them.
`fixed`线程池保存固定大小的线程来处理请求，并使用队列（可选有界）来处理没有线程为其提供服务的待处理请求。

The `size` parameter controls the number of threads.
`size`参数控制线程的数量。

The `queue_size` allows to control the size of the queue of pending requests that have no threads to execute them. By default, it is set to `-1` which means its unbounded. When a request comes in and the queue is full, it will abort the request.
`queue_size`允许控制没有线程执行的待处理请求队列的大小。默认情况下，它设置为`-1` ，这意味着它是无界的。当请求进来并且队列已满时，它将中止该请求。

```yaml
thread_pool:
    write:
        size: 30
        queue_size: 1000
```

### `scaling`

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/threadpool.asciidoc)

The `scaling` thread pool holds a dynamic number of threads. This number is proportional to the workload and varies between the value of the `core` and `max` parameters.
`scaling`线程池保存动态数量的线程。该数字与工作负载成正比，并且在`core`和`max`参数的值之间变化。

The `keep_alive` parameter determines how long a thread should be kept around in the thread pool without it doing any work.
`keep_alive`参数确定线程在不执行任何工作的情况下应在线程池中保留多长时间。

```yaml
thread_pool:
    warmer:
        core: 1
        max: 8
        keep_alive: 2m
```

## Allocated processors setting 分配的处理器设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/modules/threadpool.asciidoc)

The number of processors is automatically detected, and the thread pool settings are automatically set based on it. In some cases it can be useful to override the number of detected processors. This can be done by explicitly setting the `node.processors` setting. This setting is bounded by the number of available processors and accepts floating point numbers, which can be useful in environments where the Elasticsearch nodes are configured to run with CPU limits, such as cpu shares or quota under `Cgroups`.
自动检测处理器的数量，并根据它自动设置线程池设置。在某些情况下，覆盖检测到的处理器的数量可能很有用。这可以通过显式设置`node.processors`设置来完成。此设置受可用处理器数量的限制，并接受浮点数，这在 Elasticsearch 节点配置为在 CPU 限制（例如`Cgroups`下的 cpu 份额或配额）下运行的环境中非常有用。

```yaml
node.processors: 2
```

There are a few use-cases for explicitly overriding the `node.processors` setting:
有一些显式覆盖`node.processors`设置的用例：

1. If you are running multiple instances of Elasticsearch on the same host but want Elasticsearch to size its thread pools as if it only has a fraction of the CPU, you should override the `node.processors` setting to the desired fraction, for example, if you’re running two instances of Elasticsearch on a 16-core machine, set `node.processors` to 8. Note that this is an expert-level use case and there’s a lot more involved than just setting the `node.processors` setting as there are other considerations like changing the number of garbage collector threads, pinning processes to cores, and so on. 
   如果您在同一主机上运行多个 Elasticsearch 实例，但希望 Elasticsearch 调整其线程池的大小，就好像它只占用 CPU 的一小部分一样，您应该将`node.processors`设置覆盖为所需的分数，例如，如果您'在 16 核机器上运行两个 Elasticsearch 实例，将`node.processors`设置为 8。请注意，这是一个专家级用例，涉及的不仅仅是设置`node.processors`设置，还有其他注意事项，例如更改垃圾收集器线程的数量、将进程固定到核心等等。
2. Sometimes the number of processors is wrongly detected and in such cases explicitly setting the `node.processors` setting will workaround such issues. 
   有时会错误地检测到处理器的数量，在这种情况下，显式设置`node.processors`设置将解决此类问题。

In order to check the number of processors detected, use the nodes info API with the `os` flag.
为了检查检测到的处理器数量，请使用带有`os`标志的节点信息 API。

# Watcher settings in Elasticsearch Elasticsearch 中的观察者设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/notification-settings.asciidoc)

You configure Watcher settings to set up Watcher and send notifications via [email](https://www.elastic.co/guide/en/elasticsearch/reference/current/notification-settings.html#email-notification-settings), [Slack](https://www.elastic.co/guide/en/elasticsearch/reference/current/notification-settings.html#slack-notification-settings), and [PagerDuty](https://www.elastic.co/guide/en/elasticsearch/reference/current/notification-settings.html#pagerduty-notification-settings).
您可以配置 Watcher 设置来设置 Watcher 并通过[电子邮件](https://www.elastic.co/guide/en/elasticsearch/reference/current/notification-settings.html#email-notification-settings)、 [Slack](https://www.elastic.co/guide/en/elasticsearch/reference/current/notification-settings.html#slack-notification-settings)和[PagerDuty](https://www.elastic.co/guide/en/elasticsearch/reference/current/notification-settings.html#pagerduty-notification-settings)发送通知。

All of these settings can be added to the `elasticsearch.yml` configuration file, with the exception of the secure settings, which you add to the Elasticsearch keystore. For more information about creating and updating the Elasticsearch keystore, see [Secure settings](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html). Dynamic settings can also be updated across a cluster with the [cluster update settings API](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-update-settings.html).
所有这些设置都可以添加到`elasticsearch.yml`配置文件中，但安全设置除外，您可以将其添加到 Elasticsearch 密钥库中。有关创建和更新 Elasticsearch 密钥库的更多信息，请参阅[安全设置](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)。还可以使用[集群更新设置 API](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-update-settings.html)在集群中更新动态设置。

## General Watcher Settings 常规观察者设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/notification-settings.asciidoc)

- `xpack.watcher.enabled`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Set to `false` to disable Watcher on the node.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）设置为`false`以禁用节点上的 Watcher。



- `xpack.watcher.encrypt_sensitive_data` [![logo cloud](https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg)](https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&placement=docs-body)

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Set to `true` to encrypt sensitive data. If this setting is enabled, you must also specify the `xpack.watcher.encryption_key` setting. For more information, see [*Encrypting sensitive data in Watcher*](https://www.elastic.co/guide/en/elasticsearch/reference/current/encrypting-data.html).  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）设置为`true`以加密敏感数据。如果启用此设置，您还必须指定`xpack.watcher.encryption_key`设置。有关更多信息，请参阅[*加密 Watcher 中的敏感数据*](https://www.elastic.co/guide/en/elasticsearch/reference/current/encrypting-data.html)。

- `xpack.watcher.encryption_key`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) Specifies the path to a file that contains a key for encrypting sensitive data. If `xpack.watcher.encrypt_sensitive_data` is set to `true`, this setting is required. For more information, see [*Encrypting sensitive data in Watcher*](https://www.elastic.co/guide/en/elasticsearch/reference/current/encrypting-data.html).  ( [Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html) ) 指定包含用于加密敏感数据的密钥的文件的路径。如果 `xpack.watcher.encrypt_sensitive_data` 设置为`true` ，此设置是必需的。有关更多信息，请参阅[*加密 Watcher 中的敏感数据*](https://www.elastic.co/guide/en/elasticsearch/reference/current/encrypting-data.html)。

- `xpack.http.proxy.host`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Specifies the address of the proxy server to use to connect to HTTP services.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）指定用于连接到 HTTP 服务的代理服务器的地址。

- `xpack.http.proxy.port`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Specifies the port number to use to connect to the proxy server.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）指定用于连接到代理服务器的端口号。

- `xpack.http.proxy.scheme`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Protocol used to communicate with the proxy server. Valid values are `http` and `https`. Defaults to the protocol used in the request.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）用于与代理服务器通信的协议。有效值为`http`和`https` 。默认为请求中使用的协议。

- `xpack.http.default_connection_timeout`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The maximum period to wait until abortion of the request, when a connection is being initiated.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）启动连接时等待请求中止的最长时间。

- `xpack.http.default_read_timeout`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The maximum period of inactivity between two data packets, before the request is aborted.

- `xpack.http.tcp.keep_alive`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Whether to enable TCP keepalives on HTTP connections. Defaults to `true`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）是否在 HTTP 连接上启用 TCP keepalive。默认为`true` 。

- `xpack.http.connection_pool_ttl`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The time-to-live of connections in the connection pool. If a connection is not re-used within this timeout, it is closed. By default, the time-to-live is infinite meaning that connections never expire.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）连接池中连接的生存时间。如果在此超时时间内未重新使用连接，则该连接将被关闭。默认情况下，生存时间是无限的，这意味着连接永远不会过期。

- `xpack.http.max_response_size`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Specifies the maximum size an HTTP response is allowed to have, defaults to `10mb`, the maximum configurable value is `50mb`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）指定HTTP响应允许的最大大小，默认为`10mb` ，最大可配置值为`50mb` 。

- `xpack.http.whitelist`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) A list of URLs, that the internal HTTP client is allowed to connect to. This client is used in the HTTP input, the webhook, the slack, pagerduty, and jira actions. This setting can be updated dynamically. It defaults to `*` allowing everything. Note: If you configure this setting and you are using one of the slack/pagerduty actions, you have to ensure that the corresponding endpoints are explicitly allowed as well.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）允许内部 HTTP 客户端连接的 URL 列表。该客户端用于 HTTP 输入、webhook、slack、pagerduty 和 jira 操作。该设置可以动态更新。它默认为`*`允许一切。注意：如果您配置此设置并且正在使用 slack/pagerduty 操作之一，则必须确保也明确允许相应的端点。

## Watcher HTTP TLS/SSL settings 观察者 HTTP TLS/SSL 设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

You can configure the following TLS/SSL settings.
您可以配置以下 TLS/SSL 设置。

- `xpack.http.ssl.supported_protocols`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Supported protocols with versions. Valid protocols: `SSLv2Hello`, `SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. If the JVM’s SSL provider supports TLSv1.3, the default is `TLSv1.3,TLSv1.2,TLSv1.1`. Otherwise, the default is `TLSv1.2,TLSv1.1`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）支持的协议及其版本。有效协议： `SSLv2Hello` 、 `SSLv3` 、 `TLSv1` 、 `TLSv1.1` 、 `TLSv1.2` 、 `TLSv1.3` 。如果 JVM 的 SSL 提供程序支持 TLSv1.3，则默认值为`TLSv1.3,TLSv1.2,TLSv1.1` 。否则，默认为`TLSv1.2,TLSv1.1` 。 Elasticsearch relies on your JDK’s implementation of SSL and TLS. View [Supported SSL/TLS versions by JDK version](https://www.elastic.co/guide/en/elasticsearch/reference/current/jdk-tls-versions.html) for more information. Elasticsearch 依赖于 JDK 的 SSL 和 TLS 实现。查看[按 JDK 版本支持的 SSL/TLS 版本](https://www.elastic.co/guide/en/elasticsearch/reference/current/jdk-tls-versions.html)以了解更多信息。  If `xpack.security.fips_mode.enabled` is `true`, you cannot use `SSLv2Hello` or `SSLv3`. See [FIPS 140-2](https://www.elastic.co/guide/en/elasticsearch/reference/current/fips-140-compliance.html). 如果 `xpack.security.fips_mode.enabled` 为`true`时，您不能使用`SSLv2Hello`或`SSLv3` 。请参阅[FIPS 140-2](https://www.elastic.co/guide/en/elasticsearch/reference/current/fips-140-compliance.html) 。

- `xpack.http.ssl.verification_mode`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Defines how to verify the certificates presented by another party in the TLS connection:  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）定义如何验证 TLS 连接中另一方提供的证书： Valid values 选择痛点   `full`  Validates that the provided certificate: has an issue date that’s within the `not_before` and `not_after` dates; chains to a trusted Certificate Authority (CA); has a `hostname` or IP address that matches the names within the certificate.  验证所提供的证书： 颁发日期在`not_before`和`not_after`日期内；链接至受信任的证书颁发机构 (CA)；具有与证书中的名称匹配的`hostname`或 IP 地址。  `certificate`  Validates the provided certificate and verifies that it’s signed by a trusted authority (CA), but doesn’t check the certificate `hostname`.  验证提供的证书并验证它是否由受信任的颁发机构 (CA) 签名，但不检查证书`hostname` 。  `none`   Performs no certificate validation.  不执行证书验证。  Setting certificate validation to `none` disables many security benefits of SSL/TLS, which is very dangerous. Only set this value if instructed by Elastic Support as a temporary diagnostic mechanism when attempting to resolve TLS errors. 将证书验证设置为`none`会禁用 SSL/TLS 的许多安全优势，这是非常危险的。仅当 Elastic Support 指示在尝试解决 TLS 错误时将其作为临时诊断机制时，才设置此值。    Defaults to `full`. 默认为`full` 。

- `xpack.http.ssl.cipher_suites`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Supported cipher suites vary depending on which version of Java you use. For example, for version 12 the default value is `TLS_AES_256_GCM_SHA384`, `TLS_AES_128_GCM_SHA256`, `TLS_CHACHA20_POLY1305_SHA256`, `TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384`, `TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256`, `TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384`, `TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256`, `TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256`, `TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256`, `TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384`, `TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256`, `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384`, `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256`, `TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA`, `TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA`, `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA`, `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA`, `TLS_RSA_WITH_AES_256_GCM_SHA384`, `TLS_RSA_WITH_AES_128_GCM_SHA256`, `TLS_RSA_WITH_AES_256_CBC_SHA256`, `TLS_RSA_WITH_AES_128_CBC_SHA256`, `TLS_RSA_WITH_AES_256_CBC_SHA`, `TLS_RSA_WITH_AES_128_CBC_SHA`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）支持的密码套件因您使用的 Java 版本而异。例如，对于版本 12，默认值为`TLS_AES_256_GCM_SHA384` 、 `TLS_AES_128_GCM_SHA256` 、 `TLS_CHACHA20_POLY1305_SHA256` 、 `TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384` , `TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256` , `TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384` , `TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256` , `TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256` , `TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256` , `TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384` , `TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256` , `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384` , `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256` , `TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA` , `TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA` , `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA` , `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA` , `TLS_RSA_WITH_AES_256_GCM_SHA384` , `TLS_RSA_WITH_AES_128_GCM_SHA256` , `TLS_RSA_WITH_AES_256_CBC_SHA256` , `TLS_RSA_WITH_AES_128_CBC_SHA256` 、 `TLS_RSA_WITH_AES_256_CBC_SHA` 、 `TLS_RSA_WITH_AES_128_CBC_SHA` 。 For more information, see Oracle’s [Java Cryptography Architecture documentation](https://docs.oracle.com/en/java/javase/11/security/oracle-providers.html#GUID-7093246A-31A3-4304-AC5F-5FB6400405E2). 有关更多信息，请参阅 Oracle 的[Java 加密体系结构文档](https://docs.oracle.com/en/java/javase/11/security/oracle-providers.html#GUID-7093246A-31A3-4304-AC5F-5FB6400405E2)。

### Watcher HTTP TLS/SSL key and trusted certificate settings 观察者 HTTP TLS/SSL 密钥和可信证书设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

The following settings are used to specify a private key, certificate, and the trusted certificates that should be used when communicating over an SSL/TLS connection. A private key and certificate are optional and would be used if the server requires client authentication for PKI authentication.
以下设置用于指定通过 SSL/TLS 连接进行通信时应使用的私钥、证书和受信任证书。私钥和证书是可选的，如果服务器需要客户端身份验证进行 PKI 身份验证，则将使用私钥和证书。

### PEM encoded files PEM 编码文件

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

When using PEM encoded files, use the following settings:
使用 PEM 编码文件时，请使用以下设置：

- `xpack.http.ssl.key`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Path to a PEM encoded file containing the private key.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含私钥的 PEM 编码文件的路径。 If HTTP client authentication is required, it uses this file. You cannot use this setting and `ssl.keystore.path` at the same time. 如果需要 HTTP 客户端身份验证，则使用此文件。您不能同时使用此设置和`ssl.keystore.path` 。

- `xpack.http.ssl.secure_key_passphrase`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The passphrase that is used to decrypt the private key. Since the key might not be encrypted, this value is optional.  ( [Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html) ) 用于解密私钥的密码。由于密钥可能未加密，因此该值是可选的。

- `xpack.http.ssl.certificate`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Specifies the path for the PEM encoded certificate (or certificate chain) that is associated with the key.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）指定与密钥关联的 PEM 编码证书（或证书链）的路径。 This setting can be used only if `ssl.key` is set. 仅当设置了`ssl.key`时才能使用此设置。

- `xpack.http.ssl.certificate_authorities`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) List of paths to PEM encoded certificate files that should be trusted.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）应信任的 PEM 编码证书文件的路径列表。 This setting and `ssl.truststore.path` cannot be used at the same time. 此设置和`ssl.truststore.path`不能同时使用。

### Java keystore files Java 密钥库文件

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

When using Java keystore files (JKS), which contain the private key, certificate and certificates that should be trusted, use the following settings:
使用包含私钥、证书和应信任证书的 Java 密钥库文件 (JKS) 时，请使用以下设置：

- `xpack.http.ssl.keystore.path`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The path for the keystore file that contains a private key and certificate.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含私钥和证书的密钥库文件的路径。 It must be either a Java keystore (jks) or a PKCS#12 file. You cannot use this setting and `ssl.key` at the same time. 它必须是 Java 密钥库 (jks) 或 PKCS#12 文件。您不能同时使用此设置和`ssl.key` 。

- `xpack.http.ssl.keystore.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The password for the keystore.  ([安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) 密钥库的密码。

- `xpack.http.ssl.keystore.secure_key_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The password for the key in the keystore. The default is the keystore password.  ([安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) 密钥库中密钥的密码。默认是密钥库密码。

- `xpack.http.ssl.truststore.path`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The path for the keystore that contains the certificates to trust. It must be either a Java keystore (jks) or a PKCS#12 file.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含要信任的证书的密钥库的路径。它必须是 Java 密钥库 (jks) 或 PKCS#12 文件。 You cannot use this setting and `ssl.certificate_authorities` at the same time. 您不能同时使用此设置和`ssl.certificate_authorities` 。

- `xpack.http.ssl.truststore.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) Password for the truststore.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)）信任库的密码。

### PKCS#12 files PKCS#12 文件

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

Elasticsearch can be configured to use PKCS#12 container files (`.p12` or `.pfx` files) that contain the private key, certificate and certificates that should be trusted.
Elasticsearch 可以配置为使用 PKCS#12 容器文件（ `.p12`或`.pfx`文件），其中包含私钥、证书和应信任的证书。

PKCS#12 files are configured in the same way as Java keystore files:
PKCS#12 文件的配置方式与 Java 密钥库文件相同：

- `xpack.http.ssl.keystore.path`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The path for the keystore file that contains a private key and certificate.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含私钥和证书的密钥库文件的路径。 It must be either a Java keystore (jks) or a PKCS#12 file. You cannot use this setting and `ssl.key` at the same time. 它必须是 Java 密钥库 (jks) 或 PKCS#12 文件。您不能同时使用此设置和`ssl.key` 。

- `xpack.http.ssl.keystore.type`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The format of the keystore file. It must be either `jks` or `PKCS12`. If the keystore path ends in ".p12", ".pfx", or ".pkcs12", this setting defaults to `PKCS12`. Otherwise, it defaults to `jks`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）密钥库文件的格式。它必须是`jks`或`PKCS12` 。如果密钥库路径以“.p12”、“.pfx”或“.pkcs12”结尾，则此设置默认为`PKCS12` 。否则，它默认为`jks` 。

- `xpack.http.ssl.keystore.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The password for the keystore.  ([安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) 密钥库的密码。

- `xpack.http.ssl.keystore.secure_key_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The password for the key in the keystore. The default is the keystore password.  ([安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) 密钥库中密钥的密码。默认是密钥库密码。

- `xpack.http.ssl.truststore.path`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The path for the keystore that contains the certificates to trust. It must be either a Java keystore (jks) or a PKCS#12 file.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含要信任的证书的密钥库的路径。它必须是 Java 密钥库 (jks) 或 PKCS#12 文件。 You cannot use this setting and `ssl.certificate_authorities` at the same time. 您不能同时使用此设置和`ssl.certificate_authorities` 。

- `xpack.http.ssl.truststore.type`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Set this to `PKCS12` to indicate that the truststore is a PKCS#12 file.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）将此设置为`PKCS12`以指示信任库是 PKCS#12 文件。

- `xpack.http.ssl.truststore.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) Password for the truststore.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)）信任库的密码。

## Email Notification Settings 电子邮件通知设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/notification-settings.asciidoc)

You can configure the following email notification settings in `elasticsearch.yml`. For more information about sending notifications via email, see [Configuring email actions](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#configuring-email-actions).
您可以在`elasticsearch.yml`中配置以下电子邮件通知设置。有关通过电子邮件发送通知的更多信息，请参阅[配置电子邮件操作](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#configuring-email-actions)。

- `xpack.notification.email.default_account`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Default email account to use.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）要使用的默认电子邮件帐户。 If you configure multiple email accounts, you must either configure this setting or specify the email account to use in the [`email`](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html) action. See [Configuring email accounts](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#configuring-email). 如果您配置多个电子邮件帐户，则必须配置此设置或指定要在[`email`](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html)操作中使用的电子邮件帐户。请参阅[配置电子邮件帐户](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#configuring-email)。

- `xpack.notification.email.account`

  Specifies account information for sending notifications via email. You can specify the following email account attributes:  指定用于通过电子邮件发送通知的帐户信息。您可以指定以下电子邮件帐户属性：

- `xpack.notification.email.account.domain_allowlist`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Specifies domains to which emails are allowed to be sent. Emails with recipients (`To:`, `Cc:`, or `Bcc:`) outside of these domains will be rejected and an error thrown. This setting defaults to `["*"]` which means all domains are allowed. Simple globbing is supported, such as `*.company.com` in the list of allowed domains.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）指定允许向其发送电子邮件的域。收件人（ `To:` 、 `Cc:`或`Bcc:` ：）位于这些域之外的电子邮件将被拒绝并引发错误。此设置默认为`["*"]`这意味着允许所有域。支持简单的通配，例如允许域列表中的`*.company.com` 。



- `profile`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The [email profile](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#configuring-email) to use to build the MIME messages that are sent from the account. Valid values: `standard`, `gmail` and `outlook`. Defaults to `standard`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）用于构建从帐户发送的 MIME 消息的[电子邮件配置文件](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#configuring-email)。有效值： `standard` 、 `gmail`和`outlook` 。默认为`standard` 。

- `email_defaults.*`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) An optional set of email attributes to use as defaults for the emails sent from the account. See [Email action attributes](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#email-action-attributes) for the supported attributes.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）一组可选的电子邮件属性，用作从帐户发送的电子邮件的默认值。有关支持的属性，请参阅[电子邮件操作属性](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#email-action-attributes)。

- `smtp.auth`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Set to `true` to attempt to authenticate the user using the AUTH command. Defaults to `false`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）设置为`true`以尝试使用 AUTH 命令对用户进行身份验证。默认为`false` 。

- `smtp.host`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The SMTP server to connect to. Required.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）要连接的 SMTP 服务器。必需的。

- `smtp.port`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The SMTP server port to connect to. Defaults to 25.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）要连接的 SMTP 服务器端口。默认为 25。

- `smtp.user`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The user name for SMTP. Required.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）SMTP 的用户名。必需的。

- `smtp.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html), [reloadable](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)) The password for the specified SMTP user.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)、[可重新加载](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)）指定 SMTP 用户的密码。

- `smtp.starttls.enable`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Set to `true` to enable the use of the `STARTTLS` command (if supported by the server) to switch the connection to a TLS-protected connection before issuing any login commands. Note that an appropriate trust store must be configured so that the client will trust the server’s certificate. Defaults to `false`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）设置为`true`以允许使用`STARTTLS`命令（如果服务器支持）在发出任何登录命令之前将连接切换到受 TLS 保护的连接。请注意，必须配置适当的信任存储，以便客户端信任服务器的证书。默认为`false` 。

- `smtp.starttls.required`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) If `true`, then `STARTTLS` will be required. If that command fails, the connection will fail. Defaults to `false`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）如果`true` ，则需要`STARTTLS` 。如果该命令失败，连接将失败。默认为`false` 。

- `smtp.ssl.trust`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) A list of SMTP server hosts that are assumed trusted and for which certificate verification is disabled. If set to "*", all hosts are trusted. If set to a whitespace separated list of hosts, those hosts are trusted. Otherwise, trust depends on the certificate the server presents.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）假定受信任且禁用证书验证的 SMTP 服务器主机的列表。如果设置为“*”，则所有主机均受信任。如果设置为以空格分隔的主机列表，则这些主机是受信任的。否则，信任取决于服务器提供的证书。

- `smtp.timeout`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The socket read timeout. Default is two minutes.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）套接字读取超时。默认为两分钟。

- `smtp.connection_timeout`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The socket connection timeout. Default is two minutes.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）套接字连接超时。默认为两分钟。

- `smtp.write_timeout`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The socket write timeout. Default is two minutes.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）套接字写入超时。默认为两分钟。

- `smtp.local_address`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) A configurable local address when sending emails. Not configured by default.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）发送电子邮件时可配置的本地地址。默认情况下未配置。

- `smtp.local_port`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) A configurable local port when sending emails. Not configured by default.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）发送电子邮件时可配置的本地端口。默认情况下未配置。

- `smtp.send_partial`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Send an email, despite one of the receiver addresses being invalid.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）发送电子邮件，尽管其中一个收件人地址无效。

- `smtp.wait_on_quit`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) If set to false the QUIT command is sent and the connection closed. If set to true, the QUIT command is sent and a reply is waited for. True by default.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）如果设置为 false，则发送 QUIT 命令并关闭连接。如果设置为 true，则发送 QUIT 命令并等待回复。默认为真。

- `xpack.notification.email.html.sanitization.allow`

  Specifies the HTML elements that are allowed in email notifications. For more information, see [Configuring HTML sanitization options](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#email-html-sanitization). You can specify individual HTML elements and the following HTML feature groups:  指定电子邮件通知中允许的 HTML 元素。有关详细信息，请参阅[配置 HTML 清理选项](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-email.html#email-html-sanitization)。您可以指定单个 HTML 元素和以下 HTML 功能组：   `_tables`  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) All table related elements: `<table>`, `<th>`, `<tr>`, `<td>`, `<caption>`, `<col>`, `<colgroup>`, `<thead>`, `<tbody>`, and `<tfoot>`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）所有与表相关的元素： `<table>` 、 `<th>` 、 `<tr>` 、 `<td>` 、 `<caption>` 、 `<col>` 、 `<colgroup>` 、 `<thead>` 、 `<tbody>`和`<tfoot>` 。  `_blocks`  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The following block elements: `<p>`, `<div>`, `<h1>`, `<h2>`, `<h3>`, `<h4>`, `<h5>`, `<h6>`, `<ul>`, `<ol>`, `<li>`, and `<blockquote>`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）以下块元素： `<p>` 、 `<div>` 、 `<h1>` 、 `<h2>` 、 `<h3>` 、 `<h4>` 、 `<h5>` 、 `<h6>` 、 `<ul>` 、 `<ol>` 、 `<li>`和`<blockquote>` 。  `_formatting`  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The following inline formatting elements: `<b>`, `<i>`, `<s>`, `<u>`, `<o>`, `<sup>`, `<sub>`, `<ins>`, `<del>`, `<strong>`, `<strike>`, `<tt>`, `<code>`, `<big>`, `<small>`, `<hr>`, `<br>`, `<span>`, and `<em>`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）以下内联格式化元素： `<b>` 、 `<i>` 、 `<s>` 、 `<u>` 、 `<o>` 、 `<sup>` 、 `<sub>` 、 `<ins>` 、 `<del>` 、 `<strong>` 、 `<strike>` 、 `<tt>` 、 `<code>` 、 `<big>` 、 `<small>` 、 `<hr>` 、 `<br>` 、 `<span>`和`<em>` 。  `_links`  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The `<a>` element with an `href` attribute that points to a URL using the following protocols: `http`, `https` and `mailto`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）带有`href`属性的`<a>`元素，该元素指向使用以下协议的 URL： `http` 、 `https`和`mailto` 。  `_styles`  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The `style` attribute on all elements. Note that CSS attributes are also sanitized to prevent XSS attacks.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）所有元素的`style`属性。请注意，CSS 属性也经过清理以防止 XSS 攻击。  `img`   `img:all`  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) All images (external and embedded).  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）所有图像（外部和嵌入）。  `img:embedded`  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Only embedded images. Embedded images can only use the `cid:` URL protocol in their `src` attribute.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）仅嵌入图像。嵌入图像只能在其`src`属性中使用`cid:` URL 协议。

- `xpack.notification.email.html.sanitization.disallow`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Specifies the HTML elements that are NOT allowed in email notifications. You can specify individual HTML elements and [HTML feature groups](https://www.elastic.co/guide/en/elasticsearch/reference/current/notification-settings.html#html-feature-groups).  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）指定电子邮件通知中不允许的 HTML 元素。您可以指定单独的 HTML 元素和[HTML 功能组](https://www.elastic.co/guide/en/elasticsearch/reference/current/notification-settings.html#html-feature-groups)。

- `xpack.notification.email.html.sanitization.enabled`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Set to `false` to completely disable HTML sanitation. Not recommended. Defaults to `true`.

- `xpack.notification.reporting.warning.kbn-csv-contains-formulas.text`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Specifies a custom message, which is sent if the formula verification criteria for CSV files from Kibana’s [`xpack.reporting.csv.checkForFormulas`](https://www.elastic.co/guide/en/kibana/8.15/reporting-settings-kb.html#reporting-csv-settings) is `true`. Use `%s` in the message as a placeholder for the filename. Defaults to `Warning: The attachment [%s] contains characters which spreadsheet applications may interpret as formulas. Please ensure that the attachment is safe prior to opening.` ([动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) 指定自定义消息，如果 Kibana 的 CSV 文件的公式验证条件满足，则发送该消息是`true` 。在消息中使用`%s`作为文件名的占位符。默认为 `Warning: The attachment [%s] contains characters which spreadsheet applications may interpret as formulas. Please ensure that the attachment is safe prior to opening.` 

## Watcher Email TLS/SSL settings 观察者电子邮件 TLS/SSL 设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

You can configure the following TLS/SSL settings.
您可以配置以下 TLS/SSL 设置。

- `xpack.notification.email.ssl.supported_protocols`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Supported protocols with versions. Valid protocols: `SSLv2Hello`, `SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. If the JVM’s SSL provider supports TLSv1.3, the default is `TLSv1.3,TLSv1.2,TLSv1.1`. Otherwise, the default is `TLSv1.2,TLSv1.1`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）支持的协议及其版本。有效协议： `SSLv2Hello` 、 `SSLv3` 、 `TLSv1` 、 `TLSv1.1` 、 `TLSv1.2` 、 `TLSv1.3` 。如果 JVM 的 SSL 提供程序支持 TLSv1.3，则默认值为`TLSv1.3,TLSv1.2,TLSv1.1` 。否则，默认为`TLSv1.2,TLSv1.1` 。 Elasticsearch relies on your JDK’s implementation of SSL and TLS. View [Supported SSL/TLS versions by JDK version](https://www.elastic.co/guide/en/elasticsearch/reference/current/jdk-tls-versions.html) for more information. Elasticsearch 依赖于 JDK 的 SSL 和 TLS 实现。查看[按 JDK 版本支持的 SSL/TLS 版本](https://www.elastic.co/guide/en/elasticsearch/reference/current/jdk-tls-versions.html)以了解更多信息。  If `xpack.security.fips_mode.enabled` is `true`, you cannot use `SSLv2Hello` or `SSLv3`. See [FIPS 140-2](https://www.elastic.co/guide/en/elasticsearch/reference/current/fips-140-compliance.html). 如果 `xpack.security.fips_mode.enabled` 为`true`时，您不能使用`SSLv2Hello`或`SSLv3` 。请参阅[FIPS 140-2](https://www.elastic.co/guide/en/elasticsearch/reference/current/fips-140-compliance.html) 。

- `xpack.notification.email.ssl.verification_mode`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Defines how to verify the certificates presented by another party in the TLS connection:  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）定义如何验证 TLS 连接中另一方提供的证书： Valid values 选择痛点   `full`  Validates that the provided certificate: has an issue date that’s within the `not_before` and `not_after` dates; chains to a trusted Certificate Authority (CA); has a `hostname` or IP address that matches the names within the certificate.  验证所提供的证书： 颁发日期在`not_before`和`not_after`日期内；链接至受信任的证书颁发机构 (CA)；具有与证书中的名称匹配的`hostname`或 IP 地址。  `certificate`  Validates the provided certificate and verifies that it’s signed by a trusted authority (CA), but doesn’t check the certificate `hostname`.  验证提供的证书并验证它是否由受信任的颁发机构 (CA) 签名，但不检查证书`hostname` 。  `none`   Performs no certificate validation.  不执行证书验证。  Setting certificate validation to `none` disables many security benefits of SSL/TLS, which is very dangerous. Only set this value if instructed by Elastic Support as a temporary diagnostic mechanism when attempting to resolve TLS errors. 将证书验证设置为`none`会禁用 SSL/TLS 的许多安全优势，这是非常危险的。仅当 Elastic Support 指示在尝试解决 TLS 错误时将其作为临时诊断机制时，才设置此值。    Defaults to `full`. 默认为`full` 。

- `xpack.notification.email.ssl.cipher_suites`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Supported cipher suites vary depending on which version of Java you use. For example, for version 12 the default value is `TLS_AES_256_GCM_SHA384`, `TLS_AES_128_GCM_SHA256`, `TLS_CHACHA20_POLY1305_SHA256`, `TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384`, `TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256`, `TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384`, `TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256`, `TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256`, `TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256`, `TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384`, `TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256`, `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384`, `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256`, `TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA`, `TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA`, `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA`, `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA`, `TLS_RSA_WITH_AES_256_GCM_SHA384`, `TLS_RSA_WITH_AES_128_GCM_SHA256`, `TLS_RSA_WITH_AES_256_CBC_SHA256`, `TLS_RSA_WITH_AES_128_CBC_SHA256`, `TLS_RSA_WITH_AES_256_CBC_SHA`, `TLS_RSA_WITH_AES_128_CBC_SHA`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）支持的密码套件因您使用的 Java 版本而异。例如，对于版本 12，默认值为`TLS_AES_256_GCM_SHA384` 、 `TLS_AES_128_GCM_SHA256` 、 `TLS_CHACHA20_POLY1305_SHA256` 、 `TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384` , `TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256` , `TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384` , `TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256` , `TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256` , `TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256` , `TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384` , `TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256` , `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384` , `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256` , `TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA` , `TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA` , `TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA` , `TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA` , `TLS_RSA_WITH_AES_256_GCM_SHA384` , `TLS_RSA_WITH_AES_128_GCM_SHA256` , `TLS_RSA_WITH_AES_256_CBC_SHA256` , `TLS_RSA_WITH_AES_128_CBC_SHA256` 、 `TLS_RSA_WITH_AES_256_CBC_SHA` 、 `TLS_RSA_WITH_AES_128_CBC_SHA` 。 For more information, see Oracle’s [Java Cryptography Architecture documentation](https://docs.oracle.com/en/java/javase/11/security/oracle-providers.html#GUID-7093246A-31A3-4304-AC5F-5FB6400405E2). 有关更多信息，请参阅 Oracle 的[Java 加密体系结构文档](https://docs.oracle.com/en/java/javase/11/security/oracle-providers.html#GUID-7093246A-31A3-4304-AC5F-5FB6400405E2)。

### Watcher Email TLS/SSL key and trusted certificate settings 观察者电子邮件 TLS/SSL 密钥和可信证书设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

The following settings are used to specify a private key, certificate, and the trusted certificates that should be used when communicating over an SSL/TLS connection. A private key and certificate are optional and would be used if the server requires client authentication for PKI authentication.
以下设置用于指定通过 SSL/TLS 连接进行通信时应使用的私钥、证书和受信任证书。私钥和证书是可选的，如果服务器需要客户端身份验证进行 PKI 身份验证，则将使用私钥和证书。

### PEM encoded files PEM 编码文件

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

When using PEM encoded files, use the following settings:
使用 PEM 编码文件时，请使用以下设置：

- `xpack.notification.email.ssl.key`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Path to a PEM encoded file containing the private key.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含私钥的 PEM 编码文件的路径。 If HTTP client authentication is required, it uses this file. You cannot use this setting and `ssl.keystore.path` at the same time. 如果需要 HTTP 客户端身份验证，则使用此文件。您不能同时使用此设置和`ssl.keystore.path` 。

- `xpack.notification.email.ssl.secure_key_passphrase`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The passphrase that is used to decrypt the private key. Since the key might not be encrypted, this value is optional.  ( [Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html) ) 用于解密私钥的密码。由于密钥可能未加密，因此该值是可选的。

- `xpack.notification.email.ssl.certificate`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Specifies the path for the PEM encoded certificate (or certificate chain) that is associated with the key.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）指定与密钥关联的 PEM 编码证书（或证书链）的路径。 This setting can be used only if `ssl.key` is set. 仅当设置了`ssl.key`时才能使用此设置。

- `xpack.notification.email.ssl.certificate_authorities`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) List of paths to PEM encoded certificate files that should be trusted.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）应信任的 PEM 编码证书文件的路径列表。 This setting and `ssl.truststore.path` cannot be used at the same time. 此设置和`ssl.truststore.path`不能同时使用。

### Java keystore files Java 密钥库文件

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

When using Java keystore files (JKS), which contain the private key, certificate and certificates that should be trusted, use the following settings:
使用包含私钥、证书和应信任证书的 Java 密钥库文件 (JKS) 时，请使用以下设置：

- `xpack.notification.email.ssl.keystore.path`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The path for the keystore file that contains a private key and certificate.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含私钥和证书的密钥库文件的路径。 It must be either a Java keystore (jks) or a PKCS#12 file. You cannot use this setting and `ssl.key` at the same time. 它必须是 Java 密钥库 (jks) 或 PKCS#12 文件。您不能同时使用此设置和`ssl.key` 。

- `xpack.notification.email.ssl.keystore.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The password for the keystore.  ([安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) 密钥库的密码。

- `xpack.notification.email.ssl.keystore.secure_key_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The password for the key in the keystore. The default is the keystore password.  ([安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) 密钥库中密钥的密码。默认是密钥库密码。

- `xpack.notification.email.ssl.truststore.path`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The path for the keystore that contains the certificates to trust. It must be either a Java keystore (jks) or a PKCS#12 file.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含要信任的证书的密钥库的路径。它必须是 Java 密钥库 (jks) 或 PKCS#12 文件。 You cannot use this setting and `ssl.certificate_authorities` at the same time. 您不能同时使用此设置和`ssl.certificate_authorities` 。

- `xpack.notification.email.ssl.truststore.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) Password for the truststore.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)）信任库的密码。

### PKCS#12 files PKCS#12 文件

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/ssl-settings.asciidoc)

Elasticsearch can be configured to use PKCS#12 container files (`.p12` or `.pfx` files) that contain the private key, certificate and certificates that should be trusted.
Elasticsearch 可以配置为使用 PKCS#12 容器文件（ `.p12`或`.pfx`文件），其中包含私钥、证书和应信任的证书。

PKCS#12 files are configured in the same way as Java keystore files:
PKCS#12 文件的配置方式与 Java 密钥库文件相同：

- `xpack.notification.email.ssl.keystore.path`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The path for the keystore file that contains a private key and certificate.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含私钥和证书的密钥库文件的路径。 It must be either a Java keystore (jks) or a PKCS#12 file. You cannot use this setting and `ssl.key` at the same time. 它必须是 Java 密钥库 (jks) 或 PKCS#12 文件。您不能同时使用此设置和`ssl.key` 。

- `xpack.notification.email.ssl.keystore.type`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The format of the keystore file. It must be either `jks` or `PKCS12`. If the keystore path ends in ".p12", ".pfx", or ".pkcs12", this setting defaults to `PKCS12`. Otherwise, it defaults to `jks`.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）密钥库文件的格式。它必须是`jks`或`PKCS12` 。如果密钥库路径以“.p12”、“.pfx”或“.pkcs12”结尾，则此设置默认为`PKCS12` 。否则，它默认为`jks` 。

- `xpack.notification.email.ssl.keystore.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The password for the keystore.  ([安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) 密钥库的密码。

- `xpack.notification.email.ssl.keystore.secure_key_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) The password for the key in the keystore. The default is the keystore password.  ([安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) 密钥库中密钥的密码。默认是密钥库密码。

- `xpack.notification.email.ssl.truststore.path`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) The path for the keystore that contains the certificates to trust. It must be either a Java keystore (jks) or a PKCS#12 file.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）包含要信任的证书的密钥库的路径。它必须是 Java 密钥库 (jks) 或 PKCS#12 文件。 You cannot use this setting and `ssl.certificate_authorities` at the same time. 您不能同时使用此设置和`ssl.certificate_authorities` 。

- `xpack.notification.email.ssl.truststore.type`

  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) Set this to `PKCS12` to indicate that the truststore is a PKCS#12 file.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）将此设置为`PKCS12`以指示信任库是 PKCS#12 文件。

- `xpack.notification.email.ssl.truststore.secure_password`

  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)) Password for the truststore.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)）信任库的密码。

## Slack Notification Settings Slack 通知设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/notification-settings.asciidoc)

You can configure the following Slack notification settings in `elasticsearch.yml`. For more information about sending notifications via Slack, see [Configuring Slack actions](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-slack.html#configuring-slack-actions).
您可以在`elasticsearch.yml`中配置以下 Slack 通知设置。有关通过 Slack 发送通知的更多信息，请参阅[配置 Slack 操作](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-slack.html#configuring-slack-actions)。

- `xpack.notification.slack.default_account`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Default Slack account to use.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）要使用的默认 Slack 帐户。 If you configure multiple Slack accounts, you must either configure this setting or specify the Slack account to use in the [`slack`](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-slack.html) action. See [Configuring Slack Accounts](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-slack.html#configuring-slack). 如果您配置多个 Slack 帐户，则必须配置此设置或指定要在[`slack`](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-slack.html)操作中使用的 Slack 帐户。请参阅[配置 Slack 帐户](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-slack.html#configuring-slack)。



- `xpack.notification.slack.account`

  Specifies account information for sending notifications via Slack. You can specify the following Slack account attributes:  指定用于通过 Slack 发送通知的帐户信息。您可以指定以下 Slack 帐户属性：   `secure_url`  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html), [reloadable](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)) The Incoming Webhook URL to use to post messages to Slack. Required.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)、[可重新加载](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)）用于将消息发布到 Slack 的传入 Webhook URL。必需的。  `message_defaults`   Default values for [Slack message attributes](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-slack.html#slack-action-attributes).  [Slack 消息属性](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-slack.html#slack-action-attributes)的默认值。   `from`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The sender name to display in the Slack message. Defaults to the watch ID.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）要在 Slack 消息中显示的发件人姓名。默认为手表 ID。  `to`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The default Slack channels or groups you want to send messages to.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）您想要向其发送消息的默认 Slack 频道或组。  `icon`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The icon to display in the Slack messages. Overrides the incoming webhook’s configured icon. Accepts a public URL to an image.  ([动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) 在 Slack 消息中显示的图标。覆盖传入 webhook 的配置图标。接受图像的公共 URL。  `text`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The default message content.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）默认消息内容。  `attachment`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Default message attachments. Slack message attachments enable you to create more richly-formatted messages. Specified as an array as defined in the [ Slack attachments documentation](https://api.slack.com/docs/attachments).  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）默认消息附件。 Slack 消息附件使您能够创建格式更丰富的消息。指定为[Slack 附件文档](https://api.slack.com/docs/attachments)中定义的数组。

## Jira Notification Settings Jira 通知设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/notification-settings.asciidoc)

You can configure the following Jira notification settings in `elasticsearch.yml`. For more information about using notifications to create issues in Jira, see [Configuring Jira actions](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-jira.html#configuring-jira-actions).
您可以在`elasticsearch.yml`中配置以下 Jira 通知设置。有关使用通知在 Jira 中创建问题的更多信息，请参阅[配置 Jira 操作](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-jira.html#configuring-jira-actions)。

- `xpack.notification.jira.default_account`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Default Jira account to use.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）要使用的默认 Jira 帐户。 If you configure multiple Jira accounts, you must either configure this setting or specify the Jira account to use in the [`jira`](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-jira.html) action. See [Configuring Jira accounts](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-jira.html#configuring-jira). 如果您配置多个 Jira 帐户，则必须配置此设置或指定要在[`jira`](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-jira.html)操作中使用的 Jira 帐户。请参阅[配置 Jira 帐户](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-jira.html#configuring-jira)。



- `xpack.notification.jira.account`

  Specifies account information for using notifications to create issues in Jira. You can specify the following Jira account attributes:  指定用于使用通知在 Jira 中创建问题的帐户信息。您可以指定以下 Jira 帐户属性：   `allow_http`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) If `false`, Watcher rejects URL settings that use a HTTP protocol. Defaults to `false`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）如果为`false` ，观察程序将拒绝使用 HTTP 协议的 URL 设置。默认为`false` 。  `secure_url`  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html), [reloadable](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)) The URL of the Jira Software server. Required.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)、[可重新加载](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)）Jira Software 服务器的 URL。必需的。  `secure_user`  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html), [reloadable](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)) The name of the user to connect to the Jira Software server. Required.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)、[可重新加载](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)）连接到 Jira Software 服务器的用户名。必需的。  `secure_password`  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html), [reloadable](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)) The password of the user to connect to the Jira Software server. Required.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)、[可重新加载](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)）连接到 Jira Software 服务器的用户密码。必需的。  `issue_defaults`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Default fields values for the issue created in Jira. See [Jira action attributes](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-jira.html#jira-action-attributes) for more information. Optional.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）Jira 中创建的问题的默认字段值。有关更多信息，请参阅[Jira 操作属性](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-jira.html#jira-action-attributes)。选修的。

## PagerDuty Notification Settings PagerDuty 通知设置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/settings/notification-settings.asciidoc)

You can configure the following PagerDuty notification settings in `elasticsearch.yml`. For more information about sending notifications via PagerDuty, see [Configuring PagerDuty actions](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-pagerduty.html#configuring-pagerduty-actions).
您可以在`elasticsearch.yml`中配置以下 PagerDuty 通知设置。有关通过 PagerDuty 发送通知的更多信息，请参阅[配置 PagerDuty 操作](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-pagerduty.html#configuring-pagerduty-actions)。

- `xpack.notification.pagerduty.default_account`

  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Default PagerDuty account to use.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）要使用的默认 PagerDuty 帐户。 If you configure multiple PagerDuty accounts, you must either configure this setting or specify the PagerDuty account to use in the [`pagerduty`](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-pagerduty.html) action. See [Configuring PagerDuty accounts](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-pagerduty.html#configuring-pagerduty). 如果配置多个 PagerDuty 帐户，则必须配置此设置或指定要在[`pagerduty`](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-pagerduty.html)操作中使用的 PagerDuty 帐户。请参阅[配置 PagerDuty 帐户](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-pagerduty.html#configuring-pagerduty)。



- `xpack.notification.pagerduty.account`

  Specifies account information for sending notifications via PagerDuty. You can specify the following PagerDuty account attributes:  指定用于通过 PagerDuty 发送通知的帐户信息。您可以指定以下 PagerDuty 帐户属性：   `name`  ([Static](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)) A name for the PagerDuty account associated with the API key you are using to access PagerDuty. Required.  （[静态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#static-cluster-setting)）与您用于访问 PagerDuty 的 API 密钥关联的 PagerDuty 帐户的名称。必需的。  `secure_service_api_key`  ([Secure](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html), [reloadable](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)) The [ PagerDuty API key](https://developer.pagerduty.com/documentation/rest/authentication) to use to access PagerDuty. Required.  （[安全](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html)、[可重新加载](https://www.elastic.co/guide/en/elasticsearch/reference/current/secure-settings.html#reloadable-secure-settings)）用于访问 PagerDuty 的[PagerDuty API 密钥](https://developer.pagerduty.com/documentation/rest/authentication)。必需的。

- `event_defaults`

  Default values for [PagerDuty event attributes](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-pagerduty.html#pagerduty-event-trigger-incident-attributes). Optional.  [PagerDuty 事件属性](https://www.elastic.co/guide/en/elasticsearch/reference/current/actions-pagerduty.html#pagerduty-event-trigger-incident-attributes)的默认值。选修的。   `description`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) A string that contains the default description for PagerDuty events. If no default is configured, each PagerDuty action must specify a `description`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）包含 PagerDuty 事件的默认描述的字符串。如果未配置默认值，则每个 PagerDuty 操作都必须指定`description` 。  `incident_key`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) A string that contains the default incident key to use when sending PagerDuty events.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）包含发送 PagerDuty 事件时使用的默认事件键的字符串。  `client`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) A string that specifies the default monitoring client.  ( [Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting) ) 指定默认监控客户端的字符串。  `client_url`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The URL of the default monitoring client.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）默认监控客户端的 URL。  `event_type`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) The default event type. Valid values: `trigger`,`resolve`, `acknowledge`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）默认事件类型。有效值： `trigger` 、 `resolve` 、 `acknowledge` 。  `attach_payload`  ([Dynamic](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)) Whether or not to provide the watch payload as context for the event by default. Valid values: `true`, `false`.  （[动态](https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html#dynamic-cluster-setting)）默认情况下是否提供监视负载作为事件的上下文。有效值： `true` 、 `false` 。

# Advanced configuration 高级配置

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/setup/advanced-configuration.asciidoc)

Modifying advanced settings is generally not recommended and could negatively impact performance and stability. Using the Elasticsearch-provided defaults is recommended in most circumstances.
通常不建议修改高级设置，这可能会对性能和稳定性产生负面影响。在大多数情况下，建议使用 Elasticsearch 提供的默认值。

## Set JVM options 设置 JVM 选项

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/setup/advanced-configuration.asciidoc)

If needed, you can override the default JVM options by adding custom options files (preferred) or setting the `ES_JAVA_OPTS` environment variable.
如果需要，您可以通过添加自定义选项文件（首选）或设置`ES_JAVA_OPTS`环境变量来覆盖默认 JVM 选项。

JVM options files must have the suffix *.options* and contain a line-delimited list of JVM arguments. JVM processes options files in lexicographic order.
JVM 选项文件必须具有后缀*.options*并包含以行分隔的 JVM 参数列表。 JVM 按字典顺序处理选项文件。

Where you put the JVM options files depends on the type of installation:
JVM 选项文件的放置位置取决于安装类型：

- tar.gz or .zip: Add custom JVM options files to `config/jvm.options.d/`. 
  tar.gz 或 .zip：将自定义 JVM 选项文件添加到`config/jvm.options.d/` 。
- Debian or RPM: Add custom JVM options files to `/etc/elasticsearch/jvm.options.d/`. 
  Debian 或 RPM：添加自定义 JVM 选项文件 `/etc/elasticsearch/jvm.options.d/` 。
- Docker: Bind mount custom JVM options files into `/usr/share/elasticsearch/config/jvm.options.d/`. 
  Docker：将自定义 JVM 选项文件绑定到 `/usr/share/elasticsearch/config/jvm.options.d/` 。

Do not modify the root `jvm.options` file. Use files in `jvm.options.d/` instead.
不要修改根`jvm.options`文件。请改用`jvm.options.d/`中的文件。

### JVM options syntax JVM 选项语法

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/setup/advanced-configuration.asciidoc)

A JVM options file contains a line-delimited list of JVM arguments. Arguments are preceded by a dash (`-`). To apply the setting to specific versions, prepend the version or a range of versions followed by a colon.
JVM 选项文件包含以行分隔的 JVM 参数列表。参数前面有破折号 ( `-` )。要将设置应用于特定版本，请在版本或一系列版本前面加上冒号。

- Apply a setting to all versions:
  将设置应用于所有版本：

  ```text
  -Xmx2g
  ```

- Apply a setting to a specific version:
  将设置应用于特定版本：

  ```text
  17:-Xmx2g
  ```

- Apply a setting to a range of versions:
  将设置应用于一系列版本：

  ```text
  17-18:-Xmx2g
  ```

  To apply a setting to a specific version and any later versions, omit the upper bound of the range. For example, this setting applies to Java 8 and later:
  要将设置应用于特定版本和任何更高版本，请忽略范围的上限。例如，此设置适用于 Java 8 及更高版本：

  ```text
  17-:-Xmx2g
  ```

Blank lines are ignored. Lines beginning with `#` are treated as comments and ignored. Lines that aren’t commented out and aren’t recognized as valid JVM arguments are rejected and Elasticsearch will fail to start.
空行将被忽略。以`#`开头的行被视为注释并被忽略。未注释掉且未被识别为有效 JVM 参数的行将被拒绝，并且 Elasticsearch 将无法启动。

### Use environment variables to set JVM options 使用环境变量设置 JVM 选项

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/setup/advanced-configuration.asciidoc)

In production, use JVM options files to override the default settings. In testing and development environments, you can also set JVM options through the `ES_JAVA_OPTS` environment variable.
在生产中，使用 JVM 选项文件来覆盖默认设置。在测试和开发环境中，您还可以通过`ES_JAVA_OPTS`环境变量设置 JVM 选项。

```sh
export ES_JAVA_OPTS="$ES_JAVA_OPTS -Djava.io.tmpdir=/path/to/temp/dir"
./bin/elasticsearch
```

If you’re using the RPM or Debian packages, you can specify `ES_JAVA_OPTS` in the [system configuration file](https://www.elastic.co/guide/en/elasticsearch/reference/current/setting-system-settings.html#sysconfig).
如果您使用的是 RPM 或 Debian 软件包，则可以在[系统配置文件](https://www.elastic.co/guide/en/elasticsearch/reference/current/setting-system-settings.html#sysconfig)中指定`ES_JAVA_OPTS` 。

Elasticsearch ignores the `JAVA_TOOL_OPTIONS` and `JAVA_OPTS` environment variables.
Elasticsearch 忽略`JAVA_TOOL_OPTIONS`和`JAVA_OPTS`环境变量。

## Set the JVM heap size 设置 JVM 堆大小

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/setup/advanced-configuration.asciidoc)

By default, Elasticsearch automatically sets the JVM heap size based on a node’s [roles](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html#node-roles) and total memory. Using the default sizing is recommended for most production environments.
默认情况下，Elasticsearch 根据节点的[角色](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html#node-roles)和总内存自动设置 JVM 堆大小。对于大多数生产环境，建议使用默认大小。

To override the default heap size, set the minimum and maximum heap size settings, `Xms` and `Xmx`. The minimum and maximum values must be the same.
要覆盖默认堆大小，请设置最小和最大堆大小设置`Xms`和`Xmx` 。最小值和最大值必须相同。

The heap size should be based on the available RAM:
堆大小应基于可用 RAM：

- Set `Xms` and `Xmx` to no more than 50% of your total memory. Elasticsearch requires memory for purposes other than the JVM heap. For example, Elasticsearch uses off-heap buffers for efficient network communication and relies on the operating system’s filesystem cache for efficient access to files. The JVM itself also requires some memory. It’s normal for Elasticsearch to use more memory than the limit configured with the `Xmx` setting.
  将`Xms`和`Xmx`设置为不超过总内存的 50%。 Elasticsearch 需要内存用于 JVM 堆以外的用途。例如，Elasticsearch  使用堆外缓冲区来实现高效的网络通信，并依靠操作系统的文件系统缓存来高效地访问文件。 JVM 本身也需要一些内存。 Elasticsearch  使用的内存多于`Xmx`设置配置的限制是正常的。

  When running in a container, such as [Docker](https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html), total memory is defined as the amount of memory visible to the container, not the total system memory on the host.
  当在容器（例如[Docker](https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html) ）中运行时，总内存定义为容器可见的内存量，而不是主机上的总系统内存。

- Set `Xms` and `Xmx` to no more than the threshold for compressed ordinary object pointers (oops). The exact threshold varies but 26GB is safe on most systems and can be as large as 30GB on some systems. To verify you are under the threshold, check the Elasticsearch log for an entry like this:
  将`Xms`和`Xmx`设置为不超过压缩普通对象指针 (oops) 的阈值。确切的阈值有所不同，但 26GB 在大多数系统上是安全的，在某些系统上可以高达 30GB。要验证您是否低于阈值，请检查 Elasticsearch 日志中是否有如下条目：

  ```txt
  heap size [1.9gb], compressed ordinary object pointers [true]
  ```

  Or check the `jvm.using_compressed_ordinary_object_pointers` value for the nodes using the [nodes info API](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-info.html):
  或者检查 `jvm.using_compressed_ordinary_object_pointers` 使用[节点信息 API 的](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-info.html)节点值：

  

  ```console
  GET _nodes/_all/jvm
  ```

- Copy as curl 复制为卷曲[Try in Elastic 尝试使用弹性](http://localhost:5601/zzz/app/kibana#/dev_tools/console?load_from=https://www.elastic.co/guide/en/elasticsearch/reference/current/snippets/31.console) 

The more heap available to Elasticsearch, the more memory it can use for its internal caches. This leaves less memory for the operating system to use for the filesystem cache. Larger heaps can also cause longer garbage collection pauses.
Elasticsearch 可用的堆越多，可用于内部缓存的内存就越多。这为操作系统留下了更少的内存用于文件系统缓存。较大的堆还会导致垃圾收集暂停时间较长。

To configure the heap size, add the `Xms` and `Xmx` JVM arguments to a custom JVM options file with the extension `.options` and store it in the `jvm.options.d/` directory. For example, to set the maximum heap size to 2GB, set both `Xms` and `Xmx` to `2g`:
要配置堆大小，请将`Xms`和`Xmx` JVM 参数添加到扩展名为`.options`的自定义 JVM 选项文件中，并将其存储在`jvm.options.d/`目录中。例如，要将最大堆大小设置为 2GB，请将`Xms`和`Xmx`都设置为`2g` ：

```txt
-Xms2g
-Xmx2g
```

For testing, you can also set the heap sizes using the `ES_JAVA_OPTS` environment variable:
为了进行测试，您还可以使用`ES_JAVA_OPTS`环境变量设置堆大小：

```sh
ES_JAVA_OPTS="-Xms2g -Xmx2g" ./bin/elasticsearch
```

The `ES_JAVA_OPTS` variable overrides all other JVM options. We do not recommend using `ES_JAVA_OPTS` in production.
`ES_JAVA_OPTS`变量会覆盖所有其他 JVM 选项。我们不建议在生产中使用`ES_JAVA_OPTS` 。

If you are running Elasticsearch as a Windows service, you can change the heap size using the service manager. See [Install and run Elasticsearch as a service on Windows](https://www.elastic.co/guide/en/elasticsearch/reference/current/zip-windows.html#windows-service).
如果您将 Elasticsearch 作为 Windows 服务运行，则可以使用服务管理器更改堆大小。请参阅[在 Windows 上安装并运行 Elasticsearch 作为服务](https://www.elastic.co/guide/en/elasticsearch/reference/current/zip-windows.html#windows-service)。

### Enable the Elasticsearch TCP readiness port 启用 Elasticsearch TCP 就绪端口

[edit 编辑](https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/setup/advanced-configuration.asciidoc)

This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in  technical preview are not subject to the support SLA of official GA  features.
此功能处于技术预览阶段，可能会在未来版本中更改或删除。 Elastic 将努力解决任何问题，但技术预览版中的功能不受官方 GA 功能的支持 SLA 的约束。

If configured, a node can open a TCP port when the node is in a ready state. A node is deemed ready when it has successfully joined a cluster. In a single node configuration, the node is said to be ready, when it’s able to accept requests.
如果配置，节点可以在节点处于就绪状态时打开 TCP 端口。当节点成功加入集群时，该节点被视为准备就绪。在单节点配置中，当节点能够接受请求时，就称该节点已准备就绪。

To enable the readiness TCP port, use the `readiness.port` setting. The readiness service will bind to all host addresses.
要启用就绪 TCP 端口，请使用`readiness.port`设置。准备服务将绑定到所有主机地址。

If the node leaves the cluster, or the [Shutdown API](https://www.elastic.co/guide/en/elasticsearch/reference/current/put-shutdown.html) is used to mark the node for shutdown, the readiness port is immediately closed.
如果节点离开集群，或者使用[Shutdown API](https://www.elastic.co/guide/en/elasticsearch/reference/current/put-shutdown.html)将节点标记为关闭，则就绪端口将立即关闭。

A successful connection to the readiness TCP port signals that the Elasticsearch node is ready. When a client connects to the readiness port, the server simply terminates the socket connection. No data is sent back to the client. If a client cannot connect to the readiness port, the node is not ready.
成功连接到就绪 TCP 端口表明 Elasticsearch 节点已就绪。当客户端连接到就绪端口时，服务器只需终止套接字连接。没有数据发送回客户端。如果客户端无法连接到就绪端口，则该节点尚未就绪。