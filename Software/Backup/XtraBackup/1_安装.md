# 安装

[TOC]

## 概述

建议使用适合您系统的软件包管理器从 Percona 官方软件仓库安装 Percona XtraBackup 8.4：

- [使用 APT 仓库安装](https://docs.percona.com/percona-xtrabackup/8.4/apt-repo.html)
- [使用 YUM 存储库安装](https://docs.percona.com/percona-xtrabackup/8.4/yum-repo.html)

## 安装替代方案

Percona 还提供以下方法：

- [使用下载的 DEB 软件包安装](https://docs.percona.com/percona-xtrabackup/8.4/apt-download-deb.html)
- [使用下载的 RPM 下载的软件包安装](https://docs.percona.com/percona-xtrabackup/8.4/yum-download-rpm.html) 
- [从二进制 Tarball 安装](https://docs.percona.com/percona-xtrabackup/8.4/binary-tarball.html)，其中包含手动安装所需的所有文件和二进制文件
- [从源代码编译和安装](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html)
- [在 Docker 容器中运行](https://docs.percona.com/percona-xtrabackup/8.4/docker.html)

## 服务器版本和备份版本比较

MySQL 对功能（例如重做日志记录的结构）的更改可能会导致旧版本的 Percona XtraBackup 失败。为确保您可以备份和恢复数据，请使用与源服务器主要版本相同的 Percona XtraBackup 版本。这意味着如果您使用 Percona XtraBackup 8.4.x，您可以安全地将源服务器从 8.4.x 备份到 8.4.xx。

The `--no-server-version-check` option performs the following test. Before the backup/prepare starts, XtraBackup compares the source server version to the Percona XtraBackup version. If the source server version is greater than the XtraBackup major version, XtraBackup stops the backup and returns an error message. This comparison prevents a failed backup or a corrupted backup due to source server changes.
`--no-server-version-check` 选项执行以下测试。在备份/准备开始之前，XtraBackup 会将源服务器版本与 Percona XtraBackup  版本进行比较。如果源服务器版本高于 XtraBackup 主要版本，XtraBackup  将停止备份并返回错误消息。此比较可防止备份失败或由于源服务器更改而损坏的备份。

The parameter checks for the following scenarios:
该参数检查以下场景：

- The source server and the PXB major version are the same, the backup proceeds
  源服务器和 PXB 主要版本相同，备份继续进行
- The source server is greater than the PXB major version, and the parameter  is not overridden, the backup is stopped and returns an error message
  源服务器高于 PXB 主要版本，并且该参数未被覆盖，备份将停止并返回错误消息
- The source server is less than the PXB major version, and the parameter is  not overridden, the backup is stopped and returns an error message
  源服务器低于 PXB 主要版本，并且该参数未被覆盖，备份将停止并返回错误消息
- The source server is greater than the PXB major version up to the last  release in the LTS series, and the parameter is overridden, the backup  proceeds
  源服务器高于 LTS 系列中最后一个版本的PXB主要版本，并且该参数被覆盖，备份将继续

Explicitly adding the `--no-server-version-check` parameter, like the example, overrides the parameter and the backup proceeds.
显式添加 `--no-server-version-check` 参数（如示例所示）会覆盖该参数，并继续备份。

```
$ xtrabackup --backup --no-server-version-check --target-dir=$mysql/backup1
```

Overriding the `--no-server-version-check` parameter allows taking backups using a Percona XtraBackup version that is equal to a version of your source server up to the last release in  the LTS series. This means if you use Percona XtraBackup 8.4.x, you can  back up the source server from 8.4.x to 8.4.xx.
覆盖 `--no-server-version-check` 参数允许使用 Percona XtraBackup 版本进行备份，该版本等于源服务器在 LTS 系列中最后一个版本之前的版本。这意味着如果您使用 Percona XtraBackup 8.4.x，您可以将源服务器从 8.4.x 备份到 8.4.xx。

When you override the parameter, the following events can happen:
当您覆盖该参数时，可能会发生以下事件：

- Backup fails 备份失败
- Creates a corrupted backup
  创建损坏的备份
- Backup successful 备份成功

## Connection and privileges needed[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#connection-and-privileges-needed) 需要连接和权限[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#connection-and-privileges-needed)

Percona XtraBackup needs to be able to connect to the database server and perform operations on the server and the datadir when creating a backup, when preparing in some scenarios and when restoring it. In order to do so, there are privileges and permission requirements on its execution that must be fulfilled.
Percona XtraBackup 需要能够连接到数据库服务器，并在创建备份时、某些场景下的准备和恢复时对服务器和 datadir 执行操作。为此，必须满足其执行的权限和权限要求。

Privilege refers to the operations that a system user is permitted to do in the database server. They are set at the database server and only apply to users in the database server.
权限是指允许系统用户在数据库服务器中执行的操作。它们是在数据库服务器上设置的，并且仅适用于数据库服务器中的用户。

Permissions are those which permits a user to perform operations on the system, like reading, writing or executing on a certain directory or start/stop a system service. They are set at a system level and only apply to system users.
权限是指允许用户对系统执行操作的权限，例如读取、写入或执行某个目录或启动/停止系统服务的权限。它们是在系统级别设置的，并且仅适用于系统用户。

When xtrabackup is used, there are two actors involved: the user invoking the program - a system user - and the user performing action in the database server - a database user. Note that these are different users in different places, even though they may have the same username.
当使用 xtrabackup 时，涉及两个参与者：调用程序的用户 - 系统用户 - 和在数据库服务器中执行操作的用户 - 数据库用户。请注意，这些用户位于不同的地方，即使他们可能具有相同的用户名。

All the invocations of xtrabackup in this documentation assume that the system user has the appropriate permissions, and you are providing the relevant options for connecting the database server - besides the options for the action to be performed - and the database user has adequate privileges.
本文档中对 xtrabackup 的所有调用都假定系统用户具有适当的权限，并且您提供了连接数据库服务器的相关选项 - 除了要执行的操作的选项 - 并且数据库用户具有足够的权限。

### Connect to the server[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#connect-to-the-server) 连接到服务器[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#connect-to-the-server)

The database user used to connect to the server and its password are specified by the `--user` and `--password` option:
用于连接到服务器的数据库用户及其密码由 `--user` 和 `--password` 选项指定：

```
$ xtrabackup --user=DVADER --password=14MY0URF4TH3R --backup \
--target-dir=/data/bkps/
```

If you don’t use the `--user` option, Percona XtraBackup will assume the database user whose name is the system user executing it.
如果你不使用 `--user` 选项，Percona XtraBackup 将假定其名称为执行它的系统用户的数据库用户。

#### Other connection options[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#other-connection-options) 其他连接选项[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#other-connection-options)

According to your system, you may need to specify one or more of the following options to connect to the server:
根据您的系统，您可能需要指定以下一个或多个选项来连接到服务器：

| Option 选择   | Description 描述                                             |
| ------------- | ------------------------------------------------------------ |
| -port -港口   | Use this port when connecting to the database with TCP/IP 使用 TCP/IP 连接到数据库时使用此端口 |
| -socket -插座 | Use this socket when connecting to the local database. 连接到本地数据库时使用此套接字。 |
| -host -主机   | Use this host when connecting to the database server with TCP/IP 使用 TCP/IP 连接到数据库服务器时使用此主机 |

These options are passed to the mysql child process without alteration, see `mysql --help` for details.
这些选项将不加更改地传递给 mysql 子进程，有关详细信息，请参见 `mysql --help`。

Note 注意

In case of multiple server instances, the correct connection parameters (port, socket, host) must be specified in order for xtrabackup to talk to the correct server.
在多个服务器实例的情况下，必须指定正确的连接参数（端口、套接字、主机），以便 xtrabackup 与正确的服务器通信。

### Privileges needed[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#privileges-needed) 需要的权限[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#privileges-needed)

Once connected to the server, in order to perform a backup you need `READ` and `EXECUTE` permissions at a filesystem level in the server’s datadir.
连接到服务器后，为了执行备份，您需要服务器 datadir 中文件系统级别的 `READ` 和 `EXECUTE` 权限。

The database user needs the following privileges to back up tables or databases:
数据库用户需要以下权限来备份表或数据库：

- `RELOAD` and `FLUSH_TABLES` in order to run `FLUSH TABLES WITH READ LOCK`.
  `RELOAD` 并`FLUSH_TABLES`以运行 `FLUSH TABLES WITH READ LOCK`。
- The `BACKUP_ADMIN` privilege is needed to query the performance_schema.log_status table, and run `LOCK INSTANCE FOR BACKUP`, `LOCK BINLOG FOR BACKUP`, or `LOCK TABLES FOR BACKUP`. The `BACKUP_ADMIN` privilege is required to use the [Page tracking](https://docs.percona.com/percona-xtrabackup/8.4/page-tracking.html) feature.
  查询 performance_schema.log_status 表，并执行 `LOCK INSTANCE FOR BACKUP`、`LOCK BINLOG FOR BACKUP` 或 `LOCK TABLES FOR BACKUP` 需要 `BACKUP_ADMIN` 权限。需要 `BACKUP_ADMIN` 权限才能使用[页面跟踪](https://docs.percona.com/percona-xtrabackup/8.4/page-tracking.html)功能。
- `REPLICATION CLIENT` in order to obtain the binary log position,
  `REPLICATION CLIENT` 获取二进制对数位置，
- `CREATE TABLESPACE` in order to import tables (see Restoring Individual Tables),
  `CREATE TABLESPACE` 以导入表（请参阅恢复单个表），
- `PROCESS` in order to run `SHOW ENGINE INNODB STATUS` (which is mandatory), and optionally to see all threads which are running on the server (see FLUSH TABLES WITH READ LOCK option),
  `PROCESS` 以运行 `SHOW ENGINE INNODB STATUS`（这是强制性的），并可选择查看服务器上运行的所有线程（请参阅 FLUSH TABLES WITH READ LOCK 选项），
- `REPLICATION_SLAVE_ADMIN` in order to start/stop the replication threads in a replication environment,
  `REPLICATION_SLAVE_ADMIN`为了在复制环境中启动/停止复制线程，
- `CREATE` privilege in order to create the PERCONA_SCHEMA.xtrabackup_history database and table,
  `CREATE` 权限来创建 PERCONA_SCHEMA.xtrabackup_history 数据库和表，
- `ALTER` privilege in order to upgrade the PERCONA_SCHEMA.xtrabackup_history database and table,
  `ALTER` 权限以升级 PERCONA_SCHEMA.xtrabackup_history 数据库和表，
- `INSERT` privilege in order to add history records to the PERCONA_SCHEMA.xtrabackup_history table,
  `INSERT` 权限，以便将历史记录添加到 PERCONA_SCHEMA.xtrabackup_history 表中，
- `SELECT` privilege in order to use `--incremental-history-name` or `--incremental-history-uuid` in order for the feature to look up the `innodb_to_lsn` values in the PERCONA_SCHEMA.xtrabackup_history table.
  `SELECT` 权限，以便使用 `--incremental-history-name` 或 `--incremental-history-uuid`，以便该功能在 PERCONA_SCHEMA.xtrabackup_history 表中查找`innodb_to_lsn`值。
- `SELECT` privilege on the [keyring_component_status table](https://dev.mysql.com/doc/refman/8.4/en/performance-schema-keyring-component-status-table.html) to view the attributes and status of the installed keyring component when in use.
  `SELECT` [keyring_component_status](https://dev.mysql.com/doc/refman/8.4/en/performance-schema-keyring-component-status-table.html)权限，以查看已安装的密钥环组件在使用时的状态。
- `SELECT` privilege on the [replication_group_members table](https://dev.mysql.com/doc/refman/8.4/en/performance-schema-replication-group-members-table.html) to validate if the instance is part of group replication cluster.
  `SELECT` [replication_group_members权限](https://dev.mysql.com/doc/refman/8.4/en/performance-schema-replication-group-members-table.html)来验证实例是否是组复制集群的一部分。

A SQL example of creating a database user with the minimum privileges required to take full backups would be:
创建具有执行完整备份所需的最低权限的数据库用户的 SQL 示例是：

```
mysql> CREATE USER 'bkpuser'@'localhost' IDENTIFIED BY 's3cr%T';
mysql> GRANT BACKUP_ADMIN, PROCESS, RELOAD, LOCK TABLES, REPLICATION CLIENT ON *.* TO 'bkpuser'@'localhost';
mysql> GRANT SELECT ON performance_schema.log_status TO 'bkpuser'@'localhost';
mysql> GRANT SELECT ON performance_schema.keyring_component_status TO bkpuser@'localhost';
mysql> GRANT SELECT ON performance_schema.replication_group_members TO bkpuser@'localhost';
mysql> FLUSH PRIVILEGES;
```

#### Query the privileges[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#query-the-privileges) 查询权限[¶](https://docs.percona.com/percona-xtrabackup/8.4/privileges.html#query-the-privileges)

To query the privileges that your database user has been granted at the console of the server execute:
要查询数据库用户在服务器控制台上被授予的权限，请执行：

```
mysql> SHOW GRANTS;
```

or for a particular user with:
或者对于具有以下功能的特定用户：

```
mysql> SHOW GRANTS FOR 'db-user'@'host';
```

It will display the privileges using the same format as for the [GRANT statement](https://dev.mysql.com/doc/refman/8.4/en/show-grants.html).
它将使用与 [GRANT 语句](https://dev.mysql.com/doc/refman/8.4/en/show-grants.html)相同的格式显示权限。

Note that privileges may vary across versions of the server. To list the exact list of privileges that your server support (and a brief description of them) execute:
请注意，权限可能因服务器版本而异。要列出您的服务器支持的权限的确切列表（以及它们的简要描述），请执行：

```
mysql> SHOW PRIVILEGES;
```

## Permissions needed[¶](https://docs.percona.com/percona-xtrabackup/8.4/permissions.html#permissions-needed) 所需权限[¶](https://docs.percona.com/percona-xtrabackup/8.4/permissions.html#permissions-needed)

We will be referring to permissions to the ability of a user to access and perform changes on the relevant parts of the host’s filesystem, starting/stopping services and installing software.
我们将指的是用户访问和执行主机文件系统相关部分更改、启动/停止服务和安装软件的能力。

By privileges, we refer to the abilities of a database user to perform different kinds of actions on the database server.
权限是指数据库用户在数据库服务器上执行不同类型操作的能力。

There are many ways for checking the permission on a file or directory. For example, `ls -ls /path/to/file` or `stat /path/to/file | grep Access` will do the job:
检查文件或目录的权限的方法有很多种。例如，`ls -ls /path/to/file` 或 `stat /path/to/file | grep Access` 将执行以下任务：



```
$ stat /etc/mysql | grep Access
```

The result could look like this:
结果可能如下所示：



<details class="example" data-immersive-translate-walked="411d4c1c-db36-4090-bbdc-080c0b0cdee3"><summary data-immersive-translate-walked="411d4c1c-db36-4090-bbdc-080c0b0cdee3" data-immersive-translate-paragraph="1">Expected output<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预期输出</font></font></font></summary><div class="no-copy highlight" data-immersive-translate-walked="411d4c1c-db36-4090-bbdc-080c0b0cdee3"><pre><span></span><code></code></pre></div></details>

As in this example, `my.cnf` is owned by `root` and not writable for anyone else. Assuming that you do not have `root`‘s password, you can check what permissions you have on these types of files with `sudo -l`:
与此示例一样，`my.cnf` 由 `root` 拥有，其他任何人都无法写入。假设您没有 `root` 的密码，您可以使用 `sudo -l` 检查您对这些类型的文件拥有哪些权限：



```
$ sudo -l
```

The results could look like this:
结果可能如下所示：



<details class="example" data-immersive-translate-walked="411d4c1c-db36-4090-bbdc-080c0b0cdee3"><summary data-immersive-translate-walked="411d4c1c-db36-4090-bbdc-080c0b0cdee3" data-immersive-translate-paragraph="1">Expected output<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预期输出</font></font></font></summary><div class="no-copy highlight" data-immersive-translate-walked="411d4c1c-db36-4090-bbdc-080c0b0cdee3"><pre><span></span><code></code></pre></div></details>

Being able to execute with `sudo` scripts in `/etc/init.d/`, `/etc/rc.d/` or `/sbin/service` is the ability to start and stop services.
能够使用 `/etc/init.d/`、`/etc/rc.d/` 或 `/sbin/service` 中的 `sudo` 脚本执行是启动和停止服务的能力。

Also, If you can execute the package manager of your distribution, you can install or remove software with it. If not, having `rwx` permission over a directory will let you do a local installation of software by compiling it there. This is a typical situation in many hosting companies’ services.
此外，如果您可以执行发行版的包管理器，则可以使用它安装或删除软件。如果没有，则对目录具有 `rwx` 权限将允许您通过在目录中编译软件来执行软件的本地安装。这是许多托管公司服务的典型情况。

There are other ways for managing permissions, such as using PolicyKit,  Extended ACLs or SELinux, which may be preventing or allowing your access. You should check them in that case.
还有其他方法可以管理权限，例如使用 PolicyKit、扩展 ACL 或 SELinux，这些方法可能会阻止或允许您访问。在这种情况下，您应该检查它们。

## APT

### 使用 APT 仓库安装

即用型软件包可从 Percona XtraBackup 软件存储库和[下载页面](https://www.percona.com/downloads)获得。

#### 通过 percona-release 安装

与许多其他 Percona 产品一样，Percona XtraBackup 是使用 *percona-release* 软件包配置工具安装的。

1. 从 Percona Web 下载一个 *percona-release* 仓库包的 `DEB` 格式安装包：
   
   ```bash
   $ wget https://repo.percona.com/apt/percona-release_latest.$(lsb_release -sc)_all.deb
   ```
   
1. Install the downloaded package with **dpkg**. To do that, run the following commands as root or with **sudo**: `dpkg -i percona-release_latest.$(lsb_release -sc)_all.deb`
   使用 **dpkg** 安装下载的软件包。为此，请以 root 身份或使用 **sudo** 运行以下命令： `dpkg -i percona-release_latest.$(lsb_release -sc)_all.deb` 

1. 
   
   ```
   
   ```

```

```



Once you install this package the Percona repositories should be added. You can check the repository setup in the `/etc/apt/sources.list.d/percona-release.list` file.
安装此软件包后，应添加 Percona 存储库。您可以在 `/etc/apt/sources.list.d/percona-release.list` 文件中检查存储库设置。

Enable the repository: `percona-release enable-only tools release`
启用存储库： `percona-release enable-only tools release` 

If *Percona XtraBackup* is intended to be used in combination with the upstream MySQL Server, you only need to enable the `tools` repository: `percona-release enable-only tools`.
如果 *Percona XtraBackup* 打算与上游 MySQL Server 结合使用，则只需启用`工具`存储库： `percona-release enable-only tools` 。

Refresh the local cache to update the package information:
刷新本地缓存以更新包信息：

```
$ sudo apt update
```

Install the `percona-xtrabackup-pxb-84-lts` package:
安装 `percona-xtrabackup-pxb-84-lts` 软件包：

```
$ sudo apt install percona-xtrabackup-pxb-84-lts
```

To decompress backups made using `LZ4` or `ZSTD` compression algorithm, install the corresponding package:
要解压缩使用 `LZ4` 或 `ZSTD` 压缩算法创建的备份，请安装相应的软件包：

[Install the `lz4` package
安装 `lz4` 软件包](https://docs.percona.com/percona-xtrabackup/8.4/apt-repo.html#__tabbed_1_1)[Install the `zstd` package
安装 `zstd` 软件包](https://docs.percona.com/percona-xtrabackup/8.4/apt-repo.html#__tabbed_1_2)

```
$ sudo apt install lz4
```

Note 注意

For AppArmor profile information, see [Working with AppArmor](https://docs.percona.com/percona-xtrabackup/8.4/work-with-apparmor.html).
有关 AppArmor 配置文件的信息，请参阅[使用 AppArmor](https://docs.percona.com/percona-xtrabackup/8.4/work-with-apparmor.html)。

See also 另请参阅

To install Percona XtraBackup using downloaded deb packages, see [Install Percona XtraBackup 8.4](https://docs.percona.com/percona-xtrabackup/8.4/apt-download-deb.html).
要使用下载的 deb 软件包安装 Percona XtraBackup，请参阅[安装 Percona XtraBackup 8.4](https://docs.percona.com/percona-xtrabackup/8.4/apt-download-deb.html)。

To uninstall Percona XtraBackup, see [Uninstall Percona XtraBackup 8.4](https://docs.percona.com/percona-xtrabackup/8.4/apt-uninstall-xtrabackup.html)
要卸载 Percona XtraBackup，请参阅[卸载 Percona XtraBackup 8.4](https://docs.percona.com/percona-xtrabackup/8.4/apt-uninstall-xtrabackup.html)

#### Files in the DEB package[¶](https://docs.percona.com/percona-xtrabackup/8.4/apt-files.html#files-in-the-deb-package) DEB 包中的文件[¶](https://docs.percona.com/percona-xtrabackup/8.4/apt-files.html#files-in-the-deb-package)

The following tables show what data each `DEB` package contains.
下表显示了每个 `DEB` 数据包包含的数据。

| Package 包                         | Contains 包含                                                |
| ---------------------------------- | ------------------------------------------------------------ |
| percona-xtrabackup-pxb-84-lts      | The latest Percona XtraBackup GA binaries and associated files 最新的 Percona XtraBackup GA 二进制文件和相关文件 |
| percona-xtrabackup-dbg-pxb-84-lts  | The debug symbols for binaries in `percona-xtrabackup-pxb-84-lts` `percona-xtrabackup-pxb-84-lts` 中二进制文件的调试符号 |
| percona-xtrabackup-test-pxb-84-lts | The test suite for Percona XtraBackup Percona XtraBackup 的测试套件 |
| percona-xtrabackup                 | The older version of the Percona XtraBackup 旧版本的 Percona XtraBackup |

#### Install using downloaded DEB packages[¶](https://docs.percona.com/percona-xtrabackup/8.4/apt-download-deb.html#install-using-downloaded-deb-packages) 使用下载的 DEB 包安装[¶](https://docs.percona.com/percona-xtrabackup/8.4/apt-download-deb.html#install-using-downloaded-deb-packages)

Download `DEB` packages of the desired series for your architecture from [Percona Product Downloads](https://www.percona.com/downloads). This method requires you to resolve all dependencies and install any missing packages.
从 [Percona 产品下载](https://www.percona.com/downloads)中下载适用于您的架构的 `DEB` 包。此方法要求您解析所有依赖项并安装任何缺失的软件包。

The following example downloads Percona XtraBackup 8.4.0-1 release package for Ubuntu 20.04:
以下示例下载适用于 Ubuntu 20.04 的 Percona XtraBackup 8.4.0-1 发布包：

```
$ wget https://downloads.percona.com/downloads/Percona-XtraBackup-innovative-release/Percona-XtraBackup-8.4.0-1/binary/debian/focal/x86_64/percona-xtrabackup-84_8.4.0-1-1.focal_amd64.deb
```

Install Percona XtraBackup by using `dpkg`. Run this command as root or use the sudo command:
使用 `dpkg` 安装 Percona XtraBackup。以 root 身份运行此命令或使用 sudo 命令：

```
$ sudo dpkg -i percona-xtrabackup-84_8.4.0-1-1.focal_amd64.deb
```

### Apt pinning packages[¶](https://docs.percona.com/percona-xtrabackup/8.4/apt-pinning.html#apt-pinning-packages) Apt pinning 包[¶](https://docs.percona.com/percona-xtrabackup/8.4/apt-pinning.html#apt-pinning-packages)

In some cases you might need to `pin` the selected packages to avoid the upgrades from the distribution repositories. 
在某些情况下，您可能需要`固定`选定的软件包，以避免从分发存储库进行升级。

The pinning takes place in the `preference` file. To pin a package, set the `Pin-Priority` to higher numbers.
固定发生在`首选项`文件中。要固定包，请将 `Pin-Priority` 设置为更大的数字。

Make a new file `/etc/apt/preferences.d/00percona.pref`. For example, add the following to the preference file:
创建新文件 `/etc/apt/preferences.d/00percona.pref` .例如，将以下内容添加到首选项文件中：

```
Package:
Pin: release o=Percona Development Team
Pin-Priority: 1001
```

For more information about the pinning, check the official [debian wiki](http://wiki.debian.org/AptPreferences).
有关固定的更多信息，请查看 [debian 官方 wiki](http://wiki.debian.org/AptPreferences)。

### Work with AppArmor[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-apparmor.html#work-with-apparmor) 使用 AppArmor[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-apparmor.html#work-with-apparmor)

The Linux Security Module implements mandatory access controls (MAC) with  AppArmor. Debian and Ubuntu systems install AppArmor by default.  AppArmor uses profiles which define which files and permissions are  needed for application.
Linux 安全模块使用 AppArmor 实施强制访问控制 （MAC）。Debian 和 Ubuntu 系统默认安装 AppArmor。AppArmor 使用配置文件来定义应用程序需要哪些文件和权限。

Percona XtraBackup does not have a profile and is not confined by AppArmor.
Percona XtraBackup 没有配置文件，不受 AppArmor 的限制。

For a list of common AppArmor commands, see [Percona Server for MySQL - AppArmor](https://docs.percona.com/percona-server/innovation-release/apparmor.html).
有关常见 AppArmor 命令的列表，请参阅 [Percona Server for MySQL - AppArmor](https://docs.percona.com/percona-server/innovation-release/apparmor.html)。

#### Develop a profile[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-apparmor.html#develop-a-profile) 开发配置文件[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-apparmor.html#develop-a-profile)

Download the profile from:
从以下位置下载配置文件：

https://github.com/percona/percona-xtrabackup/tree/trunk/packaging/percona/apparmor/apparmor.d

The following profile sections should be updated with your system  information, such as location of the backup destination directory.
以下配置文件部分应使用您的系统信息（如备份目标目录的位置）进行更新。

<details class="example" data-immersive-translate-walked="ad61d8a7-8098-4f39-a0ff-b3ede64c2f26"><summary data-immersive-translate-walked="ad61d8a7-8098-4f39-a0ff-b3ede64c2f26" data-immersive-translate-paragraph="1">Expected output<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预期输出</font></font></font></summary><div class="no-copy highlight" data-immersive-translate-walked="ad61d8a7-8098-4f39-a0ff-b3ede64c2f26"><pre><span></span><code></code></pre></div></details>

Move the updated file: 移动更新的文件：

```
$ sudo mv usr.sbin.xtrabackup /etc/apparmor.d/
```

Install the profile with the following command:
使用以下命令安装配置文件：

```
$ sudo apparmor_parser -r -T -W /etc/apparmor.d/usr.sbin.xtrabackup
```

Run the backup as usual.
照常运行备份。

No additional AppArmor-related actions are required to restore a backup.
还原备份不需要其他与 AppArmor 相关的操作。

### 在 Debian 和 Ubuntu 上卸载 Percona XtraBackup 8.4[¶](https://docs.percona.com/percona-xtrabackup/8.4/apt-uninstall-xtrabackup.html#uninstall-percona-xtrabackup-84-on-debian-and-ubuntu)

To completely uninstall Percona XtraBackup, remove all the installed packages:
要完全卸载 Percona XtraBackup，请删除所有已安装的软件包：

```
$ sudo apt remove percona-xtrabackup-pxb-84-lts
```

## YUM

# 使用 YUM 仓库安装 Percona XtraBackup[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-repo.html#use-a-yum-repository-to-install-percona-xtrabackup)

Ready-to-use packages are available from the Percona XtraBackup software repositories and the [download page](https://www.percona.com/downloads/). The Percona yum repository supports popular `RPM`-based operating systems, including the `Amazon Linux AMI`.
即用型软件包可从 Percona XtraBackup 软件存储库和[下载页面](https://www.percona.com/downloads/)获得。Percona yum 存储库支持流行的基于 `RPM` 的操作系统，包括 `Amazon Linux AMI`。

The easiest way to install the Percona Yum repository is to install an `RPM` that configures yum and installs the [Percona GPG key](https://www.percona.com/downloads/RPM-GPG-KEY-percona).
安装 Percona Yum 存储库的最简单方法是安装一个配置 yum 并安装 [Percona GPG 密钥](https://www.percona.com/downloads/RPM-GPG-KEY-percona)的 `RPM`。

Specific information on the supported platforms, products, and versions is described in [Percona Software and Platform Lifecycle](https://www.percona.com/services/policies/percona-software-platform-lifecycle#mysql).
有关受支持平台、产品和版本的具体信息，请参见 [Percona 软件和平台生命周期](https://www.percona.com/services/policies/percona-software-platform-lifecycle#mysql)。

## Install Percona XtraBackup from Percona `yum` repository[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-repo.html#install-percona-xtrabackup-from-percona-yum-repository) 从 Percona `yum` 仓库安装 Percona XtraBackup[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-repo.html#install-percona-xtrabackup-from-percona-yum-repository)

To install Percona XtraBackup from Percona `yum` repository, do the following steps:
要从 Percona `yum` 存储库安装 Percona XtraBackup，请执行以下步骤：

1. Install the Percona yum repository by running the following command as the `root` user or with **sudo**: 
   通过以 `root` 用户身份运行以下命令或使用 **sudo** 安装 Percona yum 存储库：

   ```
   
   ```

```
$ sudo yum install \
https://repo.percona.com/yum/percona-release-latest.\
noarch.rpm
```

Enable the repository:  启用存储库：

```
$ sudo percona-release enable-only tools release
```

If *Percona XtraBackup* is intended to be used in combination with the upstream MySQL Server, you only need to enable the `tools repository: 
如果 *Percona XtraBackup* 打算与上游 MySQL Server 结合使用，您只需启用 'tools 存储库：

```
$ sudo percona-release enable-only tools
```

Install *Percona XtraBackup* by running:
通过运行以下命令来安装 *Percona XtraBackup*：

```
$ sudo yum install percona-xtrabackup-pxb-84-lts
```

Warning 警告

Make sure that you have the `libev` package installed before installing *Percona XtraBackup* on CentOS 6. For this operating system, the `libev` package is available from the [EPEL](https://fedoraproject.org/wiki/EPEL) repositories.
在 CentOS 6 上安装 *Percona XtraBackup* 之前，请确保你已安装 `libev` 组件。对于这个操作系统，`libev` 软件包可以从 [EPEL](https://fedoraproject.org/wiki/EPEL) 软件源中获得。

To decompress backups made using `LZ4` or `ZSTD` compression algorithm, install the corresponding package:
要解压缩使用 `LZ4` 或 `ZSTD` 压缩算法创建的备份，请安装相应的软件包：

[Install the `lz4` package
安装 `lz4` 软件包](https://docs.percona.com/percona-xtrabackup/8.4/yum-repo.html#__tabbed_1_1)[Install the `zstd` package
安装 `zstd` 软件包](https://docs.percona.com/percona-xtrabackup/8.4/yum-repo.html#__tabbed_1_2)

```
$ sudo yum install lz4
```

See also 另请参阅

To install Percona XtraBackup using downloaded rpm packages, see [Install with package manager](https://docs.percona.com/percona-xtrabackup/8.4/yum-download-rpm.html).
要使用下载的 rpm 包安装 Percona XtraBackup，请参阅[使用包管理器安装](https://docs.percona.com/percona-xtrabackup/8.4/yum-download-rpm.html)。

To uninstall Percona XtraBackup, see [Uninstall Percona XtraBackup](https://docs.percona.com/percona-xtrabackup/8.4/yum-uninstall-xtrabackup.html)
要卸载 Percona XtraBackup，请参阅[卸载 Percona XtraBackup](https://docs.percona.com/percona-xtrabackup/8.4/yum-uninstall-xtrabackup.html) 

# Files in the RPM package built for Percona XtraBackup 8.4[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-files.html#files-in-the-rpm-package-built-for-percona-xtrabackup-84) 为 Percona XtraBackup 8.4 构建的 RPM 包中的文件[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-files.html#files-in-the-rpm-package-built-for-percona-xtrabackup-84)

The following tables show what data each `RPM` package contains:
下表显示了每个 `RPM` 包包含的数据：

| Package 包                              | Contains 包含                                                |
| --------------------------------------- | ------------------------------------------------------------ |
| percona-xtrabackup-pxb-84-lts           | The latest Percona XtraBackup GA binaries and associated files 最新的 Percona XtraBackup GA 二进制文件和相关文件 |
| percona-xtrabackup-pxb-84-lts-debuginfo | The debug symbols for binaries in percona-xtrabackup-pxb-84-lts percona-xtrabackup-pxb-84-lts 中二进制文件的调试符号 |
| percona-xtrabackup-test-pxb-84-lts      | The test suite for Percona XtraBackup Percona XtraBackup 的测试套件 |
| percona-xtrabackup                      | The older version of the Percona XtraBackup 旧版本的 Percona XtraBackup |

# Install Percona XtraBackup 8.4 using downloaded RPM packages[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-download-rpm.html#install-percona-xtrabackup-84-using-downloaded-rpm-packages) 使用下载的 RPM 包安装 Percona XtraBackup 8.4[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-download-rpm.html#install-percona-xtrabackup-84-using-downloaded-rpm-packages)

Download `RPM` packages of the desired series for your architecture from the [download page](https://www.percona.com/downloads/). 
从[下载页面](https://www.percona.com/downloads/)下载适用于您的架构的所需系列的 `RPM` 软件包。

The following example downloads *Percona XtraBackup* 8.4.0-1 release package for *CentOS* 9:
以下载 *CentOS* 9 的 *Percona XtraBackup* 8.4.0-1 发布包为例：

```
$ wget https://downloads.percona.com/downloads/Percona-XtraBackup-innovative-release/Percona-XtraBackup-8.4.0-1/binary/redhat/9/x86_64/percona-xtrabackup-84-8.4.0-1.1.el9.x86_64.rpm
```

Install Percona XtraBackup by running:
通过运行以下命令来安装 Percona XtraBackup：

```
$ yum localinstall percona-xtrabackup-84-8.4.0-1.1.el9.x86_64.rpm
```

When installing packages manually like this, you’ll need to make sure to  resolve all the dependencies and install missing packages yourself.
像这样手动安装包时，您需要确保解决所有依赖项并自行安装缺少的包。

# Work with SELinux[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-selinux.html#work-with-selinux) 使用 SELinux[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-selinux.html#work-with-selinux)

Percona XtraBackup is installed as an unconfined process running in an  undefined domain. SELinux allows unconfined processes almost all access  and the processes only use Discretionary Access Control (DAC) rules.
Percona XtraBackup 作为运行在未定义域中的无限制进程安装。SELinux 允许不受限制的进程进行几乎所有的访问，并且这些进程仅使用自主访问控制 （DAC） 规则。

You find the current state of the Percona XtraBackup file with the following command:
您可以使用以下命令找到 Percona XtraBackup 文件的当前状态：

```
$ ls -Z /usr/bin | grep xtrabackup
```

<details class="example" data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c"><summary data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c" data-immersive-translate-paragraph="1">Expected output<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预期输出</font></font></font></summary><div class="no-copy highlight" data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c"><pre><span></span><code></code></pre></div></details>

The SELinux context is the following:
SELinux 上下文如下：

- user (root) 用户 （root）
- role (object_r) 角色 （object_r）
- type (bin_t) 类型 （bin_t）
- level (s0) 级别 （S0）

The unconfined domain supports the network-facing services, which are  protected by SELinux. These domains are not exposed. In this  configuration, SELinux protects against remote intrusions but local  intrusions, which require local access, are not confined.
unconfined domain 支持面向网络的服务，这些服务受 SELinux 保护。这些域不会公开。在这种配置中，SELinux 可以防止远程入侵，但需要本地访问的本地入侵不受限制。

*Percona XtraBackup* works locally. The service is not network-facing and cannot be  exploited externally. The service interacts only with the local user,  who provides the parameters. *Percona XtraBackup* requires access to the `target-dir` location.
*Percona XtraBackup* 在本地工作。该服务不面向网络，不能从外部利用。该服务仅与提供参数的本地用户交互。*Percona XtraBackup* 需要访问 `target-dir` 位置。

## Confine XtraBackup[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-selinux.html#confine-xtrabackup) 限制 XtraBackup[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-selinux.html#confine-xtrabackup)

You can modify your security configuration to confine *Percona XtraBackup*. The first question is where to store the backup files. The service requires read and write access to the selected location.
您可以修改您的安全配置以限制 *Percona XtraBackup*。第一个问题是备份文件的存储位置。该服务需要对所选位置的读取和写入访问权限。

You can use either of the following methods:
您可以使用以下任一方法：

- Allow *Percona XtraBackup* to write to any location. The user provides any path to the `target-dir` parameter.
  允许 *Percona XtraBackup* 写入任何位置。用户提供 `target-dir` 参数的任何路径。
- Allow *Percona XtraBackup* to write to a specific location, such as /backups or the user’s home directory.
  允许 *Percona XtraBackup* 写入特定位置，例如 /backups 或用户的主目录。

The first option opens the entire system to read and write. Select the second option to harden your security.
第一个选项将打开整个系统以进行读取和写入。选择第二个选项以增强安全性。

## Install SELinux tools[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-selinux.html#install-selinux-tools) 安装 SELinux 工具[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-selinux.html#install-selinux-tools)

To work with policies, you must install the SELinux tools. To find which package provides the `semanage` command and install the package. The following is an example on CentOS 7.
要使用策略，您必须安装 SELinux 工具。查找哪个软件包提供 `semanage` 命令并安装该软件包。以下是 CentOS 7 的示例。



```
$ yum provides *bin/semanage
```

The result should list the packages.
结果应列出包。



<details class="example" data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c"><summary data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c" data-immersive-translate-paragraph="1">Expected output<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预期输出</font></font></font></summary><div class="no-copy highlight" data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c"><pre><span></span><code></code></pre></div></details>

To install missing packages, run the following:
要安装缺少的软件包，请运行以下命令：

```
$ sudo yum install -y policycoreutils-python
```

The following is an example on CentOS 8:
以下是 CentOS 8 的示例：



```
$ yum provides *bin/semanage
```

The result should list the missing packages.
结果应列出缺少的包。



<details class="example" data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c"><summary data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c" data-immersive-translate-paragraph="1">Expected output<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预期输出</font></font></font></summary><div class="no-copy highlight" data-immersive-translate-walked="b685f92e-cd5a-4deb-b090-d17e50ad295c"><pre><span></span><code></code></pre></div></details>

Run the following to install the missing packages: 
运行以下命令以安装缺少的软件包：

```
$ sudo yum install -y policycoreutils-python-utils
```

## Create a policy[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-selinux.html#create-a-policy) 创建策略[¶](https://docs.percona.com/percona-xtrabackup/8.4/work-with-selinux.html#create-a-policy)

Use a modular approach to create an SELinux policy. Create a policy module to manage XtraBackup. You must create a `.te` file for type enforcement, and an optional `.fc` file for the file contexts.
使用模块化方法创建 SELinux 策略。创建策略模块来管理 XtraBackup。您必须为类型强制创建一个 `.te` 文件，并为文件上下文创建一个可选的 `.fc` 文件。

Use `$ ps -efZ | grep xtrabackup` to verify the service is not confined by SELinux.
使用 `$ ps -efZ | grep xtrabackup` 来验证服务是否不受 SELinux 的限制。

Create the `xtrabackup.fc` file and add content. This file defines the security contexts.
创建 `xtrabackup.fc` 文件并添加内容。此文件定义安全上下文。

```
/usr/bin/xtrabackup    -- gen_context(system_u:object_r:xtrabackup_exec_t,s0)
/usr/bin/xbcrypt    -- gen_context(system_u:object_r:xtrabackup_exec_t,s0)
/usr/bin/xbstream    -- gen_context(system_u:object_r:xtrabackup_exec_t,s0)
/usr/bin/xbcloud    -- gen_context(system_u:object_r:xtrabackup_exec_t,s0)
/backups(/.*)?       system_u:object_r:xtrabackup_data_t:s0
```

Note 注意

If you are using the `/backups` directory you must have the last line. If you are storing the backups in the user’s home directory, you can omit this line.
如果您使用的是 `/backups` 目录，则必须包含最后一行。如果要将备份存储在用户的主目录中，则可以省略此行。

Download the `xtrabackup.te` file from the following location:
从以下位置下载 `xtrabackup.te` 文件：

https://github.com/percona/percona-xtrabackup/tree/trunk/packaging/percona/selinx

Note 注意

In the file, the sections in bold should be modified for your system. The fc file can also be downloaded from the same location.
在文件中，应针对您的系统修改粗体部分。也可以从同一位置下载 fc 文件。

Compile the policy module:
编译 policy 模块：

```
$ make -f /usr/share/selinux/devel/Makefile xtrabackup.pp
```

Install the module: 安装模块：

```
$ semodule -i xtrabackup.pp
```

Tag the PXB binaries with the proper SELinux tags, such as `xtrabackup_exec_t`.
使用适当的 SELinux 标签（例如 `xtrabackup_exec_t`）标记 PXB 二进制文件。

```
$ restorecon -v /usr/bin/*
```

If you store your backups at `/backups`, restore the tag in that location:
如果您将备份存储在 `/backups`，请在该位置恢复标签：

```
$ restorecon -v /backups
```

Note 注意

Remember to add the standard Linux DAC permissions for this directory.
请记住为此目录添加标准 Linux DAC 权限。

Perform the backup in the standard way.
以标准方式执行备份。

# Uninstall Percona XtraBackup 8.4 on Red Hat Enterprise Linux and CentOS[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-uninstall-xtrabackup.html#uninstall-percona-xtrabackup-84-on-red-hat-enterprise-linux-and-centos) 在 Red Hat Enterprise Linux 和 CentOS 上卸载 Percona XtraBackup 8.4[¶](https://docs.percona.com/percona-xtrabackup/8.4/yum-uninstall-xtrabackup.html#uninstall-percona-xtrabackup-84-on-red-hat-enterprise-linux-and-centos)

To completely uninstall Percona XtraBackup, remove all the installed packages:
要完全卸载 Percona XtraBackup，请删除所有已安装的软件包：

```
$ yum remove percona-xtrabackup
```

## 二进制包

# 从二进制 tarball 安装[¶](https://docs.percona.com/percona-xtrabackup/8.4/binary-tarball.html#install-from-a-binary-tarball)

Binary tarballs are compressed’ tar’ archives that contain precompiled  executable files, libraries, and other dependencies. You can extract the binary tarballs to any path.
二进制 tarball 是压缩的 ' tar' 存档，其中包含预编译的可执行文件、库和其他依赖项。您可以将二进制 tarball 提取到任何路径。

Download the binary tarballs from the `Linux - Generic` section on [Percona Product Downloads](https://www.percona.com/downloads/).
从 [Percona 产品下载](https://www.percona.com/downloads/)的 `Linux - 通用`部分下载二进制 tarball。

The following example downloads the tarball:
以下示例下载 tarball：

```
$ wget https://downloads.percona.com/downloads/Percona-XtraBackup-8.4/Percona-XtraBackup-8.4.0-1/binary/tarball/percona-xtrabackup-8.4.0-1-Linux-x86_64.glibc2.28.tar.gz
```

The output displays the following information:
输出显示以下信息：

<details class="example" data-immersive-translate-walked="d0edf8f5-f884-49cd-837a-0d35d05cab3b"><summary data-immersive-translate-walked="d0edf8f5-f884-49cd-837a-0d35d05cab3b" data-immersive-translate-paragraph="1">Expected output<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预期输出</font></font></font></summary></details>

# Binary tarball file names available[¶](https://docs.percona.com/percona-xtrabackup/8.4/binary-tarball-names.html#binary-tarball-file-names-available) 可用的二进制 tarball 文件名[¶](https://docs.percona.com/percona-xtrabackup/8.4/binary-tarball-names.html#binary-tarball-file-names-available)

For recent versions of Percona XtraBackup, the tar files are organized by the `glibc2` version. You can find this version on your operating system with the following command:
对于最新版本的 Percona XtraBackup，tar 文件按 `glibc2` 版本进行组织。您可以使用以下命令在操作系统上找到此版本：

```
$ ldd --version
```

<details class="example" data-immersive-translate-walked="58beb178-bdcf-4037-b939-e96bb26ad61f"><summary data-immersive-translate-walked="58beb178-bdcf-4037-b939-e96bb26ad61f" data-immersive-translate-paragraph="1">Expected output<font class="notranslate immersive-translate-target-wrapper" data-immersive-translate-translation-element-mark="1" lang="zh-CN"><font class="notranslate" data-immersive-translate-translation-element-mark="1">&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark="1"><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner" data-immersive-translate-translation-element-mark="1">预期输出</font></font></font></summary><div class="highlight" data-immersive-translate-walked="58beb178-bdcf-4037-b939-e96bb26ad61f"><pre id="__code_1"><span></span></pre></div></details>

<details class="example" data-immersive-translate-walked="58beb178-bdcf-4037-b939-e96bb26ad61f"><div class="highlight" data-immersive-translate-walked="58beb178-bdcf-4037-b939-e96bb26ad61f"><pre id="__code_1"><code></code></pre></div></details>

If the `glibc2` version from your operating system is not listed, then this Percona  Server for MySQL version does not support that operating system.
如果您的操作系统的 `glibc2` 版本未列出，则此 Percona Server for MySQL 版本不支持该操作系统。

## Binary tarball file name organization[¶](https://docs.percona.com/percona-xtrabackup/8.4/binary-tarball-names.html#binary-tarball-file-name-organization) 二进制 tarball 文件名组织[¶](https://docs.percona.com/percona-xtrabackup/8.4/binary-tarball-names.html#binary-tarball-file-name-organization)

The following lists the platform and the associated full binary file name used by Percona Server for MySQL tar files 8.4.0-1.
下面列出了 Percona Server for MySQL tar 文件 8.4.0-1 使用的平台和关联的完整二进制文件名称。

| Platform 平台                   | Percona XtraBackup tarball name Percona XtraBackup tarball 名称 | glibc2 version glibc2 版本 |
| ------------------------------- | ------------------------------------------------------------ | -------------------------- |
| Ubuntu 24.04 Ubuntu 24.04的     | Percona-XtraBackup-8.4.0-1-Linux.x86_64.glibc2.39.tar.gz     | glibc2.39 格里布2.39       |
| Ubuntu 22.04 Ubuntu 22.04的     | Percona-XtraBackup-8.4.0-1-Linux.x86_64.glibc2.35.tar.gz     | glibc2.35 格里布2.35       |
| Ubuntu 20.04 Ubuntu 20.04的     | Percona-XtraBackup-8.4.0-1-Linux.x86_64.glibc2.31.tar.gz     | glibc2.31 格里布2.31       |
| Debian 12 Debian 12 版          | Percona-XtraBackup-8.4.0-1-Linux.x86_64.glibc2.36.tar.gz     | glibc2.36 格里布2.36       |
| Debian 11 Debian 11 版本        | Percona-XtraBackup-8.4.0-1-Linux.x86_64.glibc2.31.tar.gz     | glibc2.31 格里布2.31       |
| Red Hat Enterprise 9 红帽企业 9 | Percona-XtraBackup-8.4.0-1-Linux.x86_64.glibc2.34.tar.gz     | glibc2.34 格里布2.34       |
| Red Hat Enterprise 8 红帽企业 8 | Percona-XtraBackup-8.4.0-1-Linux.x86_64.glibc2.28.tar.gz     | glibc2.28 格里布2.28       |

Download the binary tarballs from [Percona Software Downloads](https://www.percona.com/downloads).
从 [Percona Software Downloads](https://www.percona.com/downloads) 下载二进制 tarball。

The following table lists the tarball types available in `Linux - Generic`. Select the *Percona XtraBackup* 8.4 version, the software or the operating system, and the type of  tarball for your installation. Binary tarballs support all  distributions.
下表列出了 `Linux - Generic` 中可用的 tarball 类型。选择 *Percona XtraBackup* 8.4 版本、软件或操作系统以及安装的 tarball 类型。二进制 tarball 支持所有发行版。

After you have downloaded the binary tarballs, extract the tarball in the file location of your choice.
下载二进制 tarball 后，将 tarball 解压到您选择的文件位置。

| Type 类型    | Name 名字                                                    | Operating systems 操作系统                                   | Description 描述                                             |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Full 满      | percona-xtrabackup-8.4.0-1-Linux.x86_64.glibc2.12.tar.gz     | Built for CentOS 6 为 CentOS 6 构建                          | Contains binary files, libraries, test files, and debug symbols 包含二进制文件、库、测试文件和调试符号 |
| Minimal 极小 | percona-xtrabackup-8.4.0-1-Linux.x86_64.glibc2.12-minimal.tar.gz | Built for CentOS 6 为 CentOS 6 构建                          | Contains binary files, and libraries but does not include test files, or debug symbols 包含二进制文件和库，但不包括测试文件或调试符号 |
| Full 满      | percona-xtrabackup-8.4.0-1-Linux.x86_64.glibc2.17.tar.gz     | Compatible with any operating system except for CentOS 6 兼容除 CentOS 6 之外的任何操作系统 | Contains binary files, libraries, test files, and debug symbols 包含二进制文件、库、测试文件和调试符号 |
| Minimal 极小 | percona-xtrabackup-8.4.0-1-Linux.x86_64.glibc2.17-minimal.tar.gz | Compatible with any operating system except for CentOS 6 兼容除 CentOS 6 之外的任何操作系统 | Contains binary files, and libraries but does not include test files, or debug symbols 包含二进制文件和库，但不包括测试文件或调试符号 |

Select a different software, such as Ubuntu 20.04 (Focal Fossa), for a  tarball for that operating system. You can download the packages together or separately.
为该操作系统的 tarball 选择其他软件，例如 Ubuntu 20.04 （Focal Fossa）。您可以一起或单独下载这些软件包。

## 源码

# Compile and install from source[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#compile-and-install-from-source) 从源码编译和安装[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#compile-and-install-from-source)

The following instructions install Percona XtraBackup 8.4.
以下说明安装 Percona XtraBackup 8.4。

## 1. Install Percona XtraBackup from the Git Source Tree[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#1-install-percona-xtrabackup-from-the-git-source-tree) 1. 从 Git 源代码树安装 Percona XtraBackup[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#1-install-percona-xtrabackup-from-the-git-source-tree)

Percona uses the [Github](https://github.com/) revision control system for development. To build the latest Percona Server for MySQL from the source tree, you will need `git` installed on your system.
Percona 使用 [Github](https://github.com/) 版本控制系统进行开发。要从源代码树构建最新的 Percona Server for MySQL，您需要在系统上安装 `git`。

You can now fetch the latest Percona XtraBackup 8.4 sources:
您现在可以获取最新的 Percona XtraBackup 8.4 源代码：

```
$ git clone https://github.com/percona/percona-xtrabackup.git
$ cd percona-xtrabackup
$ git checkout trunk
$ git submodule update --init --recursive
```

## 2. Installation prerequisites[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#2-installation-prerequisites) 2. 安装前提[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#2-installation-prerequisites)

The following packages and tools must be installed to compile *Percona XtraBackup* from source. These might vary from system to system.
必须安装以下软件包和工具才能从源代码编译 *Percona XtraBackup*。这些可能因系统而异。

Important 重要

To build **Percona XtraBackup 8.4 from source, you must use `cmake`  version 3. To check which version is  currently installed, run `cmake --version` at a command prompt. If the  version is not `3`, install `cmake3`.
要从源代码构建 Percona XtraBackup 8.4，您必须使用 `cmake` 版本 3。要检查当前安装的版本，请在命令提示符下运行 `cmake --version`。如果版本不是 `3`，请安装 `cmake3`。

This `cmake` version may be available  in your distribution as a separate package `cmake3`. For more information, see [cmake.org](https://cmake.org/).
此 `cmake` 版本可能作为单独的包 `cmake3` 在您的发行版中提供。有关更多信息，请参阅 [cmake.org](https://cmake.org/)。

[Debian or Ubuntu using `apt`
使用 `apt` 的 Debian 或 Ubuntu](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#__tabbed_1_1)[CentOS or Red Hat using `yum`
使用 `yum` 的 CentOS 或 Red Hat](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#__tabbed_1_2)

```
sudo apt install bison pkg-config cmake devscripts debconf \
debhelper automake bison ca-certificates libprocps-dev \
libcurl4-openssl-dev cmake debhelper libaio-dev \
libncurses-dev libssl-dev libtool libz-dev libgcrypt-dev libev-dev libprocps-dev \
lsb-release build-essential rsync libdbd-mysql-perl \
libnuma1 socat librtmp-dev libtinfo5 vim-common \
liblz4-tool liblz4-1 liblz4-dev zstd python-docutils
```

To install the man pages, install the python3-sphinx package first:
要安装手册页，请先安装 python3-sphinx 软件包：

```
$ sudo apt install python3-sphinx
```

## 3. Generate the build pipeline[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#3-generate-the-build-pipeline) 3. 生成构建管道[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#3-generate-the-build-pipeline)

At this step, you have `cmake` run the commands in the `CMakeList.txt` file to generate the build pipeline, i.e., a native build environment that will be used to compile the source code).
在此步骤中，你让 `cmake` 运行 `CMakeList.txt` 文件中的命令来生成构建管道，即将用于编译源代码的原生构建环境）。

1. Change to the directory where you cloned the Percona XtraBackup repository
   切换到您克隆 Percona XtraBackup 存储库的目录

   ```
   
   ```

```
$ cd percona-xtrabackup
```

Create a directory to store the compiled files and then change to that directory:
创建一个目录来存储编译后的文件，然后切换到该目录：

1. ```
   $ mkdir build
   $ cd build
   ```

2. Run cmake or cmake3. In either case, the options you need to use are the same.
   运行 cmake 或 cmake3。无论哪种情况，您需要使用的选项都是相同的。

Note 注意

You can build *Percona XtraBackup* with man pages but this requires `python-sphinx` package which isn’t available from that main repositories for every distribution. If you installed the `python-sphinx` package you need to remove the `-DWITH_MAN_PAGES=OFF` from previous command.
您可以使用手册页构建 *Percona XtraBackup*，但这需要 `python-sphinx` 包，该包无法从每个发行版的主存储库中获得。如果您安装了 `python-sphinx` 包，则需要从上一个命令中删除 `-DWITH_MAN_PAGES=OFF`。

```
$ cmake -DWITH_BOOST=PATH-TO-BOOST-LIBRARY -DDOWNLOAD_BOOST=ON \
-DBUILD_CONFIG=xtrabackup_release -DWITH_MAN_PAGES=OFF -B ..
```

### Parameter Information[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#parameter-information) 参数信息[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#parameter-information)

| **Parameter 参数**           | **Description 描述**                                         |
| ---------------------------- | ------------------------------------------------------------ |
| `-DWITH_BOOST`               | For the `-DWITH_BOOST` parameter, specify the name of a directory to download the boost  library to. This directory is created automatically in your current  directory. 对于 `-DWITH_BOOST` 参数，指定要将 boost 库下载到的目录的名称。此目录将在当前目录中自动创建。 |
| `-DWITH_MAN_PAGES`           | To build **Percona XtraBackup** man pages, use `ON` or remove this parameter from the command line (it is `ON` by default). To install the man pages, install the python3-sphinx package first. 要构建 **Percona XtraBackup** 手册页，请使用 `ON` 或从命令行中删除此参数（默认为 `ON`）。要安装手册页，请先安装 python3-sphinx 软件包。 |
| `-B` (–build) `-B` （–构建） | **Percona XtraBackup** is configured to forbid generating the build    pipeline for make in the same directory where you store your sources. The `-B` parameter refers to the directory that contains the source code. In  this example, we use the relative path to the parent directory (..). **Percona XtraBackup** 被配置为禁止在存储源代码的同一目录中为 make 生成构建管道。`-B` 参数引用包含源代码的目录。在此示例中，我们使用父目录的相对路径 （..）。 |

Important 重要

CMake Error at CMakeLists.txt:367 (MESSAGE): Please do not build in-source.  Out-of source builds are highly recommended: you can have multiple  builds for the same source, and there is an easy way to do cleanup,  simply remove the build directory (note that ‘make clean’ or ‘make  distclean’ does `not` work)
CMakeLists.txt：367 处的 CMake  错误（消息）：请不要在源代码中构建。强烈建议使用源外构建：您可以为同一个源进行多次构建，并且有一种简单的方法可以进行清理，只需删除构建目录即可（请注意，'make clean' 或 'make distclean' `不起作用`）

You `can` force in-source build by invoking cmake with `-DFORCE_INSOURCE_BUILD=1`.
`您可以通过`使用 `-DFORCE_INSOURCE_BUILD=1` 调用 cmake 来强制源代码内构建。

## 4. Compile the source code[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#4-compile-the-source-code) 4. 编译源码[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#4-compile-the-source-code)

To compile the source code in your `build` directory, use the `make` command.
要在 `build` 目录中编译源代码，请使用 `make` 命令。

1. Change to the `build` directory (created at Step 2: Generating the build pipeline).
   更改为`构建`目录（在步骤 2：生成构建管道中创建）。

2. Run the `make` command. This command may take a long time to complete.
   运行 `make` 命令。此命令可能需要很长时间才能完成。

   ```
   
   ```

```
$ make
```

To use all CPU threads and make compilation faster please use:
要使用所有 CPU 线程并加快编译速度，请使用：

1. ```
   $ make -j$(nproc --all)
   ```

## 5. Install on the target system[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#5-install-on-the-target-system) 5. 在目标系统上安装[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#5-install-on-the-target-system)

The following command installs all *Percona XtraBackup* binaries *xtrabackup* and tests to default location on the target system: `/usr/local/xtrabackup`.
以下命令安装所有 *Percona XtraBackup* 二进制文件 *xtrabackup*，并测试到目标系统上的默认位置：`/usr/local/xtrabackup`。

Run `make install` to install *Percona XtraBackup* to the default location.
运行 `make install` 将 *Percona XtraBackup* 安装到默认位置。

```
$ sudo make install
```

### Install to a non-default location[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#install-to-a-non-default-location) 安装到非默认位置[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#install-to-a-non-default-location)

You may use the `DESTDIR` parameter with `make install` to install *Percona XtraBackup* to another location. Make sure that the effective user is able to write to the destination you choose.
您可以使用 `DESTDIR` 参数和 `make install` 将 *Percona XtraBackup* 安装到另一个位置。确保有效用户能够写入您选择的目标。

```
$ sudo make DESTDIR=<DIR_NAME> install
```

In fact, the destination directory is determined by the installation layout (`-DINSTALL_LAYOUT`) that `cmake` applies (see Step 2: Generating the build pipeline). In addition to the installation directory, this parameter controls a number of other destinations that you can adjust for your system.
实际上，目标目录由 `cmake` 应用的安装布局 （`-DINSTALL_LAYOUT`） 确定（请参阅步骤 2：生成构建管道）。除了安装目录之外，此参数还控制可针对系统调整的许多其他目标。

By default, this parameter is set to `STANDALONE`, which implies the installation directory to be `/usr/local/xtrabackup`.
默认情况下，此参数设置为 `STANDALONE，`这意味着安装目录为 `/usr/local/xtrabackup`。

See also 另请参阅

[MySQL Documentation: -DINSTALL_LAYOUT
MySQL 文档： -DINSTALL_LAYOUT](https://dev.mysql.com/doc/refman/8.4/en/source-configuration-options.html#option_cmake_install_layout)

## 6. Run Percona XtraBackup[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#6-run-percona-xtrabackup) 6. 运行 Percona XtraBackup[¶](https://docs.percona.com/percona-xtrabackup/8.4/compile-xtrabackup.html#6-run-percona-xtrabackup)

After *Percona XtraBackup* is installed on your system, you may run it by using the full path to the `xtrabackup` command:
在您的系统上安装 *Percona XtraBackup* 后，您可以使用 `xtrabackup` 命令的完整路径来运行它：

```
$ /usr/local/xtrabackup/bin/xtrabackup
```

Update your PATH environment variable if you would like to use the command on the command line directly.
如果您想直接在命令行上使用该命令，请更新您的 PATH 环境变量。

```
$# Setting $PATH on the command line
$ PATH=$PATH:/usr/local/xtrabackup/bin/xtrabackup

$# Run xtrabackup directly
$ xtrabackup
```

Alternatively, you may consider placing a soft link (using `ln -s`) to one of the locations listed in your `PATH` environment variable.
或者，您可以考虑将软链接（使用 `ln -s`）放置到 `PATH` 环境变量中列出的位置之一。

To view the documentation with `man`, update the `MANPATH` variable.
要使用 `man` 查看文档，请更新 `MANPATH` 变量。

## Docker

# Run a Docker container[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#run-a-docker-container) 运行 Docker 容器[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#run-a-docker-container)

Docker allows you to run applications in a lightweight unit called a container.
Docker 允许您在称为容器的轻量级单元中运行应用程序。

You can run Percona XtraBackup in a Docker container without installing the product. All required libraries are available in the container. Being a lightweight execution environment, Docker containers enable creating configurations where each program runs in a separate container. You may run Percona Server for MySQL in one container and Percona XtraBackup in another. Docker images offer a range of options.
您可以在 Docker 容器中运行 Percona XtraBackup，而无需安装该产品。所有必需的库在容器中都可用。作为轻量级执行环境，Docker 容器支持创建配置，其中每个程序都在单独的容器中运行。您可以在一个容器中运行 Percona Server for  MySQL，在另一个容器中运行 Percona XtraBackup。Docker 镜像提供了一系列选项。

Create a Docker container based on a Docker image. Docker images for Percona XtraBackup are hosted publicly on [Docker Hub](https://hub.docker.com/r/percona/percona-xtrabackup).
基于 Docker 镜像创建 Docker 容器。Percona XtraBackup 的 Docker 镜像公开托管在 [Docker Hub](https://hub.docker.com/r/percona/percona-xtrabackup) 上。

```
$ sudo docker create ... percona/percona-xtrabackup --name xtrabackup ...
```

### Scope of this section[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#scope-of-this-section) 本节范围[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#scope-of-this-section)

This section demonstrates how to back up data on a Percona Server for MySQL running in another Dockers container.
本节演示如何在另一个 Dockers 容器中运行的 Percona Server for MySQL 上备份数据。

## 1. Install Docker[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#1-install-docker) 1. 安装 Docker[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#1-install-docker)

Your operating system may already provide a package for docker. However, the versions of Docker provided by your operating system are likely to be outdated.
您的操作系统可能已经为 docker 提供了一个软件包。但是，您的操作系统提供的 Docker 版本可能已过时。

Use the installation instructions for your operating system available from the Docker site to set up the latest version of docker.
使用 Docker 站点提供的适用于您的操作系统的安装说明来设置最新版本的 Docker。

## 2. Connect to a Percona Server for MySQL container[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#2-connect-to-a-percona-server-for-mysql-container) 2. 连接到 Percona Server for MySQL 容器[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#2-connect-to-a-percona-server-for-mysql-container)

Percona XtraBackup works in combination with a database server. When running a Docker container for Percona XtraBackup, you can make backups for a database server either installed on the host machine or running in a separate Docker container.
Percona XtraBackup 与数据库服务器结合使用。当为 Percona XtraBackup 运行 Docker 容器时，您可以为安装在主机上或在单独的 Docker 容器中运行的数据库服务器进行备份。

To set up a database server on a host machine or in Docker container, follow the documentation of the supported product that you intend to use with Percona XtraBackup.
要在主机或 Docker 容器中设置数据库服务器，请遵循您打算与 Percona XtraBackup 一起使用的受支持产品的文档。

See also 另请参阅

[Docker volumes as container persistent data storage
Docker 卷作为容器持久数据存储](https://docs.docker.com/storage/volumes/)

[More information about containers
有关容器的更多信息](https://docs.docker.com/config/containers/start-containers-automatically)

```
$ sudo docker run -d --name percona-server-mysql \
-e MYSQL_ROOT_PASSWORD=root percona/percona-server:8.4
```

As soon as Percona Server for MySQL runs, add some data to it. Now, you are ready to make backups with Percona XtraBackup.
Percona Server for MySQL 运行后，立即向其添加一些数据。现在，您已准备好使用 Percona XtraBackup 进行备份。

Important 重要

When running Percona XtraBackup from a container and connecting to a  MySQLserver container, we recommend using the –user root option in the  Docker command.
从容器运行 Percona XtraBackup 并连接到 MySQLserver 容器时，我们建议在 Docker 命令中使用 –user root 选项。

## 3. Create a Docker container from Percona XtraBackup image[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#3-create-a-docker-container-from-percona-xtrabackup-image) 3. 从 Percona XtraBackup 镜像创建 Docker 容器[¶](https://docs.percona.com/percona-xtrabackup/8.4/docker.html#3-create-a-docker-container-from-percona-xtrabackup-image)

You can create a Docker container based on Percona XtraBackup image with either `docker create` or the `docker run` command. `docker create` creates a Docker container and makes it available for starting later.
您可以使用 `docker create` 或 `docker run` 命令基于 Percona XtraBackup 镜像创建 Docker 容器。`docker create` 会创建一个 Docker 容器，并使其可供稍后启动。

Docker downloads the Percona XtraBackup image from the Docker Hub. If it is not the first time you use the selected image, Docker uses the image available locally.
Docker 从 Docker Hub 下载 Percona XtraBackup 镜像。如果这不是您第一次使用所选镜像，Docker 将使用本地可用的镜像。

```
$ sudo docker create --name percona-xtrabackup --volumes-from percona-server-mysql \
percona/percona-xtrabackup  \
xtrabackup --backup --datadir=/var/lib/mysql/ --target-dir=/backup \
--user=root --password=mysql
```

With parameter name you give a meaningful name to your new Docker container so that you could easily locate it among your other containers.
使用参数名称，您可以为新的 Docker 容器指定一个有意义的名称，以便您可以在其他容器中轻松找到它。

The `volumes-from` flag refers to Percona Server for MySQL and indicates that you intend to use the same data as the Percona Server for MySQL container.
`volumes-from` 标志指的是 Percona Server for MySQL，并指示您打算使用与 Percona Server for MySQL 容器相同的数据。

Run the container with exactly the same parameters that were used when the container was created:
使用与创建容器时完全相同的参数运行容器：

```
$ sudo docker start -ai percona-xtrabackup
```

This command starts the percona-xtrabackup container, attaches to its input/output streams, and opens an interactive shell.
此命令启动 percona-xtrabackup 容器，附加到其输入/输出流，并打开一个交互式 shell。

The `docker run` is a shortcut command that creates a Docker container and then immediately runs it.
`docker run` 是一个快捷命令，用于创建 Docker 容器，然后立即运行它。

```
$ sudo docker run --name percona-xtrabackup --volumes-from percona-server-mysql \
percona/percona-xtrabackup
xtrabackup --backup --data-dir=/var/lib/mysql --target-dir=/backup --user=root --password=mysql
```