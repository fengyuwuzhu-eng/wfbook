# 命令行工具

[TOC]

Ansible 为执行各种操作和自动化任务提供了临时( ad hoc )命令和几个实用程序。

## ad hoc 命令

Ansible ad hoc 命令使用 /usr/bin/ansible 命令行工具在一个或多个受控节点上自动执行单个任务。ad hoc 命令快速简单，但不可重复使用。ad hoc 命令展示了 Ansible 的简单性和强大性。

### 使用 ad hoc 命令的原因

ad hoc 命令对于很少重复的任务非常有用。例如，如果想在圣诞节假期关闭实验室里的所有机器，可以在 Ansible 中快速执行单行指令，而不需要编写 playbook 。ad hoc 命令如下所示：

```bash
ansible [pattern] -m [module] -a "[module options]"
```

`-a` 选项通过  `key=value` 语法或以 `{` 开头并以 `}` 结尾的 JSON 字符串接受选项，以获得更复杂的选项结构。

### ad hoc 任务的用例

ad hoc 任务可用于重新启动服务器、复制文件、管理软件包和用户等。可以在临时任务中使用任何 Ansible 模块。ad hoc 任务，像 playbook 一样，使用声明性模型，计算并执行达到指定最终状态所需的操作。它们通过在开始之前检查当前状态而不执行任何操作来实现幂等性，除非当前状态与指定的最终状态不同。

#### 重新启动服务器

`ansible` 命令行实用程序的默认模块是 `ansible.builtin.command` 模块。可以使用一个 ad hoc 任务来调用命令模块并重新启动所有的 web 服务器，每次 10 台。在 Ansible 能够做到这一点之前，必须在 inventory 中将所有服务器列在一个名为 [Atlanta] 的组中，并且必须为该组中的每台计算机提供有效的 SSH 凭据。要重新启动 [atlanta] 组中的所有服务器，请执行以下操作：

```bash
ansible atlanta -a "/sbin/reboot"
```

默认情况下，Ansible 只使用 5 个同时进行的进程。如果主机数超过了为 fork 计数设置的值，Ansible 将与它们对话，但这需要更长的时间。要使用 10 个并行 fork 重新启动 [atlanta] 服务器：

```bash
ansible atlanta -a "/sbin/reboot" -f 10
```

/usr/bin/ansible 将默认为从用户帐户运行。要以其他用户身份连接：

```bash
ansible atlanta -a "/sbin/reboot" -f 10 -u username
```

重新启动可能需要权限升级。您可以以 `username` 身份连接到服务器，并以 `root` 用户身份运行命令，方法是使用 `become` 关键字：

```bash
ansible atlanta -a "/sbin/reboot" -f 10 -u username --become [--ask-become-pass]
```

如果添加 `--ask-become-pass` 或 `-K` ，Ansible 会提示您输入用于权限升级的密码（`sudo/su/pfexec/doas/etc`）。

> **Note：**
>
> command 模块不支持扩展的 shell 语法，如管道和重定向（尽管 shell 变量始终有效）。如果命令需要特定于 shell 的语法，请改用 shell 模块。

到目前为止，所有的示例都使用了默认的 “command” 模块。要使用不同的模块，请传递 `-m` 作为模块名称。例如，要使用 `ansible.builtin.shell` 模块：

```bash
ansible raleigh -m ansible.builtin.shell -a 'echo $TERM'
```

当使用 Ansible ad hoc CLI 运行任何命令时（与 Playbook 相反），请特别注意 shell 引用规则，因此本地 shell 保留变量并将其传递给 Ansible 。例如，在上面的示例中使用双引号而不是单引号将计算所处框上的变量。

#### 管理文件

一个 ad hoc 任务可以利用 Ansible 和 SCP 的功能将许多文件并行传输到多台计算机。要将文件直接传输到 [atlanta] 组中的所有服务器：

```bash
ansible atlanta -m ansible.builtin.copy -a "src=/etc/hosts dest=/tmp/hosts"
```

如果计划重复这样的任务，请使用 playbook 中的 ansible.built.template 模块。

ansible.builtin.file 模块允许更改文件的所有权和权限。这些相同的选项也可以直接传递给 `copy` 模块：

```bash
ansible webservers -m ansible.builtin.file -a "dest=/srv/foo/a.txt mode=600"
ansible webservers -m ansible.builtin.file -a "dest=/srv/foo/b.txt mode=600 owner=mdehaan group=mdehaan"
```

The `file` module can also create directories, similar to:

`file` 模块还可以创建目录，类似于 `mkdir -p` ：

```bash
ansible webservers -m ansible.builtin.file -a "dest=/path/to/c mode=755 owner=mdehaan group=mdehaan state=directory"
```

以及删除目录（递归）和删除文件：

```bash
ansible webservers -m ansible.builtin.file -a "dest=/path/to/c state=absent"
```

#### 管理软件包

还可以使用包管理模块（如  `yum` ）在受控节点上安装、更新或删除包。包管理模块支持安装、删除和一般管理包的通用功能。Ansible 模块中可能不存在包管理器的某些特定功能，因为它们不是通用包管理的一部分。

要确保在不更新软件包的情况下安装软件包，请执行以下操作：

```bash
ansible webservers -m ansible.builtin.yum -a "name=acme state=present"
```

要确保安装了包的特定版本，请执行以下操作：

```bash
ansible webservers -m ansible.builtin.yum -a "name=acme-1.5 state=present"
```

要确保软件包为最新版本，请执行以下操作：

```bash
ansible webservers -m ansible.builtin.yum -a "name=acme state=latest"
```

要确保未安装软件包，请执行以下操作：

```bash
ansible webservers -m ansible.builtin.yum -a "name=acme state=absent"
```

Ansible 在许多平台下都有用于管理包的模块。如果没有包管理器的模块，则可以使用命令模块安装包或为包管理器创建模块。

#### 管理用户和组

您可以使用 ad hoc 任务在受控节点上创建、管理和删除用户帐户：

```bash
ansible all -m ansible.builtin.user -a "name=foo password=<crypted password here>"
ansible all -m ansible.builtin.user -a "name=foo state=absent"
```

#### 管理服务

确保在所有 Web 服务器上启动服务：

```bash
ansible webservers -m ansible.builtin.service -a "name=httpd state=started"
```

或者，在所有 Web 服务器上重新启动服务：

```bash
ansible webservers -m ansible.builtin.service -a "name=httpd state=restarted"
```

确保服务已停止：

```bash
ansible webservers -m ansible.builtin.service -a "name=httpd state=stopped"
```

#### 收集 fact

Facts represent discovered variables about a system. You can use  facts to implement conditional execution of tasks but also just to get  ad hoc information about your systems. To see all facts:

事实代表发现的系统变量。您可以使用事实来实现任务的条件执行，但也可以仅获取有关系统的临时信息。要查看所有事实：

```bash
ansible all -m ansible.builtin.setup
```

## 命令行工具

Ansible 实用程序的完整列表。

> Note：
>
> You should not run most Ansible CLI tools in parallel against the same targets.您不应针对相同的目标并行运行大多数Ansible CLI工具。

- ansible
- ansible-config
- ansible-console
- ansible-doc
- ansible-galaxy
- ansible-inventory
- ansible-playbook
- ansible-pull
- ansible-vault

### ansible

是一个非常简单的工具 / 框架 / API，用于执行“远程操作”。该命令允许针对一组主机定义和运行单个任务 “playbook” 。

```bash
ansible [-h] [--version] [-v] [-b] [--become-method BECOME_METHOD]
        [--become-user BECOME_USER]
        [-K | --become-password-file BECOME_PASSWORD_FILE]
        [-i INVENTORY] [--list-hosts] [-l SUBSET] [-P POLL_INTERVAL]
        [-B SECONDS] [-o] [-t TREE] [--private-key PRIVATE_KEY_FILE]
        [-u REMOTE_USER] [-c CONNECTION] [-T TIMEOUT]
        [--ssh-common-args SSH_COMMON_ARGS]
        [--sftp-extra-args SFTP_EXTRA_ARGS]
        [--scp-extra-args SCP_EXTRA_ARGS]
        [--ssh-extra-args SSH_EXTRA_ARGS]
        [-k | --connection-password-file CONNECTION_PASSWORD_FILE] [-C]
        [--syntax-check] [-D] [-e EXTRA_VARS] [--vault-id VAULT_IDS]
        [--ask-vault-password | --vault-password-file VAULT_PASSWORD_FILES]
        [-f FORKS] [-M MODULE_PATH] [--playbook-dir BASEDIR]
        [--task-timeout TASK_TIMEOUT] [-a MODULE_ARGS] [-m MODULE_NAME]
        pattern
```

#### 通用选项

- --ask-vault-password

- --ask-vault-pass

  询问 vault 密码。

- --become-method <BECOME_METHOD>

  要使用的权限提升方法（默认值=sudo），请使用 ansible-doc -t become -l 列出有效选项。

- --become-password-file <BECOME_PASSWORD_FILE>

- --become-pass-file <BECOME_PASSWORD_FILE>

  Become 密码文件。

- --become-user <BECOME_USER>

  以此用户身份运行操作（默认值=root）。

- --connection-password-file <CONNECTION_PASSWORD_FILE>

- --conn-pass-file <CONNECTION_PASSWORD_FILE>

  连接密码文件。

- --list-hosts

  输出匹配主机的列表；不执行任何其他操作。

- --playbook-dir <BASEDIR>

  Since this tool does not use playbooks, use this as a substitute  playbook directory. This sets the relative path for many features  including roles/ group_vars/ etc.

  由于此工具不使用playbook，请将其用作替代playbook目录。这为许多功能设置了相对路径，包括角色/组变量等。

- --private-key <PRIVATE_KEY_FILE>

- --key-file <PRIVATE_KEY_FILE>

  使用此文件验证连接。

- --scp-extra-args <SCP_EXTRA_ARGS>

  指定仅传递给 scp 的额外参数（例如 -l）

- --sftp-extra-args <SFTP_EXTRA_ARGS>

  指定仅传递给 sftp 的额外参数（例如 -f 、-l）。

- --ssh-common-args <SSH_COMMON_ARGS>

  指定要传递给 sftp / scp / ssh 的公共参数（例如 ProxyCommand）。

- --ssh-extra-args <SSH_EXTRA_ARGS>

  指定仅传递给 ssh 的额外参数（例如 -R）。

- --syntax-check

  对 playbook 执行语法检查，但不执行。

- --task-timeout <TASK_TIMEOUT>

  设置任务超时限制（秒），必须为正整数。

- --vault-id

  要使用的 vault ID。

- --vault-password-file

- --vault-pass-file

  vault 密码文件。

- --version

  show program’s version number, config file location, configured  module search path, module location, executable location and exit

  显示程序的版本号、配置文件位置、配置的模块搜索路径、模块位置、可执行文件位置并退出。

- -B <SECONDS>

- --background <SECONDS>

  异步运行，X 秒后失败（默认值=N/A）

- -C

- --check

  不要做任何改变；相反，尝试预测可能发生的一些变化。

- -D

- --diff

  更改（小）文件和模板时，显示这些文件中的差异；works great with –check适用于–check

- -K

- --ask-become-pass

  请求权限提升密码。

- -M

- --module-path

  prepend colon-separated path(s) to module library (default={{  ANSIBLE_HOME ~ “/plugins/modules:/usr/share/ansible/plugins/modules” }})

  在模块库前面加上冒号分隔的路径（默认值＝｛｛ANSIBLE HOME~“/plugins/modules:/usr/share/ANSIBLE/plugins/modules”｝｝）

- -P <POLL_INTERVAL>

- --poll <POLL_INTERVAL>

  如果使用 -B（默认值=15），则设置轮询间隔。

- -T <TIMEOUT>

- --timeout <TIMEOUT>

  以秒为单位覆盖连接超时（默认值=10）。

- -a <MODULE_ARGS>

- --args <MODULE_ARGS>

  以空格分隔的 k=v 格式的操作选项：-a ‘opt1=val1 opt2=val2’ 

  或json字符串：-a ‘{“opt1”: “val1”, “opt2”: “val2”}’

- -b

- --become

  run operations with become (does not imply password prompting)

  使用 become 运行操作（不暗示密码提示）。

- -c <CONNECTION>

- --connection <CONNECTION>

  要使用的连接类型（默认值=smart）。

- -e

- --extra-vars

  set additional variables as key=value or YAML/JSON, if filename prepend with @

- -f <FORKS>

- --forks <FORKS>

  指定要使用的并行进程数（默认值=5）。

- -h

- --help

  显示此帮助消息并退出。

- -i

- --inventory

- --inventory-file

  指定 inventory 主机路径或逗号分隔的主机列表。–inventory-file 已弃用。

- -k

- --ask-pass

  询问连接密码。

- -l <SUBSET>

- --limit <SUBSET>

  further limit selected hosts to an additional pattern

  进一步将所选主机限制为其他模式。

- -m <MODULE_NAME>

- --module-name <MODULE_NAME>

  要执行的操作的名称（默认值=command）。

- -o

- --one-line

  condense output

- -t <TREE>

- --tree <TREE>

  将输出记录到此目录。

- -u <REMOTE_USER>

- --user <REMOTE_USER>

  以此用户身份连接（默认值=None）。

- -v

- --verbose

  使 Ansible 打印更多调试消息。添加多个 -v 将增加冗长性，内置插件目前的评估值最高为 -vvvvvv 。一个合理的启动级别是 -vvv ，连接调试可能需要 -vvvv 。

#### 环境

可以指定以下环境变量：

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – 覆盖默认的 ansible 配置文件。

Many more are available for most options in ansible.cfg

#### 文件

`/etc/ansible/ansible.cfg` – 配置文件，如果存在则使用。

`~/.ansible.cfg` – 用户配置文件，覆盖默认配置（如果存在）。

### ansible-config

查看 ansible 配置。配置命令行类

```bash
ansible-config [-h] [--version] [-v] {list,dump,view,init} ...
```

#### 通用选项

- --version

  显示程序的版本号、配置文件位置、配置的模块搜索路径、模块位置、可执行文件位置并退出。

- -h

- --help

  显示此帮助消息并退出。

- -v

- --verbose

  使 Ansible 打印更多调试消息。添加多个 -v 将增加冗长性，内置插件目前的评估值最高为 -vvvvvv 。一个合理的启动级别是 -vvv ，连接调试可能需要 -vvvv 。

#### Actions

##### list

列出并输出可用配置。

- --format <FORMAT>

- -f <FORMAT>

  列表的输出格式。

- -c <CONFIG_FILE>

- --config <CONFIG_FILE>

  配置文件的路径，默认为优先找到的第一个文件。

- -t <TYPE>

- --type <TYPE>

  Filter down to a specific plugin type.
  
  过滤到特定的插件类型。

##### dump

Shows the current settings, merges ansible.cfg if specified

显示当前设置，如果指定，则合并 ansible.cfg

- --format <FORMAT>

- -f <FORMAT>

  dump 的输出格式。

- --only-changed

- --changed-only

  Only show configurations that have changed from the default

  仅显示从默认值更改的配置

- -c <CONFIG_FILE>

- --config <CONFIG_FILE>

  配置文件的路径，默认为优先找到的第一个文件。

- -t <TYPE>

- --type <TYPE>

  Filter down to a specific plugin type.
  
  过滤到特定的插件类型。

##### view

显示当前配置文件。

- -c <CONFIG_FILE>

- --config <CONFIG_FILE>

  配置文件的路径，默认为优先找到的第一个文件。

- -t <TYPE>

- --type <TYPE>

  过滤到特定的插件类型。

##### init

- --disabled

  在所有条目前加上注释字符以禁用它们。

- --format <FORMAT>

- -f <FORMAT>

  init 的输出格式。

- -c <CONFIG_FILE>

- --config <CONFIG_FILE>

  配置文件的路径，默认为优先找到的第一个文件。

- -t <TYPE>

- --type <TYPE>

  过滤到特定的插件类型。

#### 环境

可以指定以下环境变量：

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – 覆盖默认的 ansible 配置文件。

文件夹

/etc/ansible/ansible.cfg–

~/.ansible.cfg–

#### 文件

`/etc/ansible/ansible.cfg` – 配置文件，如果存在则使用。

`~/.ansible.cfg` – 用户配置文件，覆盖默认配置（如果存在）。

### ansible-console

用于执行 Ansible 任务的 REPL 控制台。

A REPL that allows for running ad-hoc tasks against a chosen inventory from a nice shell with built-in tab completion (based on dominis’ ansible-shell).

一个 REPL，它允许从一个内置标签完成的漂亮shell（基于dominis的ansible shell）中对所选库存运行特殊任务。

It supports several commands, and you can modify its configuration at runtime:

它支持多个命令，您可以在运行时修改其配置：

- cd [pattern]

  change host/group (you can use host patterns eg.: app*.dc*:!app01*)

  更改主机/组（您可以使用主机模式，例如：app*.dc*：！app01*）

- list

  list available hosts in the current path列出当前路径中的可用主机

- list groups

  list groups included in the current path当前路径中包含的列表组

- become

  toggle the become flag切换成为标志

- !

  forces shell module instead of the ansible module (!yum update -y)强制shell模块而不是ansible模块（！yum update-y）

- verbosity [num]

  set the verbosity level设置详细级别

- forks [num]

  set the number of forks设置分叉数

- become_user [user]

  设置 become_user 。

- remote_user [user]

  设置 remote_user 。

- become_method [method]

  set the privilege escalation method设置权限提升方法

- check [bool]

  toggle check mode切换检查模式

- diff [bool]

  toggle diff mode切换diff模式

- timeout [integer]

  set the timeout of tasks in seconds (0 to disable)以秒为单位设置任务的超时（0表示禁用）

- help [command/module]

  显示命令或模块的文档。

- exit

  退出 ansible 控制台。

```bash
ansible-console [-h] [--version] [-v] [-b]
                    [--become-method BECOME_METHOD]
                    [--become-user BECOME_USER]
                    [-K | --become-password-file BECOME_PASSWORD_FILE]
                    [-i INVENTORY] [--list-hosts] [-l SUBSET]
                    [--private-key PRIVATE_KEY_FILE] [-u REMOTE_USER]
                    [-c CONNECTION] [-T TIMEOUT]
                    [--ssh-common-args SSH_COMMON_ARGS]
                    [--sftp-extra-args SFTP_EXTRA_ARGS]
                    [--scp-extra-args SCP_EXTRA_ARGS]
                    [--ssh-extra-args SSH_EXTRA_ARGS]
                    [-k | --connection-password-file CONNECTION_PASSWORD_FILE]
                    [-C] [--syntax-check] [-D] [--vault-id VAULT_IDS]
                    [--ask-vault-password | --vault-password-file VAULT_PASSWORD_FILES]
                    [-f FORKS] [-M MODULE_PATH] [--playbook-dir BASEDIR]
                    [-e EXTRA_VARS] [--task-timeout TASK_TIMEOUT] [--step]
                    [pattern]
```

#### 通用选项

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --become-method <BECOME_METHOD>

  privilege escalation method to use (default=sudo), use ansible-doc -t become -l to list valid choices.

- --become-password-file <BECOME_PASSWORD_FILE>, --become-pass-file <BECOME_PASSWORD_FILE>

  Become password file

- --become-user <BECOME_USER>

  run operations as this user (default=root)

- --connection-password-file <CONNECTION_PASSWORD_FILE>, --conn-pass-file <CONNECTION_PASSWORD_FILE>

  Connection password file

- --list-hosts

  outputs a list of matching hosts; does not execute anything else

- --playbook-dir <BASEDIR>

  Since this tool does not use playbooks, use this as a substitute  playbook directory. This sets the relative path for many features  including roles/ group_vars/ etc.

- --private-key <PRIVATE_KEY_FILE>, --key-file <PRIVATE_KEY_FILE>

  use this file to authenticate the connection

- --scp-extra-args <SCP_EXTRA_ARGS>

  specify extra arguments to pass to scp only (e.g. -l)

- --sftp-extra-args <SFTP_EXTRA_ARGS>

  specify extra arguments to pass to sftp only (e.g. -f, -l)

- --ssh-common-args <SSH_COMMON_ARGS>

  specify common arguments to pass to sftp/scp/ssh (e.g. ProxyCommand)

- --ssh-extra-args <SSH_EXTRA_ARGS>

  specify extra arguments to pass to ssh only (e.g. -R)

- --step

  one-step-at-a-time: confirm each task before running

- --syntax-check

  perform a syntax check on the playbook, but do not execute it

- --task-timeout <TASK_TIMEOUT>

  set task timeout limit in seconds, must be positive integer.

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

- --version

  show program’s version number, config file location, configured  module search path, module location, executable location and exit

- -C, --check

  don’t make any changes; instead, try to predict some of the changes that may occur

- -D, --diff

  when changing (small) files and templates, show the differences in those files; works great with –check

- -K, --ask-become-pass

  ask for privilege escalation password

- -M, --module-path

  prepend colon-separated path(s) to module library (default={{  ANSIBLE_HOME ~ “/plugins/modules:/usr/share/ansible/plugins/modules” }})

- -T <TIMEOUT>, --timeout <TIMEOUT>

  override the connection timeout in seconds (default=10)

- -b, --become

  run operations with become (does not imply password prompting)

- -c <CONNECTION>, --connection <CONNECTION>

  connection type to use (default=smart)

- -e, --extra-vars

  set additional variables as key=value or YAML/JSON, if filename prepend with @

- -f <FORKS>, --forks <FORKS>

  specify number of parallel processes to use (default=5)

- -h, --help

  show this help message and exit

- -i, --inventory, --inventory-file

  specify inventory host path or comma separated host list. –inventory-file is deprecated

- -k, --ask-pass

  ask for connection password

- -l <SUBSET>, --limit <SUBSET>

  further limit selected hosts to an additional pattern

- -u <REMOTE_USER>, --user <REMOTE_USER>

  connect as this user (default=None)

- -v, --verbose

  Causes Ansible to print more debug messages. Adding multiple -v  will increase the verbosity, the builtin plugins currently evaluate up  to -vvvvvv. A reasonable level to start is -vvv, connection debugging  might require -vvvv.

#### 环境

The following environment variables may be specified.

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – Override the default ansible config file

Many more are available for most options in ansible.cfg

#### 文件

`/etc/ansible/ansible.cfg` – Config file, used if present

`~/.ansible.cfg` – User config file, overrides the default config if present

### ansible-doc

**plugin documentation tool**

```bash
ansible-doc [-h] [--version] [-v] [-M MODULE_PATH]
                [--playbook-dir BASEDIR]
                [-t {become,cache,callback,cliconf,connection,httpapi,inventory,lookup,netconf,shell,vars,module,strategy,test,filter,role,keyword}]
                [-j] [-r ROLES_PATH]
                [-e ENTRY_POINT | -s | -F | -l | --metadata-dump]
                [--no-fail-on-errors]
                [plugin ...]
```

#### Description

displays information on modules installed in Ansible libraries. It displays a terse listing of plugins and their short descriptions, provides a printout of their DOCUMENTATION strings, and it can create a short “snippet” which can be pasted into a playbook.

#### Common Options

- --metadata-dump

  **For internal use only** Dump json metadata for all entries, ignores other options.

- --no-fail-on-errors

  **For internal use only** Only used for –metadata-dump. Do not fail on errors. Report the error message in the JSON instead.

- --playbook-dir <BASEDIR>

  Since this tool does not use playbooks, use this as a substitute  playbook directory. This sets the relative path for many features  including roles/ group_vars/ etc.

- --version

  show program’s version number, config file location, configured  module search path, module location, executable location and exit

- -F, --list_files

  Show plugin names and their source files without summaries  (implies –list). A supplied argument will be used for filtering, can be a namespace or full collection name.

- -M, --module-path

  prepend colon-separated path(s) to module library (default={{  ANSIBLE_HOME ~ “/plugins/modules:/usr/share/ansible/plugins/modules” }})

- -e <ENTRY_POINT>, --entry-point <ENTRY_POINT>

  Select the entry point for role(s).

- -h, --help

  show this help message and exit

- -j, --json

  Change output into json format.

- -l, --list

  List available plugins. A supplied argument will be used for filtering, can be a namespace or full collection name.

- -r, --roles-path

  The path to the directory containing your roles.

- -s, --snippet

  Show playbook snippet for these plugin types: inventory, lookup, module

- -t <TYPE>, --type <TYPE>

  Choose which plugin type (defaults to “module”). Available plugin types are : (‘become’, ‘cache’, ‘callback’, ‘cliconf’, ‘connection’,  ‘httpapi’, ‘inventory’, ‘lookup’, ‘netconf’, ‘shell’, ‘vars’, ‘module’,  ‘strategy’, ‘test’, ‘filter’, ‘role’, ‘keyword’)

- -v, --verbose

  Causes Ansible to print more debug messages. Adding multiple -v  will increase the verbosity, the builtin plugins currently evaluate up  to -vvvvvv. A reasonable level to start is -vvv, connection debugging  might require -vvvv.

#### Environment

The following environment variables may be specified.

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – Override the default ansible config file

Many more are available for most options in ansible.cfg

#### Files

`/etc/ansible/ansible.cfg` – Config file, used if present

`~/.ansible.cfg` – User config file, overrides the default config if present

### ansible-galaxy

**Perform various Role and Collection related operations.**

```
ansible-galaxy [-h] [--version] [-v] TYPE ...
```

#### Description

Command to manage Ansible roles and collections.

None of the CLI tools are designed to run concurrently with themselves. Use an external scheduler and/or locking to ensure there are no clashing operations.

#### Common Options

- --version

  show program’s version number, config file location, configured  module search path, module location, executable location and exit

- -h, --help

  show this help message and exit

- -v, --verbose

  Causes Ansible to print more debug messages. Adding multiple -v  will increase the verbosity, the builtin plugins currently evaluate up  to -vvvvvv. A reasonable level to start is -vvv, connection debugging  might require -vvvv.

#### Actions

##### collection

Perform the action on an Ansible Galaxy collection. Must be combined with a further action like init/install as listed below.



###### collection download

- --clear-response-cache

  Clear the existing server response cache.

- --no-cache

  Do not use the server response cache.

- --pre

  Include pre-release versions. Semantic versioning pre-releases are ignored by default

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -n, --no-deps

  Don’t download collection(s) listed as dependencies.

- -p <DOWNLOAD_PATH>, --download-path <DOWNLOAD_PATH>

  The directory to download the collections to.

- -r <REQUIREMENTS>, --requirements-file <REQUIREMENTS>

  A file containing a list of collections to be downloaded.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



######  collection init

Creates the skeleton framework of a role or collection that complies with the Galaxy metadata format. Requires a role or collection name. The collection name must be in the format `<namespace>.<collection>`.

- --collection-skeleton <COLLECTION_SKELETON>

  The path to a collection skeleton that the new collection should be based upon.

- --init-path <INIT_PATH>

  The path in which the skeleton collection will be created. The default is the current working directory.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -f, --force

  Force overwriting an existing role or collection

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



######  collection build

Build an Ansible Galaxy collection artifact that can be stored in a central repository like Ansible Galaxy. By default, this command builds from the current working directory. You can optionally pass in the collection input path (where the `galaxy.yml` file is).

- --output-path <OUTPUT_PATH>

  The path in which the collection is built to. The default is the current working directory.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -f, --force

  Force overwriting an existing role or collection

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



######  collection publish

Publish a collection into Ansible Galaxy. Requires the path to the collection tarball to publish.

- --import-timeout <IMPORT_TIMEOUT>

  The time to wait for the collection import process to finish.

- --no-wait

  Don’t wait for import validation results.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



######  collection install

- --clear-response-cache

  Clear the existing server response cache.

- --disable-gpg-verify

  Disable GPG signature verification when installing collections from a Galaxy server

- --force-with-deps

  Force overwriting an existing collection and its dependencies.

- --ignore-signature-status-code

  A status code to ignore during signature verification (for  example, NO_PUBKEY). Provide this option multiple times to ignore a list of status codes. Descriptions for the choices can be seen at L(https://github.com/gpg/gnupg/blob/master/doc/DETAILS#general-status-codes).

- --keyring <KEYRING>

  The keyring used during signature verification

- --no-cache

  Do not use the server response cache.

- --offline

  Install collection artifacts (tarballs) without contacting any  distribution servers. This does not apply to collections in remote Git  repositories or URLs to remote tarballs.

- --pre

  Include pre-release versions. Semantic versioning pre-releases are ignored by default

- --required-valid-signature-count <REQUIRED_VALID_SIGNATURE_COUNT>

  The number of signatures that must successfully verify the  collection. This should be a positive integer or -1 to signify that all  signatures must be used to verify the collection. Prepend the value with + to fail if no valid signatures are found for the collection (e.g.  +all).

- --signature

  An additional signature source to verify the authenticity of the  MANIFEST.json before installing the collection from a Galaxy server. Use in conjunction with a positional collection name (mutually exclusive  with –requirements-file).

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -U, --upgrade

  Upgrade installed collection artifacts. This will also update dependencies unless –no-deps is provided

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -f, --force

  Force overwriting an existing role or collection

- -i, --ignore-errors

  Ignore errors during installation and continue with the next  specified collection. This will not ignore dependency conflict errors.

- -n, --no-deps

  Don’t download collections listed as dependencies.

- -p <COLLECTIONS_PATH>, --collections-path <COLLECTIONS_PATH>

  The path to the directory containing your collections.

- -r <REQUIREMENTS>, --requirements-file <REQUIREMENTS>

  A file containing a list of collections to be installed.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL

###### collection list

List installed collections or roles

- --format <OUTPUT_FORMAT>

  Format to display the list of collections in.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -p, --collections-path

  One or more directories to search for collections in addition to  the default COLLECTIONS_PATHS. Separate multiple paths with ‘:’.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL

###### collection verify

- --ignore-signature-status-code

  A status code to ignore during signature verification (for  example, NO_PUBKEY). Provide this option multiple times to ignore a list of status codes. Descriptions for the choices can be seen at L(https://github.com/gpg/gnupg/blob/master/doc/DETAILS#general-status-codes).

- --keyring <KEYRING>

  The keyring used during signature verification

- --offline

  Validate collection integrity locally without contacting server for canonical manifest hash.

- --required-valid-signature-count <REQUIRED_VALID_SIGNATURE_COUNT>

  The number of signatures that must successfully verify the  collection. This should be a positive integer or all to signify that all signatures must be used to verify the collection. Prepend the value  with + to fail if no valid signatures are found for the collection (e.g. +all).

- --signature

  An additional signature source to verify the authenticity of the  MANIFEST.json before using it to verify the rest of the contents of a  collection from a Galaxy server. Use in conjunction with a positional  collection name (mutually exclusive with –requirements-file).

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -i, --ignore-errors

  Ignore errors during verification and continue with the next specified collection.

- -p, --collections-path

  One or more directories to search for collections in addition to  the default COLLECTIONS_PATHS. Separate multiple paths with ‘:’.

- -r <REQUIREMENTS>, --requirements-file <REQUIREMENTS>

  A file containing a list of collections to be verified.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL

##### role

Perform the action on an Ansible Galaxy role. Must be combined with a further action like delete/install/init as listed below.



###### role init

Creates the skeleton framework of a role or collection that complies with the Galaxy metadata format. Requires a role or collection name. The collection name must be in the format `<namespace>.<collection>`.

- --init-path <INIT_PATH>

  The path in which the skeleton role will be created. The default is the current working directory.

- --offline

  Don’t query the galaxy API when creating roles

- --role-skeleton <ROLE_SKELETON>

  The path to a role skeleton that the new role should be based upon.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- --type <ROLE_TYPE>

  Initialize using an alternate role type. Valid types include: ‘container’, ‘apb’ and ‘network’.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -f, --force

  Force overwriting an existing role or collection

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



###### role remove

removes the list of roles passed as arguments from the local system.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -p, --roles-path

  The path to the directory containing your roles. The default is  the first writable one configured via DEFAULT_ROLES_PATH: {{  ANSIBLE_HOME ~ “/roles:/usr/share/ansible/roles:/etc/ansible/roles” }}

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



###### role delete

Delete a role from Ansible Galaxy.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL

###### role list

List installed collections or roles

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -p, --roles-path

  The path to the directory containing your roles. The default is  the first writable one configured via DEFAULT_ROLES_PATH: {{  ANSIBLE_HOME ~ “/roles:/usr/share/ansible/roles:/etc/ansible/roles” }}

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



###### role search

searches for roles on the Ansible Galaxy server

- --author <AUTHOR>

  GitHub username

- --galaxy-tags <GALAXY_TAGS>

  list of galaxy tags to filter by

- --platforms <PLATFORMS>

  list of OS platforms to filter by

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



###### role import

used to import a role into Ansible Galaxy

- --branch <REFERENCE>

  The name of a branch to import. Defaults to the repository’s default branch (usually master)

- --no-wait

  Don’t wait for import results.

- --role-name <ROLE_NAME>

  The name the role should have, if different than the repo name

- --status

  Check the status of the most recent import request for given github_user/github_repo.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



###### role setup

Setup an integration from Github or Travis for Ansible Galaxy roles

- --list

  List all of your integrations.

- --remove <REMOVE_ID>

  Remove the integration matching the provided ID value. Use –list to see ID values.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -p, --roles-path

  The path to the directory containing your roles. The default is  the first writable one configured via DEFAULT_ROLES_PATH: {{  ANSIBLE_HOME ~ “/roles:/usr/share/ansible/roles:/etc/ansible/roles” }}

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



###### role info

prints out detailed information about an installed role as well as info available from the galaxy API.

- --offline

  Don’t query the galaxy API when creating roles

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -p, --roles-path

  The path to the directory containing your roles. The default is  the first writable one configured via DEFAULT_ROLES_PATH: {{  ANSIBLE_HOME ~ “/roles:/usr/share/ansible/roles:/etc/ansible/roles” }}

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL



###### role install

- --force-with-deps

  Force overwriting an existing role and its dependencies.

- --timeout <TIMEOUT>

  The time to wait for operations against the galaxy server, defaults to 60s.

- --token <API_KEY>, --api-key <API_KEY>

  The Ansible Galaxy API key which can be found at https://galaxy.ansible.com/me/preferences.

- -c, --ignore-certs

  Ignore SSL certificate validation errors.

- -f, --force

  Force overwriting an existing role or collection

- -g, --keep-scm-meta

  Use tar instead of the scm archive option when packaging the role.

- -i, --ignore-errors

  Ignore errors and continue with the next specified role.

- -n, --no-deps

  Don’t download roles listed as dependencies.

- -p, --roles-path

  The path to the directory containing your roles. The default is  the first writable one configured via DEFAULT_ROLES_PATH: {{  ANSIBLE_HOME ~ “/roles:/usr/share/ansible/roles:/etc/ansible/roles” }}

- -r <REQUIREMENTS>, --role-file <REQUIREMENTS>

  A file containing a list of roles to be installed.

- -s <API_SERVER>, --server <API_SERVER>

  The Galaxy API server URL

#### Environment

The following environment variables may be specified.

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – Override the default ansible config file

Many more are available for most options in ansible.cfg

#### Files

`/etc/ansible/ansible.cfg` – Config file, used if present

`~/.ansible.cfg` – User config file, overrides the default config if present

### ansible-inventory

```
ansible-inventory [-h] [--version] [-v] [-i INVENTORY]
                      [--vault-id VAULT_IDS]
                      [--ask-vault-password | --vault-password-file VAULT_PASSWORD_FILES]
                      [--playbook-dir BASEDIR] [-e EXTRA_VARS] [--list]
                      [--host HOST] [--graph] [-y] [--toml] [--vars]
                      [--export] [--output OUTPUT_FILE]
                      [host|group]
```

used to display or dump the configured inventory as Ansible sees it

#### Common Options

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --export

  When doing an –list, represent in a way that is optimized for  export,not as an accurate representation of how Ansible has processed it

- --graph

  create inventory graph, if supplying pattern it must be a valid group name

- --host <HOST>

  Output specific host info, works as inventory script

- --list

  Output all hosts info, works as inventory script

- --list-hosts

  ==SUPPRESS==

- --output <OUTPUT_FILE>

  When doing –list, send the inventory to a file instead of to the screen

- --playbook-dir <BASEDIR>

  Since this tool does not use playbooks, use this as a substitute  playbook directory. This sets the relative path for many features  including roles/ group_vars/ etc.

- --toml

  Use TOML format instead of default JSON, ignored for –graph

- --vars

  Add vars to graph display, ignored unless used with –graph

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

- --version

  show program’s version number, config file location, configured  module search path, module location, executable location and exit

- -e, --extra-vars

  set additional variables as key=value or YAML/JSON, if filename prepend with @

- -h, --help

  show this help message and exit

- -i, --inventory, --inventory-file

  specify inventory host path or comma separated host list. –inventory-file is deprecated

- -l, --limit

  ==SUPPRESS==

- -v, --verbose

  Causes Ansible to print more debug messages. Adding multiple -v  will increase the verbosity, the builtin plugins currently evaluate up  to -vvvvvv. A reasonable level to start is -vvv, connection debugging  might require -vvvv.

- -y, --yaml

  Use YAML format instead of default JSON, ignored for –graph

#### Environment

The following environment variables may be specified.

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – Override the default ansible config file

Many more are available for most options in ansible.cfg

#### Files

`/etc/ansible/ansible.cfg` – Config file, used if present

`~/.ansible.cfg` – User config file, overrides the default config if present

### ansible-playbook

**Runs Ansible playbooks, executing the defined tasks on the targeted hosts.**

```
usage: ansible-playbook [-h] [--version] [-v] [--private-key PRIVATE_KEY_FILE]
                     [-u REMOTE_USER] [-c CONNECTION] [-T TIMEOUT]
                     [--ssh-common-args SSH_COMMON_ARGS]
                     [--sftp-extra-args SFTP_EXTRA_ARGS]
                     [--scp-extra-args SCP_EXTRA_ARGS]
                     [--ssh-extra-args SSH_EXTRA_ARGS]
                     [-k | --connection-password-file CONNECTION_PASSWORD_FILE]
                     [--force-handlers] [--flush-cache] [-b]
                     [--become-method BECOME_METHOD]
                     [--become-user BECOME_USER]
                     [-K | --become-password-file BECOME_PASSWORD_FILE]
                     [-t TAGS] [--skip-tags SKIP_TAGS] [-C]
                     [--syntax-check] [-D] [-i INVENTORY] [--list-hosts]
                     [-l SUBSET] [-e EXTRA_VARS] [--vault-id VAULT_IDS]
                     [--ask-vault-password | --vault-password-file VAULT_PASSWORD_FILES]
                     [-f FORKS] [-M MODULE_PATH] [--list-tasks]
                     [--list-tags] [--step] [--start-at-task START_AT_TASK]
                     playbook [playbook ...]
```

#### Description

the tool to run *Ansible playbooks*, which are a configuration and multinode deployment system. See the project home page (https://docs.ansible.com) for more information.

#### Common Options

- --ask-vault-password, --ask-vault-pass[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-ask-vault-password)

  ask for vault password

- --become-method <BECOME_METHOD>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-become-method)

  privilege escalation method to use (default=sudo), use ansible-doc -t become -l to list valid choices.

- --become-password-file <BECOME_PASSWORD_FILE>, --become-pass-file <BECOME_PASSWORD_FILE>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-become-password-file)

  Become password file

- --become-user <BECOME_USER>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-become-user)

  run operations as this user (default=root)

- --connection-password-file <CONNECTION_PASSWORD_FILE>, --conn-pass-file <CONNECTION_PASSWORD_FILE>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-connection-password-file)

  Connection password file

- --flush-cache[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-flush-cache)

  clear the fact cache for every host in inventory

- --force-handlers[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-force-handlers)

  run handlers even if a task fails

- --list-hosts[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-list-hosts)

  outputs a list of matching hosts; does not execute anything else

- --list-tags[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-list-tags)

  list all available tags

- --list-tasks[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-list-tasks)

  list all tasks that would be executed

- --private-key <PRIVATE_KEY_FILE>, --key-file <PRIVATE_KEY_FILE>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-private-key)

  use this file to authenticate the connection

- --scp-extra-args <SCP_EXTRA_ARGS>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-scp-extra-args)

  specify extra arguments to pass to scp only (e.g. -l)

- --sftp-extra-args <SFTP_EXTRA_ARGS>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-sftp-extra-args)

  specify extra arguments to pass to sftp only (e.g. -f, -l)

- --skip-tags[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-skip-tags)

  only run plays and tasks whose tags do not match these values

- --ssh-common-args <SSH_COMMON_ARGS>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-ssh-common-args)

  specify common arguments to pass to sftp/scp/ssh (e.g. ProxyCommand)

- --ssh-extra-args <SSH_EXTRA_ARGS>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-ssh-extra-args)

  specify extra arguments to pass to ssh only (e.g. -R)

- --start-at-task <START_AT_TASK>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-start-at-task)

  start the playbook at the task matching this name

- --step[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-step)

  one-step-at-a-time: confirm each task before running

- --syntax-check[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-syntax-check)

  perform a syntax check on the playbook, but do not execute it

- --vault-id[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-vault-id)

  the vault identity to use

- --vault-password-file, --vault-pass-file[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-vault-password-file)

  vault password file

- --version[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-version)

  show program’s version number, config file location, configured  module search path, module location, executable location and exit

- -C, --check[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-C)

  don’t make any changes; instead, try to predict some of the changes that may occur

- -D, --diff[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-D)

  when changing (small) files and templates, show the differences in those files; works great with –check

- -K, --ask-become-pass[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-K)

  ask for privilege escalation password

- -M, --module-path[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-M)

  prepend colon-separated path(s) to module library (default={{  ANSIBLE_HOME ~ “/plugins/modules:/usr/share/ansible/plugins/modules” }})

- -T <TIMEOUT>, --timeout <TIMEOUT>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-T)

  override the connection timeout in seconds (default=10)

- -b, --become[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-b)

  run operations with become (does not imply password prompting)

- -c <CONNECTION>, --connection <CONNECTION>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-0)

  connection type to use (default=smart)

- -e, --extra-vars[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-e)

  set additional variables as key=value or YAML/JSON, if filename prepend with @

- -f <FORKS>, --forks <FORKS>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-f)

  specify number of parallel processes to use (default=5)

- -h, --help[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-h)

  show this help message and exit

- -i, --inventory, --inventory-file[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-i)

  specify inventory host path or comma separated host list. –inventory-file is deprecated

- -k, --ask-pass[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-1)

  ask for connection password

- -l <SUBSET>, --limit <SUBSET>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-l)

  further limit selected hosts to an additional pattern

- -t, --tags[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-2)

  only run plays and tasks tagged with these values

- -u <REMOTE_USER>, --user <REMOTE_USER>[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-u)

  connect as this user (default=None)

- -v, --verbose[](https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-v)

  Causes Ansible to print more debug messages. Adding multiple -v  will increase the verbosity, the builtin plugins currently evaluate up  to -vvvvvv. A reasonable level to start is -vvv, connection debugging  might require -vvvv.

#### Environment

The following environment variables may be specified.

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – Override the default ansible config file

Many more are available for most options in ansible.cfg

#### Files

`/etc/ansible/ansible.cfg` – Config file, used if present

`~/.ansible.cfg` – User config file, overrides the default config if present

### ansible-pull

### cutes them for the local host**

```
usage: ansible-pull [-h] [--version] [-v] [--private-key PRIVATE_KEY_FILE]
                 [-u REMOTE_USER] [-c CONNECTION] [-T TIMEOUT]
                 [--ssh-common-args SSH_COMMON_ARGS]
                 [--sftp-extra-args SFTP_EXTRA_ARGS]
                 [--scp-extra-args SCP_EXTRA_ARGS]
                 [--ssh-extra-args SSH_EXTRA_ARGS]
                 [-k | --connection-password-file CONNECTION_PASSWORD_FILE]
                 [--vault-id VAULT_IDS]
                 [--ask-vault-password | --vault-password-file VAULT_PASSWORD_FILES]
                 [-e EXTRA_VARS] [-t TAGS] [--skip-tags SKIP_TAGS]
                 [-i INVENTORY] [--list-hosts] [-l SUBSET] [-M MODULE_PATH]
                 [-K | --become-password-file BECOME_PASSWORD_FILE]
                 [--purge] [-o] [-s SLEEP] [-f] [-d DEST] [-U URL] [--full]
                 [-C CHECKOUT] [--accept-host-key] [-m MODULE_NAME]
                 [--verify-commit] [--clean] [--track-subs] [--check]
                 [--diff]
                 [playbook.yml ...]
```

#### Description

Used to pull a remote copy of ansible on each managed node, each set to run via cron and update playbook source via a source repository. This inverts the default *push* architecture of ansible into a *pull* architecture, which has near-limitless scaling potential.

None of the CLI tools are designed to run concurrently with themselves, you should use an external scheduler and/or locking to ensure there are no clashing operations.

The setup playbook can be tuned to change the cron frequency, logging locations, and parameters to ansible-pull. This is useful both for extreme scale-out as well as periodic remediation. Usage of the ‘fetch’ module to retrieve logs from ansible-pull runs would be an excellent way to gather and analyze remote logs from ansible-pull.

#### Common Options

- --accept-host-key

  adds the hostkey for the repo url if not already added

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --become-password-file <BECOME_PASSWORD_FILE>, --become-pass-file <BECOME_PASSWORD_FILE>[](https://docs.ansible.com/ansible/latest/cli/ansible-pull.html#cmdoption-ansible-pull-become-password-file)

  Become password file

- --check

  don’t make any changes; instead, try to predict some of the changes that may occur

- --clean

  modified files in the working repository will be discarded

- --connection-password-file <CONNECTION_PASSWORD_FILE>, --conn-pass-file <CONNECTION_PASSWORD_FILE>

  Connection password file

- --diff

  when changing (small) files and templates, show the differences in those files; works great with –check

- --full

  Do a full clone, instead of a shallow one.

- --list-hosts

  outputs a list of matching hosts; does not execute anything else

- --private-key <PRIVATE_KEY_FILE>, --key-file <PRIVATE_KEY_FILE>

  use this file to authenticate the connection

- --purge

  purge checkout after playbook run

- --scp-extra-args <SCP_EXTRA_ARGS>

  specify extra arguments to pass to scp only (e.g. -l)

- --sftp-extra-args <SFTP_EXTRA_ARGS>

  specify extra arguments to pass to sftp only (e.g. -f, -l)

- --skip-tags

  only run plays and tasks whose tags do not match these values

- --ssh-common-args <SSH_COMMON_ARGS>

  specify common arguments to pass to sftp/scp/ssh (e.g. ProxyCommand)

- --ssh-extra-args <SSH_EXTRA_ARGS>

  specify extra arguments to pass to ssh only (e.g. -R)

- --track-subs

  submodules will track the latest changes. This is equivalent to specifying the –remote flag to git submodule update

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

- --verify-commit

  verify GPG signature of checked out commit, if it fails abort  running the playbook. This needs the corresponding VCS module to support such an operation

- --version

  show program’s version number, config file location, configured  module search path, module location, executable location and exit

- -C <CHECKOUT>, --checkout <CHECKOUT>

  branch/tag/commit to checkout. Defaults to behavior of repository module.

- -K, --ask-become-pass

  ask for privilege escalation password

- -M, --module-path

  prepend colon-separated path(s) to module library (default={{  ANSIBLE_HOME ~ “/plugins/modules:/usr/share/ansible/plugins/modules” }})

- -T <TIMEOUT>, --timeout <TIMEOUT>

  override the connection timeout in seconds (default=10)

- -U <URL>, --url <URL>

  URL of the playbook repository

- -c <CONNECTION>, --connection <CONNECTION>

  connection type to use (default=smart)

- -d <DEST>, --directory <DEST>

  absolute path of repository checkout directory (relative paths are not supported)

- -e, --extra-vars

  set additional variables as key=value or YAML/JSON, if filename prepend with @

- -f, --force

  run the playbook even if the repository could not be updated

- -h, --help

  show this help message and exit

- -i, --inventory, --inventory-file

  specify inventory host path or comma separated host list. –inventory-file is deprecated

- -k, --ask-pass

  ask for connection password

- -l <SUBSET>, --limit <SUBSET>

  further limit selected hosts to an additional pattern

- -m <MODULE_NAME>, --module-name <MODULE_NAME>

  Repository module name, which ansible will use to check out the  repo. Choices are (‘git’, ‘subversion’, ‘hg’, ‘bzr’). Default is git.

- -o, --only-if-changed

  only run the playbook if the repository has been updated

- -s <SLEEP>, --sleep <SLEEP>

  sleep for random interval (between 0 and n number of seconds) before starting. This is a useful way to disperse git requests

- -t, --tags

  only run plays and tasks tagged with these values

- -u <REMOTE_USER>, --user <REMOTE_USER>

  connect as this user (default=None)

- -v, --verbose

  Causes Ansible to print more debug messages. Adding multiple -v  will increase the verbosity, the builtin plugins currently evaluate up  to -vvvvvv. A reasonable level to start is -vvv, connection debugging  might require -vvvv.

#### Environment

The following environment variables may be specified.

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – Override the default ansible config file

Many more are available for most options in ansible.cfg

#### Files

`/etc/ansible/ansible.cfg` – Config file, used if present

`~/.ansible.cfg` – User config file, overrides the default config if present

### ansible-vault

**encryption/decryption utility for Ansible data files**

```
ansible-vault [-h] [--version] [-v]
                  {create,decrypt,edit,view,encrypt,encrypt_string,rekey}
                  ...
```

can encrypt any structured data file used by Ansible. This can include *group_vars/* or *host_vars/* inventory variables, variables loaded by *include_vars* or *vars_files*, or variable files passed on the ansible-playbook command line with *-e @file.yml* or *-e @file.json*. Role variables and defaults are also included!

Because Ansible tasks, handlers, and other objects are data, these can also be encrypted with vault. If you’d like to not expose what variables you are using, you can keep an individual task file entirely encrypted.

#### Common Options

- --version

  show program’s version number, config file location, configured  module search path, module location, executable location and exit

- -h, --help

  show this help message and exit

- -v, --verbose

  Causes Ansible to print more debug messages. Adding multiple -v  will increase the verbosity, the builtin plugins currently evaluate up  to -vvvvvv. A reasonable level to start is -vvv, connection debugging  might require -vvvv.

##### Actions

###### create

create and open a file in an editor that will be encrypted with the provided vault secret when closed

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --encrypt-vault-id <ENCRYPT_VAULT_ID>

  the vault id used to encrypt (required if more than one vault-id is provided)

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

###### decrypt

decrypt the supplied file using the provided vault secret

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --output <OUTPUT_FILE>

  output file name for encrypt or decrypt; use - for stdout

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

###### edit

open and decrypt an existing vaulted file in an editor, that will be encrypted again when closed

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --encrypt-vault-id <ENCRYPT_VAULT_ID>

  the vault id used to encrypt (required if more than one vault-id is provided)

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

###### view

open, decrypt and view an existing vaulted file using a pager using the supplied vault secret

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

###### encrypt

encrypt the supplied file using the provided vault secret

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --encrypt-vault-id <ENCRYPT_VAULT_ID>

  the vault id used to encrypt (required if more than one vault-id is provided)

- --output <OUTPUT_FILE>

  output file name for encrypt or decrypt; use - for stdout

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

###### encrypt_string

encrypt the supplied string using the provided vault secret

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --encrypt-vault-id <ENCRYPT_VAULT_ID>

  the vault id used to encrypt (required if more than one vault-id is provided)

- --output <OUTPUT_FILE>

  output file name for encrypt or decrypt; use - for stdout

- --show-input

  Do not hide input when prompted for the string to encrypt

- --stdin-name <ENCRYPT_STRING_STDIN_NAME>

  Specify the variable name for stdin

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

- -n, --name

  Specify the variable name

- -p, --prompt

  Prompt for the string to encrypt

###### rekey

re-encrypt a vaulted file with a new secret, the previous secret is required

- --ask-vault-password, --ask-vault-pass

  ask for vault password

- --encrypt-vault-id <ENCRYPT_VAULT_ID>

  the vault id used to encrypt (required if more than one vault-id is provided)

- --new-vault-id <NEW_VAULT_ID>

  the new vault identity to use for rekey

- --new-vault-password-file <NEW_VAULT_PASSWORD_FILE>

  new vault password file for rekey

- --vault-id

  the vault identity to use

- --vault-password-file, --vault-pass-file

  vault password file

#### Environment

The following environment variables may be specified.

[`ANSIBLE_CONFIG`](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_CONFIG) – Override the default ansible config file

Many more are available for most options in ansible.cfg

#### Files

`/etc/ansible/ansible.cfg` – Config file, used if present

`~/.ansible.cfg` – User config file, overrides the default config if present