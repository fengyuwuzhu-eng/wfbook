# 使用 Jenkins

[TOC]

## 最佳实践

持续集成（CI）与自动化测试执行和趋势分析相结合，彻底改变了公司处理构建管理、发布管理、部署自动化和测试编排的方式。

### 自动化作业定义

Jenkins 能够根据它在软件配置管理系统中识别的存储库自动创建、更新和删除作业。利用此功能，以最大限度地利用 Jenkins 的自动作业管理功能提供的优势来构建作业定义，从而优化作业管理。

自动作业管理有多种选择，包括：

- [Use organization folders](https://www.jenkins.io/doc/book/using/best-practices/#use-organization-folders) [使用组织文件夹](https://www.jenkins.io/doc/book/using/best-practices/#use-organization-folders) - 自动创建、更新和删除多分支 Pipeline 文件夹和 Pipeline 作业（首选）
- [Use multibranch Pipelines](https://www.jenkins.io/doc/book/using/best-practices/#use-multibranch-pipelines) [使用多分支管道](https://www.jenkins.io/doc/book/using/best-practices/#use-multibranch-pipelines) - 自动创建、更新和删除 Pipeline 作业
- [Use Pipeline](https://www.jenkins.io/doc/book/using/best-practices/#use-pipeline) - Manually defined Pipeline jobs for more control over the job management process.
  [使用 Pipeline](https://www.jenkins.io/doc/book/using/best-practices/#use-pipeline) - 手动定义的 Pipeline 作业，以更好地控制作业管理过程。

#### 使用组织文件夹

组织文件夹提供了一种在添加或删除存储库和分支时在 Jenkins 中自动创建和删除作业的便捷方法。如果使用的是 GitHub organizations组织、Bitbucket teams团队、GitLab groups组或 Gitea  organizations组织，Jenkins 可以自动检测新存储库的创建并为其生成 Multibranch Pipeline 项目。

#### multibranch Pipelines 使用多分支管道

如果无法使用组织文件夹，则可以选择 multibranch Pipelines 作为替代。但是，请务必注意，组织文件夹比多分支管道更可取，因为它们可以在添加或删除存储库时自动创建和删除多分支项目。

#### 使用 Pipeline

如果组织文件夹不适合您，请考虑使用多分支管道作为替代方法。但是，需要强调的是，组织文件夹是首选文件夹，因为它们能够在添加或删除存储库时自动创建和删除多分支项目。

### 管理您的任务

可以管理和优化 Jenkins 作业定义，以增强用户交互和生产力。

#### 报告构建结果

图表和图形提供了有关项目状态和进度的宝贵见解，展示了趋势和模式。Automated test results including unit tests, integration tests, and end-to-end tests can reveal brittleness or instability. Coverage reports help identify areas where automated tests are not being executed. Compiler warning messages often serve as the first indication of a problem. Static analysis tools are effective in reporting risky code or code with potential security risks. Performance test results help identify delays or areas of concern.
自动化测试结果（包括单元测试、集成测试和端到端测试）可以揭示脆性或不稳定性。覆盖率报告有助于识别未执行自动化测试的区域。编译器警告消息通常作为问题的第一个指示。静态分析工具可以有效地报告有风险的代码或具有潜在安全风险的代码。性能测试结果有助于识别延迟或需要关注的区域。

[Warnings Next Generation](https://plugins.jenkins.io/warnings-ng) 插件提供对许多报告的便捷访问，包括：

- 编译器警告和错误（如 gcc、clang、javac 或 golang）
- 静态分析警告和错误（spotbugs、checkstyle、pmd、lint、cpd 或 Simian）
- 代码覆盖率报告

#### Build on agents 基于代理构建

使用代理执行构建，而不是在控制器上运行构建。利用代理提供增强的安全性和可扩展性。

#### Show failures to the right people 向合适的人展示失败

Configure notifications for failing and unstable jobs, to ensure that the right  people receive them without causing unnecessary distractions for others. Many Jenkins users prefer to be notified only when a failure is likely  their responsibility. This approach acknowledges that if they are not responsible for the  failure, they may not be the most suitable person to investigate it.
为失败和不稳定的工作配置通知，以确保合适的人会收到通知，而不会对其他人造成不必要的干扰。许多 Jenkins 用户更喜欢仅在故障可能是他们的责任时才收到通知。这种方法承认，如果他们不对失败负责，他们可能不是调查失败的最合适人选。

优化您的通知系统，以便在发生新的测试失败时优先通知最近的提交者，因为他们可能是问题的原因。

#### 使用简单的项目名称

Jenkins 利用项目名称来组织相关文件夹。However, it’s important to note that certain tools may encounter issues  with spaces, dollar signs, or similar characters in file paths. To ensure compatibility, it’s recommended to limit project names to  alphanumeric characters (`a-z,A-Z,0-9,_,-,+`). To enhance the appearance of project names, you can utilize the **Display Name** feature. This allows you to customize the presentation, while maintaining the  restricted characters in the underlying project name. To enforce consistent naming conventions across all projects, enable the "Restrict project naming" setting in the system configuration. This ensures that naming restrictions are enforced uniformly.
但是，请务必注意，某些工具可能会遇到文件路径中的空格、美元符号或类似字符的问题。为确保兼容性，建议将项目名称限制为字母数字字符 （`a-z，A-Z，0-9，_,-,+`）。要增强项目名称的外观，您可以使用 **Display Name** 功能。这允许您自定义表示，同时在基础项目名称中保留受限制的字符。要在所有项目中强制实施一致的命名约定，请在系统配置中启用“Restrict project naming”设置。这可确保统一实施命名限制。

#### Fingerprint your dependencies 对依赖项进行指纹识别

When dealing with interdependent projects, it can be challenging to keep  track of which version of one project is used by another. However, Jenkins offers a solution called "file fingerprinting" to  simplify this process.
在处理相互依赖的项目时，跟踪一个项目的哪个版本被另一个项目使用可能具有挑战性。但是，Jenkins 提供了一种称为“文件指纹识别”的解决方案来简化此过程。

#### 不要使用 Maven 作业类型

Jenkins has been providing the [Maven integration plugin](https://plugins.jenkins.io/maven-plugin) for many years, allowing users to create Maven projects using the  "Maven project" selection from the Jenkins "New item" menu. While the Maven job type offers a higher level of integration with Maven builds, it can sometimes introduce unnecessary complexities due to this deep integration.
Jenkins 多年来一直提供 [Maven 集成插件](https://plugins.jenkins.io/maven-plugin)，允许用户使用 Jenkins “New item” 菜单中的 “Maven project” 选项创建 Maven 项目。虽然 Maven 作业类型提供了与 Maven 构建的更高级别的集成，但由于这种深度集成，它有时会引入不必要的复杂性。

Consider using organization folders, multibranch Pipelines, or Pipeline jobs instead of the Maven job type. These alternatives provide more flexibility and simplicity in managing your Jenkins jobs and workflows.
考虑使用组织文件夹、多分支 Pipelines 或 Pipeline 作业，而不是 Maven 作业类型。这些替代方案在管理 Jenkins 作业和工作流方面提供了更大的灵活性和简单性。

The Jenkins project uses organization folders to build [Jenkins core](https://ci.jenkins.io/job/Core/) and [Jenkins plugins](https://ci.jenkins.io/job/Plugins/) on ci.jenkins.io. A Jenkins Pipeline builds Maven projects easily and provides much better control for Maven users.
Jenkins 项目使用组织文件夹在 ci.jenkins.io 上构建 [Jenkins 核心](https://ci.jenkins.io/job/Core/)和 [Jenkins 插件](https://ci.jenkins.io/job/Plugins/)。Jenkins Pipeline 可以轻松构建 Maven 项目，并为 Maven 用户提供更好的控制。

### 管理您的控制器

Jenkins 控制器作为中央资源起着至关重要的作用，需要有效的管理以实现最佳性能。通过遵循这些做法，可以确保控制器为用户提供最佳体验。

#### 保护控制器

Jenkins 安装默认启用安全性，这是保护系统的一个重要方面。虽然从技术上讲可以禁用安全性，但强烈建议**不要**这样做。禁用安全性可能会使您的 Jenkins 控制器容易受到未经授权的访问和潜在的安全漏洞。通过始终启用安全性来维护安全环境非常重要。

#### 定期备份

即使是最可靠的系统也可能会遇到故障。That’s why it’s crucial to be prepared and regularly check the health of your backups.这就是为什么做好准备并定期检查备份的运行状况至关重要的原因。备份是确保数据完整性和可用性的关键组成部分。定期测试备份并验证其完整性和可还原性将有助于减轻任何潜在故障的影响，并确保可以在需要时有效地恢复数据。确定备份运行状况的优先级并执行例行检查对于维护强大且有弹性的系统至关重要。

#### 避免调度超负荷

Schedule your jobs strategically to balance the number of jobs running concurrently. If you’re using timer triggers or periodic polling, consider using the `H` syntax in the cron expression to introduce scheduling jitter. This helps to distribute the start times of jobs more evenly and prevent them from all starting simultaneously. Additionally, take advantage of predefined tokens like `@hourly` to further distribute the starting times of your jobs. These tokens can help create a more balanced schedule and reduce the likelihood of resource contention.
战略性地安排您的作业，以平衡并发运行的作业数量。如果您使用的是计时器触发器或定期轮询，请考虑在 cron 表达式中使用 `H` 语法来引入调度抖动。这有助于更均匀地分配作业的开始时间，并防止它们同时启动。此外，利用预定义的令牌（如 `@hourly`）进一步分配作业的开始时间。这些令牌可以帮助创建更平衡的计划并降低资源争用的可能性。

By implementing these scheduling techniques, you can optimize the  utilization of your resources and ensure a smoother execution of your  jobs.
通过实施这些计划技术，您可以优化资源的利用率并确保更顺利地执行作业。

#### 避免资源冲突

When multiple jobs run simultaneously, there is a possibility of collisions  occurring, especially if they require exclusive access to certain  resources or set-up services. To prevent interference and ensure smooth execution, it is important to  manage resource access effectively. For builds involving databases or networked services, it is crucial to  implement measures that prevent conflicts. The [Lockable Resources plugin](https://plugins.jenkins.io/lockable-resources) offers fine-grained resource-locking capabilities for Jenkins jobs. By using this plugin, you can ensure that only one job has access to a  specific resource at a time, avoiding conflicts and ensuring proper  synchronization. In cases where resource locking with the lockable resources plugin is  not sufficient, you can further control concurrent builds using the [Throttle Concurrent Builds plugin](https://plugins.jenkins.io/throttle-concurrents). This plugin allows you to limit the number of builds that can run  simultaneously, providing additional control and preventing overload on  shared resources.
当多个作业同时运行时，可能会发生冲突，尤其是当它们需要对某些资源或设置服务进行独占访问时。为了防止干扰并确保顺利执行，有效管理资源访问非常重要。对于涉及数据库或网络服务的构建，实施防止冲突的措施至关重要。[Lockable Resources 插件](https://plugins.jenkins.io/lockable-resources)为 Jenkins 作业提供精细的资源锁定功能。通过使用此插件，您可以确保一次只有一个作业可以访问特定资源，从而避免冲突并确保正确同步。如果使用可锁定资源插件进行资源锁定还不够，您可以使用 [Throttle Concurrent Builds 插件](https://plugins.jenkins.io/throttle-concurrents)进一步控制并发构建。此插件允许您限制可以同时运行的构建数量，从而提供额外的控制并防止共享资源过载。

通过利用这些插件，您可以有效地管理资源冲突和并发，确保 Jenkins 作业的顺利可靠执行。

## Working with projects 使用项目

Jenkins 使用项目（也称为 “作业”） 来执行其工作。项目由 Jenkins 用户定义和运行。Jenkins 提供了几种不同类型的项目，包括：

- [Pipeline 管道](https://www.jenkins.io/doc/book/pipeline/)
- [Multibranch Pipeline 多分支管道](https://www.jenkins.io/doc/book/pipeline/multibranch/)
- [组织文件夹](https://www.jenkins.io/doc/book/pipeline/multibranch/#organization-folders)
- Freestyle
- [Multi-configuration (matrix)
  多配置 （matrix）](https://plugins.jenkins.io/matrix-project)
- [Maven](https://plugins.jenkins.io/maven-plugin)
- [外部作业](https://plugins.jenkins.io/external-monitor-job)

### 复制项目

通过单击侧面板上的 “New Item” 链接复制现有项目。在 “Item name” 字段中输入目标项目的名称。将源项目的名称插入到 “Copy from” 字段中。现有项目将被复制到新项目，其名称是在 “Item name” 字段中输入的。

### 重命名项目

通过单击项目页面上的 “Rename” 操作来重命名现有项目。重命名作业时，必须更新按名称引用作业的其他作业以匹配新名称。

### 移动项目

通过单击项目页面上的 “Move” 操作，将现有项目移动到另一个文件夹。移动作业时，必须更新按名称引用作业的其他作业以匹配新名称。

## 使用凭证

有许多第三方站点和应用程序可以与 Jenkins 交互，例如，构件存储库、基于云的存储系统和服务等。

此类应用程序的系统管理员可以在应用程序中配置凭证，以供 Jenkins 专用。This would typically be done to "lock down" areas of the application’s functionality available to Jenkins, usually by applying access controls to these credentials. Once a Jenkins manager (i.e. a Jenkins user who administers a Jenkins site) adds/configures these credentials in Jenkins, the credentials can be used by Pipeline projects to interact with these 3rd party applications.
这样做通常是为了“锁定”Jenkins 可用的应用程序功能区域，通常是通过对这些凭证应用访问控制来实现的。一旦  Jenkins 经理（即管理 Jenkins 站点的 Jenkins 用户）在 Jenkins  中添加/配置这些凭证，管道项目就可以使用这些凭证与这些第三方应用程序进行交互。

**注意：**Jenkins 凭证功能由 [Credentials Binding 插件](https://plugins.jenkins.io/credentials-binding)提供。

Credentials stored in Jenkins can be used:
存储在 Jenkins 中的凭证可用于：

- anywhere applicable throughout Jenkins (i.e. global credentials), 
  在整个 Jenkins 中适用的任何位置（即全局凭证），
- by a specific Pipeline project/item (read more about this in the [Handling credentials](https://www.jenkins.io/doc/book/pipeline/jenkinsfile#handling-credentials) section of [Using a Jenkinsfile](https://www.jenkins.io/doc/book/pipeline/jenkinsfile)),
  通过特定的 Pipeline 项目/项（在[使用 Jenkinsfile](https://www.jenkins.io/doc/book/pipeline/jenkinsfile) 的 [处理凭证](https://www.jenkins.io/doc/book/pipeline/jenkinsfile#handling-credentials) 部分阅读更多相关信息），
- by a specific Jenkins user (as is the case for [Pipeline projects created in Blue Ocean](https://www.jenkins.io/doc/book/blueocean/creating-pipelines)).
  由特定的 Jenkins 用户创建（就像[在 Blue Ocean 中创建的 Pipeline 项目](https://www.jenkins.io/doc/book/blueocean/creating-pipelines)一样）。

Jenkins 可以存储以下类型的凭据：

- **Secret text** - a token such as an API token (e.g. a GitHub personal access token),
  **密钥文本** - 令牌，例如 API 令牌（例如 GitHub 个人访问令牌），
- **Username and password** - which could be handled as separate components or as a colon separated string in the format `username:password` (read more about this in [Handling credentials](https://www.jenkins.io/doc/book/pipeline/jenkinsfile#handling-credentials)),
  **用户名和密码** - 可以作为单独的组件或冒号分隔的字符串以 `username：password` 格式处理（在 [处理凭据](https://www.jenkins.io/doc/book/pipeline/jenkinsfile#handling-credentials) 中阅读更多相关信息），
- **Secret file** - which is essentially secret content in a file,
  **Secret file** - 本质上是文件中的 secret 内容，
- **SSH Username with private key** - an [SSH public/private key pair](http://www.snailbook.com/protocols.html),
  **带私钥的 SSH 用户名** - [SSH 公钥/私钥对](http://www.snailbook.com/protocols.html)，
- **Certificate** - a [PKCS#12 certificate file](https://tools.ietf.org/html/rfc7292) and optional password, or
  **证书** - [PKCS#12 证书文件](https://tools.ietf.org/html/rfc7292)和可选密码，或
- **Docker Host Certificate Authentication** credentials.
  **Docker 主机证书身份验证**凭证。

### 凭证安全性

To maximize security, credentials configured in Jenkins are stored in an encrypted form on the controller Jenkins controller (encrypted by the Jenkins controller ID) and are only handled in Pipeline projects via their credential IDs.
为了最大限度地提高安全性，在 Jenkins 中配置的凭证以加密形式存储在控制器 Jenkins 控制器上（由 Jenkins 控制器 ID 加密），并且仅在流水线项目中通过其凭证 ID 进行处理。

This minimizes the chances of exposing the actual credentials themselves to Jenkins users and hinders the ability to copy functional credentials from one Jenkins controller to another.
这最大限度地减少了向 Jenkins 用户公开实际凭证本身的机会，并阻碍了将功能凭证从一个 Jenkins 控制器复制到另一个 Jenkins 控制器的能力。

### 配置凭证

Credentials can be added to Jenkins by any Jenkins user who has the **Credentials > Create** permission (set through **Matrix-based security**). These permissions can be configured by a Jenkins user with the **Administer** permission. Read more about this in the [Authorization](https://www.jenkins.io/doc/book/managing/security/#authorization) section of [Managing Security](https://www.jenkins.io/doc/book/managing/security).
任何具有 **Credentials > Create** 权限（通过**基于矩阵的安全性**设置）的 Jenkins 用户都可以将凭证添加到 Jenkins。这些权限可由具有 **Administer** 权限的 Jenkins 用户配置。在 [Managing Security](https://www.jenkins.io/doc/book/managing/security) 的 [Authorization](https://www.jenkins.io/doc/book/managing/security/#authorization) 部分中阅读更多相关信息。

Otherwise, any Jenkins user can add and configure credentials if the **Authorization** settings of your Jenkins controller’s **Security** settings page is set to the default **Logged-in users can do anything** setting or **Anyone can do anything** setting.
否则，如果 Jenkins 控制器的 **Security** settings （安全设置） 页面的 **Authorization （授权**） 设置设置为默认的 **Logged-in users can do anything （登录用户可以执行任何操作**） 设置或 **Anyone can do anything （任何人都可以执行任何**操作） 设置，则任何 Jenkins 用户都可以添加和配置凭证。

#### 添加新的全局凭证

To add new global credentials to your Jenkins controller:
要向 Jenkins 控制器添加新的全局凭证：

1. If required, ensure you are logged in to Jenkins (as a user with the **Credentials > Create** permission).
   如果需要，请确保您已登录到 Jenkins（以具有 **Credentials > Create** 权限的用户身份）。

2. From the Jenkins home page (i.e. the Dashboard of the Jenkins classic UI), click **Manage Jenkins > Manage Credentials**.
   在 Jenkins 主页（即 Jenkins 经典 UI 的仪表板）中，单击**管理 Jenkins > 管理凭据**。

   ![image](https://www.jenkins.io/images/using/manage.png)

3. Under **Stores scoped to Jenkins** on the right, click on **Jenkins**.
   在右侧的 **Stores scaled to Jenkins** 下，单击 **Jenkins**。

   ![image](https://www.jenkins.io/images/using/store.png)

4. Under **System**, click the **Global credentials (unrestricted)** link to access this default domain.
   在 **System （系统**） 下，单击 **Global credentials （unrestricted） （全局凭据 （不受限制））** 链接以访问此默认域。

   ![image](https://www.jenkins.io/images/using/system_global_credentials.png)

5. Click **Add Credentials** on the left.
   单击左侧的 **Add Credentials（添加凭证**）。
    **Note:** If there are no credentials in this default domain, you could also click the **add some credentials** link (which is the same as clicking the **Add Credentials** link).
   **注意：**如果此默认域中没有凭证，您还可以单击 **add some credentials** 链接（与单击 **Add Credentials** 链接相同）。

6. From the **Kind** field, choose the [type of credentials](https://www.jenkins.io/doc/book/using/using-credentials/#types-of-credentials) to add.
   从 **Kind （种类**） 字段中，选择要添加[的凭证类型](https://www.jenkins.io/doc/book/using/using-credentials/#types-of-credentials)。

7. From the **Scope** field, choose either:
   从 **Scope** 字段中，选择以下任一选项：

   - **Global** - if the credential/s to be added is/are for a Pipeline project/item. Choosing this option applies the scope of the credential/s to the Pipeline project/item "object" and all its descendant objects.
     **全局** - 如果要添加的凭据是管道项目/项的凭据。选择此选项会将凭据的范围应用于 Pipeline 项目/项“对象”及其所有后代对象。
   - **System** - if the credential/s to be added is/are for the Jenkins controller itself to interact with system administration functions, such as email authentication, agent connection, etc. Choosing this option applies the scope of the credential/s to a single object only.
     **系统** - 如果要添加的凭证是供 Jenkins 控制器本身与系统管理功能交互，例如电子邮件身份验证、代理连接等。选择此选项会将凭证的范围仅应用于单个对象。

8. Add the credentials themselves into the appropriate fields for your chosen credential type:
   将凭证本身添加到所选凭证类型的相应字段中：

   - **Secret text** - copy the secret text and paste it into the **Secret** field.
     **Secret text （密钥文本**） - 复制密钥文本并将其粘贴到 **Secret （密钥**） 字段中。
   - **Username and password** - specify the credential’s **Username** and **Password** in their respective fields.
     **Username and password** - 在各自的字段中指定凭证的 **Username** 和 **Password**。
   - **Secret file** - click the **Choose file** button next to the **File** field to select the secret file to upload to Jenkins.
     **密钥文件** - 单击 **File** 字段旁边的 **Choose file** 按钮，选择要上传到 Jenkins 的密钥文件。
   - **SSH Username with private key** - specify the credentials **Username**, **Private Key** and optional **Passphrase** into their respective fields.
     **带私钥的 SSH 用户名** - 在各自的字段中指定凭据**用户名**、**私钥**和可选**密码**。
      **Note:** Choosing **Enter directly** allows you to copy the private key’s text and paste it into the resulting **Key** text box.
     **注意：**选择 **Enter directly （输入**） 允许您复制私有密钥的文本并将其粘贴到生成的 **Key （密钥**） 文本框中。
   - **Certificate** - specify the **Certificate** and optional **Password**. Choosing **Upload PKCS#12 certificate** allows you to upload the certificate as a file via the resulting **Upload certificate** button.
     **证书** - 指定 **证书** 和可选的 **密码**。选择 **Upload PKCS#12 certificate （上传 PKCS#12 证书**） 允许您通过生成的 **Upload certificate （上传证书**） 按钮将证书作为文件上传。
   - **Docker Host Certificate Authentication** - copy and paste the appropriate details into the **Client Key**, **Client Certificate** and **Server CA Certificate** fields.
     **Docker 主机证书身份验证** - 将相应的详细信息复制并粘贴到 **Client Key**、**Client Certificate** 和 **Server CA Certificate** 字段中。

9. In the **ID** field, specify a meaningful credential ID value - for example, `jenkins-user-for-xyz-artifact-repository`. The inbuilt (default) credentials provider can use uppercase or lowercase letters for the credential ID, as well as any valid separator character, other credential providers may apply further restrictions on allowed characters or lengths. However, for the benefit of all users on your Jenkins controller, it is best to use a single and consistent convention for specifying credential IDs.
   在 **ID** 字段中，指定有意义的凭证 ID 值 — 例如， `jenkins-user-for-xyz-artifact-repository` .内置（默认）凭据提供程序可以使用大写或小写字母作为凭据 ID，以及任何有效的分隔符，其他凭据提供程序可能会对允许的字符或长度应用进一步的限制。但是，为了 Jenkins 控制器上的所有用户的利益，最好使用单一且一致的约定来指定凭证 ID。
    **Note:** This field is optional. If you do not specify its value, Jenkins assigns a globally unique ID (GUID) value for the credential ID. Bear in mind that once a credential ID is set, it can no longer be changed.
   **注意：**此字段为可选字段。如果您未指定其值，Jenkins 会为凭证 ID 分配一个全局唯一 ID （GUID） 值。请记住，一旦设置了凭证 ID，就无法再更改它。

10. Specify an optional **Description** for the credential/s.
    指定凭证的可选 **Description**。

11. Click **OK** to save the credentials.
    单击 **OK** 保存凭据。

## 搜索框

Jenkins 中的每个页面的右上角都有一个搜索框，无需多次单击即可快速到达目的地。

![image](https://www.jenkins.io/doc/book/resources/using/search/box.png)

For example, if you type "foo #53 console", you’ll be taken to the console output page of the "foo" job build #53. If you have "XYZ" view, just type "XYZ" to get to that view. The search box comes with auto-completion to assist you.
例如，如果您键入“foo #53 console”，您将被带到“foo”作业版本 #53 的控制台输出页面。如果您有 “XYZ” 视图，只需键入 “XYZ” 即可访问该视图。搜索框带有自动完成功能来帮助您。

![image](https://www.jenkins.io/doc/book/resources/using/search/dropdown.png)

The search box is also context sensitive. If you are already somewhere in the foo job (perhaps you are looking at  another build), then you can just type "#53 console" instead of "foo #53 console". If you are already somewhere in the foo #53 (maybe you are looking at  test report), then you can just type "console" to get to the same page.
搜索框也与上下文相关。如果您已经在 foo 工作的某个位置（也许您正在查看另一个版本），那么您只需键入 “#53 console” 而不是 “foo #53  console”。如果您已经在 foo #53 中的某个地方（也许您正在查看测试报告），那么您只需键入 “console” 即可进入同一页面。

### 不区分大小写的搜索

If you want the search box to be case insensitive, go to your profile  configuration page (/jenkins/user/<your profile>/configure) and  activate the case insensitive search option.
如果您希望搜索框不区分大小写，请转到您的配置文件配置页面 （/jenkins/user/<your profile>/configure） 并激活不区分大小写的搜索选项。

![image](https://www.jenkins.io/doc/book/resources/using/search/case-sensitivity.png)

Please note that case-insensitive search is not available for anonymous (not logged in) users.
请注意，不区分大小写的搜索不适用于匿名（未登录）用户。

### OpenSearch 支持

This search box feature is also exposed to the browser through [OpenSearch](http://en.wikipedia.org/wiki/OpenSearch), so you can install this search and auto-completion feature to your  browser search box. This would further reduce the overhead it takes for  you to visit a particular page in Jenkins.
此搜索框功能也通过 [OpenSearch](http://en.wikipedia.org/wiki/OpenSearch) 向浏览器公开，因此您可以将此搜索和自动完成功能安装到浏览器搜索框中。这将进一步减少您访问 Jenkins 中的特定页面所需的开销。

For example in Firefox, you can add the Jenkins search to your browser’s  search engines via the dropdown on the right of the address bar:
例如，在 Firefox 中，您可以通过地址栏右侧的下拉菜单将 Jenkins 搜索添加到浏览器的搜索引擎中：

![image](https://www.jenkins.io/doc/book/resources/using/search/add-to-firefox.png)

## Referencing another project by name  按名称引用另一个项目

In many places throughout Jenkins, you can refer to another project/job by name. For example, in a Pipeline Script, you might want to [copy artifacts](https://plugins.jenkins.io/copyartifact/) from another project:
在 Jenkins 的许多地方，你可以按名称引用另一个项目/作业。例如，在 Pipeline Script 中，您可能希望从另一个项目[复制工件](https://plugins.jenkins.io/copyartifact/)：

```
copyArtifacts projectName: 'myproject'
```

That’s all you need to do if your target project’s name is simply  alphanumeric, and is a simple project without subprojects, and has a  unique name throughout your entire Jenkins controller. Read on for more  complex scenarios…
如果你的目标项目的名称只是字母数字，并且是一个没有子项目的简单项目，并且在整个 Jenkins 控制器中具有唯一的名称，那么这就是你需要做的全部工作。请继续阅读，了解更复杂的场景...

### 区分具有相同名称的多个项目

If you’re using the [Folders Plugin](https://plugins.jenkins.io/cloudbees-folder) and you have multiple projects with the same name that are in different folders, you can differentiate between them using a path, similar to a  Unix filesystem path. There are two types of paths:
如果您使用的是 [Folders Plugin](https://plugins.jenkins.io/cloudbees-folder)，并且有多个同名工程位于不同的文件夹中，则可以使用路径来区分它们，类似于 Unix 文件系统路径。有两种类型的路径：

#### 绝对路径

Absolute paths begin with a forward slash, and refer to a project by describing  the complete path to navigate to the project from the home page of your  Jenkins controller. For example, to reference a project in the root of  your Jenkins controller:
绝对路径以正斜杠开头，并通过描述从 Jenkins 控制器的主页导航到项目的完整路径来引用项目。例如，要引用 Jenkins 控制器根目录中的项目：

```
/myproject
```

Or, to reference a project in a subfolder:
或者，要引用子文件夹中的项目：

```
/myfolder/myproject
```

#### 相对路径

Relative paths begin with something other than a forward slash, and refer to  another project in relation to the current project. For example, say you have projects with the following absolute paths:
相对路径以正斜杠以外的内容开头，并引用与当前项目相关的另一个项目。例如，假设您的项目具有以下绝对路径：

```
/thatproject
/folder/someproject
/folder/subfolder/myproject
/folder/subfolder/anotherproject
```

In a Pipeline Script for `/folder/subfolder/myproject`, you could refer to `/folder/subfolder/anotherproject` using this relative path:
在 `/folder/subfolder/myproject` 的管道脚本中，您可以使用以下相对路径进行引用 `/folder/subfolder/anotherproject` ：

```
anotherproject
```

And you could refer to `/folder/someproject` using this relative path, where `..` means to look in the parent folder:
您可以使用此相对路径引用 `/folder/someproject`，其中 `..` 表示在父文件夹中查找：

```
../someproject
```

And you could refer to `/thatproject` using this relative path:
您可以使用此相对路径引用 `/thatproject`：

```
../../thatproject
```

### Referencing components inside projects 引用项目中的组件

Some types of projects — such as Maven projects, Matrix projects, and  Multibranch projects — have subcomponents. You can refer to these  subcomponents as follows:
某些类型的项目（如 Maven 项目、Matrix 项目和 Multibranch 项目）具有子组件。您可以按如下方式引用这些子组件：

#### Maven 项目

You can refer to an entire Maven project:
您可以引用整个 Maven 项目：

```
mymavenproject
```

Or to a group within a Maven project:
或者发送到 Maven 项目中的某个组：

```
mymavenproject/my.group
```

Or to a particular module:
或者到特定模块：

```
mymavenproject/my.group$MyModule
```

#### Matrix projects 矩阵项目

You can refer to all configurations of a Matrix project:
您可以参考 Matrix 项目的所有配置：

```
mymatrixproject
```

Or to a particular configuration, restricted by a axis:
或者到受轴限制的特定配置：

```
mymatrixproject/someaxis=somevalue
```

Or restricted by multiple axes:
或受多个轴限制：

```
mymatrixproject/someaxis=somevalue,anotheraxis=anothervalue
```

#### Multibranch Pipelines 多分支管道

You can refer to a particular branch:
您可以引用特定分支：

```
mymultibranchproject/mybranch
```

### Name encoding 名称编码

Special characters in paths should be URL-encoded. For example, if your Multibranch Pipeline has a branch with a slash in it (`feature/myfeature`), replace the slash with `%2F`:
路径中的特殊字符应进行 URL 编码。例如，如果您的多分支管道有一个带有斜杠的分支 （`feature/myfeature`），请将斜杠替换为 `%2F`：

```
mymultibranchproject/feature%2Fmyfeature
```

### 对于 Jenkins 和 Jenkins 插件的开发人员

See the [`Jenkins::getItem()`](https://javadoc.jenkins.io/jenkins/model/Jenkins.html#getItem-java.lang.String-hudson.model.ItemGroup-) function.
请参阅 [`Jenkins：：getItem（）`](https://javadoc.jenkins.io/jenkins/model/Jenkins.html#getItem-java.lang.String-hudson.model.ItemGroup-) 函数。

## 中止构建

When you click that [x] icon from the UI, the following things happen:
当您从 UI 中单击该 [x] 图标时，将发生以下情况：

1. Browser sends a request to the server.
   浏览器向服务器发送请求。
2. The server interrupts (via Thread.interrupt()) the thread (AKA executor thread) that is responsible for carrying out a build.
   服务器中断（通过 Thread.interrupt（））负责执行构建的线程（也称为执行线程）。
3. The server returns 服务器返回

At this point, your browser is back, but the actual abort process happens from here asynchronously.
此时，您的浏览器已返回，但实际的 abort 过程从这里异步进行。

1. The thread gets the interrupt signal. How quickly this happens depends on what the executor is doing at the time of the interruption. Specifically, an executor thread can only be interrupted in "interruption points" due to the Java design.
   线程收到中断信号。这种情况发生的速度取决于执行程序在中断时正在做什么。具体来说，由于 Java 设计，执行程序线程只能在 “中断点” 中断。
   - Waiting for a completion of a child process (for example, maybe the build is running Ant) is an interruption point. That means if the executor was doing that, it gets interrupted instantaneously.
     等待子进程完成（例如，可能构建正在运行 Ant）是一个中断点。这意味着如果执行程序正在执行此操作，它会立即中断。
   - Waiting for a computation on an agent is an interruption point.
     等待代理上的计算是一个中断点。
   - Waiting for file or network I/O is not an interruption point. This often causes the problem where a build appears to be un-abortable. For example, checking out a Subversion repository falls in this category.
     等待文件或网络 I/O 不是中断点。这通常会导致构建似乎不可中止的问题。例如，签出 Subversion 版本库就属于这一类。
   - Normal computation is also not an interruption point.
     正常计算也不是中断点。
2. The executor performs a clean up operation. This depends on what it was doing by the time it noticed the interruption.
   执行程序执行清理操作。这取决于它在注意到中断时正在做什么。
   - If it was waiting for a completion of a child process, Jenkins will search for all the descendant processes and kill them all. On Unix, this is done through `java.lang.UnixProcess.destroyProcess`, which sends [SIGTERM](http://en.wikipedia.org/wiki/SIGTERM) on Unix-based JDK implementations. On Windows, this is done through [TerminateProcess](http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx) API.
     如果它正在等待子进程完成，Jenkins 将搜索所有后代进程并杀死它们。在 Unix 上，这是通过 `java.lang.UnixProcess.destroyProcess` 完成的，它在基于 Unix 的 JDK 实现上发送 [SIGTERM](http://en.wikipedia.org/wiki/SIGTERM)。在 Windows 上，这是通过 [TerminateProcess](http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx) API 完成的。
   - If it was waiting for a completion of some computation in an agent, the thread that’s performing the remote computation is interrupted asynchronously. How quickly that threads gets interrupted depends on what that thread is doing. See above.
     如果它正在等待代理中的某些计算完成，则执行远程计算的线程将异步中断。该线程中断的速度取决于该线程正在执行的操作。见上文。
3. Executor starts unwinding the stack, and eventually it finishes the unwinding. At this point, the build is marked as aborted and executor returns to the idle status.
   Executor 开始展开堆栈，并最终完成展开。此时，构建被标记为 aborted，并且 executor 返回到 idle 状态。

Pipeline jobs can be stopped by sending an HTTP POST request to URL endpoints of a build.
可以通过向生成的 URL 终端节点发送 HTTP POST 请求来停止管道作业。

- `BUILD ID URL/stop` - aborts a Pipeline.
  `BUILD ID URL/stop` - 中止管道。
- `BUILD ID URL/term` - forcibly terminates a build (should only be used if `stop` does not work).
  `BUILD ID URL/term` - 强制终止构建（仅当 `stop` 不起作用时才应使用）。
- `BUILD ID URL/kill` - hard kill a pipeline. This is the most destructive way to stop a pipeline and should only be used as a last resort.
  `BUILD ID URL/kill` - 硬终止管道。这是阻止管道的最具破坏性的方法，只能作为最后的手段使用。

### 如果您的构建未中止

Check the thread dump `http://yourserver/jenkins/threadDump` and look for the executor thread in question — they are named after the agent and executor number. That’ll normally tell you where the thread is, and often reveals why it’s not responding to an interruption.
检查线程转储 `http://yourserver/jenkins/threadDump` 并查找有问题的执行程序线程 — 它们以代理和执行程序编号命名。这通常会告诉您线程的位置，并且通常会揭示它为什么不响应中断。

## Fingerprints 指纹

### Tracking file usage across Jenkins jobs using fingerprints 使用指纹跟踪 Jenkins 作业中的文件使用情况

When you have interdependent projects on Jenkins, it often becomes hard to keep track of which version of a file is used by which version of a dependency on that file. Jenkins supports **file fingerprinting** to track dependencies.
当您在 Jenkins 上有相互依赖的项目时，通常很难跟踪该文件的依赖项的哪个版本使用哪个版本的文件。Jenkins 支持**文件指纹识别**来跟踪依赖关系。

For example, suppose you have a TOP project that depends on a MIDDLE project, which in turn depends on a BOTTOM project. You are working on the BOTTOM project. The TOP team reported that the `bottom.jar` that they are using causes an NPE, which you (a member of the BOTTOM team) thought you fixed in BOTTOM #32. Jenkins can tell you which MIDDLE builds and TOP builds are using (or not using) your `bottom.jar` #32.
例如，假设您有一个 TOP 项目，该项目依赖于 MIDDLE 项目，而 MIDDLE 项目又依赖于 BOTTOM 项目。您正在处理 BOTTOM 项目。TOP 团队报告说，他们正在使用的 `bottom.jar` 会导致 NPE，您（BOTTOM 团队的成员）认为您在 BOTTOM #32 中修复了这个问题。Jenkins 可以告诉你哪些 MIDDLE 构建和 TOP 构建正在使用（或不使用）你的 `bottom.jar` #32。

### How do I set it up? 我该如何设置？

To make this work, all the relevant projects need to be configured to **Record fingerprints** of the jar files (in the above case, `bottom.jar`).
要实现此工作，需要将所有相关项目配置为 **Record fingerprints** of the jar files（在上述情况下为 `bottom.jar`）。

For example, if you just want to track which BOTTOM builds are used by which TOP builds, configure TOP and BOTTOM to record the fingerprint of `bottom.jar`. If you also want to know which MIDDLE builds are using which `bottom.jar`, also configure MIDDLE.
例如，如果您只想跟踪哪些 TOP 构建使用了哪些 BOTTOM 构建，请配置 TOP 和 BOTTOM 以记录 `bottom.jar` 的指纹。如果您还想知道哪些 MIDDLE 版本正在使用哪些`bottom.jar`，请同时配置 MIDDLE。

Since recording fingerprints is a cheap operation, the simplest thing to do is just blindly record all fingerprints of the followings:
由于记录指纹是一项廉价的操作，因此最简单的做法就是盲目记录以下所有指纹：

1. jar files that your project produce
   项目生成的 jar 文件
2. jar files that your project rely on
   项目所依赖的 jar 文件

The disk usage is affected more by the number of files fingerprinted, as opposed to the size of files or the number of builds they are used. So unless you have a plenty of disk space, you don’t want to fingerprint `**/*`.
磁盘使用情况受指纹识别的文件数量的影响更大，而不是文件大小或使用的构建数量。因此，除非您有足够的磁盘空间，否则您不想对 `**/*` 进行指纹识别。

#### Configure a job to Record Fingerprint(s) of a file or set of files 配置作业以记录文件或文件集的指纹

Go to your project, click **Configure** in the left navigation bar, then scroll down to the **Post-build Actions** section of the job
转到您的项目，单击左侧导航栏中的 **Configure**，然后向下滚动到作业的 **Post-build Actions** 部分

Click on the button to add a **Post-build** action.
单击该按钮以添加 **Post-build** 操作。

Select **Record fingerprints of files to track usage**.
选择 **Record fingerprints of files （记录文件的指纹） 以跟踪使用情况**。

The post-build action configuration fields provide you with a pattern option to match the files you want to fingerprint as well as a couple check-box selections to do your file fingerprinting.
构建后操作配置字段为您提供了一个模式选项，用于匹配要进行指纹识别的文件，并提供了几个复选框选择，用于执行文件指纹识别。

Maven job type does this automatically for its dependencies and artifacts.
Maven 作业类型会自动为其依赖项和工件执行此操作。

### How does it work? 它是如何工作的？

The fingerprint of a file is simply an MD5 checksum. Jenkins maintains a database of MD5 checksums, and for each MD5 checksum, Jenkins records which builds of which projects used it. This database is updated every time a build runs and files are fingerprinted.
文件的指纹只是一个 MD5 校验和。Jenkins 维护一个 MD5 校验和数据库，对于每个 MD5 校验和，Jenkins 会记录哪些项目的哪些构建使用了它。每次运行构建时，此数据库都会更新，并对文件进行指纹识别。

To avoid excessive disk usage, Jenkins does not store the actual file. Instead, it just stores MD5 checksums and their usages. These files can be seen in
为避免过多的磁盘使用，Jenkins 不存储实际文件。相反，它只存储 MD5 校验和及其用法。这些文件可以在

**$JENKINS_HOME/fingerprints
$JENKINS_HOME/指纹**

Plugins can store additional information in these records. For example, [Deployment Notification Plugin](https://plugins.jenkins.io/deployment-notification/) tracks files deployed on servers via chef/puppet through fingerprints.
插件可以在这些记录中存储其他信息。例如，[Deployment Notification Plugin](https://plugins.jenkins.io/deployment-notification/) 通过指纹跟踪通过 chef/puppet 部署在服务器上的文件。

### How can I use it? 我该如何使用它？

Here are a few typical scenarios that benefit from this feature:
以下是受益于此功能的一些典型场景：

You develop the BOTTOM project and you want to know who is using BOTTOM #13 in which builds
您开发了 BOTTOM 项目，并且想知道谁在哪些构建中使用 BOTTOM #13

1. Go to BOTTOM #13 build page.
   转到 BOTTOM #13 构建页面。
2. Click the "fingerprint" icon of `bottom.jar` in the build artifacts
   单击构建工件中 `bottom.jar` 的 “fingerprint” 图标
3. You’ll see all the projects and builds that use it.
   您将看到使用它的所有项目和构建。

You develop the TOP project and you want to know which build of `bottom.jar` and `middle.jar` you are using in TOP #10.
您开发了 TOP 项目，并且想知道您在 TOP #10 中使用的`bottom.jar`和`middle.jar`的哪个版本。

1. Go to TOP #10 build page.
   转到 TOP #10 构建页面。
2. Click "see fingerprints" 点击“查看指纹”
3. You’ll see all the files fingerprinted in TOP #10, along with where they came from.
   您将看到 TOP #10 中的所有指纹文件，以及它们的来源。

You have the TOP project that builds a jar. You also have the TOP-TEST project that runs after the TOP project and does extensive integration tests on the latest TOP bits. You want to know the test results of TOP #7.
您有构建 jar 的 TOP 项目。您还有 TOP-TEST 项目，该项目在 TOP 项目之后运行，并对最新的 TOP 位进行广泛的集成测试。您想知道 TOP #7 的测试结果。

1. Go to TOP #7 build page.
   转到 TOP #7 构建页面。
2. Click the "fingerprint" icon of `top.jar` in the build artifacts
   单击构建工件中 `top.jar`的 “fingerprint” 图标
3. You’ll see all the TOP-TEST builds that used it.
   您将看到使用它的所有 TOP-TEST 版本。
4. Click it and you’ll be taken to the appropriate TOP-TEST build page, which will show you test reports.
   单击它，您将被带到相应的 TOP-TEST 构建页面，该页面将向您显示测试报告。
5. If there’s no TOP-TEST builds displayed, then that means TOP-TEST build didn’t run against TOP #7. Maybe it skipped TOP #7 (this can happen if there are a lot of TOP builds in a short period of time), or maybe a new TOP-TEST build is in progress.
   如果未显示 TOP-TEST 版本，则意味着 TOP-TEST 版本未针对 TOP #7 运行。也许它跳过了 TOP #7（如果在短时间内有很多 TOP 版本，可能会发生这种情况），或者新的 TOP-TEST 版本正在进行中。

## 使用当地语言

Jenkins 根据浏览器的语言显示文本。它会检测您的互联网浏览器的语言。

请注意，根据浏览器和语言，可能需要下载插件。

还可以使用 [Locale 插件](https://plugins.jenkins.io/locale) 更改系统语言（在执行构建时使用）以及所有用户的用户界面语言。

 ![](../../Image/j/jenkins-in-italian.png)

## 更改时区

If your Jenkins controller is running in a different location than your  own (for example: the server is in NY but you are in LA), then the NY  time zone will most probably be used. This may be quite annoying if you need to compare build dates.
如果您的 Jenkins 控制器在与您自己的位置不同的位置运行（例如：服务器在纽约，但您在洛杉矶），则很可能使用纽约时区。如果您需要比较构建日期，这可能会很烦人。

要查看当前设置的时区，请转到 `jenkins_server/systemInfo` 并查看 `user.timezone` 系统属性。

 ![](../../Image/j/jenkins-server-timezone.png)

可能希望更改显示的时区以匹配自己的时区。通过转到用户配置页面，可以设置 `User Defined Time Zone` 以匹配自己的时区。

 ![](../../Image/c/change-time-zone.png)

## 远程访问 API

Jenkins provides machine-consumable remote access API to its functionalities. Currently it comes in three flavors:
Jenkins 为其功能提供机器消耗品远程访问 API。目前它有三种风格：

1. XML XML 格式
2. JSON with JSONP support 支持 JSONP 的 JSON
3. Python 蟒

Remote access API is offered in a REST-like style. That is, there is no single entry point for all features, and instead they are available under the `".../api/"` URL where `"..."` portion is the data that it acts on.
远程访问 API 以类似 REST 的样式提供。也就是说，所有功能都没有单一的入口点，而是在 `“.../api/”` URL 下可用，其中 `“...”` 部分是它所作用于的数据。

For example, if your Jenkins installation sits at https://ci.jenkins.io, visiting https://ci.jenkins.io/api/ will show just the top-level API features available – primarily a listing of the configured jobs for this Jenkins controller.
例如，如果您的 Jenkins 安装位于 https://ci.jenkins.io，则访问 https://ci.jenkins.io/api/ 将仅显示可用的顶级 API 功能 – 主要是为此 Jenkins 控制器配置的作业列表。
 Or if you want to access information about a particular build, e.g. https://ci.jenkins.io/job/Websites/job/jenkins.io/job/master/lastSuccessfulBuild/ , then go to https://ci.jenkins.io/job/Websites/job/jenkins.io/job/master/lastSuccessfulBuild/api/ and you’ll see the list of functionalities for that build.
或者，如果您想访问有关特定构建的信息，例如 https://ci.jenkins.io/job/Websites/job/jenkins.io/job/master/lastSuccessfulBuild/ ，然后转到 https://ci.jenkins.io/job/Websites/job/jenkins.io/job/master/lastSuccessfulBuild/api/ ，您将看到该版本的功能列表。

### What can you do with it? 您可以用它做什么？

Remote API can be used to do things like these:
远程 API 可用于执行如下操作：

1. retrieve information from Jenkins for programmatic consumption.
   从 Jenkins 检索信息以供编程使用。
2. trigger a new build 触发新生成
3. create/copy jobs 创建/复制作业

### Submitting jobs 提交作业

**Jobs without parameters 没有参数的作业**

You merely need to perform an HTTP POST on `JENKINS_URL/job/JOBNAME/build`.
您只需在 `JENKINS_URL/job/JOBNAME/build` 上执行 HTTP POST。

This also works for Multibranch Pipelines and Organization Folders. It would trigger a scan.
这也适用于 Multibranch Pipelines 和 Organization Folders。它将触发扫描。

**Jobs with parameters 带参数的作业**

Simple example - sending "String Parameters":
简单示例 - 发送 “String Parameters”：

```
curl JENKINS_URL/job/JOB_NAME/buildWithParameters \
  --user USER:TOKEN \
  --data id=123 --data verbosity=high
```

Another example - sending a "File Parameter":
另一个例子 - 发送一个 “File Parameter”：

```
curl JENKINS_URL/job/JOB_NAME/buildWithParameters \
  --user USER:PASSWORD \
  --form FILE_LOCATION_AS_SET_IN_JENKINS=@PATH_TO_FILE
```

The symbol '@' is important in this example. Also, the path to the file is absolute path. In order to make this command work, you need to configure your Jenkins job to take a file parameter and match the **File location** field in the Jenkins job configuration with the key in the `--form` option.
在此示例中，符号 '@' 很重要。此外，文件的路径是绝对路径。为了使此命令正常工作，您需要将 Jenkins 作业配置为采用 file 参数，并将 Jenkins 作业配置中的 **File location** 字段与 `--form` 选项中的键匹配。

### Remote API and security 远程 API 和安全性

When your Jenkins is secured, you can use HTTP BASIC authentication to authenticate remote API requests. See [Authenticating scripted clients](https://www.jenkins.io/doc/book/system-administration/authenticating-scripted-clients/) for more details.
当您的 Jenkins 受到保护时，您可以使用 HTTP BASIC 身份验证来验证远程 API 请求。有关更多详细信息，请参阅[验证脚本化客户端](https://www.jenkins.io/doc/book/system-administration/authenticating-scripted-clients/)。

### CSRF Protection CSRF 保护

**Note**: API tokens are preferred instead of crumbs for CSRF protection.
**注意**：为了保护 CSRF，首选 API 令牌而不是 crumb。

### XPath selection XPath 选择

The XML API supports a selection by XPath by using the query parameter 'xpath'. This is convenient for extracting information in environments where XML manipulation is tedious (such as shell script.) See [issue #626](https://issues.jenkins.io/browse/JENKINS-626) for an example of how to use this.
XML API 支持使用查询参数 'xpath' 按 XPath 进行选择。 这便于在环境中提取信息 其中 XML 操作很乏味（例如 shell 脚本）。 有关如何使用它的示例，请参阅 [issue #626](https://issues.jenkins.io/browse/JENKINS-626) 。
 See `.../api/` on your Jenkins server for more up-to-date details.
有关更多最新详细信息，请参阅 Jenkins 服务器上的 `.../api/`。

#### XPath exclusion XPath 排除项

Similar to the 'xpath' query parameter above, you can use (possibly multiple) 'exclude' query patterns to exclude nodes from the resulting XML. All the nodes that match the specified XPath will be removed from the XML.
与上面的 'xpath' 查询参数类似，您可以使用 （可能 multiple） 'exclude' 查询模式，以从生成的 XML 中排除节点。 将从 XML 中删除与指定 XPath 匹配的所有节点。
 See `.../api/` on your Jenkins server for more up-to-date details.
有关更多最新详细信息，请参阅 Jenkins 服务器上的 `.../api/`。

### Depth control 深度控制

Sometimes the remote API doesn’t give you enough information in one call. For example, if you’d like to find the last successful build of a given view, you’d realize that the invocation to the remote API of the view won’t give you this, and you’d have to recursively call the remote API of each project. Depth control solves this problem. Depth control is fundamentally connected to the Jenkins data model.
有时，远程 API 无法在一次调用中为您提供足够的信息。例如，如果您想查找给定视图的最后一个成功构建，您会意识到对视图的远程 API  的调用不会为您提供此结果，您必须递归调用每个项目的远程 API。深度控制解决了这个问题。深度控制从根本上与 Jenkins 数据模型有关。

The data model that Jenkins maintains internally can be thought of as a big tree structure, and when you make a remote API call, you are getting a small subtree of it. The subtree is rooted at the object for which you made a remote API call, and the sub-tree is cut beyond certain depth to avoid returning too much data. You can adjust this cut-off behavior by specifying the depth query parameter. When you specify a positive depthvalue, the subtree cut-off happens that much later.
Jenkins 内部维护的数据模型可以看作是一个大树结构，当你进行远程 API 调用时，你会得到一个小的子树。子树以您为其进行远程 API  调用的对象为根，并且子树被剪切到一定深度之外，以避免返回过多数据。您可以通过指定 depth 查询参数来调整此截止行为。当您指定正  depthvalue 时，子树截断发生的时间会晚得多。

So the net result is, if you specify a bigger depth value, you’ll see that the remote API will now return more data. Because of the algorithm, this works in such a way that the data returned by a bigger depth value includes all the data returned by smaller depth value.
因此，最终结果是，如果您指定更大的深度值，您将看到远程 API 现在将返回更多数据。由于算法的原因，其工作方式是，较大的深度值返回的数据包括较小深度值返回的所有数据。

See `.../api/` on your Jenkins server for more up-to-date details.
有关更多最新详细信息，请参阅 Jenkins 服务器上的 `.../api/`。

### Python API wrappers Python API 包装器

[JenkinsAPI](https://pypi.python.org/pypi/jenkinsapi), [Python-Jenkins](https://pypi.python.org/pypi/python-jenkins/), [api4jenkins](https://pypi.org/project/api4jenkins/), [aiojenkins](https://pypi.org/project/aiojenkins/) are object-oriented python wrappers for the Python REST API which aim to provide a more conventionally pythonic way of controlling a Jenkins server. It provides a higher-level API containing a number of convenience functions. Services offered currently include:
[JenkinsAPI](https://pypi.python.org/pypi/jenkinsapi)、[Python-Jenkins](https://pypi.python.org/pypi/python-jenkins/)、[api4jenkins](https://pypi.org/project/api4jenkins/)、[aiojenkins](https://pypi.org/project/aiojenkins/) 是 Python REST API 的面向对象的 python 包装器，旨在提供更传统的 python 方式来控制 Jenkins 服务器。它提供了一个更高级别的 API，其中包含许多便利函数。目前提供的服务包括：

- Query the test-results of a completed build
  查询已完成构建的测试结果
- Get objects representing the latest builds of a job
  获取表示作业最新版本的对象
- Search for artifacts by simple criteria
  按简单标准搜索对象
- Block until jobs are complete
  阻止直到作业完成
- Install artifacts to custom-specified directory structures
  将构件安装到自定义指定的目录结构
- Authentication support for Jenkins controllers
  Jenkins 控制器的身份验证支持
- Ability to search for builds by subversion revision
  能够按 subversion 修订版搜索构建
- Ability to add/remove/query Jenkins agents
  能够添加/删除/查询 Jenkins 代理

### Ruby API wrappers Ruby API 包装器

[Jenkins API Client](https://rubygems.org/gems/jenkins_api_client) is an object oriented ruby wrapper project that consumes Jenkins’s JSON API and aims at providing access to all remote API Jenkins provides. It is available as a Rubygem and can be useful to interact with the Job, Node, View, BuildQueue, and System related functionalities. Services currently offered include:
[Jenkins API 客户端](https://rubygems.org/gems/jenkins_api_client)是一个面向对象的 ruby 包装器项目，它使用 Jenkins 的 JSON API，旨在提供对 Jenkins 提供的所有远程 API 的访问。它以  Rubygem 的形式提供，可用于与 Job、Node、View、BuildQueue 和 System 相关功能进行交互。目前提供的服务包括：

- Creating jobs by sending xml file or by specifying params as options with more customization options including source control, notifications, etc.
  通过发送 xml 文件或将 params 指定为具有更多自定义选项（包括源代码控制、通知等）的选项来创建作业。
- Building jobs (with params), stopping builds, querying details of recent builds, obtaining build params, etc.
  构建作业（带参数）、停止构建、查询最近构建的详细信息、获取构建参数等。
- Listing jobs available in Jenkins with job name filter, job status filter.
  使用作业名称筛选器、作业状态筛选器列出 Jenkins 中可用的作业。
- Adding/removing downstream projects.
  添加/删除下游项目。
- Chaining jobs i.e given a list of projects each project is added as a downstream project to the previous one.
  链接作业，即给定一个项目列表，每个项目都作为下游项目添加到前一个项目。
- Obtaining progressive console output.
  获取渐进式控制台输出。
- Username/password based authentication.
  基于用户名/密码的身份验证。
- Command Line Interface with a lot of options provided in the libraries.
  命令行界面，库中提供了许多选项。
- Creating, listing views. 创建、列出视图。
- Adding jobs to views and removing jobs from views.
  向视图添加作业和从视图中删除作业。
- Adding/removing Jenkins agents, querying details of agents.
  添加/删除 Jenkins Agent，查询 Agent 的详细信息。
- Obtaining the tasks in build queue, and their age, cause, reason, ETA, ID, params and much more.
  获取构建队列中的任务，以及它们的年龄、原因、原因、ETA、ID、参数等等。
- Quiet down, cancel quiet down, safe restart, force restart, and wait till Jenkins becomes available after a restart.
  静默、取消静默、安全重启、强制重启，并等待 Jenkins 在重启后变为可用。
- Ability to list installed/available plugins, obtain information about plugins, install/uninstall plugins and much more with plugins.
  能够列出已安装/可用的插件、获取有关插件的信息、安装/卸载插件等等。

The project source code is at [here](https://github.com/arangamani/jenkins_api_client).
项目源代码位于[此处](https://github.com/arangamani/jenkins_api_client)。

### Java API wrappers Java API 包装器

The [jenkins-rest](https://github.com/cdancy/jenkins-rest) library is an object oriented Java project that provides access to the Jenkins REST API programmatically to some remote API Jenkins provides. It is built using the [jclouds toolkit](https://jclouds.apache.org/) and can easily be extended to support more REST endpoints. Its feature set evolves and users are invited to contribute new endpoints via pull-requests. In its current state it is possible with this library to submit a job, track its progress through the queue, and monitor its execution until its completion, and obtain the build status. Services currently offered include:
[jenkins-rest](https://github.com/cdancy/jenkins-rest) 库是一个面向对象的 Java 项目，它以编程方式提供对 Jenkins REST API 的访问，以及 Jenkins 提供的一些远程 API。它是使用 [jclouds 工具包](https://jclouds.apache.org/)构建的，可以轻松扩展以支持更多 REST 端点。它的功能集不断发展，并邀请用户通过拉取请求贡献新的终端节点。在当前状态下，此库可以提交作业，在队列中跟踪其进度，监视其执行情况直到完成，并获取构建状态。目前提供的服务包括：

- Endpoint definition (property or environment variable)
  端点定义（属性或环境变量）
- Authentication (basic and API token via property or environment variable)
  身份验证（通过属性或环境变量的基本令牌和 API 令牌）
- Crumbs Issuer support (auto-detect crumbs)
  Crumbs Issuer 支持（自动检测 Crumbs）
- Folder support 文件夹支持
- Jobs API (build, buildInfo, buildWithParameters, config, create, delete, description, disable, enable, jobInfo, lastBuildNumber, lastBuildTimestamp and progressiveText)
  作业  API（build、buildInfo、buildWithParameters、config、create、delete、description、disable、enable、jobInfo、lastBuildNumber、lastBuildTimestamp 和 progressiveText）
- Plugin manager API (installNecessaryPlugins, list current plugins)
  插件管理器 API （installNecessaryPlugins， 列出当前插件）
- Queue API (cancel, list queue items, query queue item)
  队列 API（取消、列出队列项、查询队列项）
- Statistics API (overall load)
  统计 API（总负载）
- Systems API (systemInfo) 系统 API （systemInfo）

The project can evolve rapidly, this list is accurate only as of the date of writing.
该项目可以迅速发展，此列表仅在撰写之日准确无误。

### 检测 Jenkins 版本

To check the version of Jenkins, load the top page or any `.../api/*` page and check for the `X-Jenkins` response header. This contains the version number of Jenkins, like "1.404" This is also a good way to check if an URL is a Jenkins URL.
要检查 Jenkins 的版本，请加载首页或任何 `.../api/*` 页面，并检查 `X-Jenkins` 响应标头。这包含 Jenkins 的版本号，比如 “1.404” 这也是检查 URL 是否是 Jenkins URL 的好方法。

## Executor Starvation 执行者饥饿

If you see a little black clock icon in the build queue as shown below, it is an indication that your job is sitting in the queue unnecessarily.
如果您在构建队列中看到一个黑色的小时钟图标，如下所示，则表示您的作业不必要地位于队列中。

![image](https://www.jenkins.io/images/using/starvation.png)

The tool tip of the job name link next to the clock icon should tell you exactly why it is not building, but the common symptoms are as follows:
时钟图标旁边的作业名称链接的工具提示应该会告诉您它未构建的确切原因，但常见症状如下：

1. **Agents are offline**: your build needs to run on a particular agent, but the agent is offline. Go to http://server/jenkins/computer/AGENTNAME to understand why, and bring it back online. Or better yet, use labels and do not tie builds to specific agents, so that a single offline agents will not prevent your builds from starving.
   **代理处于脱机**状态：您的构建需要在特定代理上运行，但代理处于脱机状态。转到 http://server/jenkins/computer/AGENTNAME  了解原因，然后将其重新联机。或者更好的是，使用标签，不要将构建绑定到特定代理，这样单个离线代理就不会阻止您的构建不足。
2. **Waiting for an available executor on an agent**: your build needs to run on a particular agent, but the agent is already fully busy building other things, and your build is waiting for "too long" compared to the time it takes to execute it — in other words, it does not make sense to wait for 5 minutes when the build itself finishes in 2 minutes. Use labels so that builds can run on any machine that satisfies the system requirements, and in this way you can add more agents to improve the turn-around time.
   **等待代理上的可用执行程序**：您的构建需要在特定代理上运行，但代理已经完全忙于构建其他内容，并且与执行它所需的时间相比，您的构建等待“太长”——换句话说，当构建本身在 2 分钟内完成时，等待 5 分钟是没有意义的。使用标签，以便构建可以在满足系统要求的任何计算机上运行，这样您就可以添加更多代理以缩短周转时间。
3. **Waiting for an available executor on a label**: all the agents that have the given label are fully busy doing other things. It is time to add more agents.
   **Waiting for a available executor on a label**：所有具有给定标签的代理都忙于做其他事情。是时候添加更多代理了。

## 使用 Jenkins 代理

Jenkins 架构专为分布式构建环境而设计。它允许我们为每个构建项目使用不同的环境，从而在并行运行作业的多个代理之间平衡工作负载。

Jenkins 控制器是 Jenkins 安装中的原始节点。Jenkins 控制器管理 Jenkins 代理并编排其工作，包括在代理上安排作业和监控代理。代理可以使用本地或云计算机连接到 Jenkins 控制器。

代理需要安装 Java 并与 Jenkins 控制器建立网络连接。

Jenkins 代理可以在物理机、虚拟机、Kubernetes 集群中启动，也可以使用 Docker 镜像启动。

### 使用 Docker 配置代理

#### 环境

需要一台具有以下特点的计算机：

- 安装 Java
- 安装 Jenkins
- 安装 Docker
- SSH 密钥对

#### 生成 SSH 密钥对

要生成 SSH 密钥对，必须在有权访问的计算机上执行名为 `ssh-keygen` 的命令行工具。它可能是：

- 运行 Jenkins 控制器的计算机
- 主机（如果使用容器）
- 运行代理的计算机
- 甚至是开发人员计算机

The SSH key pair generation can be done on any operating system: SSH 密钥对的生成可以在任何操作系统上完成：   On Windows, you can use any OpenSSH installation such as [Windows OpenSSH](https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse), the `ssh-keygen` that is included with [git for Windows](https://gitforwindows.org/), or [Cygwin](https://cygwin.com/) 在 Windows 上，您可以使用任何 OpenSSH 安装，例如 [Windows OpenSSH](https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse)、[Git for Windows](https://gitforwindows.org/) 附带的 `ssh-keygen` 或 [Cygwin](https://cygwin.com/)  On Unix (Linux, macOS, BSD, etc.) you can use any OpenSSH installation packaged with your system as well 在 Unix（Linux、macOS、BSD 等）上，您也可以使用与系统打包的任何 OpenSSH 安装<br />Note that you will have to be able to copy the key value to your  controller and agent afterwards, so check that you can copy a file  content into the clipboard beforehand.  请注意，之后您必须能够将密钥值复制到控制器和代理，因此请检查是否可以事先将文件内容复制到剪贴板中。

1. In a terminal window run the command: `ssh-keygen -f ~/.ssh/jenkins_agent_key`
   在终端窗口中，运行以下命令： `ssh-keygen -f ~/.ssh/jenkins_agent_key` 

2. Provide a passphrase to use with the key (it can be empty)
   提供用于密钥的密码（可以为空）

3. Confirm the output looks something like this:
   确认输出如下所示：

   ```
   ubuntu@desktop:~$ ssh-keygen -f ~/.ssh/jenkins_agent_key
   Generating public/private rsa key pair.
   Enter passphrase (empty for no passphrase):
   Enter same passphrase again:
   Your identification has been saved in /home/ubuntu/.ssh/jenkins_agent_key
   Your public key has been saved in /home/ubuntu/.ssh/jenkins_agent_key.pub
   The key fingerprint is:
   SHA256:XqxxjqsLlvDD0ZHm9Y2iR7zC6IbsUlMEHo3ffy8TzGs
   The key's randomart image is:
   +---[RSA 3072]----+
   |  o+             |
   | ...o  .         |
   |  .o .+ .        |
   |    o+.+ o o     |
   |  ... o.So* .    |
   |  o+ = +.X=      |
   | o oO + *..+     |
   |. oo.o o .E .    |
   | o... oo.. o     |
   +----[SHA256]-----+
   ```

##### Create a Jenkins SSH credential 创建 Jenkins SSH 凭证

1. Go to your Jenkins dashboard;
   转到 Jenkins 仪表板;

2. Go to `Manage Jenkins` option in main menu and click on the `Manage Credentials` button;
   转到主菜单中的 `Manage Jenkins` 选项，然后单击 `Manage Credentials` 按钮;

   ![credentials menu](https://www.jenkins.io/doc/book/resources/node/credentials-1.png)

3. select the drop option `Add Credentials` from the global item;
   从全局项目中选择拖放选项 `Add Credentials`;

   ![add credentials option](https://www.jenkins.io/doc/book/resources/node/credentials-2.png)

4. Fill in the form: 填写表格：

   - Kind:  SSH Username with private key;
     Kind： 带私钥的 SSH 用户名;
   - id: jenkins ID：詹金斯
   - description: The jenkins ssh key
     description：jenkins ssh 密钥
   - username: jenkins 用户名：Jenkins
   - Private Key: select `Enter directly` and press the Add button to insert the content of your private key file at `~/.ssh/jenkins_agent_key`
     私钥：直接选择 `Enter`，然后按 Add 按钮，将私钥文件的内容插入 `~/.ssh/jenkins_agent_key`
   - Passphrase: fill your passphrase used to generate the SSH key pair (leave empty if  you didn’t use one at the previous step) and then press the `Create` button 
     Passphrase：填写用于生成 SSH 密钥对的密码（如果您在上一步中没有使用，请留空），然后按 `Create` 按钮![credentials filled form](https://www.jenkins.io/doc/book/resources/node/credentials-3.png)

#### 创建 Docker 代理

##### 在 Linux 上

Here we will use the [docker-ssh-agent image](https://github.com/jenkinsci/docker-ssh-agent) to create the agent containers.
在这里，我们将使用 [docker-ssh-agent 镜像](https://github.com/jenkinsci/docker-ssh-agent)来创建代理容器。

1. run the command to start your first agent:
   运行命令以启动您的第一个代理：

   ```
   docker run -d --rm --name=agent1 -p 22:22 \
   -e "JENKINS_AGENT_SSH_PUBKEY=[your-public-key]" \
   jenkins/ssh-agent:alpine-jdk17
   ```

1. |      | Remember to replace the tag [your-public-key] for your own SSH **public** key. 请记住将标签 [your-public-key] 替换为您自己的 SSH **公钥**。  Your public key value in this example could be found by issuing : `cat ~/.ssh/jenkins_agent_key.pub` on the machine your created it. Do not add the square brackets `[]` around the key value 在此示例中的公钥值可以通过在您创建它的计算机上发出 ： `cat ~/.ssh/jenkins_agent_key.pub` 来找到。不要在键值周围添加方括号 `[]`  The value of [your-public-key] MUST include the full contents of your .pub file, including the `ssh-XXXX` prefix. [your-public-key] 的值必须包含 .pub 文件的完整内容，包括 `ssh-XXXX` 前缀。  Ex: `ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAQQCo9+BpMRYQ/dL3DS2CyJxRF+j6ctbT3/Qp84+KeFhnii7NT7fELilKUSnxS30WAvQCCo2yU1orfgqr41mM70MB` 前任： `ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAQQCo9+BpMRYQ/dL3DS2CyJxRF+j6ctbT3/Qp84+KeFhnii7NT7fELilKUSnxS30WAvQCCo2yU1orfgqr41mM70MB`     If your machine already has a ssh server running on the `22` port (if you logged onto this machine thanks to the `ssh` command, that’s the case), you should use another port for the `docker` command, such as `-p 4444:22` 如果您的机器已经在 `22` 端口上运行了 ssh 服务器（如果您通过 `ssh` 命令登录到这台机器，则会出现这种情况），您应该为 `docker` 命令使用另一个端口，例如 `-p 4444：22` |
   | ---- | ------------------------------------------------------------ |
   |      |                                                              |

2. Now the container `agent1` is running.
   现在，容器 `agent1` 正在运行。
    Hint: the command `docker ps` can be used to check if the container is running as expected.
   提示：命令 `docker ps` 可用于检查容器是否按预期运行。

##### On Windows 在 Windows 上

Here we will use the [docker-ssh-agent image](https://github.com/jenkinsci/docker-ssh-agent) to create the agent containers.
在这里，我们将使用 [docker-ssh-agent 镜像](https://github.com/jenkinsci/docker-ssh-agent)来创建代理容器。

1. run the command to start your first agent:
   运行命令以启动您的第一个代理：

   ```
   docker run -d --rm --name=agent1 --network jenkins -p 22:22 `
     -e "JENKINS_AGENT_SSH_PUBKEY=[your-public-key]" `
     jenkins/ssh-agent:jdk17
   ```

1. |      | Remember to replace the tag [your-public-key] for your own SSH **public** key. 请记住将标签 [your-public-key] 替换为您自己的 SSH **公钥**。  Your public key in this example is: `Get-Content $Env:USERPROFILE\.ssh\jenkins_agent_key.pub` 在此示例中，您的公钥为： `Get-Content $Env:USERPROFILE\.ssh\jenkins_agent_key.pub` |
   | ---- | ------------------------------------------------------------ |
   |      |                                                              |

2. Now the container `agent1` is running.
   现在，容器 `agent1` 正在运行。
    Hint: the command `docker ps` can be used to check if the container is running as expected. Additionally, the command `docker container inspect agent1 | Select-String -Pattern '"IPAddress": "\d+\.\d+\.\d+\.\d+"'` can be used to see the **Host** to be set in Jenkins for the agent.
   提示：命令 `docker ps` 可用于检查容器是否按预期运行。此外，该命令 `docker container inspect agent1 | Select-String -Pattern '"IPAddress": "\d+\.\d+\.\d+\.\d+"'` 还可用于查看要在 Jenkins 中为代理设置的 **Host**。

#### 在 jenkins 上设置 agent1

1. Go to your Jenkins dashboard;
   转到 Jenkins 仪表板;

2. Go to `Manage Jenkins` option in main menu;
   转到主菜单中的 `Manage Jenkins` 选项;

3. Go to `Manage Nodes and clouds` item;
   转到 `Manage Nodes and clouds （管理节点和云）` 项;

   ![Manage node menu](https://www.jenkins.io/doc/book/resources/node/node-1.png)

4. Go to `New Node` option in side menu;
   前往侧面菜单中的`“新建节点`”选项;

5. Fill the Node/agent name and select the type; (e.g. Name: agent1, Type: Permanent Agent)
   填写 Node/agent name 并选择类型;（例如：姓名：agent1，类型：永久代理人）

6. Now fill the fields: 现在填写字段：

   - Remote root directory; (e.g.: /home/jenkins )
     远程根目录;（例如： /home/jenkins ）
   - label; (e.g.: agent1 ) 标签;（例如：agent1 ）
   - usage; (e.g.: only build jobs with label expression…)
     用法;（例如：仅使用标签表达式构建作业...
   - Launch method; (e.g.: Launch agents by SSH )
     Launch 方法;（例如：通过 SSH 启动代理 ）
     - Host; (e.g.: localhost or your IP address )
       主机;（例如：localhost 或您的 IP 地址）
     - Credentials; (e.g.: jenkins )
       凭据;（例如： Jenkins ）
     - Host Key verification Strategy; (e.g.: Manually trusted key verification … ) 
       Host Key 验证策略;（例：手动信任密钥验证...![node create form](https://www.jenkins.io/doc/book/resources/node/node-2.png)

7. Press the `Save` button and the agent1 will be registered, but offline for the time being. Click on it.
   按下 `Save` 按钮，agent1 将被注册，但暂时处于离线状态。点击它。

   ![node offline](https://www.jenkins.io/doc/book/resources/node/node-3.png)

8. You should now see `This node is being launched.`. If that’s not the case, you can now press the `Relaunch agent` button and wait a few seconds. You can now click on the `Log` button on the left, then you should receive
   您现在应该看到 `This node is being launched.`.如果不是这种情况，您现在可以按 `Relaunch agent （重新启动代理`） 按钮并等待几秒钟。您现在可以单击左侧的 `Log` 按钮，然后您应该会收到
    the message: `Agent successfully connected and online` on the last log line.
   消息： `Agent successfully connected and online` on the last log 行。

   ![Agent successfully connected](https://www.jenkins.io/doc/book/resources/node/node-4.png)

If your Jenkins controller does not start the agent via ssh, please check the port you [configured](https://www.jenkins.io/doc/book/using/using-agents/#ssh-anchor) on your agent. Copy it, and then click on the `Advanced…` button. You will then be able to paste the port number into the `Port` textfield.
如果您的 Jenkins 控制器没有通过 ssh 启动代理，请检查您在代理上[配置的](https://www.jenkins.io/doc/book/using/using-agents/#ssh-anchor)端口。复制它，然后单击 `Advanced...（高级...`）按钮。然后，您将能够将端口号粘贴到 `Port` 文本字段中。

#### 将第一个作业委派给 agent1

1. Go to your jenkins dashboard;
   转到您的 jenkins 仪表板;

2. Select `New Item` on side menu;
   选择 `新建项目` 在侧面菜单上;

3. Enter a name. (e.g.: First Job to Agent1)
   输入名称。（例如：First Job to agent1）

4. Select the `Freestyle project` and press OK;
   选择 `Freestyle 项目`，然后按 OK;

5. Check the option: `Restrict where this project can be run`;
   选中选项： `Restrict where this project can be run` ;

6. Fill the field: label with the agent1 label; (e.g.: agent1)
   使用 agent1 标签填写字段：label;（例如：agent1）

   ![Agent job 1](https://www.jenkins.io/doc/book/resources/node/node-5.png)

   |      | Be careful with white spaces before or after the label. 请注意标签前后的空白处。 |
   | ---- | ------------------------------------------------------------ |
   |      |                                                              |

7. Now Select the option `Execute shell` at Build Section;
   现在选择 `Execute shell` at Build Section 选项;

   ![Agent job 2](https://www.jenkins.io/doc/book/resources/node/node-6.png)

8. Add the command: `echo $NODE_NAME` in the `Command` field of the `Execute shell` step  and the name
   在 Execute shell 步骤的 `Command` 字段中添加命令 `echo $NODE_NAME`，并在 `Execute shell` 步骤中添加名称
    of the agent will be printed inside the log when this job is run;
   当此作业运行时，代理将打印在日志中;

9. press the save button and then select the option `Build Now`;
   按 保存 按钮，然后选择选项 `立即构建`;

10. Wait some seconds and then go to `Console Output` page
    等待几秒钟，然后转到 `Console Output` 页面

    ![Agent job 3](https://www.jenkins.io/doc/book/resources/node/node-7.png)

11. you should receive output similar to:
    您应该会收到类似于以下内容的输出：

    ```
    Started by user Admin User
    Running as SYSTEM
    Building remotely on agent1 in workspace /home/jenkins/workspace/First Job to Agent1
    [First Job to Agent1] $ /bin/sh -xe /tmp/jenkins15623311211559049312.sh
    + echo $NODE_NAME
    agent1
    Finished: SUCCESS
    ```

### 重新启动 Jenkins 代理

## 将 JMeter 与 Jenkins 结合使用

There are several advantages to using JMeter and Jenkins together. Continuous integration and test automation have become standards in the  DevOps world, but the performance levels and system complexity are  constantly increasing.
结合使用 JMeter 和 Jenkins 有几个优点。持续集成和测试自动化已成为 DevOps 领域的标准，但性能水平和系统复杂性不断增加。

With Jenkins, you can integrate all JMeter tests in your pipeline process,  and better understand the details of your applications.
借助 Jenkins，您可以将所有 JMeter 测试集成到管道流程中，并更好地了解应用程序的详细信息。

Some of the main benefits of using JMeter with Jenkins are:
将 JMeter 与 Jenkins 结合使用的一些主要好处是：

- Unattended test execution for each system.
  每个系统的无人值守测试执行。
- Build failure logs and recovery steps.
  构建失败日志和恢复步骤。
- Secure and easy access to test reports of each build.
  安全、轻松地访问每个版本的测试报告。
- Automation of routine work.
  日常工作的自动化。

|      | This page outlines how to use Apache JMeter with Jenkins. The instructions are intentionally performed by running Apache JMeter on the Jenkins controller. Apache JMeter in a Jenkins production environment should be run on a Jenkins agent, not on the Jenkins controller. To learn more about Jenkins agents, refer to the [using Jenkins agents](https://www.jenkins.io/doc/book/using/using-agents/) page.  本页概述了如何将 Apache JMeter 与 Jenkins 结合使用。这些指令是通过在 Jenkins 控制器上运行 Apache JMeter  来有意执行的。Jenkins 生产环境中的 Apache JMeter 应在 Jenkins 代理上运行，而不是在 Jenkins  控制器上运行。要了解有关 Jenkins 代理的更多信息，请参阅[使用 Jenkins 代理](https://www.jenkins.io/doc/book/using/using-agents/)页面。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

### Apache JMeter

[Apache JMeter](https://jmeter.apache.org/) may be used to test the performance of static sites, dynamic sites, and complete web applications. It can also be used to simulate a heavy load on a server, group of  servers, network, or object, allowing for strength testing or overall  performance analyzation under different load types.
[Apache JMeter](https://jmeter.apache.org/) 可用于测试静态站点、动态站点和完整 Web 应用程序的性能。它还可用于模拟服务器、服务器组、网络或对象上的重负载，从而允许在不同负载类型下进行强度测试或整体性能分析。

### Jenkins 安装

The Jenkins docs has a page to help with the [Jenkins installation process.](https://www.jenkins.io/doc/book/installing/). This guide uses the .jar installation. Refer to the [guided tour page](https://www.jenkins.io/doc/pipeline/tour/getting-started/) if you want to use .jar as well. Both installation methods produce the same results.
Jenkins 文档有一个页面可以帮助完成 [Jenkins 安装过程.](https://www.jenkins.io/doc/book/installing/).本指南使用 .jar 安装。如果您还想使用 .jar，请参阅[指导教程页面](https://www.jenkins.io/doc/pipeline/tour/getting-started/)。两种安装方法产生的结果相同。

### 安装 Performance 插件

To integrate JMeter with Jenkins, we will use the [Performance plugin](https://plugins.jenkins.io/performance).
要将 JMeter 与 Jenkins 集成，我们将使用 [Performance 插件](https://plugins.jenkins.io/performance)。

Follow these steps to install it:
请按照以下步骤进行安装：

1. From your Jenkins dashboard page, go to: **Manage Jenkins**.
   在 Jenkins 控制面板页面中，转到：**管理 Jenkins**。

2. Go to the **Plugins** page.
   转到 Plugins （**插件）** 页面。

3. Select **Available**, and enter 'performance' in the search field.
   选择 **Available**，然后在搜索字段中输入 'performance'。

4. Mark the installation checkbox, and select **Install without restart**.
   选中安装复选框，然后选择 **Install without restart（安装不重新启动**）。

   ![Available plugins filtered for performance.](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-00.png)

If everything is successful, you will receive this confirmation screen:
如果一切顺利，您将收到以下确认屏幕：

![Install success confirmation page.](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-01.png)

### JMeter 安装

要安装 JMeter，请执行以下步骤：

1. Refer to the [Apache JMeter download page](https://jmeter.apache.org/download_jmeter.cgi).
   请参阅 [Apache JMeter 下载页面](https://jmeter.apache.org/download_jmeter.cgi)。

2. Select your download option based on your system: .zip for Windows or .tgz for Linux. This tutorial is done on Linux, so the .tgz option is displayed.
   根据您的系统选择下载选项：.zip （Windows 版）或 .tgz （Linux 版）。本教程在 Linux 上完成，因此会显示 .tgz 选项。

3. Extract the downloaded file in your preferred location, for example `/usr/jmeter`.
   将下载的文件提取到您的首选位置，例如 `/usr/jmeter`。

4. Edit the file: `<YOUR-JMETER-PATH>>/bin/user.properties`. For example, usr/jmeter/bin is the file path used here.
   编辑文件： `<YOUR-JMETER-PATH>>/bin/user.properties` 。例如，usr/jmeter/bin 是此处使用的文件路径。

5. Add this command to the last line of the file: `jmeter.save.saveservice.output_format=xml`. Save and close the file to ensure the changes are made.
   将此命令添加到文件的最后一行： `jmeter.save.saveservice.output_format=xml` 。保存并关闭文件以确保进行更改。

   ![user.properties command](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-03.png)

This command integrates the output from JMeter into Jenkins. Now let’s create our JMeter test plan.
此命令将 JMeter 的输出集成到 Jenkins 中。现在，让我们创建 JMeter 测试计划。

#### 第一个使用 GUI 的 JMeter 测试计划

JMeter uses test plans to organize each test. Once configured, Jenkins calls all test plans defined in a pipeline, and then shows the results in the build reports. This means all test plans must be configured on JMeter first. After this is complete, enter the info in Jenkins so it knows which tests needs to call.
JMeter 使用测试计划来组织每个测试。配置完成后，Jenkins 会调用管道中定义的所有测试计划，然后在构建报告中显示结果。这意味着必须首先在 JMeter 上配置所有测试计划。完成此操作后，在 Jenkins 中输入信息，以便它知道需要调用哪些测试。

Follow these steps to create a test plan:
按照以下步骤创建测试计划：

1. Run the file: `<YOUR-JMETER-PATH>>/bin/jmeter.sh` to open the JMeter GUI. For example, /usr/jmeter/bin/jmeter.sh would be used in this example. In a definitive installation, you can set these commands to your path system or system variables.
   运行 file： `<YOUR-JMETER-PATH>>/bin/jmeter.sh` 打开 JMeter GUI。例如，在此示例中将使用 /usr/jmeter/bin/jmeter.sh。在最终安装中，您可以将这些命令设置为路径系统或系统变量。

   |      | For Windows users the file will be `jmeter.bat`.  对于 Windows 用户，文件将被`jmeter.bat`。 |
   | ---- | ------------------------------------------------------------ |
   |      |                                                              |

2. From the JMeter GUI, go to **File**, and then select **New**.
   在 JMeter GUI 中，转到 **File （文件**），然后选择 **New （新建**）。

3. Enter a name for your test plan.
   输入测试计划的名称。

4. On the left side of the screen, using the right or secondary select with your mouse, select your test plan. Follow this path: **Add > Thread(Users) > Thread Group**, and select it.
   在屏幕左侧，使用鼠标的右侧或辅助选择，选择您的测试计划。按照以下路径操作：**添加 > 线程（用户） > 线程组**，然后选择它。

   ![Adding a Thread Group to the test plan.](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-04.png)

5. In Thread Group, increase the **Number of Threads (users)** to five and the **Loop Count** to two.
   在 Thread Group （线程组） 中，将 **Number of Threads （users） （线程 （用户）** 数） 增加到 5，将 **Loop Count （循环计数**） 增加到 2。

6. On the left side of the screen, right or secondary select **Thread Group** with your mouse, then follow this path: **Add > Sampler > HTTP Request**, and select the HTTP Request option.
   在屏幕左侧，使用鼠标右侧或辅助选择 **Thread Group（线程组**），然后按照以下路径操作：**Add > Sampler > HTTP Request（添加 > Sampler > HTTP Request**），然后选择 HTTP Request（HTTP 请求）选项。

   ![Thread Group](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-05.png)

7. In HTTP Request, enter the **Name** of your test, the **Server Name or IP**, and the **Path** context. For example, here we would use `Installing`, `www.jenkins.io`, and `/doc/book/installing/`.
   在 HTTP Request 中，输入 **Name** of your test， **Server Name 或 IP**以及 **Path** 上下文。例如，这里我们将使用 `Installing`、`www.jenkins.io` 和 `/doc/book/installing/`。

   ![HTTP Request sample](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-06.png)

8. Repeat steps six and seven two more times to different context/pages. For example, we will use www.jenkins.io/node. Now our plan has three things to test.
   对不同的上下文/页面再重复步骤 6 和 7 两次。例如，我们将使用 www.jenkins.io/node。现在我们的计划有三件事需要测试。

9. To add a visual report, right or secondary select your Thread Group, then follow the path: **Add > Listener > View results in table**. Select the **View Results in Table** option.
   要添加可视化报告，请右键单击或辅助选择您的线程组，然后按照路径操作：**添加 > 侦听器 > 在表中查看结果**。选择 **View Results in Table** 选项。

   ![Save and run test plan](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-07.png)

10. To save the test plan, select the Save (disk) icon in the upper left side of the screen or go to **File > Save**, and enter a name for the test plan with a .jmx extension. For example: `jenkins.io.jml`.
    要保存测试计划，请选择屏幕左上角的 Save （disk） 图标，或转到 **File > Save**，然后输入扩展名为 .jmx 的测试计划的名称。例如：`jenkins.io.jml`。

Run the test and view the table results.
运行测试并查看表结果。

![test results](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-08.png)

#### 使用终端命令的第一个 JMeter 测试计划

Our test is working well in the graphical user interface, but to integrate  it with Jenkins, it needs to be run from the command line.
我们的测试在图形用户界面中运行良好，但要将其与 Jenkins 集成，需要从命令行运行。

To run the test plan using the command line, follow these steps:
要使用命令行运行测试计划，请执行以下步骤：

1. From the terminal, run the following command:
   在终端中，运行以下命令：

   ```
   set OUT=jmeter.save.saveservice.output_format
   set JMX=/usr/jmeter/bin/jenkins.io.jmx
   set JTL=/usr/jmeter/reports/jenkins.io.report.jtl
   /usr/jmeter/bin/jmeter -j %OUT%=xml -n -t %JMX% -l %JTL%
   ```

1. If everything works properly, the report file is created at the indicated location by the `-l` parameter.
   如果一切正常，则通过 `-l` 参数在指定位置创建报告文件。

   ![Jmeter command line test results.](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-09.png)

### Jenkins 和 JMeter 一起运行

After running Jmeter from the command line, we now have everything needed to execute JMeter from Jenkins.
从命令行运行 Jmeter 后，我们现在拥有从 Jenkins 执行 JMeter 所需的一切。

To execute Jmeter from Jenkins, follow these steps:
要从 Jenkins 执行 Jmeter，请执行以下步骤：

1. From the Jenkins dashboard, select **New Item**.
   在 Jenkins 控制面板中，选择 **New Item （新建项目**）。

2. Enter the item name, for example `JmeterTest`, select freestyle project, and then select **OK**.
   输入项名称，例如 `JmeterTest`，选择 freestyle project，然后选择 **OK。**

3. Go to the **Build Environment** tab, select **Add build step**, and select the option **Execute Windows batch command**.
   转到 **Build Environment** 选项卡，选择 **Add build step**，然后选择选项 **Execute Windows batch command**。

4. Enter the same code we used to run JMeter in the previous section:
   输入我们在上一节中运行 JMeter 时使用的相同代码：

   ![Jenkins JMeter build step](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-10.png)

5. Go to the **Post-build Action** tab and select **Add post-build action**, then select **Publish Performance test result report**.
   转到 **Post-build Action** 选项卡，选择 **Add post-build action**，然后选择 **Publish Performance test result report**。

   |      | This option comes from the performance plugin. If it is not available, check the previous section and make sure you have installed the plugin.  此选项来自 performance 插件。如果它不可用，请检查上一节并确保您已安装该插件。 |
   | ---- | ------------------------------------------------------------ |
   |      |                                                              |

6. Fill in the source for these reports:
   填写这些报告的来源：

   ![Source of reports](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-11.png)

7. Save the project, and then select **Build Now** from the JmeterTest page.
   保存项目，然后从 JmeterTest 页面中选择 **Build Now**。

8. After the job finishes, navigate to the **Console Output** view the execution details.
   作业完成后，导航到 **Console Output （控制台输出**） 视图执行详细信息。

   ![Execution Details](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-12.png)

9. From the **Console Output** view, you can access the **Performance Report**, and can view the JMeter report data.
   从 **Console Output （控制台输出**） 视图中，您可以访问 **Performance Report （性能报告**），并查看 JMeter 报告数据。

   ![Report Execution Details](https://www.jenkins.io/doc/book/resources/jmeter/jmeter-13.png)

You now have JMeter running within Jenkins, and can use the data provided.
现在，您已在 Jenkins 中运行 JMeter，并且可以使用提供的数据。

## Pluggable Storage 可插拔存储

The current default approach of storing everything into the filesystem is  the main reason why Jenkins does not fit the "Cloud Native" model, with  features like high availability, zero downtime, or pay per use. While there are plenty of plugins that implement parts of this vision,  this becomes cumbersome to configure and a usability nightmare for  users, as [JEP-300](https://github.com/jenkinsci/jep/blob/master/jep/300/README.adoc) has pointed out. Going towards a model where cloud services are consumed where it makes  sense, the overall complexity on operating Jenkins in a cloud or  containerized environment is greatly reduced. Other related projects would greatly benefit from cloud native storage  for Jenkins.
当前将所有内容存储到文件系统中的默认方法是 Jenkins 不适合“云原生”模型的主要原因，该模型具有高可用性、零停机时间或按使用付费等功能。虽然有很多插件实现了这一愿景的一部分，但正如 [JEP-300](https://github.com/jenkinsci/jep/blob/master/jep/300/README.adoc) 所指出的那样，这变得很麻烦，并且是用户可用性的噩梦。转向在有意义的地方使用云服务的模型，在云或容器化环境中操作 Jenkins 的整体复杂性大大降低。其他相关项目将从 Jenkins 的云原生存储中受益匪浅。

There are several clear areas open for improvement. A major pain point is the usage of local disk as all-purpose storage,  which causes issues running on containerized or distributed  environments, requiring highly performant filesystems, and all the  configuration pain like initial sizing and resizing with downtime. We believe that by using cloud provided services the overall usability,  performance and scalability can be improved while enabling new demanded  functionality.
有几个明显的改进领域有待改进。一个主要痛点是将本地磁盘用作通用存储，这会导致在容器化或分布式环境中运行的问题，需要高性能的文件系统，以及所有配置痛点，例如初始大小调整和停机调整大小。我们相信，通过使用云服务，可以提高整体可用性、性能和可扩展性，同时实现新的需求功能。

You can find more information about Pluggable Storage and priorities in [this blogpost](https://www.jenkins.io/blog/2018/07/30/introducing-cloud-native-sig/).
您可以在[此博客文章](https://www.jenkins.io/blog/2018/07/30/introducing-cloud-native-sig/)中找到有关可插拔存储和优先级的更多信息。

### 状态摘要

Below you can find a summary of ongoing activities and their current status:
您可以在下面找到正在进行的活动及其当前状态的摘要：

| Type / Status 类型 / 状态                                    | Comment 评论                                                 | Implementation(s) 实现                                       |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **Artifacts 工件**   **(Available) （可用）**                | Fully delivered, with support for uploading artifacts directly from agents.  Related JEPs: [JEP-202](https://github.com/jenkinsci/jep/blob/master/jep/202/README.adoc). 完全交付，支持直接从代理上传构件。相关 JEP：[JEP-202](https://github.com/jenkinsci/jep/blob/master/jep/202/README.adoc)。  [Extension point 扩展点](https://www.jenkins.io/doc/developer/extensions/jenkins-core/#artifactmanagerfactory) | [Artifact Manager on S3](https://plugins.jenkins.io/artifact-manager-s3),  [Azure Artifact Manager](https://plugins.jenkins.io/azure-artifact-manager),  [](https://www.jenkins.io/doc/developer/extensions/jenkins-core/#artifactmanagerfactory) [S3 上的项目管理器](https://plugins.jenkins.io/artifact-manager-s3)、[Azure 项目管理器](https://plugins.jenkins.io/azure-artifact-manager)、[< 更多实现>](https://www.jenkins.io/doc/developer/extensions/jenkins-core/#artifactmanagerfactory) |
| **Credentials 凭据**   **(Available) （可用）**              | Completed before the JEP process was introduced. 在引入 JEP 流程之前完成。 [Extension point 扩展点](https://www.jenkins.io/doc/developer/extensions/credentials/#credentialsprovider) | [Kubernetes Credentials Provider](https://plugins.jenkins.io/kubernetes-credentials-provider),  [AWS Secrets Manager Credentials Provider](https://plugins.jenkins.io/aws-secrets-manager-credentials-provider),  [](https://www.jenkins.io/doc/developer/extensions/credentials/#credentialsprovider) [Kubernetes 凭证提供程序](https://plugins.jenkins.io/kubernetes-credentials-provider)、[AWS Secrets Manager 凭证提供程序](https://plugins.jenkins.io/aws-secrets-manager-credentials-provider)、[< 更多实现>](https://www.jenkins.io/doc/developer/extensions/credentials/#credentialsprovider) |
| Build logs 构建日志   (Preview / Paused) （预览 / 暂停）     | Pipeline Log Storage API and reference implementations are available for preview, only Jenkins Pipeline job types are supported.  Related JEP: [JEP-210](https://github.com/jenkinsci/jep/blob/master/jep/210/README.adoc). Pipeline Log Storage API 和参考实现可供预览，仅支持 Jenkins Pipeline 作业类型。相关 JEP：[JEP-210](https://github.com/jenkinsci/jep/blob/master/jep/210/README.adoc)。  Jenkins core APIs and reference implementations have not been merged/released yet,  but prototypes are available for evaluation.  Related JEPs: [JEP-207](https://github.com/jenkinsci/jep/blob/master/jep/207/README.adoc), [JEP-212](https://github.com/jenkinsci/jep/blob/master/jep/212/README.adoc) Jenkins 核心 API 和参考实现尚未合并/发布，但原型可用于评估。相关 JEP：[JEP-207](https://github.com/jenkinsci/jep/blob/master/jep/207/README.adoc)、[JEP-212](https://github.com/jenkinsci/jep/blob/master/jep/212/README.adoc) | Pipeline logging: 管道日志记录：   [AWS CloudWatch](https://github.com/jenkinsci/pipeline-cloudwatch-logs-plugin)  [Elasticsearch](https://github.com/SAP/elasticsearch-logs-plugin)   Jenkins core: Jenkins 核心：   [External Logging API 外部日志记录 API](https://github.com/jenkinsci/external-logging-api-plugin)  [Elasticsearch](https://github.com/jenkinsci/external-logging-elasticsearch-plugin) |
| **System logs 系统日志**   **(Available) （可用）**          | Jenkins supports custom log appenders using standard `java.util.logging`  [configuration options](https://jenkov.com/tutorials/java-logging/configuration.html). Jenkins 支持使用标准 `java.util.logging`[配置选项](https://jenkov.com/tutorials/java-logging/configuration.html)的自定义日志附加程序。 | [Syslog logger](https://plugins.jenkins.io/syslog-logger),  non-Jenkins implementation [Syslog 记录器](https://plugins.jenkins.io/syslog-logger)，非 Jenkins 实现 |
| Task logs 任务日志   (Not started) （未启动）                | Storage of system logs and various tasks (e.g. agent connection or SCM polling) 存储系统日志和各种任务（例如代理连接或 SCM 轮询） | N/A 不适用                                                   |
| Configurations 配置   (Paused) （停顿）                      | Largely replaced by the [Configuration as Code](https://plugins.jenkins.io/configuration-as-code) plugin  which allows storing Jenkins configurations in SCM or other locations without a database. 在很大程度上被 [Configuration as Code](https://plugins.jenkins.io/configuration-as-code) 插件取代，该插件允许将 Jenkins 配置存储在 SCM 或其他没有数据库的位置。  Related JEPs: [JEP-213](https://github.com/jenkinsci/jep/blob/master/jep/213/README.adoc) 相关 JEP：[JEP-213](https://github.com/jenkinsci/jep/blob/master/jep/213/README.adoc) | N/A 不适用                                                   |
| **Test Results 测试结果**   **(Available) （可用）**         | API is available in [JUnit Plugin](https://plugins.jenkins.io/junit). API 在 [JUnit 插件](https://plugins.jenkins.io/junit)中可用。 | [Junit SQL Storage Junit SQL 存储](https://plugins.jenkins.io/junit-sql-storage) |
| Code Coverage results 代码覆盖率结果   (Not started) （未启动） | Planned only for plugins based on [Code Coverage API](https://plugins.jenkins.io/code-coverage-api) which unifies the storage implementation.  See *Runs* for other coverage report types. 仅针对基于统一存储实现[的 Code Coverage API](https://plugins.jenkins.io/code-coverage-api) 的插件进行规划。有关其他覆盖率报表类型，请参阅 *Runs* 。 | N/A 不适用                                                   |
| Builds/Runs 构建/运行   (Not started) （未启动）             | Storage of full build records in an external database.  Includes storing build data which is not otherwise listed (such as logs or test results). 将完整的构建记录存储在外部数据库中。包括存储未另行列出的构建数据（如日志或测试结果）。 | N/A 不适用                                                   |
| Jobs 工作   (Not started) （未启动）                         | Storage of Job configurations and job-specific metadata in an external database.  Existing plugins like Jenkins Pipeline and JobDSL partially address this case  by keeping configurations in SCM. 将作业配置和特定于作业的元数据存储在外部数据库中。Jenkins Pipeline 和 JobDSL 等现有插件通过将配置保留在 SCM 中来部分解决这种情况。 | N/A 不适用                                                   |
| **Fingerprints 指纹**   **(Preview) （预览）**               | Jenkins 2.252+ include the external fingerprint storage API which can be consumed by plugins.  More info: [GSoC Project Page](https://www.jenkins.io/projects/gsoc/2020/projects/external-fingerprint-storage/) Jenkins 2.252+ 包含外部指纹存储 API，插件可以使用该 API。更多信息：[GSoC 项目页面](https://www.jenkins.io/projects/gsoc/2020/projects/external-fingerprint-storage/)  Related JEPs: [JEP-226](https://github.com/jenkinsci/jep/blob/master/jep/226/README.adoc) 相关 JEP：[JEP-226](https://github.com/jenkinsci/jep/blob/master/jep/226/README.adoc) | [Redis](https://plugins.jenkins.io/redis-fingerprint-storage),  [PostgreSQL (unreleased)](https://github.com/jenkinsci/postgresql-fingerprint-storage-plugin) [Redis](https://plugins.jenkins.io/redis-fingerprint-storage)、[PostgreSQL（未发布）](https://github.com/jenkinsci/postgresql-fingerprint-storage-plugin) |
| Workspaces 工作区   (Not started) （未启动）                 | Proposed as a GSoC 2019 project:  [Cloud Features for External Workspace Manager Plugin](https://www.jenkins.io/projects/gsoc/2019/project-ideas/ext-workspace-manager-cloud-features/) 作为 GSoC 2019 项目提出：[外部 Workspace Manager 插件的云功能](https://www.jenkins.io/projects/gsoc/2019/project-ideas/ext-workspace-manager-cloud-features/) | N/A 不适用                                                   |

The list above is not complete. Other storage types may be considered according to the feedback. You can find more information about Pluggable Storage and priorities in [this blogpost](https://www.jenkins.io/blog/2018/07/30/introducing-cloud-native-sig/).
上面的列表并不完整。根据反馈，可以考虑其他存储类型。您可以在[此博客文章](https://www.jenkins.io/blog/2018/07/30/introducing-cloud-native-sig/)中找到有关可插拔存储和优先级的更多信息。

### Artifact Storage 构件存储

There are many existing plugins allowing to upload and download artifacts from external storage (e.g. S3, Artifactory, Publish over SFTP, etc., etc.), but there are no plugins which can do it transparently without using new steps. In many cases the artifacts also get uploaded through the Jenkins controller, and it increases load on the system. It would be great if there was a layer which would allow storing artifacts externally when using common steps like *Archive Artifacts*.
有许多现有的插件允许从外部存储上传和下载工件（例如 S3、Artifactory、Publish over SFTP  等），但没有插件可以在不使用新步骤的情况下透明地完成此操作。在许多情况下，工件也会通过 Jenkins  控制器上传，这会增加系统的负载。如果有一个层允许在使用 *Archive Artifacts* 等常见步骤时在外部存储工件，那就太好了。

Jenkins 2.118+ offers an extended [jenkins.util.VirtualFile](https://javadoc.jenkins.io/jenkins/util/VirtualFile.html) API which allows implementing external artifact managers using the [ArtifactManagerFactory](https://www.jenkins.io/doc/developer/extensions/jenkins-core/#artifactmanagerfactory) extension point.
Jenkins 2.118+ 提供了一个扩展的 [jenkins.util.VirtualFile](https://javadoc.jenkins.io/jenkins/util/VirtualFile.html) API，它允许使用 [ArtifactManagerFactory](https://www.jenkins.io/doc/developer/extensions/jenkins-core/#artifactmanagerfactory) 扩展点实现外部工件管理器。

Implementation example(s):
实现示例：

- [Artifact Manager for S3 适用于 S3 的构件管理器](https://plugins.jenkins.io/artifact-manager-s3)

Related JEPs: 相关 JEP：

- [JEP-202: External Artifact Storage
  JEP-202： 外部工件存储](https://github.com/jenkinsci/jep/blob/master/jep/202/README.adoc)

### Build Log Storage 构建日志存储

Logs disk usage causes the same issues previously mentioned for artifacts. Plus an external focused log storage such as [AWS CloudWatch Logs](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html) allows demanded features as centralized log management, log retention policies, advanced querying, etc. There are already options to externally ship the logs to a backend, or plugins that would do that like the  [aws-cloudwatch-logs-publisher-plugin](https://github.com/jenkinsci/aws-cloudwatch-logs-publisher-plugin), but there is no integrated way to both send and display logs from external log storage. The External log storage work is tracked as [JENKINS-38313](https://issues.jenkins.io/browse/JENKINS-38313).
日志磁盘使用情况会导致前面提到的与工件相同的问题。此外，[AWS CloudWatch Logs](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html) 等外部专用日志存储允许使用集中日志管理、日志保留策略、高级查询等所需功能。已经有将日志从外部发送到后端的选项，或者像 [aws-cloudwatch-logs-publisher-plugin](https://github.com/jenkinsci/aws-cloudwatch-logs-publisher-plugin) 这样执行此操作的插件，但没有集成的方式来发送和显示来自外部日志存储的日志。External log storage （外部日志存储） 工作被跟踪为 [JENKINS-38313](https://issues.jenkins.io/browse/JENKINS-38313)。

Reference implementation(s):
参考实现：

- [Pipeline Logging over fluentd + CloudWatch Plugin
  通过 fluentd 的管道日志记录 + CloudWatch 插件](https://github.com/jenkinsci/pipeline-log-fluentd-cloudwatch-plugin)
- [External Logging for Elasticsearch
  Elasticsearch 的外部日志记录](https://github.com/jenkinsci/external-logging-elasticsearch-plugin)

Related JEPs: 相关 JEP：

- [JEP-207: External Build Logging support in the Jenkins Core
  JEP-207：Jenkins Core 中的外部构建日志记录支持](https://github.com/jenkinsci/jep/blob/master/jep/207/README.adoc)
- [JEP-210: External log storage for Pipeline
  JEP-210：Pipeline 的外部日志存储](https://github.com/jenkinsci/jep/blob/master/jep/210/README.adoc)
- [JEP-212: External Logging API Plugin
  JEP-212：外部日志记录 API 插件](https://github.com/jenkinsci/jep/blob/master/jep/212/README.adoc)
- [JEP-206: Use UTF-8 for Pipeline build logs
  JEP-206：将 UTF-8 用于管道生成日志](https://github.com/jenkinsci/jep/blob/master/jep/206/README.adoc)

### Configuration Storage 配置存储

Although configurations are not big, externalizing them is a critical task for getting highly-available or disposable Jenkins controllers. There are many ways to store configurations in Jenkins, but 95% of cases are covered by the `XmlFile` layer which serializes objects to disk and reads them using the XStream library. Externalizing these `XmlFile`s would be a great step forward.
尽管配置并不大，但将其外部化是获得高可用性或一次性 Jenkins 控制器的关键任务。在 Jenkins 中存储配置的方法有很多，但 95% 的情况都由 `XmlFile` 层覆盖，该层将对象序列化到磁盘并使用 XStream 库读取它们。外部化这些 `XmlFile`将是向前迈出的一大步。

There are several prototypes for externalizing configurations, e.g. in DotCI. There are also other implementations which could be upstreamed to the Jenkins core.
有几个原型用于外部化配置，例如在 DotCI 中。还有其他实现可以上游到 Jenkins 核心。

Related JEPs: 相关 JEP：

- [JEP-213: Configuration Storage API in the Jenkins Core
  JEP-213： Jenkins Core 中的配置存储 API](https://github.com/jenkinsci/jep/blob/master/jep/213/README.adoc)

### Credentials 凭据

In [Credentials Plugin](https://plugins.jenkins.io/credentials) 1.15+ there is a [CredentialsProvider](https://www.jenkins.io/doc/developer/extensions/credentials/#credentialsprovider) extension point which allows referencing and resolving external credentials. This engine allows implementing external credentials for plugins implementing Credentials API..
在 [Credentials Plugin](https://plugins.jenkins.io/credentials) 1.15+ 中，有一个 [CredentialsProvider](https://www.jenkins.io/doc/developer/extensions/credentials/#credentialsprovider) 扩展点，它允许引用和解析外部凭证。此引擎允许为实现 Credentials API 的插件实现外部凭据。

Implementation example(s):
实现示例：

- [Kubernetes Credentials Provider
  Kubernetes 凭证提供程序](https://plugins.jenkins.io/kubernetes-credentials-provider)

Other credentials API in Jenkins (like jenkinsdoc:hudson.util.Secret) are not supported.
不支持 Jenkins 中的其他凭据 API（如 jenkinsdoc：hudson.util.Secret）。

### Test results 测试结果

In common CI/CD use-cases a lot of the space is being consumed by test reports. This data is stored within `JENKINS_HOME`, and the current storage format requires huge overheads when retrieving statistics and, especially, trends. In order to display trends, each report has to be loaded and then processed in-memory.
在常见的 CI/CD 用例中，测试报告会占用大量空间。此数据存储在 `JENKINS_HOME` 中，当前的存储格式在检索统计数据（尤其是趋势）时需要巨大的开销。为了显示趋势，必须加载每个报表，然后在内存中进行处理。

The main purpose of externalising Test Results is to optimize Jenkins logic by querying the desired data from specialized external storages, e.g. from Document-based databases like Elasticsearch. According to the current plan, [JUnit Plugin](https://plugins.jenkins.io/junit) will be extended in order to support such external storage in its APIs being widely used by test reporting plugins.
外部化 Test Results 的主要目的是通过从专门的外部存储（例如从 Elasticsearch 等基于文档的数据库）查询所需的数据来优化 Jenkins 逻辑。根据目前的计划，[JUnit 插件](https://plugins.jenkins.io/junit)将进行扩展，以便在其 API 中支持此类外部存储，这些外部存储被测试报告插件广泛使用。

Status: 地位：

- A SQL implementation is available [Junit SQL Storage](https://plugins.jenkins.io/junit-sql-storage/) plugin.
  SQL 实现可用 [Junit SQL Storage](https://plugins.jenkins.io/junit-sql-storage/) 插件。

Please try it out, report issues to [GitHub](https://github.com/jenkinsci/junit-plugin/issues) and general feedback to [GitHub#142](https://github.com/jenkinsci/junit-plugin/issues/142).
请尝试一下，向 [GitHub](https://github.com/jenkinsci/junit-plugin/issues) 报告问题，并将一般反馈报告给 [GitHub#142](https://github.com/jenkinsci/junit-plugin/issues/142)。

### Fingerprints 指纹

The fingerprints are stored within `JENKINS_HOME` inside a local XML-based database. Externalizing fingerprints decreases the dependence of Jenkins on the  physical disk storage of the controller, and allows configuring of cloud storages which can be cheaper, and more reliable. Another advantage is that it would allow tracing fingerprints across  Jenkins controllers and the entire CI/CD flow.
指纹存储在 `JENKINS_HOME` 中，并存储在基于 XML 的本地数据库中。外部化指纹减少了 Jenkins 对控制器物理磁盘存储的依赖，并允许配置更便宜、更可靠的云存储。另一个优点是，它允许跨 Jenkins 控制器和整个 CI/CD 流程跟踪指纹。

Status: 地位：

- In progress 进行中
- Related JEP: [JEP-226: External Fingerprint Storage](https://github.com/jenkinsci/jep/blob/master/jep/226/README.adoc)
  相关 JEP： [JEP-226： 外部指纹存储](https://github.com/jenkinsci/jep/blob/master/jep/226/README.adoc)
- [Prototype API 原型 API](https://github.com/jenkinsci/jenkins/pull/4731)
- Reference Implementation: [Redis Fingerprint Storage Plugin](https://github.com/jenkinsci/redis-fingerprint-storage-plugin)
  参考实现：[Redis 指纹存储插件](https://github.com/jenkinsci/redis-fingerprint-storage-plugin)