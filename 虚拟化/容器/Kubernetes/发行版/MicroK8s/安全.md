# 安全

# Services and ports 服务和端口

#### On this page 本页内容

​                                                [Services binding to the default Host interface
绑定到默认 Host 接口的服务](https://microk8s.io/docs/services-and-ports#services-binding-to-the-default-host-interface)                                                      [Services binding to the localhost interface
绑定到 localhost 接口的服务](https://microk8s.io/docs/services-and-ports#services-binding-to-the-localhost-interface)                                                      [Containerd and etcd containerd 和 etcd](https://microk8s.io/docs/services-and-ports#containerd-and-etcd)                                                      [References 引用](https://microk8s.io/docs/services-and-ports#references)                                                              

Services can be placed in two groups based on the network interface they bind to. Services binding to the `localhost` interface are only available from within the host. Services binding to  the default host interface are available from outside the host and thus  are subject to access restrictions.
服务可以根据它们绑定到的网络接口分为两组。绑定到 `localhost` 接口的服务只能在主机中使用。绑定到默认主机接口的服务可从主机外部使用，因此受访问限制的约束。

### [ Services binding to the default Host interface 绑定到默认 Host 接口的服务](https://microk8s.io/docs/services-and-ports#services-binding-to-the-default-host-interface)

| Port 港口 | Service 服务                         | Access Restrictions 访问限制                                 |
| --------- | ------------------------------------ | ------------------------------------------------------------ |
| 16443     | API server API 服务器                | SSL encrypted. Clients need to present a valid password from a [Static Password File](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#authentication-strategies). SSL 加密。客户端需要提供静态[密码文件中](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#authentication-strategies)的有效密码。 |
| 10250     | kubelet                              | Anonymous authentication is disabled. [X509 client certificate](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/) is required. 匿名身份验证已禁用。需要 [X509 客户端证书](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/)。 |
| 10255     | kubelet                              | Read only port for the Kubelet. Kubelet 的只读端口。         |
| 25000     | cluster-agent 群集代理               | Proper token required to authorise actions. 授权作所需的适当令牌。 |
| 12379     | etcd                                 | SSL encrypted. Client certificates required to connect. SSL 加密。连接所需的客户端证书。 |
| 10257     | kube-controller kube 控制器          | Serve HTTPS with authentication and authorization. 通过身份验证和授权提供 HTTPS。 |
| 10259     | kube-scheduler kube-scheduler 调度器 | Serve HTTPS with authentication and authorization. 通过身份验证和授权提供 HTTPS。 |
| 19001     | dqlite                               | SSL encrypted. Client certificates required to connect. SSL 加密。连接所需的客户端证书。 |
| 4789/udp  | calico 白布                          | Calico networking with VXLAN enabled. 启用了 VXLAN 的 Calico 网络。 |

### [ Services binding to the localhost interface 绑定到 localhost 接口的服务](https://microk8s.io/docs/services-and-ports#services-binding-to-the-localhost-interface)

| Port 港口 | Service 服务                     | Description 描述                                             |
| --------- | -------------------------------- | ------------------------------------------------------------ |
| 10248     | kubelet                          | Localhost healthz endpoint.                                  |
| 10249     | kube-proxy kube-proxy 代理       | Port for the metrics server to serve on. 用于提供服务的指标服务器的端口。 |
| 10251     | kube-schedule kube-schedule 计划 | Port on which to serve HTTP insecurely. 不安全地提供 HTTP 的端口。 |
| 10252     | kube-controller kube 控制器      | Port on which to serve HTTP insecurely. 不安全地提供 HTTP 的端口。 |
| 10256     | kube-proxy kube-proxy 代理       | Port to bind the health check server. 用于绑定健康检查服务器的端口。 |
| 2380      | etcd                             | Used for peer connections. 用于对等连接。                    |
| 1338      | containerd                       | Metrics port Metrics 端口                                    |

### [ Containerd and etcd containerd 和 etcd](https://microk8s.io/docs/services-and-ports#containerd-and-etcd)

Both these services are exposed through unix sockets.
这两个服务都是通过 unix 套接字公开的。

| Service 服务 | Socket 插座                                          |
| ------------ | ---------------------------------------------------- |
| containerd   | unix:///var/snap/microk8s/common/run/containerd.sock |

## Authentication and authorization 身份验证和授权

Upon deployment MicroK8s creates a Certificate Authority, a signed server  certificate and a service account key file. These files are stored under `/var/snap/microk8s/current/certs/`. Kubelet and the API server are aware of the same CA and so the signed  server certificate is used by the API server to authenticate with  kubelet (`--kubelet-client-certificate`).
部署后，MicroK8s 会创建一个证书颁发机构、一个签名的服务器证书和一个服务帐户密钥文件。这些文件存储在 `/var/snap/microk8s/current/certs/` 下。Kubelet 和 API 服务器知道同一个 CA，因此 API 服务器使用签名的服务器证书对 kubelet 进行身份验证 （`--kubelet-client-certificate`）。

Initially the server certificates will be issued for:
最初，将颁发服务器证书：

- localhost and all the ip addresses avaliable on the machine, typically it’s LAN address
  localhost 和机器上可用的所有 IP 地址，通常是 LAN 地址
- various mDNS addresses, such as kubernetes.default and kubernetes.default.svc.cluster.local
  各种 mDNS 地址，例如 kubernetes.default 和 kubernetes.default.svc.cluster.local

This will only allow Kubectl to access the API server locally, to access it  through the internet and a real domain name you must add it to the file `/var/snap/microk8s/current/certs/csr.conf.template`, for example:
这将只允许 Kubectl 在本地访问 API 服务器，要通过 Internet 和真实域名访问它，您必须将其添加到文件中 `/var/snap/microk8s/current/certs/csr.conf.template` ，例如：

```auto
[ alt_names ]
DNS.1 = kubernetes
DNS.2 = kubernetes.default
DNS.3 = kubernetes.default.svc
DNS.4 = kubernetes.default.svc.cluster
DNS.5 = kubernetes.default.svc.cluster.local
DNS.6 = mydomain.com
```

After changing, refresh the certificates with:
更改后，使用以下命令刷新证书：

```auto
sudo microk8s refresh-certs --cert server.crt
```

This will generate new certs and restart the apiserver. Your DNS server settings and
这将生成新的证书并重新启动 apiserver。您的 DNS 服务器设置和
 `kubeconfig` file must be updated appropriately.
`kubeconfig` 文件。

Clients talking to the secure port of the API server (`16443`), such as the Kubectl command line utility, have to be aware of the CA (`certificate-authority-data` in user kubeconfig).
与 API 服务器的安全端口（`16443`）通信的客户端（例如 Kubectl 命令行工具）必须知道 CA（用户 kubeconfig 中的 `certificate-authority-data`）。

The authentication [strategies](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#authentication-strategies)  enabled by default are:
默认启用的身份验证[策略](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#authentication-strategies)包括：

- Static Token File with tokens in `/var/snap/microk8s/current/credentials/known_tokens.csv`
  包含 token 的 `/var/snap/microk8s/current/credentials/known_tokens.csv` 静态令牌文件
- X509 Client Certs with the client CA file set to `/var/snap/microk8s/current/certs/ca.crt`
  客户端 CA 文件设置为 `/var/snap/microk8s/current/certs/ca.crt` 

Prior to version 1.19, the following strategy is also available:
在 1.19 版本之前，还可以使用以下策略：

- Static Password File with password tokens and usernames stored in `/var/snap/microk8s/current/credentials/basic_auth.csv`
  静态密码文件，其中包含存储在 `/var/snap/microk8s/current/credentials/basic_auth.csv` 

Under `/var/snap/microk8s/current/credentials/` you can find the `client.config` kubeconfig file used by `microk8s kubectl`.
在下面 `/var/snap/microk8s/current/credentials/` ，您可以找到 `microk8s kubectl` 使用的 `client.config` kubeconfig 文件。

By default all authenticated requests are authorized as the api-server runs with `--authorization-mode=AlwaysAllow`. Turning on [RBAC](https://kubernetes.io/docs/reference/access-authn-authz/rbac/) is done through `microk8s enable rbac`.
默认情况下，所有经过身份验证的请求都经过授权，因为 api-server 使用 `--authorization-mode=AlwaysAllow` .打开 [RBAC](https://kubernetes.io/docs/reference/access-authn-authz/rbac/) 是通过 `microk8s enable rbac` 完成的。

## [ References 引用](https://microk8s.io/docs/services-and-ports#references)

- [Authentication strategies
  身份验证策略](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#authentication-strategies)
- [Role-based access control (RBAC)
  基于角色的访问控制 （RBAC）](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)
- [kubelet](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/)
- [kube-proxy kube-proxy 代理](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/)
- [kube-scheduler kube-scheduler 调度器](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/)
- [kube-controller-manager kube 控制器管理器](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/)

# CIS cluster hardening CIS 群集强化

The Center for Internet Security (CIS) is an independent, nonprofit  organization that regularly offers recommendations for hardening  organizations’ technologies against cyber attacks.
互联网安全中心 （CIS） 是一个独立的非营利组织，定期为加强组织抵御网络攻击的技术提供建议。
 CIS has issued recommendations, in the form of Benchmarks, for setting  up and configuring Kubernetes. These hardening recommendations cover the following areas:
CIS 以 Benchmarks 的形式发布了设置和配置 Kubernetes 的建议。这些强化建议涵盖以下方面：

- Control Plane Security Configuration
  控制平面安全配置
- Datastore Configuration, (dqlite)
  数据存储配置 （dqlite）
- Control Plane Node Configuration
  Control Plane 节点配置
- Worker Node Security Configuration
  Worker 节点安全配置
- Kubernetes Policies Kubernetes 策略

Typically, Kubernetes distributions (including MicroK8s) do not comply with all  hardening recommendations by default as some of them come with  performance penalties while others require user configuration/input.
通常，Kubernetes 发行版（包括 MicroK8s）默认不遵守所有强化建议，因为其中一些会带来性能损失，而另一些则需要用户配置/输入。

In the [CIS hardening and assessment](https://microk8s.io/docs/how-to-cis-harden) page we cover the relevant CIS recommendations and provide details on  how to configure a MicroK8s cluster to pass the CIS Benchmark checks.  Auditors will also find information on how to verify a cluster complies  with each recommendation.
在 [CIS 强化和评估](https://microk8s.io/docs/how-to-cis-harden)页面中，我们介绍了相关的 CIS 建议，并提供了有关如何配置 MicroK8s 集群以通过 CIS 基准检查的详细信息。审计员还将找到有关如何验证集群是否符合每个建议的信息。

Starting with the v1.28 MicroK8s release a `cis-hardening` addon is included in the core addons.
从 v1.28 MicroK8s 版本开始，核心插件中包含了一个`顺式强化`插件。
 `microk8s enable cis-hardening` applies all the [Kubernetes specific CIS configurations](https://www.cisecurity.org/benchmark/kubernetes) v1.24 of the
`microk8s 启用 CIS 强化`应用所有[特定于 Kubernetes 的 CIS 配置](https://www.cisecurity.org/benchmark/kubernetes) v1.24 的
 CIS Kubernetes Benchmark to the MicroK8s node it is executed on.
CIS Kubernetes Benchmark 添加到执行它的 MicroK8s 节点。

For more details on how to use the `cis-hardening` addon or how to manually harden a pre-v1.28 cluster see the [respective page](https://microk8s.io/docs/how-to-cis-harden).
有关如何使用 `cis-hardening` 插件或如何手动强化 v1.28 之前的集群的更多详细信息，请参阅[相应的页面](https://microk8s.io/docs/how-to-cis-harden)。

# CIS hardening and assesment CIS 强化和评估

#### On this page 本页内容

​                                                [CIS-hardening addons usage
CIS-hardening 插件的使用](https://microk8s.io/docs/how-to-cis-harden#cis-hardening-addons-usage)                                                      [CIS hardening assessment CIS 强化评估](https://microk8s.io/docs/how-to-cis-harden#cis-hardening-assessment)                                                                                            [Control Plane Security Configuration
控制平面安全配置](https://microk8s.io/docs/how-to-cis-harden#control-plane-security-configuration)                                                  [Check 1.1.1 检查 1.1.1](https://microk8s.io/docs/how-to-cis-harden#check-111)                                                  [Check 1.1.2 检查 1.1.2](https://microk8s.io/docs/how-to-cis-harden#check-112)                                                  [Check 1.1.3 检查 1.1.3](https://microk8s.io/docs/how-to-cis-harden#check-113)                                                  [Check 1.1.4 检查 1.1.4](https://microk8s.io/docs/how-to-cis-harden#check-114)                                                  [Check 1.1.5 检查 1.1.5](https://microk8s.io/docs/how-to-cis-harden#check-115)                                                  [Check 1.1.6 检查 1.1.6](https://microk8s.io/docs/how-to-cis-harden#check-116)                                                  [Check 1.1.7 检查 1.1.7](https://microk8s.io/docs/how-to-cis-harden#check-117)                                                  [Check 1.1.8 检查 1.1.8](https://microk8s.io/docs/how-to-cis-harden#check-118)                                                  [Check 1.1.9 检查 1.1.9](https://microk8s.io/docs/how-to-cis-harden#check-119)                                                  [Check 1.1.10 检查 1.1.10](https://microk8s.io/docs/how-to-cis-harden#check-1110)                                                  [Check 1.1.11 检查 1.1.11](https://microk8s.io/docs/how-to-cis-harden#check-1111)                                                  [Check 1.1.12 检查 1.1.12](https://microk8s.io/docs/how-to-cis-harden#check-1112)                                                  [Check 1.1.13 检查 1.1.13](https://microk8s.io/docs/how-to-cis-harden#check-1113)                                                  [Check 1.1.14 检查 1.1.14](https://microk8s.io/docs/how-to-cis-harden#check-1114)                                                  [Check 1.1.15 检查 1.1.15](https://microk8s.io/docs/how-to-cis-harden#check-1115)                                                  [Check 1.1.16 检查 1.1.16](https://microk8s.io/docs/how-to-cis-harden#check-1116)                                                  [Check 1.1.17](https://microk8s.io/docs/how-to-cis-harden#check-1117)                                                  [Check 1.1.18](https://microk8s.io/docs/how-to-cis-harden#check-1118)                                                  [Check 1.1.19](https://microk8s.io/docs/how-to-cis-harden#check-1119)                                                  [Check 1.1.20](https://microk8s.io/docs/how-to-cis-harden#check-1120)                                                  [Check 1.1.21](https://microk8s.io/docs/how-to-cis-harden#check-1121)                                                  [Check 1.2.1](https://microk8s.io/docs/how-to-cis-harden#check-121)                                                  [Check 1.2.2](https://microk8s.io/docs/how-to-cis-harden#check-122)                                                  [Check 1.2.3](https://microk8s.io/docs/how-to-cis-harden#check-123)                                                  [Check 1.2.4](https://microk8s.io/docs/how-to-cis-harden#check-124)                                                  [Check 1.2.5](https://microk8s.io/docs/how-to-cis-harden#check-125)                                                  [Check 1.2.6](https://microk8s.io/docs/how-to-cis-harden#check-126)                                                  [Check 1.2.7](https://microk8s.io/docs/how-to-cis-harden#check-127)                                                  [Check 1.2.8](https://microk8s.io/docs/how-to-cis-harden#check-128)                                                  [Check 1.2.9](https://microk8s.io/docs/how-to-cis-harden#check-129)                                                  [Check 1.2.10](https://microk8s.io/docs/how-to-cis-harden#check-1210)                                                  [Check 1.2.11](https://microk8s.io/docs/how-to-cis-harden#check-1211)                                                  [Check 1.2.12](https://microk8s.io/docs/how-to-cis-harden#check-1212)                                                  [Check 1.2.13](https://microk8s.io/docs/how-to-cis-harden#check-1213)                                                  [Check 1.2.14](https://microk8s.io/docs/how-to-cis-harden#check-1214)                                                  [Check 1.2.15](https://microk8s.io/docs/how-to-cis-harden#check-1215)                                                  [Check 1.2.16](https://microk8s.io/docs/how-to-cis-harden#check-1216)                                                  [Check 1.2.17](https://microk8s.io/docs/how-to-cis-harden#check-1217)                                                  [Check 1.2.18](https://microk8s.io/docs/how-to-cis-harden#check-1218)                                                  [Check 1.2.19](https://microk8s.io/docs/how-to-cis-harden#check-1219)                                                  [Check 1.2.20](https://microk8s.io/docs/how-to-cis-harden#check-1220)                                                  [Check 1.2.21](https://microk8s.io/docs/how-to-cis-harden#check-1221)                                                  [Check 1.2.22](https://microk8s.io/docs/how-to-cis-harden#check-1222)                                                  [Check 1.2.23](https://microk8s.io/docs/how-to-cis-harden#check-1223)                                                  [Check 1.2.24](https://microk8s.io/docs/how-to-cis-harden#check-1224)                                                  [Check 1.2.25](https://microk8s.io/docs/how-to-cis-harden#check-1225)                                                  [Check 1.2.26](https://microk8s.io/docs/how-to-cis-harden#check-1226)                                                  [Check 1.2.27](https://microk8s.io/docs/how-to-cis-harden#check-1227)                                                  [Check 1.2.28](https://microk8s.io/docs/how-to-cis-harden#check-1228)                                                  [Check 1.2.29](https://microk8s.io/docs/how-to-cis-harden#check-1229)                                                  [Check 1.2.30](https://microk8s.io/docs/how-to-cis-harden#check-1230)                                                  [Check 1.2.31](https://microk8s.io/docs/how-to-cis-harden#check-1231)                                                  [Check 1.3.1](https://microk8s.io/docs/how-to-cis-harden#check-131)                                                  [Check 1.3.2](https://microk8s.io/docs/how-to-cis-harden#check-132)                                                  [Check 1.3.3](https://microk8s.io/docs/how-to-cis-harden#check-133)                                                  [Check 1.3.4](https://microk8s.io/docs/how-to-cis-harden#check-134)                                                  [Check 1.3.5](https://microk8s.io/docs/how-to-cis-harden#check-135)                                                  [Check 1.3.6](https://microk8s.io/docs/how-to-cis-harden#check-136)                                                  [Check 1.3.7](https://microk8s.io/docs/how-to-cis-harden#check-137)                                                  [Check 1.4.1](https://microk8s.io/docs/how-to-cis-harden#check-141)                                                  [Check 1.4.2](https://microk8s.io/docs/how-to-cis-harden#check-142)                                                  [Etcd Node Configuration, for dqlite](https://microk8s.io/docs/how-to-cis-harden#etcd-node-configuration-for-dqlite)                                                  [Check 2.1](https://microk8s.io/docs/how-to-cis-harden#check-21)                                                  [Check 2.2](https://microk8s.io/docs/how-to-cis-harden#check-22)                                                  [Check 2.3](https://microk8s.io/docs/how-to-cis-harden#check-23)                                                  [Check 2.4](https://microk8s.io/docs/how-to-cis-harden#check-24)                                                  [Check 2.5](https://microk8s.io/docs/how-to-cis-harden#check-25)                                                  [Check 2.6](https://microk8s.io/docs/how-to-cis-harden#check-26)                                                  [Check 2.7](https://microk8s.io/docs/how-to-cis-harden#check-27)                                                  [Control Plane Configuration](https://microk8s.io/docs/how-to-cis-harden#control-plane-configuration)                                                  [Check 3.1.1](https://microk8s.io/docs/how-to-cis-harden#check-311)                                                  [Check 3.2.1](https://microk8s.io/docs/how-to-cis-harden#check-321)                                                  [Check 3.2.2](https://microk8s.io/docs/how-to-cis-harden#check-322)                                                  [Worker Node Security Configuration](https://microk8s.io/docs/how-to-cis-harden#worker-node-security-configuration)                                                  [Check 4.1.1](https://microk8s.io/docs/how-to-cis-harden#check-411)                                                  [Check 4.1.2](https://microk8s.io/docs/how-to-cis-harden#check-412)                                                  [Check 4.1.3](https://microk8s.io/docs/how-to-cis-harden#check-413)                                                  [Check 4.1.4](https://microk8s.io/docs/how-to-cis-harden#check-414)                                                  [Check 4.1.5](https://microk8s.io/docs/how-to-cis-harden#check-415)                                                  [Check 4.1.6](https://microk8s.io/docs/how-to-cis-harden#check-416)                                                  [Check 4.1.7](https://microk8s.io/docs/how-to-cis-harden#check-417)                                                  [Check 4.1.8](https://microk8s.io/docs/how-to-cis-harden#check-418)                                                  [Check 4.1.9](https://microk8s.io/docs/how-to-cis-harden#check-419)                                                  [Check 4.1.10](https://microk8s.io/docs/how-to-cis-harden#check-4110)                                                  [Check 4.2.1](https://microk8s.io/docs/how-to-cis-harden#check-421)                                                  [Check 4.2.2](https://microk8s.io/docs/how-to-cis-harden#check-422)                                                  [Check 4.2.3](https://microk8s.io/docs/how-to-cis-harden#check-423)                                                  [Check 4.2.4](https://microk8s.io/docs/how-to-cis-harden#check-424)                                                  [Check 4.2.5](https://microk8s.io/docs/how-to-cis-harden#check-425)                                                  [Check 4.2.6](https://microk8s.io/docs/how-to-cis-harden#check-426)                                                  [Check 4.2.7](https://microk8s.io/docs/how-to-cis-harden#check-427)                                                  [Check 4.2.8](https://microk8s.io/docs/how-to-cis-harden#check-428)                                                  [Check 4.2.9](https://microk8s.io/docs/how-to-cis-harden#check-429)                                                  [Check 4.2.10](https://microk8s.io/docs/how-to-cis-harden#check-4210)                                                  [Check 4.2.11](https://microk8s.io/docs/how-to-cis-harden#check-4211)                                                  [Check 4.2.12](https://microk8s.io/docs/how-to-cis-harden#check-4212)                                                  [Check 4.2.13](https://microk8s.io/docs/how-to-cis-harden#check-4213)                                                  [Kubernetes Policies](https://microk8s.io/docs/how-to-cis-harden#kubernetes-policies)                                                  [Check 5.1.1](https://microk8s.io/docs/how-to-cis-harden#check-511)                                                  [Check 5.1.2](https://microk8s.io/docs/how-to-cis-harden#check-512)                                                  [Check 5.1.3](https://microk8s.io/docs/how-to-cis-harden#check-513)                                                  [Check 5.1.4](https://microk8s.io/docs/how-to-cis-harden#check-514)                                                  [Check 5.1.5](https://microk8s.io/docs/how-to-cis-harden#check-515)                                                  [Check 5.1.6](https://microk8s.io/docs/how-to-cis-harden#check-516)                                                  [Check 5.1.7](https://microk8s.io/docs/how-to-cis-harden#check-517)                                                  [Check 5.1.8](https://microk8s.io/docs/how-to-cis-harden#check-518)                                                  [Check 5.2.1](https://microk8s.io/docs/how-to-cis-harden#check-521)                                                  [Check 5.2.2](https://microk8s.io/docs/how-to-cis-harden#check-522)                                                  [Check 5.2.3](https://microk8s.io/docs/how-to-cis-harden#check-523)                                                  [Check 5.2.4](https://microk8s.io/docs/how-to-cis-harden#check-524)                                                  [Check 5.2.5](https://microk8s.io/docs/how-to-cis-harden#check-525)                                                  [Check 5.2.6](https://microk8s.io/docs/how-to-cis-harden#check-526)                                                  [Check 5.2.7](https://microk8s.io/docs/how-to-cis-harden#check-527)                                                  [Check 5.2.8](https://microk8s.io/docs/how-to-cis-harden#check-528)                                                  [Check 5.2.9](https://microk8s.io/docs/how-to-cis-harden#check-529)                                                  [Check 5.2.10](https://microk8s.io/docs/how-to-cis-harden#check-5210)                                                  [Check 5.2.11](https://microk8s.io/docs/how-to-cis-harden#check-5211)                                                  [Check 5.2.12](https://microk8s.io/docs/how-to-cis-harden#check-5212)                                                  [Check 5.2.13](https://microk8s.io/docs/how-to-cis-harden#check-5213)                                                  [Check 5.3.1](https://microk8s.io/docs/how-to-cis-harden#check-531)                                                  [Check 5.3.2](https://microk8s.io/docs/how-to-cis-harden#check-532)                                                  [Check 5.4.1](https://microk8s.io/docs/how-to-cis-harden#check-541)                                                  [Check 5.4.2](https://microk8s.io/docs/how-to-cis-harden#check-542)                                                  [Check 5.5.1](https://microk8s.io/docs/how-to-cis-harden#check-551)                                                  [Check 5.7.1](https://microk8s.io/docs/how-to-cis-harden#check-571)                                                  [Check 5.7.2](https://microk8s.io/docs/how-to-cis-harden#check-572)                                                  [Check 5.7.3](https://microk8s.io/docs/how-to-cis-harden#check-573)                                                  [Check 5.7.4](https://microk8s.io/docs/how-to-cis-harden#check-574)                                                                                                    [Further reading](https://microk8s.io/docs/how-to-cis-harden#further-reading)                                                              

[Kubernetes specific CIS configurations](https://www.cisecurity.org/benchmark/kubernetes) is a set of recommendations on the Kubernetes services setup and configuration.
[特定于 Kubernetes 的 CIS 配置](https://www.cisecurity.org/benchmark/kubernetes)是有关 Kubernetes 服务设置和配置的一组建议。

With the v1.28 MicroK8s release a `cis-hardening` addon is included as part of the core addons.
在 v1.28 MicroK8s 版本中，`一个顺式强化`插件作为核心插件的一部分包含在内。
 As described below, this addon reconfigures the cluster nodes to comply with the CIS recommendations v1.24.
如下所述，此插件会重新配置集群节点以符合 CIS 建议 v1.24。

On pre-1.28 releases you need to follow the remediation steps described  below so as to manually configure MicroK8s according to the CIS  recommendations.
在 1.28 之前的版本中，您需要按照下面描述的修复步骤进行作，以便根据 CIS 建议手动配置 MicroK8s。

## [CIS-hardening addons usage CIS-hardening 插件的使用](https://microk8s.io/docs/how-to-cis-harden#cis-hardening-addons-usage)

The addon is enabled with:
该插件通过以下方式启用：

```auto
microk8s enable cis-hardening
```

The addon assumes a default configuration and reconfigures the MicroK8s services to comply with the CIS-1.24 recommendations.
该插件采用默认配置并重新配置 MicroK8s 服务以符合 CIS-1.24 建议。
 The CIS hardening  actions need to be applied to each individual node before it joins a cluster.
在加入集群之前，需要将 CIS 强化作应用于每个单独的节点。

To enable the addon through [launch configurations](https://microk8s.io/docs/add-launch-config) during node deployment or at a later stage use the following configuration:
要在节点部署期间或稍后阶段通过[启动配置](https://microk8s.io/docs/add-launch-config)启用插件，请使用以下配置：

```auto
---
version: 0.1.0
addons:
  - name: dns
  - name: cis-hardening
```

To remove the CIS hardening process, disable the addon with:
要删除 CIS 强化过程，请使用以下命令禁用插件：

```auto
microk8s disable cis-hardening
```

Unless the `--install-kubebench` flag is set to `false`, enabling the addon also installs [kube-bench](https://github.com/aquasecurity/kube-bench)
除非将 `--install-kubebench` 标志设置为 `false` ，否则启用该插件也会安装 kube-bench
 as a plugin along with a revised version of CIS benchmark configurations applicable for MicroK8s. You may want to skip the kube-bench  installation in offline deployments. Call kube-bench with:
作为插件，以及适用于 MicroK8s 的 CIS 基准测试配置的修订版本。您可能希望在离线部署中跳过 kube-bench 安装。使用以下命令调用 kube-bench：

```auto
sudo microk8s kube-bench
```

All `kube-bench` arguments can be passed to the `microk8s kube-bench` command. For example to check the results of a single test, 1.2.3:
所有 `kube-bench` 参数都可以传递给 `microk8s kube-bench` 命令。例如，要检查单个测试的结果，1.2.3：

```auto
sudo microk8s kube-bench --check 1.2.3
```

If you need to run `kube-bench` before enabling the addon but also use the CIS benchmark configuration  appropriate for MicroK8s you need to install kube-bench manually and  point it to the configuration that comes with the addon.
如果你需要在启用插件之前运行 `kube-bench`，但还需要使用适合 MicroK8s 的 CIS 基准测试配置，则需要手动安装 kube-bench 并将其指向插件自带的配置。
 To do so pass the following parameters to `kube-bench`:
为此，请将以下参数传递给 `kube-bench`：

```auto
--version cis-1.24-microk8s
--config /var/snap/microk8s/common/addons/core/addons/cis-hardening/cfg/config.yaml
--config-dir /var/snap/microk8s/common/addons/core/addons/cis-hardening/cfg/
```

## [CIS hardening assessment CIS 强化评估](https://microk8s.io/docs/how-to-cis-harden#cis-hardening-assessment)

In this section we review each of the CIS recommendations so that the  interested reader (auditors, security teams) can assess the level at  which the respective security concerns are addressed. This section also  shows how to CIS harden MicroK8s versions
在本节中，我们将回顾每个 CIS 建议，以便感兴趣的读者（审计员、安全团队）可以评估解决相应安全问题的级别。本节还介绍如何对 MicroK8s 版本进行 CIS 强化
 where the `cis-hardening` addon is not available for (pre 1.28 releases).
`其中 cis-hardening` 插件不适用于 （1.28 之前的版本）。

CIS recommendations are in one of the following categories:
CIS 建议属于以下类别之一：

- Control Plane Security Configuration, checks 1.x.y
  控制平面安全配置，检查 1.x.y
- Etcd Node Configuration, checks 2.x.y. Tailored to dqlite instead of etcd.
  Etcd 节点配置，检查 2.x.y.为 dqlite 而不是 etcd 量身定制。
- Control Plane Configuration, checks 3.x.y
  Control Plane Configuration，检查 3.x.y
- Worker Node Security Configuration, checks 4.x.y
  Worker Node 安全配置，检查 4.x.y
- Kubernetes Policies, checks 5.x.y
  Kubernetes 策略，检查 5.x.y

Each check presented below includes the following information:
下面显示的每项检查都包含以下信息：

- Description of the check 检查说明
- Remediation to handle the CIS security concerns
  处理 CIS 安全问题的补救措施
- Automated remediation through the `cis-hardening` addon
  通过 `cis-hardening` 插件进行自动修复
- Audit and expected outcome for the automated tests when applicable
  自动化测试的审计和预期结果（如果适用）

### [Control Plane Security Configuration 控制平面安全配置](https://microk8s.io/docs/how-to-cis-harden#control-plane-security-configuration)

### [Check 1.1.1 检查 1.1.1](https://microk8s.io/docs/how-to-cis-harden#check-111)

> Ensure that the API server pod specification file permissions are set to 600 or more restrictive (Automated)
> 确保将 API 服务器 Pod 规范文件权限设置为 600 或更严格（自动）

**Remediation 修复**

In MicroK8s the control plane is not self-hosted and therefore it does not run in pods. Instead the API server is a
在 MicroK8s 中，控制平面不是自托管的，因此它不会在 Pod 中运行。相反，API 服务器是一个
 systemd service with its configuration found at `/var/snap/microk8s/current/args/kube-apiserver`. The permissions of this
systemd 服务，其配置位于 `/var/snap/microk8s/current/args/kube-apiserver` 。此权限
 file need to be set to 600 or more restrictive:
file 需要设置为 600 或更严格：

```auto
chmod 600 /var/snap/microk8s/current/args/kube-apiserver
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600
是的。权限设置为 600

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/args/kube-apiserver; then stat -c permissions=%a /var/snap/microk8s/current/args/kube-apiserver; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.2 检查 1.1.2](https://microk8s.io/docs/how-to-cis-harden#check-112)

> Ensure that the API server pod specification file ownership is set to root:root (Automated)
> 确保 API 服务器 Pod 规范文件所有权设置为 root：root （Automated）

**Remediation 修复**

In MicroK8s the control plane is not self-hosted and therefore it does not run in pods. Instead the API server is a
在 MicroK8s 中，控制平面不是自托管的，因此它不会在 Pod 中运行。相反，API 服务器是一个
 systemd service with its configuration found at `/var/snap/microk8s/current/args/kube-apiserver`. The configuration file is owned by the
systemd 服务，其配置位于 `/var/snap/microk8s/current/args/kube-apiserver` 。配置文件归
 user `root` and is editable by users in the `microk8s` (or `snap_microk8s`) group. To comply with the CIS recommendation:
用户 `root 的 U 用户`，可由 `microk8s`（或 `snap_microk8s`）组中的用户进行编辑。要符合 CIS 建议，请执行以下作：

```auto
chown root:root /var/snap/microk8s/current/args/kube-apiserver
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/args/kube-apiserver; then stat -c %U:%G /var/snap/microk8s/current/args/kube-apiserver; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 1.1.3 检查 1.1.3](https://microk8s.io/docs/how-to-cis-harden#check-113)

> Ensure that the controller manager pod specification file permissions are set to 600 or more restrictive (Automated)
> 确保控制器管理器 Pod 规范文件权限设置为 600 或更严格（自动）

**Remediation 修复**

In MicroK8s the control plane is not self-hosted and therefore it does not run in pods. Instead the controller manager is a
在 MicroK8s 中，控制平面不是自托管的，因此它不会在 Pod 中运行。相反，控制器管理器是一个
 systemd service with its configuration found at `/var/snap/microk8s/current/args/kube-controller-manager`. The permissions of this
systemd 服务，其配置位于 `/var/snap/microk8s/current/args/kube-controller-manager` 。此权限
 file need to be set to 600 or more restrictive:
file 需要设置为 600 或更严格：

```auto
chmod 600 /var/snap/microk8s/current/args/kube-controller-manager
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600
是的。权限设置为 600

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/args/kube-controller-manager; then stat -c permissions=%a /var/snap/microk8s/current/args/kube-controller-manager; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.4 检查 1.1.4](https://microk8s.io/docs/how-to-cis-harden#check-114)

> Ensure that the controller manager pod specification file ownership is set to root:root (Automated)
> 确保控制器管理器 Pod 规范文件所有权设置为 root：root （Automated）

**Remediation 修复**

In MicroK8s the control plane is not self-hosted and therefore it does not run in pods. Instead the controller manager is a
在 MicroK8s 中，控制平面不是自托管的，因此它不会在 Pod 中运行。相反，控制器管理器是一个
 systemd service with its configuration found at `/var/snap/microk8s/current/args/kube-controller-manager`. The configuration file is owned by the
systemd 服务，其配置位于 `/var/snap/microk8s/current/args/kube-controller-manager` 。配置文件归
 user `root` and is editable by users in the `microk8s` (or `snap_microk8s`) group. To comply with the CIS recommendation:
用户 `root 的 U 用户`，可由 `microk8s`（或 `snap_microk8s`）组中的用户进行编辑。要符合 CIS 建议，请执行以下作：

```auto
chown root:root /var/snap/microk8s/current/args/kube-controller-manager
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/args/kube-controller-manager; then stat -c %U:%G /var/snap/microk8s/current/args/kube-controller-manager; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 1.1.5 检查 1.1.5](https://microk8s.io/docs/how-to-cis-harden#check-115)

> Ensure that the scheduler pod specification file permissions are set to 600 or more restrictive (Automated)
> 确保将调度程序 Pod 规范文件权限设置为 600 或更严格（自动）

**Remediation 修复**

In MicroK8s the control plane is not self-hosted and therefore it does not run in pods. Instead the scheduler is a
在 MicroK8s 中，控制平面不是自托管的，因此它不会在 Pod 中运行。相反，调度程序是一个
 systemd service with its configuration found at `/var/snap/microk8s/current/args/kube-scheduler`. The permissions of this
systemd 服务，其配置位于 `/var/snap/microk8s/current/args/kube-scheduler` 。此权限
 file need to be set to 600 or more restrictive:
file 需要设置为 600 或更严格：

```auto
chmod 600 /var/snap/microk8s/current/args/kube-scheduler
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600
是的。权限设置为 600

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/args/kube-scheduler; then stat -c permissions=%a /var/snap/microk8s/current/args/kube-scheduler; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.6 检查 1.1.6](https://microk8s.io/docs/how-to-cis-harden#check-116)

> Ensure that the scheduler pod specification file ownership is set to root:root (Automated)
> 确保调度程序 Pod 规范文件所有权设置为 root：root （Automated）

**Remediation 修复**

In MicroK8s the control plane is not self-hosted and therefore it does not run in pods. Instead the controller manager is a
在 MicroK8s 中，控制平面不是自托管的，因此它不会在 Pod 中运行。相反，控制器管理器是一个
 systemd service with its configuration found at `/var/snap/microk8s/current/args/kube-scheduler`. The configuration file is owned by the
systemd 服务，其配置位于 `/var/snap/microk8s/current/args/kube-scheduler` 。配置文件归
 user `root` and is editable by users in the `microk8s` (or `snap_microk8s`) group. To comply with the CIS recommendation:
用户 `root 的 U 用户`，可由 `microk8s`（或 `snap_microk8s`）组中的用户进行编辑。要符合 CIS 建议，请执行以下作：

```auto
chown root:root /var/snap/microk8s/current/args/kube-scheduler
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/args/kube-scheduler; then stat -c %U:%G /var/snap/microk8s/current/args/kube-scheduler; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 1.1.7 检查 1.1.7](https://microk8s.io/docs/how-to-cis-harden#check-117)

> Ensure that the etcd pod specification file permissions are set to 600 or more restrictive (Automated)
> 确保将 etcd pod 规范文件权限设置为 600 或更严格 （Automated）

**Remediation 修复**

Not applicable. MicroK8s does not use etcd as its datastore it uses dqlite.
不適用。MicroK8s 不使用 etcd 作为其数据存储，它使用 dqlite。

Dqlite is a systemd service with its configuration found at `/var/snap/microk8s/current/args/k8s-dqlite`.
Dqlite 是一项 systemd 服务，其配置位于 `/var/snap/microk8s/current/args/k8s-dqlite` 。
 To comply with the spirit of this CIS recommendation:
为了遵守本 CIS 建议的精神：

```auto
chmod 600 /var/snap/microk8s/current/args/k8s-dqlite
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600
是的。权限设置为 600

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/args/k8s-dqlite; then stat -c permissions=%a /var/snap/microk8s/current/args/k8s-dqlite; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.8 检查 1.1.8](https://microk8s.io/docs/how-to-cis-harden#check-118)

> Ensure that the etcd pod specification file ownership is set to root:root (Automated)
> 确保 etcd pod 规范文件所有权设置为 root：root （Automated）

**Remediation 修复**

Not applicable. MicroK8s does not use etcd as its datastore it uses dqlite.
不適用。MicroK8s 不使用 etcd 作为其数据存储，它使用 dqlite。

Dqlite is a systemd service with its configuration found at `/var/snap/microk8s/current/args/k8s-dqlite`.
Dqlite 是一项 systemd 服务，其配置位于 `/var/snap/microk8s/current/args/k8s-dqlite` 。
 The configuration file is owned by the user `root` and is editable by users in the `microk8s` (or `snap_microk8s`) group.
配置文件归用户 `root` 所有，可由 `microk8s`（或 `snap_microk8s`）组中的用户编辑。
 To comply with the spirit of this CIS recommendation:
为了遵守本 CIS 建议的精神：

```auto
chown root:root /var/snap/microk8s/current/args/k8s-dqlite
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership set to root:root
是的。所有权设置为 root：root

**Audit 审计**

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/args/k8s-dqlite; then stat -c %U:%G /var/snap/microk8s/current/args/k8s-dqlite; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 1.1.9 检查 1.1.9](https://microk8s.io/docs/how-to-cis-harden#check-119)

> Ensure that the Container Network Interface file permissions are set to 600 or more restrictive (Manual)
> 确保将 Container Network Interface 文件权限设置为 600 或更严格 （Manual）

**Remediation 修复**

In MicroK8s the CNI configuration files are stored by default under `/var/snap/microk8s/current/args/cni-network/`. To comply with the CIS recommendation:
在 MicroK8s 中，CNI 配置文件默认存储在 `/var/snap/microk8s/current/args/cni-network/` .要符合 CIS 建议，请执行以下作：

```auto
chmod -R 600 /var/snap/microk8s/current/args/cni-network/
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permission set to 600
是的。权限设置为 600

**Audit 审计**

As root: 作为 root：

```auto
find /var/snap/microk8s/current/args/cni-network/10-calico.conflist -type f 2> /dev/null | xargs --no-run-if-empty stat -c permissions=%a
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.10 检查 1.1.10](https://microk8s.io/docs/how-to-cis-harden#check-1110)

> Ensure that the Container Network Interface file ownership is set to root:root (Manual)
> 确保将 Container Network Interface 文件所有权设置为 root：root （手动）

**Remediation 修复**

In MicroK8s the CNI configuration files are stored by default under `/var/snap/microk8s/current/args/cni-network/`. To comply with the CIS recommendation:
在 MicroK8s 中，CNI 配置文件默认存储在 `/var/snap/microk8s/current/args/cni-network/` .要符合 CIS 建议，请执行以下作：

```auto
chown -R root:root /var/snap/microk8s/current/args/cni-network/
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
find /var/snap/microk8s/current/args/cni-network/10-calico.conflist -type f 2> /dev/null | xargs --no-run-if-empty stat -c %U:%G
```

Expected output: 预期输出：

```auto
root:toot
```

### [Check 1.1.11 检查 1.1.11](https://microk8s.io/docs/how-to-cis-harden#check-1111)

> Ensure that the etcd data directory permissions are set to 700 or more restrictive (Automated)
> 确保 etcd 数据目录权限设置为 700 或更严格 （Automated）

**Remediation 修复**

Not applicable. MicroK8s uses dqlite as its datastore.
不適用。MicroK8s 使用 dqlite 作为其数据存储。

Dqlite data are kept by default under `/var/snap/microk8s/current/var/kubernetes/backend/`.
默认情况下，Dqlite 数据保存在 `/var/snap/microk8s/current/var/kubernetes/backend/` 下。
 To comply with the spirit of this CIS recommendation:
为了遵守本 CIS 建议的精神：

```auto
chmod -R 700 /var/snap/microk8s/current/var/kubernetes/backend/
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permission set to 700
是的。权限设置为 700

**Audit 审计**

As root: 作为 root：

```auto
stat -c permissions=%a /var/snap/microk8s/current/var/kubernetes/backend/
```

Expected output: 预期输出：

```auto
permissions=700
```

### [Check 1.1.12 检查 1.1.12](https://microk8s.io/docs/how-to-cis-harden#check-1112)

> Ensure that the etcd data directory ownership is set to etcd:etcd (Automated)
> 确保 etcd 数据目录所有权设置为 etcd：etcd （Automated）

**Remediation 修复**

Not applicable.  MicroK8s uses dqlite as its datastore owned by root.
不適用。MicroK8s 使用 dqlite 作为 root 拥有的数据存储。

Dqlite data are kept by default under `/var/snap/microk8s/current/var/kubernetes/backend/`.
默认情况下，Dqlite 数据保存在 `/var/snap/microk8s/current/var/kubernetes/backend/` 下。
 To comply with the spirit of this CIS recommendation:
为了遵守本 CIS 建议的精神：

```auto
chown -R root:root /var/snap/microk8s/current/var/kubernetes/backend/
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
stat -c %U:%G /var/snap/microk8s/current/var/kubernetes/backend/
```

Expected output: 预期输出：

```auto
root:toot
```

### [Check 1.1.13 检查 1.1.13](https://microk8s.io/docs/how-to-cis-harden#check-1113)

> Ensure that the admin.conf file permissions are set to 600 or more restrictive (Automated)
> 确保将 admin.conf 文件权限设置为 600 或更严格 （自动）

**Remediation 修复**

In MicroK8s the administration kubeconfig file is `/var/snap/microk8s/current/credentials/client.config`. The permissions of this
在 MicroK8s 中，管理 kubeconfig 文件是 `/var/snap/microk8s/current/credentials/client.config` 。此权限
 file need to be set to 600 or more restrictive:
file 需要设置为 600 或更严格：

```auto
chmod 600 /var/snap/microk8s/current/credentials/client.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600
是的。权限设置为 600

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/client.config; then stat -c permissions=%a /var/snap/microk8s/current/credentials/client.config; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.14 检查 1.1.14](https://microk8s.io/docs/how-to-cis-harden#check-1114)

> Ensure that the admin.conf file ownership is set to root:root (Automated)
> 确保 admin.conf 文件所有权设置为 root：root （Automated）

**Remediation 修复**

In MicroK8s the administration kubeconfig file is `/var/snap/microk8s/current/credentials/client.config`. The ownership of this
在 MicroK8s 中，管理 kubeconfig 文件是 `/var/snap/microk8s/current/credentials/client.config` 。此
 file need to be set to root:root:
file 需要设置为 root：root：

```auto
chown root:root /var/snap/microk8s/current/credentials/client.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership is set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/client.config; then stat -c %U:%G /var/snap/microk8s/current/credentials/client.config; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 1.1.15 检查 1.1.15](https://microk8s.io/docs/how-to-cis-harden#check-1115)

> Ensure that the scheduler.conf file permissions are set to 600 or more restrictive (Automated)
> 确保将 scheduler.conf 文件权限设置为 600 或更严格 （自动）

**Remediation 修复**

In MicroK8s the scheduler kubeconfig file is `/var/snap/microk8s/current/credentials/scheduler.config`. The permissions of this
在 MicroK8s 中，调度器 kubeconfig 文件是 `/var/snap/microk8s/current/credentials/scheduler.config` 。此权限
 file need to be set to 600 or more restrictive:
file 需要设置为 600 或更严格：

```auto
chmod 600 /var/snap/microk8s/current/credentials/scheduler.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600
是的。权限设置为 600

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/scheduler.config; then stat -c permissions=%a /var/snap/microk8s/current/credentials/scheduler.config; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.16 检查 1.1.16](https://microk8s.io/docs/how-to-cis-harden#check-1116)

> Ensure that the scheduler.conf file ownership is set to root:root (Automated)
> 确保将 scheduler.conf 文件所有权设置为 root：root （Automated）

**Remediation 修复**

In MicroK8s the scheduler kubeconfig file is `/var/snap/microk8s/current/credentials/scheduler.config`. The ownership of this
在 MicroK8s 中，调度器 kubeconfig 文件是 `/var/snap/microk8s/current/credentials/scheduler.config` 。此
 file need to be set to root:root:
file 需要设置为 root：root：

```auto
chown root:root /var/snap/microk8s/current/credentials/scheduler.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership is set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/scheduler.config; then stat -c %U:%G /var/snap/microk8s/current/credentials/scheduler.config; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 1.1.17 检查 1.1.17](https://microk8s.io/docs/how-to-cis-harden#check-1117)

> Ensure that the controller-manager.conf file permissions are set to 600 or more restrictive (Automated)
> 确保将 controller-manager.conf 文件权限设置为 600 或更严格（自动）

**Remediation 修复**

In MicroK8s the controller manager kubeconfig file is `/var/snap/microk8s/current/credentials/controller.config`. The permissions of this
在 MicroK8s 中，控制器管理器 kubeconfig 文件是 `/var/snap/microk8s/current/credentials/controller.config` 。此权限
 file need to be set to 600 or more restrictive:
file 需要设置为 600 或更严格：

```auto
chmod 600 /var/snap/microk8s/current/credentials/controller.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600
是的。权限设置为 600

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/controller.config; then stat -c permissions=%a /var/snap/microk8s/current/credentials/controller.config; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.18 检查 1.1.18](https://microk8s.io/docs/how-to-cis-harden#check-1118)

> Ensure that the controller-manager.conf file ownership is set to root:root (Automated)
> 确保 controller-manager.conf 文件所有权设置为 root：root （Automated）

**Remediation 修复**

In MicroK8s the controller manager kubeconfig file is `/var/snap/microk8s/current/credentials/controller.config`. The ownership of this
在 MicroK8s 中，控制器管理器 kubeconfig 文件是 `/var/snap/microk8s/current/credentials/controller.config` 。此
 file need to be set to root:root:
file 需要设置为 root：root：

```auto
chown root:root /var/snap/microk8s/current/credentials/controller.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership is set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/controller.config; then stat -c %U:%G /var/snap/microk8s/current/credentials/controller.config; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 1.1.19 检查 1.1.19](https://microk8s.io/docs/how-to-cis-harden#check-1119)

> Ensure that the Kubernetes PKI directory and file ownership is set to root:root (Automated)
> 确保 Kubernetes PKI 目录和文件所有权设置为 root：root （Automated）

**Remediation 修复**

In MicroK8s the certificates are stored under `/var/snap/microk8s/current/certs/`. The ownership of this
在 MicroK8s 中，证书存储在 `/var/snap/microk8s/current/certs/` .此
 directory and the included files need to be set to root:root:
目录，并且包含的文件需要设置为 root：root：

```auto
chown -R root:root /var/snap/microk8s/current/certs/
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Ownership is set to root:root
是的。所有权设置为 root：root

**Audit 审计**

As root: 作为 root：

```auto
find /var/snap/microk8s/current/certs/ | xargs stat -c %U:%G
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 1.1.20 检查 1.1.20](https://microk8s.io/docs/how-to-cis-harden#check-1120)

> Ensure that the Kubernetes PKI certificate file permissions are set to 600 or more restrictive (Manual)
> 确保将 Kubernetes PKI 证书文件权限设置为 600 或更严格（手动）

**Remediation 修复**

In MicroK8s the certificates are stored under `/var/snap/microk8s/current/certs/`. The permissions of this
在 MicroK8s 中，证书存储在 `/var/snap/microk8s/current/certs/` .此权限
 directory and the included files need to be set to 600 or more restrictive:
目录，并且包含的文件需要设置为 600 或更严格：

```auto
chmod -R 600 /var/snap/microk8s/current/certs/
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600.
是的。权限设置为 600。

**Audit 审计**

As root: 作为 root：

```auto
find /var/snap/microk8s/current/certs/ -name '*.crt' | xargs stat -c permissions=%a"
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.1.21 检查 1.1.21](https://microk8s.io/docs/how-to-cis-harden#check-1121)

> Ensure that the Kubernetes PKI key file permissions are set to 600 (Manual)
> 确保 Kubernetes PKI 密钥文件权限设置为 600（手动）

**Remediation 修复**

In MicroK8s the certificates are stored under `/var/snap/microk8s/current/certs/`. The permissions of the keys
在 MicroK8s 中，证书存储在 `/var/snap/microk8s/current/certs/` .键的权限
 included in the directory need to be set to 600 or more restrictive:
included 的目录中需要设置为 600 或更严格：

```auto
chmod -R 600 /var/snap/microk8s/current/certs/
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. Permissions set to 600.
是的。权限设置为 600。

**Audit 审计**

As root: 作为 root：

```auto
find /var/snap/microk8s/current/certs/ -name '*.key' | xargs stat -c permissions=%a
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 1.2.1 检查 1.2.1](https://microk8s.io/docs/how-to-cis-harden#check-121)

> Ensure that the `--anonymous-auth` argument is set to false (Manual)
> 确保 `--anonymous-auth` 参数设置为 false（手动）

**Remediation 修复**

In MicroK8s the API server arguments file is `/var/snap/microk8s/current/args/kube-apiserver`. Make sure `--anonymous-auth` is not present in this file.
在 MicroK8s 中，API 服务器参数文件是 `/var/snap/microk8s/current/args/kube-apiserver` 。确保此文件中不存在 `--anonymous-auth`。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. 是的。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep anonymous-auth ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.2 检查 1.2.2](https://microk8s.io/docs/how-to-cis-harden#check-122)

> Ensure that the --token-auth-file parameter is not set (Automated)
> 确保未设置 --token-auth-file 参数 （Automated）

**Remediation 修复**

Follow the documentation and configure alternate mechanisms for authentication. Then,
按照文档作并配置替代身份验证机制。然后
 edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and remove the --token-auth-file= parameter. For example,
并删除 --token-auth-file= 参数。例如
 to switch to x509 certificate authentication as root first create certificates for the admin, kubelet,
要切换到 X509 证书身份验证作为 root 先为管理员 kubelet 创建证书，
 kube-proxy, controller manager and kube-scheduler.
kube-proxy、controller manager 和 kube-scheduler 的 Kubernetes。

```auto
mkdir -p /var/tmp/certs
for user in client kubelet scheduler controller proxy; do
  openssl genrsa -out /var/tmp/certs/${user}.key 2048
done

# client/admin cert
subject="/CN=admin/O=system:masters"
openssl req -new -sha256 -key /var/tmp/certs/client.key -out /var/tmp/certs/client.csr -subj ${subject}

# kubelet cert
hostname=$(hostname | tr '[:upper:]' '[:lower:]')
echo "subjectAltName=DNS:$hostname" > /var/tmp/certs/kubelet.csr.conf
subject="/CN=system:node:${hostname}/O=system:nodes"
openssl req -new -sha256 -key /var/tmp/certs/kubelet.key -out /var/tmp/certs/kubelet.csr -subj ${subject}

# kube-proxy cert
subject="/CN=system:kube-proxy"
openssl req -new -sha256 -key /var/tmp/certs/proxy.key -out /var/tmp/certs/proxy.csr -subj ${subject}

# kube-scheduler cert
subject="/CN=system:kube-scheduler"
openssl req -new -sha256 -key /var/tmp/certs/scheduler.key -out /var/tmp/certs/scheduler.csr -subj ${subject}

# kube-controller-manager cert
subject="/CN=system:kube-controller-manager"
openssl req -new -sha256 -key /var/tmp/certs/controller.key -out /var/tmp/certs/controller.csr -subj ${subject}

for user in client scheduler controller proxy; do
  openssl x509 -req -sha256 -in /var/tmp/certs/${user}.csr -CA /var/snap/microk8s/current/certs/ca.crt -CAkey /var/snap/microk8s/current/certs/ca.key -CAcreateserial -out /var/tmp/certs/${user}.crt -days 3650
done

openssl x509 -req -sha256 -in /var/tmp/certs/kubelet.csr -CA /var/snap/microk8s/current/certs/ca.crt -CAkey /var/snap/microk8s/current/certs/ca.key -CAcreateserial -out /var/tmp/certs/kubelet.crt -days 3650 -extfile /var/tmp/certs/kubelet.csr.conf
```

Replace the kubeconfig files of the admin, kubelet, kube-proxy, controller manager and kube-scheduler:
替换 admin、kubelet、kube-proxy、controller manager 和 kube-scheduler 的 kubeconfig 文件：

```auto
create_x509_cert() {
  # Create a kubeconfig file with x509 auth
  # $1: the name of the config file
  # $2: the user to use al login
  # $3: path to certificate file
  # $4: path to certificate key file

  kubeconfig=$1
  user=$2
  cert=$3
  key=$4

  ca_data=$(cat /var/snap/microk8s/current/certs/ca.crt | base64 -w 0)
  cert_data=$(cat ${cert} | base64 -w 0)
  key_data=$(cat ${key} | base64 -w 0)
  config_file=/var/snap/microk8s/current/credentials/${kubeconfig}

  cp /snap/microk8s/current/client-x509.config.template ${config_file}
  sed -i 's/CADATA/'"${ca_data}"'/g' ${config_file}
  sed -i 's/NAME/'"${user}"'/g' ${config_file}
  sed -i 's/PATHTOCERT/'"${cert_data}"'/g' ${config_file}
  sed -i 's/PATHTOKEYCERT/'"${key_data}"'/g' ${config_file}
  sed -i 's/client-certificate/client-certificate-data/g' ${config_file}
  sed -i 's/client-key/client-key-data/g' ${config_file}
}

create_x509_cert "client.config" "admin" /var/tmp/certs/client.crt /var/tmp/certs/client.key
create_x509_cert "controller.config" "system:kube-controller-manager" /var/tmp/certs/controller.crt /var/tmp/certs/controller.key
create_x509_cert "proxy.config" "system:kube-proxy" /var/tmp/certs/proxy.crt /var/tmp/certs/proxy.key
create_x509_cert "scheduler.config" "system:kube-scheduler" /var/tmp/certs/scheduler.crt /var/tmp/certs/scheduler.key
create_x509_cert "kubelet.config" "system:node:${hostname}" /var/tmp/certs/kubelet.crt /var/tmp/certs/kubelet.key
```

Update the API server arguments:
更新 API 服务器参数：

```auto
sed -i '/--token-auth-file.*/d' /var/snap/microk8s/current/args/kube-apiserver
```

Restart `kubelite`:
重启 `kubelite`：

```auto
systemctl restart snap.microk8s.daemon-kubelite
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. Starting from v1.28 the default MicroK8s setup does not use token based authentication.
不。从 v1.28 开始，默认的 MicroK8s 设置不使用基于令牌的身份验证。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep token-auth-file ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.3 检查 1.2.3](https://microk8s.io/docs/how-to-cis-harden#check-123)

> Ensure that the `--DenyServiceExternalIPs` is not set (Automated)
> 确保未设置 `--DenyServiceExternalIPs` （Automated）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and remove the `DenyServiceExternalIPs`
并删除 `DenyServiceExternalIPs`
 from enabled admission plugins.
从启用的准入插件。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default MicroK8s setup does not enable the `DenyServiceExternalIPs`
不。默认的 MicroK8s 设置不启用 `DenyServiceExternalIPs`
 admission plugin. Admission 插件。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep DenyServiceExternalIPs ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.4 检查 1.2.4](https://microk8s.io/docs/how-to-cis-harden#check-124)

> Ensure that the --kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate (Automated)
> 确保 --kubelet-client-certificate 和 --kubelet-client-key 参数设置得适当（自动）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set the two arguments appropriately:
在 control plane 节点上，并适当地设置两个参数：

```auto
--kubelet-client-certificate=${SNAP_DATA}/certs/server.crt
--kubelet-client-key=${SNAP_DATA}/certs/server.key
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default MicroK8s setup sets these arguments.
不。默认的 MicroK8s 设置设置这些参数。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep kubelet-client-certificate && cat /var/snap/microk8s/current/args/kube-apiserver | grep  kubelet-client-key
```

Expected output: 预期输出：

```auto
--kubelet-client-certificate=${SNAP_DATA}/certs/server.crt
--kubelet-client-key=${SNAP_DATA}/certs/server.key
```

### [Check 1.2.5 检查 1.2.5](https://microk8s.io/docs/how-to-cis-harden#check-125)

> Ensure that the `--kubelet-certificate-authority` argument is set as appropriate (Automated)
>  `--kubelet-certificate-authority` 确保参数设置为适当 （Automated）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set:
在 control plane 节点上，并设置：

```auto
--kubelet-certificate-authority=${SNAP_DATA}/certs/ca.crt
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, `--kubelet-certificate-authority` is set.
是的， `--kubelet-certificate-authority` 已设置。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep kubelet-certificate-authority
```

Expected output: 预期输出：

```auto
--kubelet-certificate-authority=${SNAP_DATA}/certs/ca.crt
```

### [Check 1.2.6 检查 1.2.6](https://microk8s.io/docs/how-to-cis-harden#check-126)

> Ensure that the `--authorization-mode` argument is not set to AlwaysAllow (Automated)
> 确保 `--authorization-mode` 参数未设置为 AlwaysAllow （Automated）

**Remediation 修复**

Enable RBAC by calling: 通过调用启用 RBAC：

```auto
microk8s enable rbac
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The RBAC addon is enabled as part of the CIS hardening.
是的。RBAC 插件作为 CIS 强化的一部分启用。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep -e "authorization-mode.*AlwaysAllow" ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.7 检查 1.2.7](https://microk8s.io/docs/how-to-cis-harden#check-127)

> Ensure that the `--authorization-mode` argument includes Node (Automated)
> 确保 `--authorization-mode` 参数包括 Node （Automated）

**Remediation 修复**

Enable RBAC by calling: 通过调用启用 RBAC：

```auto
microk8s enable rbac
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The RBAC addon is enabled as part of the CIS hardening.
是的。RBAC 插件作为 CIS 强化的一部分启用。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep -e "authorization-mode.*Node"
```

Expected output: 预期输出：

```auto
--authorization-mode=RBAC,Node
```

### [Check 1.2.8 检查 1.2.8](https://microk8s.io/docs/how-to-cis-harden#check-128)

> Ensure that the --authorization-mode argument includes RBAC (Automated)
> 确保 --authorization-mode 参数包括 RBAC （Automated）

**Remediation 修复**

Enable RBAC by calling: 通过调用启用 RBAC：

```auto
microk8s enable rbac
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The RBAC addon is enabled as part of the CIS hardening.
是的。RBAC 插件作为 CIS 强化的一部分启用。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep -e "authorization-mode.*RBAC"
```

Expected output: 预期输出：

```auto
--authorization-mode=RBAC,Node
```

### [Check 1.2.9 检查 1.2.9](https://microk8s.io/docs/how-to-cis-harden#check-129)

> Ensure that the admission control plugin EventRateLimit is set (Manual)
> 确保设置准入控制插件 EventRateLimit（手动）

**Remediation 修复**

Follow the Kubernetes documentation and set the desired event rate limits in a configuration file. One such example file would be:
按照 Kubernetes 文档进行作，并在配置文件中设置所需的事件速率限制。一个这样的示例文件是：

```auto
apiVersion: eventratelimit.admission.k8s.io/v1alpha1
kind: Configuration
limits:
  - type: Namespace
    qps: 50
    burst: 100
    cacheSize: 2000
  - type: User
    qps: 10
    burst: 50
```

Place this file in `/var/snap/microk8s/current/args/`, and name it `eventconfig.yaml`.
将此文件放在 `/var/snap/microk8s/current/args/` 中，并将其命名为 `eventconfig.yaml`。

Create a file to point to the admission configurations:
创建一个文件以指向准入配置：

```auto
apiVersion: apiserver.config.k8s.io/v1
kind: AdmissionConfiguration
plugins:
  - name: EventRateLimit
    path: eventconfig.yaml
```

Place this file in `/var/snap/microk8s/current/args/` and name it `admission-control-config-file.yaml`.
将此文件放入 `/var/snap/microk8s/current/args/` 并命名为 `admission-control-config-file.yaml` 。

Edit the API server arguments file /var/snap/microk8s/current/args/kube-apiserver
编辑 API 服务器参数文件 /var/snap/microk8s/current/args/kube-apiserver
 and set the arguments: 并设置参数：

```auto
--enable-admission-plugins=...,EventRateLimit,...,
--admission-control-config-file=${SNAP_DATA}/args/admission-control-config-file.yaml
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The above remediation is applied.
是的。应用上述补救措施。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep EventRateLimit && cat /var/snap/microk8s/current/args/kube-apiserver | grep  admission-control-config-file
```

Expected output: 预期输出：

```auto
--enable-admission-plugins=EventRateLimit,AlwaysPullImages,NodeRestriction
--admission-control-config-file=${SNAP_DATA}/args/admission-control-config-file.yaml
```

### [Check 1.2.10 检查 1.2.10](https://microk8s.io/docs/how-to-cis-harden#check-1210)

> Ensure that the admission control plugin AlwaysAdmit is not set (Automated)
> 确保未设置准入控制插件 AlwaysAdmit （Automated）

**Remediation 修复**

Follow the Kubernetes documentation and set the `--enable-admission-plugins` in `/var/snap/microk8s/current/args/kube-apiserver` to a value that does not include `AlwaysAdmit`.
按照 Kubernetes 文档将 `--enable-admission-plugins` 设置为 `/var/snap/microk8s/current/args/kube-apiserver` 不包含 `AlwaysAdmit` 的值。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. `--enable-admission-plugins` is set to `EventRateLimit,AlwaysPullImages,NodeRestriction`.
是的。`--enable-admission-plugins` 设置为 `EventRateLimit,AlwaysPullImages,NodeRestriction` 。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep -e "--enable-admission-plugins.*AlwaysAdmit.*" ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.11 检查 1.2.11](https://microk8s.io/docs/how-to-cis-harden#check-1211)

> Ensure that the admission control plugin AlwaysPullImages is set (Manual)
> 确保已设置准入控制插件 AlwaysPullImages（手动）

**Remediation 修复**

Edit ``/var/snap/microk8s/current/args/kube-apiserver`to include`AlwaysPullImages`in the`–enable-admission-plugins`.
编辑 ''/var/snap/microk8s/current/args/kube-apiserver`，将`AlwaysPullImages 包含在 –enable-admission-plugins'`中`。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. `--enable-admission-plugins` is set to `EventRateLimit,AlwaysPullImages,NodeRestriction`.
是的。`--enable-admission-plugins` 设置为 `EventRateLimit,AlwaysPullImages,NodeRestriction` 。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kube-apiserver | grep -e "--enable-admission-plugins.*AlwaysPullImages.*"
```

Expected output: 预期输出：

```auto
--enable-admission-plugins=EventRateLimit,AlwaysPullImages,NodeRestriction
```

### [Check 1.2.12 检查 1.2.12](https://microk8s.io/docs/how-to-cis-harden#check-1212)

> Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used (Manual)
> 如果未使用 PodSecurityPolicy，请确保设置准入控制插件 SecurityContextDeny（手动）

**Remediation 修复**

Not applicable. Both PodSecurityPolicy and SecurityContextDeny have been deprecated. See:
不適用。PodSecurityPolicy 和 SecurityContextDeny 都已被弃用。看：

- [Admission Controllers Reference | Kubernetes
  准入控制器参考 |Kubernetes （简体中文）](https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#securitycontextdeny)
- [Pod Security Policies | Kubernetes
  Pod 安全策略 |Kubernetes （简体中文）](https://kubernetes.io/docs/concepts/security/pod-security-policy/)

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. 不。

**Audit 审计**

As root: 作为 root：

```auto
grep 'SecurityContextDeny\|PodSecurityPolicy' /var/snap/microk8s/current/args/kube-apiserver ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.13 检查 1.2.13](https://microk8s.io/docs/how-to-cis-harden#check-1213)

> Ensure that the admission control plugin ServiceAccount is set (Automated)
> 确保已设置准入控制插件 ServiceAccount （Automated）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 and ensure that the `--disable-admission-plugins` parameter is set to a
并确保 `--disable-admission-plugins` 参数设置为
 value that does not include ServiceAccount.
值，该值不包括 ServiceAccount。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default MicroK8s setup does not `--disable-admission-plugins`.
不。默认的 MicroK8s 设置不会 `--disable-admission-plugins`。

**Audit 审计**

As root: 作为 root：

```auto
grep -e 'disable-admission-plugins.*ServiceAccount.*' /var/snap/microk8s/current/args/kube-apiserver ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.14 检查 1.2.14](https://microk8s.io/docs/how-to-cis-harden#check-1214)

> Ensure that the admission control plugin NamespaceLifecycle is set (Automated)
> 确保已设置准入控制插件 NamespaceLifecycle （Automated）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 and ensure that the `--disable-admission-plugins` parameter is set to a
并确保 `--disable-admission-plugins` 参数设置为
 value that does not include NamespaceLifecycle.
值，该值不包含 NamespaceLifecycle。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default MicroK8s setup does not `--disable-admission-plugins`.
不。默认的 MicroK8s 设置不会 `--disable-admission-plugins`。

**Audit 审计**

As root: 作为 root：

```auto
grep -e 'disable-admission-plugins.*NamespaceLifecycle.*' /var/snap/microk8s/current/args/kube-apiserver ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.15 检查 1.2.15](https://microk8s.io/docs/how-to-cis-harden#check-1215)

> Ensure that the admission control plugin NodeRestriction is set (Automated)
> 确保已设置准入控制插件 NodeRestriction （Automated）

**Remediation 修复**

Follow the Kubernetes documentation and configure NodeRestriction plug-in on kubelets.
按照 Kubernetes 文档在 kubelet 上配置 NodeRestriction 插件。
 Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set the `--enable-admission-plugins` parameter to a
并在 control plane 节点上将 `--enable-admission-plugins` 参数设置为
 value that includes NodeRestriction:
包含 NodeRestriction 的值：

```auto
--enable-admission-plugins=...,NodeRestriction,...
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. `--enable-admission-plugins` is set to `EventRateLimit,AlwaysPullImages,NodeRestriction`.
是的。`--enable-admission-plugins` 设置为 `EventRateLimit,AlwaysPullImages,NodeRestriction` 。

**Audit 审计**

As root: 作为 root：

```auto
grep -e 'enable-admission-plugins.*NodeRestriction.*' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--enable-admission-plugins=EventRateLimit,AlwaysPullImages,NodeRestriction
```

### [Check 1.2.16 检查 1.2.16](https://microk8s.io/docs/how-to-cis-harden#check-1216)

> Ensure that the `--secure-port` argument is not set to 0 (Automated)
> 确保 `--secure-port` 参数未设置为 0（自动）

**Remediation 修复**

Follow the Kubernetes documentation and configure NodeRestriction plug-in on kubelets.
按照 Kubernetes 文档在 kubelet 上配置 NodeRestriction 插件。
 Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 and either remove the `--secure-port` parameter or set it to a different (non-zero) desired port.
并删除 `--secure-port` 参数或将其设置为其他（非零）所需端口。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets the `--secure-port` parameter to 16443.
不。默认设置将 `--secure-port` 参数设置为 16443。

**Audit 审计**

As root: 作为 root：

```auto
grep -e 'secure-port' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--secure-port=16443
```

### [Check 1.2.17 检查 1.2.17](https://microk8s.io/docs/how-to-cis-harden#check-1217)

> Ensure that the `--profiling` argument is set to false (Automated)
> 确保 `--profiling` 参数设置为 false （Automated）

**Remediation 修复**

Follow the Kubernetes documentation and configure the below parameter:
按照 Kubernetes 文档并配置以下参数：

```auto
--profiling=false
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter to a proper value.
不。默认设置将此参数设置为适当的值。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--profiling' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--profiling=false
```

### [Check 1.2.18 检查 1.2.18](https://microk8s.io/docs/how-to-cis-harden#check-1218)

> Ensure that the `--audit-log-path` argument is set (Automated)
> 确保设置了 `--audit-log-path` 参数（自动）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set the `--audit-log-path` parameter to a suitable path and
在控制平面节点上，将 `--audit-log-path` 参数设置为合适的路径，并将
 file where you would like audit logs to be written, for example:
文件，例如：

```auto
--audit-log-path=/var/log/apiserver/audit.log
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The `--audit-log-path` is set to `/var/log/apiserver/audit.log`.
是的。`--audit-log-path` 设置为 `/var/log/apiserver/audit.log`。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--audit-log-path' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--audit-log-path=/var/log/apiserver/audit.log
```

### [Check 1.2.19 检查 1.2.19](https://microk8s.io/docs/how-to-cis-harden#check-1219)

> Ensure that the `--audit-log-maxage` argument is set to 30 or as appropriate (Automated)
> 确保将 `--audit-log-maxage` 参数设置为 30 或适当 （Automated）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set the `--audit-log-maxage` parameter to 30
在 Control Plane 节点上，并将 `--audit-log-maxage` 参数设置为 30
 or as an appropriate number of days, for example:
或适当的天数，例如：

```auto
--audit-log-maxage=30
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The `--audit-log-maxage` is set to 30.
是的。`--audit-log-maxage` 设置为 30。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--audit-log-maxage' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--audit-log-maxage=30
```

### [Check 1.2.20 检查 1.2.20](https://microk8s.io/docs/how-to-cis-harden#check-1220)

> Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate (Automated)
> 确保 --audit-log-maxbackup 参数设置为 10 或适当 （Automated）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set the `--audit-log-maxbackup` parameter to 10 or to an appropriate
并将 `--audit-log-maxbackup` 参数设置为 10 或适当的
 value, for example: 值，例如：

```auto
--audit-log-maxbackup=10
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The `--audit-log-maxbackup` is set to 10.
是的。`--audit-log-maxbackup` 设置为 10。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--audit-log-maxbackup' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--audit-log-maxbackup=10
```

### [Check 1.2.21 检查 1.2.21](https://microk8s.io/docs/how-to-cis-harden#check-1221)

> Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate (Automated)
> 确保 --audit-log-maxsize 参数设置为 100 或适当 （Automated）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set the `--audit-log-maxsize argument` parameter to 100 or to an appropriate
并在 control plane 节点上将 `--audit-log-maxsize 参数`参数设置为 100 或适当的
 value, for example: 值，例如：

```auto
--audit-log-maxsize argument=100
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The `--audit-log-maxsize` is set to 100.
是的。`--audit-log-maxsize` 设置为 100。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--audit-log-maxsize' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--audit-log-maxsize=100
```

### [Check 1.2.22 检查 1.2.22](https://microk8s.io/docs/how-to-cis-harden#check-1222)

> Ensure that the --request-timeout argument is set as appropriate (Manual)
> 确保 --request-timeout 参数设置得合适（手动）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 and set the below parameter as appropriate and if needed, for example:
并根据需要设置以下参数，例如：

```auto
--request-timeout=300s
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The `--request-timeout` is set to 300s.
是的。`--request-timeout` 设置为 300 秒。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--request-timeout' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--request-timeout=300s
```

### [Check 1.2.23 检查 1.2.23](https://microk8s.io/docs/how-to-cis-harden#check-1223)

> Ensure that the --service-account-lookup argument is set to true (Automated)
> 确保 --service-account-lookup 参数设置为 true（自动）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set the below parameter.
在 Control Plane 节点上并设置以下参数。

```auto
--service-account-lookup=true
```

Alternatively, you can delete the `--service-account-lookup` parameter from this file so
或者，您可以从此文件中删除 `--service-account-lookup` 参数，以便
 that the default takes effect.
默认值生效。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup does not set this parameter.
不。默认设置不设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--service-account-lookup' /var/snap/microk8s/current/args/kube-apiserver ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.2.24 检查 1.2.24](https://microk8s.io/docs/how-to-cis-harden#check-1224)

> Ensure that the --service-account-key-file argument is set as appropriate (Automated)
> 确保 --service-account-key-file 参数设置得适当 （Automated）

**Remediation 修复**

Edit the API server arguments file `/var/snap/microk8s/current/args/kube-apiserver`
编辑 API 服务器参数文件 `/var/snap/microk8s/current/args/kube-apiserver` 
 on the control plane node and set the --service-account-key-file parameter
在 control plane 节点上，并设置 --service-account-key-file 参数
 to the public key file for service accounts. For example,
添加到服务账户的公钥文件。例如

```auto
--service-account-key-file=${SNAP_DATA}/certs/serviceaccount.key
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter properly.
不。默认设置会正确设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--service-account-key-file' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--service-account-key-file=${SNAP_DATA}/certs/serviceaccount.key
```

### [Check 1.2.25 检查 1.2.25](https://microk8s.io/docs/how-to-cis-harden#check-1225)

> Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate (Automated)
> 确保 --etcd-certfile 和 --etcd-keyfile 参数设置得适当（自动）

**Remediation 修复**

Not applicable. MicroK8s used dqlite and the communication to this service is done through a
不適用。MicroK8s 使用 dqlite，与此服务的通信是通过
 local socket (`/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379`) accessible
本地套接字 （ `/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379` ） 可访问
 to users with root permissions.
分配给具有 root 权限的用户。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. Not applicable. 不。不適用。

**Audit 审计**

Not applicable. 不適用。

### [Check 1.2.26 检查 1.2.26](https://microk8s.io/docs/how-to-cis-harden#check-1226)

> Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (Automated)
> 确保 --tls-cert-file 和 --tls-private-key-file 参数设置得适当（自动）

**Remediation 修复**

Follow the Kubernetes documentation and set up the TLS connection on the apiserver.
按照 Kubernetes 文档在 API 服务器上设置 TLS 连接。
 Then, edit the API server pod specification file /var/snap/microk8s/current/args/kube-apiserver
然后，编辑 API 服务器 Pod 规范文件 /var/snap/microk8s/current/args/kube-apiserver
 on the control plane node and set the TLS certificate and private key file parameters.
并设置 TLS 证书和私有密钥文件参数。

```auto
--tls-cert-file=${SNAP_DATA}/certs/server.crt
--tls-private-key-file=${SNAP_DATA}/certs/server.key
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets these parameters appropriately.
不。默认设置会适当地设置这些参数。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--tls-cert-file\|--tls-private-key-file' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--tls-cert-file=${SNAP_DATA}/certs/server.crt
--tls-private-key-file=${SNAP_DATA}/certs/server.key
```

### [Check 1.2.27 检查 1.2.27](https://microk8s.io/docs/how-to-cis-harden#check-1227)

> Ensure that the --client-ca-file argument is set as appropriate (Automated)
> 确保 --client-ca-file 参数设置得适当 （Automated）

**Remediation 修复**

Follow the Kubernetes documentation and set up the TLS connection on the apiserver.
按照 Kubernetes 文档在 API 服务器上设置 TLS 连接。
 Then, edit the API server pod specification file /var/snap/microk8s/current/args/kube-apiserver
然后，编辑 API 服务器 Pod 规范文件 /var/snap/microk8s/current/args/kube-apiserver
 on the control plane node and set the client certificate authority file:
在 control plane 节点上，并设置客户端证书颁发机构文件：

```auto
--client-ca-file=${SNAP_DATA}/certs/ca.crt
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter appropriately.
不。默认设置会相应地设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--client-ca-file' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--client-ca-file=${SNAP_DATA}/certs/ca.crt
```

### [Check 1.2.28 检查 1.2.28](https://microk8s.io/docs/how-to-cis-harden#check-1228)

> Ensure that the --etcd-cafile argument is set as appropriate (Automated)
> 确保 --etcd-cafile 参数设置得适当（自动）

**Remediation 修复**

Not applicable. MicroK8s used dqlite and the communication to this service is done through a
不適用。MicroK8s 使用 dqlite，与此服务的通信是通过
 local socket (`/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379`) accessible
本地套接字 （ `/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379` ） 可访问
 to users with root permissions.
分配给具有 root 权限的用户。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. Not applicable. 不。不適用。

**Audit 审计**

Not applicable. 不適用。

### [Check 1.2.29 检查 1.2.29](https://microk8s.io/docs/how-to-cis-harden#check-1229)

> Ensure that the --encryption-provider-config argument is set as appropriate (Manual)
> 确保 --encryption-provider-config 参数设置得合适（手动）

**Remediation 修复**

Follow the Kubernetes documentation and configure a EncryptionConfig file.
按照 Kubernetes 文档并配置 EncryptionConfig 文件。
 Then, edit the API server pod specification file /var/snap/microk8s/current/args/kube-apiserver
然后，编辑 API 服务器 Pod 规范文件 /var/snap/microk8s/current/args/kube-apiserver
 on the control plane node and set the --encryption-provider-config parameter to the path of that file.
并在 control plane 节点上将 --encryption-provider-config 参数设置为该文件的路径。
 For example, 例如

```auto
--encryption-provider-config=</path/to/EncryptionConfig/File>
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. This is a warning.
不。这是一个警告。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--encryption-provider-config' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--encryption-provider-config=</path/to/EncryptionConfig/File>
```

### [Check 1.2.30 检查 1.2.30](https://microk8s.io/docs/how-to-cis-harden#check-1230)

> Ensure that encryption providers are appropriately configured (Manual)
> 确保加密提供程序配置正确（手动）

**Remediation 修复**

Follow the Kubernetes documentation and configure a EncryptionConfig file.
按照 Kubernetes 文档并配置 EncryptionConfig 文件。
 In this file, choose aescbc, kms or secretbox as the encryption provider.
在此文件中，选择 aescbc、kms 或 secretbox 作为加密提供程序。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. This is a warning.
不。这是一个警告。

**Audit 审计**

As root: 作为 root：

```auto
grep -e 'aescbc\|kms\|secretbox' /path/to/encryption/providers/file ; echo $?
```

Expected output: 预期输出：

```auto
0
```

### [Check 1.2.31 检查 1.2.31](https://microk8s.io/docs/how-to-cis-harden#check-1231)

> Ensure that the API Server only makes use of Strong Cryptographic Ciphers (Manual)
> 确保 API 服务器仅使用强加密密码（手动）

**Remediation 修复**

Edit the API server arguments file /var/snap/microk8s/current/args/kube-apiserver
编辑 API 服务器参数文件 /var/snap/microk8s/current/args/kube-apiserver
 on the control plane node and set the below parameter.
在 Control Plane 节点上并设置以下参数。

```auto
--tls-cipher-suites=TLS_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_CHACHA20_POLY1305_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_GCM_SHA384
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, Strong Cryptographic Ciphers are configured.
是的，配置了强加密密码。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--tls-cipher-suites' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--tls-cipher-suites=TLS_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384,TLS_CHACHA20_POLY1305_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,TLS_RSA_WITH_3DES_EDE_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_256_GCM_SHA384
```

### [Check 1.3.1 检查 1.3.1](https://microk8s.io/docs/how-to-cis-harden#check-131)

> Ensure that the --terminated-pod-gc-threshold argument is set as appropriate (Manual)
> 确保 --terminated-pod-gc-threshold 参数设置得适当（手动）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-controller-manager
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-controller-manager
 on the control plane node and set the --terminated-pod-gc-threshold to an appropriate threshold,
并在 control plane 节点上将 --terminated-pod-gc-threshold 设置为适当的阈值，
 for example: 例如：

```auto
--terminated-pod-gc-threshold=10
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The parameter `--terminated-pod-gc-threshold=10` is set.
是的。参数 `--terminated-pod-gc-threshold=10` 已设置。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--terminated-pod-gc-threshold' /var/snap/microk8s/current/args/kube-controller-manager
```

Expected output: 预期输出：

```auto
--terminated-pod-gc-threshold=10
```

### [Check 1.3.2 检查 1.3.2](https://microk8s.io/docs/how-to-cis-harden#check-132)

> Ensure that the `--profiling` argument is set to false (Automated)
> 确保 `--profiling` 参数设置为 false （Automated）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-controller-manager
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-controller-manager
 to configure the below parameter:
配置以下参数：

```auto
--profiling=false
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter to a proper value.
不。默认设置将此参数设置为适当的值。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--profiling' /var/snap/microk8s/current/args/kube-controller-manager
```

Expected output: 预期输出：

```auto
--profiling=false
```

### [Check 1.3.3 检查 1.3.3](https://microk8s.io/docs/how-to-cis-harden#check-133)

> Ensure that the --use-service-account-credentials argument is set to true (Automated)
> 确保 --use-service-account-credentials 参数设置为 true（自动）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-controller-manager
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-controller-manager
 and set the below parameter:
并设置以下参数：

```auto
--use-service-account-credentials=true
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter to a proper value.
不。默认设置将此参数设置为适当的值。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--use-service-account-credentials' /var/snap/microk8s/current/args/kube-controller-manager
```

Expected output: 预期输出：

```auto
--use-service-account-credentials
```

### [Check 1.3.4 检查 1.3.4](https://microk8s.io/docs/how-to-cis-harden#check-134)

> Ensure that the --service-account-private-key-file argument is set as appropriate (Automated)
> 确保 --service-account-private-key-file 参数设置得适当（自动）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-controller-manager
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-controller-manager
 and set the below parameter:
并设置以下参数：

```auto
--service-account-private-key-file=${SNAP_DATA}/certs/serviceaccount.key
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter to a proper value.
不。默认设置将此参数设置为适当的值。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--service-account-private-key-file' /var/snap/microk8s/current/args/kube-controller-manager
```

Expected output: 预期输出：

```auto
--service-account-private-key-file=${SNAP_DATA}/certs/serviceaccount.key
```

### [Check 1.3.5 检查 1.3.5](https://microk8s.io/docs/how-to-cis-harden#check-135)

> Ensure that the --root-ca-file argument is set as appropriate (Automated)
> 确保 --root-ca-file 参数设置得适当（自动）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-controller-manager
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-controller-manager
 and set the --root-ca-file parameter to the certificate bundle file:
，并将 --root-ca-file 参数设置为证书包文件：

```auto
--root-ca-file=${SNAP_DATA}/certs/ca.crt
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter to a proper value.
不。默认设置将此参数设置为适当的值。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--root-ca-file' /var/snap/microk8s/current/args/kube-controller-manager
```

Expected output: 预期输出：

```auto
--root-ca-file=${SNAP_DATA}/certs/ca.crt
```

### [Check 1.3.6 检查 1.3.6](https://microk8s.io/docs/how-to-cis-harden#check-136)

> Ensure that the RotateKubeletServerCertificate argument is set to true (Automated)
> 确保 RotateKubeletServerCertificate 参数设置为 true（自动）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-controller-manager
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-controller-manager
 and set the --feature-gates parameter to include RotateKubeletServerCertificate=true.
并设置 --feature-gates 参数以包含 RotateKubeletServerCertificate=true。

```auto
--feature-gates=RotateKubeletServerCertificate=true
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup does not set any feature-gates so the RotateKubeletServerCertificate is enabled by default.
不。默认设置没有设置任何特性门控，因此 RotateKubeletServerCertificate 默认处于启用状态。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--feature-gates' /var/snap/microk8s/current/args/kube-controller-manager ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.3.7 检查 1.3.7](https://microk8s.io/docs/how-to-cis-harden#check-137)

> Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)
> 确保 --bind-address 参数设置为 127.0.0.1 （自动）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-controller-manager
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-controller-manager
 and ensure the correct value for the --bind-address parameter.
并确保 --bind-address 参数的值正确。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup does not set --bind-address it defaults to an appropriate value.
不。默认设置不设置 --bind-address，它默认为适当的值。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--bind-address' /var/snap/microk8s/current/args/kube-controller-manager ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 1.4.1 检查 1.4.1](https://microk8s.io/docs/how-to-cis-harden#check-141)

> Ensure that the `--profiling` argument is set to false (Automated)
> 确保 `--profiling` 参数设置为 false （Automated）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-scheduler
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-scheduler
 to configure the below parameter:
配置以下参数：

```auto
--profiling=false
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter to a proper value.
不。默认设置将此参数设置为适当的值。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--profiling' /var/snap/microk8s/current/args/kube-scheduler
```

Expected output: 预期输出：

```auto
--profiling=false
```

### [Check 1.4.2 检查 1.4.2](https://microk8s.io/docs/how-to-cis-harden#check-142)

> Ensure that the --bind-address argument is set to 127.0.0.1 (Automated)
> 确保 --bind-address 参数设置为 127.0.0.1 （自动）

**Remediation 修复**

Edit the Controller Manager arguments file /var/snap/microk8s/current/args/kube-scheduler
编辑控制器管理器参数文件 /var/snap/microk8s/current/args/kube-scheduler
 and ensure the correct value for the --bind-address parameter.
并确保 --bind-address 参数的值正确。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup does not set --bind-address it defaults to an appropriate value.
不。默认设置不设置 --bind-address，它默认为适当的值。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--bind-address' /var/snap/microk8s/current/args/kube-scheduler ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Etcd Node Configuration, for dqlite etcd 节点配置，用于 dqlite](https://microk8s.io/docs/how-to-cis-harden#etcd-node-configuration-for-dqlite)

### [Check 2.1 检查 2.1](https://microk8s.io/docs/how-to-cis-harden#check-21)

> Ensure that the --cert-file and --key-file arguments are set as appropriate (Automated)
> 确保 --cert-file 和 --key-file 参数设置得适当（自动）

**Remediation 修复**

Not applicable. MicroK8s used dqlite and the communication to this service is done through a
不適用。MicroK8s 使用 dqlite，与此服务的通信是通过
 local socket (`/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379`) accessible
本地套接字 （ `/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379` ） 可访问
 to users with root permissions.
分配给具有 root 权限的用户。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. Not applicable. 不。不適用。

**Audit 审计**

Not applicable. 不適用。

### [Check 2.2 检查 2.2](https://microk8s.io/docs/how-to-cis-harden#check-22)

> Ensure that the --client-cert-auth argument is set to true (Automated)
> 确保 --client-cert-auth 参数设置为 true （Automated）

**Remediation 修复**

Not applicable. MicroK8s used dqlite and the communication to this service is done through a
不適用。MicroK8s 使用 dqlite，与此服务的通信是通过
 local socket (`/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379`) accessible
本地套接字 （ `/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379` ） 可访问
 to users with root permissions.
分配给具有 root 权限的用户。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. Not applicable. 不。不適用。

**Audit 审计**

Not applicable. 不適用。

### [Check 2.3 检查 2.3](https://microk8s.io/docs/how-to-cis-harden#check-23)

> Ensure that the --auto-tls argument is not set to true (Automated)
> 确保 --auto-tls 参数未设置为 true （Automated）

**Remediation 修复**

Not applicable. MicroK8s used dqlite and the communication to this service is done through a
不適用。MicroK8s 使用 dqlite，与此服务的通信是通过
 local socket (`/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379`) accessible
本地套接字 （ `/var/snap/microk8s/current/var/kubernetes/backend/kine.sock:12379` ） 可访问
 to users with root permissions.
分配给具有 root 权限的用户。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. Not applicable. 不。不適用。

**Audit 审计**

Not applicable. 不適用。

### [Check 2.4 检查 2.4](https://microk8s.io/docs/how-to-cis-harden#check-24)

> Ensure that the --peer-cert-file and --peer-key-file arguments are set as appropriate (Automated)
> 确保 --peer-cert-file 和 --peer-key-file 参数设置为适当（自动）

**Remediation 修复**

MicroK8s used dqlite and tls peer communication uses the certificate pair
MicroK8s 使用 dqlite，TLS 对等通信使用证书对
 `/var/snap/microk8s/current/var/kubernetes/backend/cluster.crt` and  `/var/snap/microk8s/current/var/kubernetes/backend/cluster.crt` 和
 `/var/snap/microk8s/current/var/kubernetes/backend/cluster.key`.

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default configuration enables TLS.
不。默认配置启用 TLS。

**Audit 审计**

As root: 作为 root：

```auto
if [ -e /var/snap/microk8s/current/var/kubernetes/backend/cluster.crt ] &&
  [ -e /var/snap/microk8s/current/var/kubernetes/backend/cluster.key ];
then
  echo 'certs-found';
fi
```

Expected output: 预期输出：

```auto
certs-found
```

### [Check 2.5 检查 2.5](https://microk8s.io/docs/how-to-cis-harden#check-25)

> Ensure that the --peer-client-cert-auth argument is set to true (Automated)
> 确保 --peer-client-cert-auth 参数设置为 true（自动）

**Remediation 修复**

MicroK8s used dqlite and tls peer communication always uses is TLS unless the `--enable-tls` is set to false in
MicroK8s 使用的 dqlite 和 tls 对等通信始终使用 TLS，除非 `--enable-tls` 在
 `/var/snap/microk8s/current/args/k8s-dqlite`.

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default configuration enables TLS.
不。默认配置启用 TLS。

**Audit 审计**

As root: 作为 root：

```auto
grep enable-tls /var/snap/microk8s/current/args/k8s-dqlite
```

Expected no output or: 预期无输出或：

```auto
--enable-tls=true
```

### [Check 2.6 检查 2.6](https://microk8s.io/docs/how-to-cis-harden#check-26)

> Ensure that the --peer-auto-tls argument is not set to true (Automated)
> 确保 --peer-auto-tls 参数未设置为 true（自动）

**Remediation 修复**

Not applicable. MicroK8s used dqlite and tls peer communication uses the certificates
不適用。MicroK8s 使用 dqlite 和 tls 对等通信使用证书
 created upon the snap creation.
在创建捕捉时创建。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. Not applicable. 不。不適用。

**Audit 审计**

Not applicable. 不適用。

### [Check 2.7 检查 2.7](https://microk8s.io/docs/how-to-cis-harden#check-27)

> Ensure that a unique Certificate Authority is used for etcd (Manual)
> 确保 etcd 使用唯一的证书颁发机构（手动）

**Remediation 修复**

Not applicable. MicroK8s used dqlite and tls peer communication uses the certificates
不適用。MicroK8s 使用 dqlite 和 tls 对等通信使用证书
 created upon the snap creation.
在创建捕捉时创建。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. Not applicable. 不。不適用。

**Audit 审计**

Not applicable. 不適用。

### [Control Plane Configuration 控制平面配置](https://microk8s.io/docs/how-to-cis-harden#control-plane-configuration)

### [Check 3.1.1 检查 3.1.1](https://microk8s.io/docs/how-to-cis-harden#check-311)

> Client certificate authentication should not be used for users (Manual)
> 客户端证书身份验证不应用于用户（手动）

**Remediation 修复**

Alternative mechanisms provided by Kubernetes such as the use of OIDC should be
Kubernetes 提供的替代机制（例如使用 OIDC）应该是
 implemented in place of client certificates.
代替客户端证书实现。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. This is a manual configuration step.
不。这是一个手动配置步骤。

### [Check 3.2.1 检查 3.2.1](https://microk8s.io/docs/how-to-cis-harden#check-321)

> Ensure that a minimal audit policy is created (Manual)
> 确保创建最小审核策略 （手动）

**Remediation 修复**

Create an audit policy file for your cluster. Here is a minimal one:
为您的集群创建审计策略文件。下面是一个最小的：

```auto
# Log all requests at the Metadata level.
apiVersion: audit.k8s.io/v1
kind: Policy
rules:
- level: Metadata
```

Save this file under `/var/snap/microk8s/current/args/audit-policy.yaml` and point to it
将此文件保存在 `/var/snap/microk8s/current/args/audit-policy.yaml` 并指向它
 in the `/var/snap/microk8s/current/args/kube-apiserver` with:
在 `/var/snap/microk8s/current/args/kube-apiserver` ：

```auto
--audit-policy-file=${SNAP_DATA}/args/audit-policy.yaml
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the above minimal policy is applied.
是的，应用了上述最低策略。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--audit-policy-file' /var/snap/microk8s/current/args/kube-apiserver
```

Expected output: 预期输出：

```auto
--audit-policy-file=${SNAP_DATA}/args/audit-policy.yaml
```

### [Check 3.2.2 检查 3.2.2](https://microk8s.io/docs/how-to-cis-harden#check-322)

> Ensure that the audit policy covers key security concerns (Manual)
> 确保审计策略涵盖关键安全问题（手动）

**Remediation 修复**

Review the audit policy provided for the cluster and ensure that it covers
查看为集群提供的审核策略，并确保它涵盖
 at least the following areas,
至少在以下领域，

- Access to Secrets managed by the cluster. Care should be taken to only
  访问集群管理的 Secret。应注意仅
   log Metadata for requests to Secrets, ConfigMaps, and TokenReviews, in
  log 对 Secrets、ConfigMaps 和 TokenReviews 的请求的元数据，在
   order to avoid risk of logging sensitive data.
  以避免记录敏感数据的风险。
- Modification of Pod and Deployment objects.
  修改 Pod 和 Deployment 对象。
- Use of `pods/exec`, `pods/portforward`, `pods/proxy` and `services/proxy`.
  使用 `pods/exec`、`pods/portforward`、`pods/proxy` 和 `services/proxy`。
   For most requests, minimally logging at the Metadata level is recommended
  对于大多数请求，建议在 Metadata 级别进行最低限度的日志记录
   (the most basic level of logging).
  （日志记录的最基本级别）。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No, this cannot be automated.
不可以，这不能自动完成。

### [Worker Node Security Configuration Worker 节点安全配置](https://microk8s.io/docs/how-to-cis-harden#worker-node-security-configuration)

### [Check 4.1.1 检查 4.1.1](https://microk8s.io/docs/how-to-cis-harden#check-411)

> Ensure that the kubelet service file permissions are set to 600 or more restrictive (Automated)
> 确保将 kubelet 服务文件权限设置为 600 或更严格 （Automated）

**Remediation 修复**

kubelet starts as part of the `snap.microk8s.daemon-kubelite.service` systemd service.
kubelet 作为 `snap.microk8s.daemon-kubelite.service` systemd 服务的一部分启动。
 Run the below command (based on the file location on your system) on the each worker node.
在每个 worker 节点上运行以下命令（基于系统上的文件位置）。

```auto
chmod 600 /etc/systemd/system/snap.microk8s.daemon-kubelite.service
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the addon sets the above permissions when enabled.
是的，插件在启用时会设置上述权限。

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /etc/systemd/system/snap.microk8s.daemon-kubelite.service; then stat -c permissions=%a /etc/systemd/system/snap.microk8s.daemon-kubelite.service; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 4.1.2 检查 4.1.2](https://microk8s.io/docs/how-to-cis-harden#check-412)

> Ensure that the kubelet service file ownership is set to root:root (Automated)
> 确保 kubelet 服务文件所有权设置为 root：root （Automated）

**Remediation 修复**

kubelet starts as part of the `snap.microk8s.daemon-kubelite.service` systemd service.
kubelet 作为 `snap.microk8s.daemon-kubelite.service` systemd 服务的一部分启动。
 Run the below command (based on the file location on your system) on the each worker node.
在每个 worker 节点上运行以下命令（基于系统上的文件位置）。

```auto
chown root:root /etc/systemd/system/snap.microk8s.daemon-kubelite.service
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the addon sets the root:root ownership.
是的，插件会设置 root：root 所有权。

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /etc/systemd/system/snap.microk8s.daemon-kubelite.service; then stat -c %U:%G /etc/systemd/system/snap.microk8s.daemon-kubelite.service; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 4.1.3 检查 4.1.3](https://microk8s.io/docs/how-to-cis-harden#check-413)

> If proxy kubeconfig file exists ensure permissions are set to 600 or more restrictive (Manual)
> 如果存在代理 kubeconfig 文件，请确保将权限设置为 600 或更严格（手动）

**Remediation 修复**

Run the below command (based on the file location on your system) on the each worker node.
在每个 worker 节点上运行以下命令（基于系统上的文件位置）。

```auto
chmod 600 /var/snap/microk8s/current/credentials/proxy.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the addon sets the above permissions when enabled.
是的，插件在启用时会设置上述权限。

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/proxy.config; then stat -c permissions=%a /var/snap/microk8s/current/credentials/proxy.config; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 4.1.4 检查 4.1.4](https://microk8s.io/docs/how-to-cis-harden#check-414)

> If proxy kubeconfig file exists ensure ownership is set to root:root (Manual)
> 如果代理 kubeconfig 文件存在，请确保将所有权设置为 root：root（手动）

**Remediation 修复**

Run the below command (based on the file location on your system) on the each worker node.
在每个 worker 节点上运行以下命令（基于系统上的文件位置）。

```auto
chown root:root /var/snap/microk8s/current/credentials/proxy.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the addon sets the root:root ownership.
是的，插件会设置 root：root 所有权。

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/proxy.config; then stat -c %U:%G /var/snap/microk8s/current/credentials/proxy.config; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 4.1.5 检查 4.1.5](https://microk8s.io/docs/how-to-cis-harden#check-415)

> Ensure that the --kubeconfig kubelet.conf file permissions are set to 600 or more restrictive (Automated)
> 确保将 --kubeconfig kubelet.conf 文件权限设置为 600 或更严格（自动）

**Remediation 修复**

Run the below command (based on the file location on your system) on the each worker node.
在每个 worker 节点上运行以下命令（基于系统上的文件位置）。

```auto
chmod 600 /var/snap/microk8s/current/credentials/kubelet.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the addon sets the above permissions when enabled.
是的，插件在启用时会设置上述权限。

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/kubelet.config; then stat -c permissions=%a /var/snap/microk8s/current/credentials/kubelet.config; fi'
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 4.1.6 检查 4.1.6](https://microk8s.io/docs/how-to-cis-harden#check-416)

> Ensure that the --kubeconfig kubelet.conf file ownership is set to root:root (Automated)
> 确保 --kubeconfig kubelet.conf 文件所有权设置为 root：root（自动）

**Remediation 修复**

Run the below command (based on the file location on your system) on the each worker node.
在每个 worker 节点上运行以下命令（基于系统上的文件位置）。

```auto
chown root:root /var/snap/microk8s/current/credentials/kubelet.config
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the addon sets the root:root ownership.
是的，插件会设置 root：root 所有权。

**Audit 审计**

As root: 作为 root：

```auto
/bin/sh -c 'if test -e /var/snap/microk8s/current/credentials/kubelet.config; then stat -c %U:%G /var/snap/microk8s/current/credentials/kubelet.config; fi'
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 4.1.7 检查 4.1.7](https://microk8s.io/docs/how-to-cis-harden#check-417)

> Ensure that the certificate authorities file permissions are set to 600 or more restrictive (Manual)
> 确保将证书颁发机构文件权限设置为 600 或更严格 （手动）

**Remediation 修复**

Run the following command to modify the file permissions of the `--client-ca-file`
执行以下命令，修改 `--client-ca-file` 的文件权限

```auto
chmod 600 /var/snap/microk8s/current/certs/ca.crt
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the addon sets the right permissions.
是的，插件设置了正确的权限。

**Audit 审计**

As root: 作为 root：

```auto
stat -c permissions=%a /var/snap/microk8s/current/certs/ca.crt
```

Expected output: 预期输出：

```auto
permissions=600
```

### [Check 4.1.8 检查 4.1.8](https://microk8s.io/docs/how-to-cis-harden#check-418)

> Ensure that the client certificate authorities file ownership is set to root:root (Manual)
> 确保客户端证书颁发机构文件所有权设置为 root：root （手动）

**Remediation 修复**

Run the following command to modify the ownership of the `--client-ca-file`.
执行以下命令修改 `--client-ca-file` 的所有权。

```auto
chown root:root /var/snap/microk8s/current/certs/ca.crt
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the addon sets the right ownership.
是的，插件设置了正确的所有权。

**Audit 审计**

As root: 作为 root：

```auto
stat -c %U:%G  /var/snap/microk8s/current/certs/ca.crt
```

Expected output: 预期输出：

```auto
root:root
```

### [Check 4.1.9 检查 4.1.9](https://microk8s.io/docs/how-to-cis-harden#check-419)

> If the kubelet config.yaml configuration file is being used validate permissions set to 600 or more restrictive (Manual)
> 如果正在使用 kubelet config.yaml 配置文件，请将验证权限设置为 600 或更严格（手动）

**Remediation 修复**

Not applicable. MicroK8s does not use a config.yaml configuration file.
不適用。MicroK8s 不使用 config.yaml 配置文件。

### [Check 4.1.10 检查 4.1.10](https://microk8s.io/docs/how-to-cis-harden#check-4110)

> If the kubelet config.yaml configuration file is being used validate file ownership is set to root:root (Manual)
> 如果正在使用 kubelet config.yaml 配置文件，则验证文件所有权设置为 root：root（手动）

**Remediation 修复**

Not applicable. MicroK8s does not use a config.yaml configuration file.
不適用。MicroK8s 不使用 config.yaml 配置文件。

### [Check 4.2.1 检查 4.2.1](https://microk8s.io/docs/how-to-cis-harden#check-421)

> Ensure that the `--anonymous-auth` argument is set to false (Manual)
> 确保 `--anonymous-auth` 参数设置为 false（手动）

**Remediation 修复**

In MicroK8s the API server arguments file is `/var/snap/microk8s/current/args/kubelet`.
在 MicroK8s 中，API 服务器参数文件是 `/var/snap/microk8s/current/args/kubelet` 。
 Make sure `--anonymous-auth` is not present in the file or set to false.
确保 `--anonymous-auth` 不存在于文件中或设置为 false。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. 是的。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kubelet | grep anonymous-auth
```

Expected output: 预期输出：

```auto
--anonymous-auth=false
```

### [Check 4.2.2 检查 4.2.2](https://microk8s.io/docs/how-to-cis-harden#check-422)

> Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)
> 确保 --authorization-mode 参数未设置为 AlwaysAllow （Automated）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 set the parameter: 设置参数：

```auto
--authorization-mode=Webhook
```

Review and apply the following RBAC rules so calls from the API server to kubelet are authorized:
查看并应用以下 RBAC 规则，以便从 API 服务器到 kubelet 的调用获得授权：

```auto
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
    rbac.authorization.kubernetes.io/autoupdate: "true"
  labels:
    kubernetes.io/bootstrapping: rbac-defaults
  name: system:kube-apiserver-to-kubelet
rules:
  - apiGroups:
      - ""
    resources:
      - nodes/proxy
      - nodes/stats
      - nodes/log
      - nodes/spec
      - nodes/metrics
    verbs:
      - "*"
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: system:kube-apiserver
  namespace: ""
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:kube-apiserver-to-kubelet
subjects:
  - apiGroup: rbac.authorization.k8s.io
    kind: User
    name: 127.0.0.1
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The authorization mode is set to webhook.
是的。授权模式设置为 Webhook。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kubelet | grep authorization-mode
```

Expected output: 预期输出：

```auto
--authorization-mode=Webhook
```

### [Check 4.2.3 检查 4.2.3](https://microk8s.io/docs/how-to-cis-harden#check-423)

> Ensure that the --client-ca-file argument is set as appropriate (Automated)
> 确保 --client-ca-file 参数设置得适当 （Automated）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 set the parameter: 设置参数：

```auto
--client-ca-file=${SNAP_DATA}/certs/ca.crt
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter appropriately.
不。默认设置会相应地设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--client-ca-file' /var/snap/microk8s/current/args/kubelet
```

Expected output: 预期输出：

```auto
--client-ca-file=${SNAP_DATA}/certs/ca.crt
```

### [Check 4.2.4 检查 4.2.4](https://microk8s.io/docs/how-to-cis-harden#check-424)

> Verify that the --read-only-port argument is set to 0 (Manual)
> 验证 --read-only-port 参数是否设置为 0（手动）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 set the parameter: 设置参数：

```auto
--read-only-port=0
```

or remove it. 或将其删除。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter appropriately.
不。默认设置会相应地设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--read-only-port' /var/snap/microk8s/current/args/kubelet ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 4.2.5 检查 4.2.5](https://microk8s.io/docs/how-to-cis-harden#check-425)

> Ensure that the --streaming-connection-idle-timeout argument is not set to 0 (Manual)
> 确保 --streaming-connection-idle-timeout 参数未设置为 0（手动）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 remove the parameter `--streaming-connection-idle-timeout`.
删除参数 `--streaming-connection-idle-timeout` .

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. The default setup sets this parameter appropriately.
不。默认设置会相应地设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--streaming-connection-idle-timeout' /var/snap/microk8s/current/args/kubelet ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 4.2.6 检查 4.2.6](https://microk8s.io/docs/how-to-cis-harden#check-426)

> Ensure that the --protect-kernel-defaults argument is set to true (Automated)
> 确保 --protect-kernel-defaults 参数设置为 true （Automated）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 set the parameter: 设置参数：

```auto
--protect-kernel-defaults=true
```

Mind you may need set in `/etc/sysctl.conf`:
请注意，您可能需要在 `/etc/sysctl.conf` 中设置：

```auto
vm.panic_on_oom=0
vm.overcommit_memory=1
kernel.panic=10
kernel.panic_on_oops=1
kernel.keys.root_maxkeys=1000000
kernel.keys.root_maxbytes=25000000
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes. The --protect-kernel-defaults is set to true.
是的。--protect-kernel-defaults 设置为 true。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kubelet | grep --protect-kernel-defaults
```

Expected output: 预期输出：

```auto
--protect-kernel-defaults=true
```

### [Check 4.2.7 检查 4.2.7](https://microk8s.io/docs/how-to-cis-harden#check-427)

> Ensure that the --make-iptables-util-chains argument is set to true (Automated)
> 确保 --make-iptables-util-chains 参数设置为 true（自动）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 remove the parameter `--make-iptables-util-chains`.
删除参数 `--make-iptables-util-chains`。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. By default MicroKs does not set this parameter.
不。默认情况下，MicroKs 不设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kubelet | grep --make-iptables-util-chains ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 4.2.8 检查 4.2.8](https://microk8s.io/docs/how-to-cis-harden#check-428)

> Ensure that the --hostname-override argument is not set (Manual)
> 确保未设置 --hostname-override 参数（手动）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 remove the parameter `--hostname-override`.
删除参数 `--hostname-override`。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. By default MicroKs does not set this parameter.
不。默认情况下，MicroKs 不设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kubelet | grep hostname-override ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 4.2.9 检查 4.2.9](https://microk8s.io/docs/how-to-cis-harden#check-429)

> Ensure that the eventRecordQPS argument is set to a level which ensures appropriate event capture (Manual)
> 确保将 eventRecordQPS 参数设置为可确保适当事件捕获的级别（手动）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 set the parameter: 设置参数：

```auto
--event-qps=0
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, the --event-qps is set to 0.
是的，--event-qps 设置为 0。

**Audit 审计**

As root: 作为 root：

```auto
cat /var/snap/microk8s/current/args/kubelet | grep event-qps ; echo $?
```

Expected output: 预期输出：

```auto
--event-qps=0
```

### [Check 4.2.10 检查 4.2.10](https://microk8s.io/docs/how-to-cis-harden#check-4210)

> Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (Manual)
> 确保 --tls-cert-file 和 --tls-private-key-file 参数设置得合适（手动）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 set the parameters: 设置参数：

```auto
--tls-cert-file=${SNAP_DATA}/certs/kubelet.crt
--tls-private-key-file=${SNAP_DATA}/certs/kubelet.key
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, both arguments are set to point to the self signed CA created by kubelet.
是的，这两个参数都设置为指向 kubelet 创建的自签名 CA。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--tls-cert-file\|--tls-private-key-file' /var/snap/microk8s/current/args/kubelet
```

Expected output: 预期输出：

```auto
--tls-cert-file=${SNAP_DATA}/certs/kubelet.crt
--tls-private-key-file=${SNAP_DATA}/certs/kubelet.key
```

### [Check 4.2.11 检查 4.2.11](https://microk8s.io/docs/how-to-cis-harden#check-4211)

> Ensure that the --rotate-certificates argument is not set to false (Automated)
> 确保 --rotate-certificates 参数未设置为 false （Automated）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 remove the parameter `--rotate-certificates`.
删除参数 `--rotate-certificates`。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. By default MicroKs does not set this parameter.
不。默认情况下，MicroKs 不设置此参数。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--rotate-certificates' /var/snap/microk8s/current/args/kubelet ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 4.2.12 检查 4.2.12](https://microk8s.io/docs/how-to-cis-harden#check-4212)

> Verify that the RotateKubeletServerCertificate argument is set to true (Manual)
> 验证 RotateKubeletServerCertificate 参数是否设置为 true（手动）

**Remediation 修复**

Edit the kubelet service arguments file `/var/snap/microk8s/current/args/kubelet` and
编辑 kubelet 服务参数文件 `/var/snap/microk8s/current/args/kubelet` ，然后
 remove the feature gate `RotateKubeletServerCertificate` as it is set to true by default.
删除特性门控 `RotateKubeletServerCertificate` ，因为它默认设置为 true。

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

No. By default MicroKs does not set this feature gate to false.
不。默认情况下，MicroKs 不会将此功能门控设置为 false。

**Audit 审计**

As root: 作为 root：

```auto
grep -e 'RotateKubeletServerCertificate' /var/snap/microk8s/current/args/kubelet ; echo $?
```

Expected output: 预期输出：

```auto
1
```

### [Check 4.2.13 检查 4.2.13](https://microk8s.io/docs/how-to-cis-harden#check-4213)

> Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers (Manual)
> 确保 Kubelet 仅使用强加密密码（手动）

**Remediation 修复**

Edit the kubelet arguments file /var/snap/microk8s/current/args/kubelet
编辑 kubelet 参数文件 /var/snap/microk8s/current/args/kubelet
 and set the below parameter.
并设置以下参数。

```auto
--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256
```

**Remediation by the cis-hardening addon
通过 cis-hardening 插件进行补救**

Yes, Strong Cryptographic Ciphers are configured.
是的，配置了强加密密码。

**Audit 审计**

As root: 作为 root：

```auto
grep -e '--tls-cipher-suites' /var/snap/microk8s/current/args/kubelet
```

Expected output: 预期输出：

```auto
--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256
```

### [Kubernetes Policies Kubernetes 策略](https://microk8s.io/docs/how-to-cis-harden#kubernetes-policies)

The following CIS policy recommendations cannot be automated and therefore are out of the scope of the `cis-hardening` addon.
以下 CIS 策略建议无法自动化，因此不在 `cis-hardening` 插件的范围内。
 The cluster administration should take proper action to comply with them whenever possible.
集群管理部门应尽可能采取适当的措施来遵守这些规定。

### [Check 5.1.1 检查 5.1.1](https://microk8s.io/docs/how-to-cis-harden#check-511)

> Ensure that the cluster-admin role is only used where required (Manual)
> 确保仅在需要时使用 cluster-admin 角色（手动）

**Remediation 修复**

Identify all clusterrolebindings to the cluster-admin role. Check if they are used and
确定所有 clusterrole绑定到 cluster-admin 角色。检查它们是否被使用，以及
 if they need this role or if they could use a role with fewer privileges.
他们是否需要此角色，或者是否可以使用具有较少权限的角色。
 Where possible, first bind users to a lower privileged role and then remove the
在可能的情况下，首先将用户绑定到较低权限的角色，然后删除
 clusterrolebinding to the cluster-admin role :
clusterrole绑定到 cluster-admin 角色：
 kubectl delete clusterrolebinding [name]
kubectl delete clusterrolebinding [名称]

### [Check 5.1.2 检查 5.1.2](https://microk8s.io/docs/how-to-cis-harden#check-512)

> Minimize access to secrets (Manual)
> 最大限度地减少对密钥的访问（手动）

**Remediation 修复**

Where possible, remove get, list and watch access to Secret objects in the cluster.
在可能的情况下，删除对集群中 Secret 对象的 get、list 和 watch 访问权限。

### [Check 5.1.3 检查 5.1.3](https://microk8s.io/docs/how-to-cis-harden#check-513)

> Minimize wildcard use in Roles and ClusterRoles (Manual)
> 最大限度地减少 Roles 和 ClusterRole 中的通配符使用（手动）

**Remediation 修复**

Where possible replace any use of wildcards in clusterroles and roles with specific
如果可能，请将 clusterroles 和 roles 中通配符的任何使用替换为特定的
 objects or actions. 对象或作。

### [Check 5.1.4 检查 5.1.4](https://microk8s.io/docs/how-to-cis-harden#check-514)

> Minimize access to create pods (Manual)
> 最小化创建 Pod 的访问权限（手动）

**Remediation 修复**

Where possible, remove create access to pod objects in the cluster.
在可能的情况下，删除对集群中 Pod 对象的 create 访问权限。

### [Check 5.1.5 检查 5.1.5](https://microk8s.io/docs/how-to-cis-harden#check-515)

> Ensure that default service accounts are not actively used. (Manual)
> 确保默认服务帐户未被主动使用。（手动）

**Remediation 修复**

Create explicit service accounts wherever a Kubernetes workload requires specific access
在 Kubernetes 工作负载需要特定访问权限的任何地方创建显式服务帐户
 to the Kubernetes API server.
添加到 Kubernetes API 服务器。
 Modify the configuration of each default service account to include this value
修改每个默认服务帐户的配置以包含此值

```auto
automountServiceAccountToken: false
```

### [Check 5.1.6 检查 5.1.6](https://microk8s.io/docs/how-to-cis-harden#check-516)

> Ensure that Service Account Tokens are only mounted where necessary (Manual)
> 确保仅在必要时挂载服务帐户令牌 （手动）

**Remediation 修复**

Modify the definition of pods and service accounts which do not need to mount service
修改不需要挂载服务的 Pod 和服务账号的定义
 account tokens to disable it.
account tokens 来禁用它。

### [Check 5.1.7 检查 5.1.7](https://microk8s.io/docs/how-to-cis-harden#check-517)

> Avoid use of system:masters group (Manual)
> 避免使用 system：masters 组（手动）

**Remediation 修复**

Remove the `system:masters` group from all users in the cluster.
从集群中的所有用户中删除 `system：masters` 组。

### [Check 5.1.8 检查 5.1.8](https://microk8s.io/docs/how-to-cis-harden#check-518)

> Limit use of the Bind, Impersonate and Escalate permissions in the Kubernetes cluster (Manual)
> 限制在 Kubernetes 集群中使用 Bind、Impersonate 和 Escalate 权限（手动）

**Remediation 修复**

Where possible, remove the impersonate, bind and escalate rights from subjects.
在可能的情况下，删除使用者的 impersonate、bind 和 escalate 权限。

### [Check 5.2.1 检查 5.2.1](https://microk8s.io/docs/how-to-cis-harden#check-521)

> Ensure that the cluster has at least one active policy control mechanism in place (Manual)
> 确保集群至少有一个活动的策略控制机制 （手动）

**Remediation 修复**

Ensure that either Pod Security Admission or an external policy control system is in place
确保 Pod 安全准入或外部策略控制系统已到位
 for every namespace which contains user workloads.
对于包含用户工作负载的每个命名空间。

### [Check 5.2.2 检查 5.2.2](https://microk8s.io/docs/how-to-cis-harden#check-522)

> Minimize the admission of privileged containers (Manual)
> 最大程度地减少特权容器的允许（手动）

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of privileged containers.
特权容器的准入。

### [Check 5.2.3 检查 5.2.3](https://microk8s.io/docs/how-to-cis-harden#check-523)

> Minimize the admission of containers wishing to share the host process ID namespace (Automated)
> 最大限度地减少希望共享主机进程 ID 命名空间的容器的允许（自动）

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of `hostPID` containers.
允许 `hostPID` 容器。

### [Check 5.2.4 检查 5.2.4](https://microk8s.io/docs/how-to-cis-harden#check-524)

> Minimize the admission of containers wishing to share the host IPC namespace (Automated)
> 最大限度地减少希望共享主机 IPC 命名空间的容器的允许（自动）

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of `hostIPC` containers.
允许 `hostIPC` 容器。

### [Check 5.2.5 检查 5.2.5](https://microk8s.io/docs/how-to-cis-harden#check-525)

> Minimize the admission of containers wishing to share the host network namespace (Automated)
> 最大限度地减少希望共享主机网络命名空间的容器的允许（自动）

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of `hostNetwork` containers.
允许 `hostNetwork` 容器。

### [Check 5.2.6 检查 5.2.6](https://microk8s.io/docs/how-to-cis-harden#check-526)

> Minimize the admission of containers with allowPrivilegeEscalation (Automated)
> 使用 allowPrivilegeEscalation （Automated） 最大限度地减少容器的允许

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of containers with `.spec.allowPrivilegeEscalation` set to `true`.
允许设置为 `true` 的容器 `.spec.allowPrivilegeEscalation` 。

### [Check 5.2.7 检查 5.2.7](https://microk8s.io/docs/how-to-cis-harden#check-527)

> Minimize the admission of root containers (Automated)
> 最大限度地减少根容器的允许 （Automated）

**Remediation 修复**

Create a policy for each namespace in the cluster, ensuring that either `MustRunAsNonRoot`
为集群中的每个命名空间创建一个策略，确保 `MustRunAsNonRoot`
 or `MustRunAs` with the range of UIDs not including 0, is set.
或 `MustRunAs` 且 UID 范围不包括 0。

### [Check 5.2.8 检查 5.2.8](https://microk8s.io/docs/how-to-cis-harden#check-528)

> Minimize the admission of containers with the NET_RAW capability (Automated)
> 使用 NET_RAW 功能（自动）最大限度地减少容器的允许

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of containers with the `NET_RAW` capability.
允许具有 `NET_RAW` 功能的容器。

### [Check 5.2.9 检查 5.2.9](https://microk8s.io/docs/how-to-cis-harden#check-529)

> Minimize the admission of containers with added capabilities (Automated)
> 通过添加功能最大限度地减少容器的准入 （Automated）

**Remediation 修复**

Ensure that `allowedCapabilities` is not present in policies for the cluster unless
确保群集的策略中不存在 `allowedCapabilities`，除非
 it is set to an empty array.
它被设置为一个空数组。

### [Check 5.2.10 检查 5.2.10](https://microk8s.io/docs/how-to-cis-harden#check-5210)

> Minimize the admission of containers with capabilities assigned (Manual)
> 最大限度地减少允许分配了功能的容器（手动）

**Remediation 修复**

Review the use of capabilities in applications running on your cluster. Where a namespace
查看集群上运行的应用程序中的功能使用情况。其中命名空间
 contains applications which do not require any Linux capabilities to operate consider adding
包含不需要任何 Linux 功能即可运行的应用程序，请考虑添加
 a PSP which forbids the admission of containers which do not drop all capabilities.
禁止允许不放弃所有功能的容器的 PSP。

### [Check 5.2.11 检查 5.2.11](https://microk8s.io/docs/how-to-cis-harden#check-5211)

> Minimize the admission of Windows HostProcess containers (Manual)
> 最大程度地减少 Windows HostProcess 容器的允许（手动）

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of containers that have `.securityContext.windowsOptions.hostProcess` set to `true`.
允许已 `.securityContext.windowsOptions.hostProcess` 设置为 `true` 的容器。

### [Check 5.2.12 检查 5.2.12](https://microk8s.io/docs/how-to-cis-harden#check-5212)

> Minimize the admission of HostPath volumes (Manual)
> 最大限度地减少 HostPath 卷的允许（手动）

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of containers with `hostPath` volumes.
允许使用 `hostPath` 卷的容器。

### [Check 5.2.13 检查 5.2.13](https://microk8s.io/docs/how-to-cis-harden#check-5213)

> Minimize the admission of containers which use HostPorts (Manual)
> 最大限度地减少使用 HostPort 的容器的允许（手动）

**Remediation 修复**

Add policies to each namespace in the cluster which has user workloads to restrict the
将策略添加到集群中的每个命名空间，这些命名空间具有用户工作负载以限制
 admission of containers which use `hostPort` sections.
允许使用 `hostPort` 部分的容器。

### [Check 5.3.1 检查 5.3.1](https://microk8s.io/docs/how-to-cis-harden#check-531)

> Ensure that the CNI in use supports NetworkPolicies (Manual)
> 确保正在使用的 CNI 支持 NetworkPolicies（手动）

**Remediation 修复**

Follow the documentation and create NetworkPolicy objects as you need them.
按照文档进行作，并根据需要创建 NetworkPolicy 对象。
 The default CNI in MicroK8s is calico that supports network policies.
MicroK8s 中的默认 CNI 是支持网络策略的 calico。

### [Check 5.3.2 检查 5.3.2](https://microk8s.io/docs/how-to-cis-harden#check-532)

> Ensure that all Namespaces have NetworkPolicies defined (Manual)
> 确保所有命名空间都定义了 NetworkPolicy（手动）

**Remediation 修复**

Follow the documentation and create NetworkPolicy objects as you need them.
按照文档进行作，并根据需要创建 NetworkPolicy 对象。

### [Check 5.4.1 检查 5.4.1](https://microk8s.io/docs/how-to-cis-harden#check-541)

> Prefer using Secrets as files over Secrets as environment variables (Manual)
> 首选将 Secrets 用作文件，而不是将 Secrets 用作环境变量（手动）

**Remediation 修复**

If possible, rewrite application code to read Secrets from mounted secret files, rather than
如果可能，请重写应用程序代码以从挂载的 Secret 文件中读取 Secret，而不是
 from environment variables.
从环境变量中。

### [Check 5.4.2 检查 5.4.2](https://microk8s.io/docs/how-to-cis-harden#check-542)

> Consider external secret storage (Manual)
> 考虑外部密钥存储（手动）

**Remediation 修复**

Refer to the Secrets management options offered by your cloud provider or a third-party
请参阅您的云提供商或第三方提供的密钥管理选项
 secrets management solution.
机密管理解决方案。

### [Check 5.5.1 检查 5.5.1](https://microk8s.io/docs/how-to-cis-harden#check-551)

> Configure Image Provenance using ImagePolicyWebhook admission controller (Manual)
> 使用 ImagePolicyWebhook 准入控制器配置图像来源（手动）

**Remediation 修复**

Follow the Kubernetes documentation and setup image provenance.
遵循 Kubernetes 文档并设置映像来源。

### [Check 5.7.1 检查 5.7.1](https://microk8s.io/docs/how-to-cis-harden#check-571)

> Create administrative boundaries between resources using namespaces (Manual)
> 使用命名空间在资源之间创建管理边界（手动）

**Remediation 修复**

Follow the documentation and create namespaces for objects in your deployment as you need
按照文档进行作，并根据需要为部署中的对象创建命名空间
 them. 他们。

### [Check 5.7.2 检查 5.7.2](https://microk8s.io/docs/how-to-cis-harden#check-572)

> Ensure that the seccomp profile is set to docker/default in your Pod definitions (Manual)
> 确保在 Pod 定义中将 seccomp 配置文件设置为 docker/default（手动）

**Remediation 修复**

Use `securityContext` to enable the docker/default seccomp profile in your pod definitions.
使用 `securityContext` 在 Pod 定义中启用 docker/default seccomp 配置文件。
 For example: 例如：

```auto
securityContext:
  seccompProfile:
    type: RuntimeDefault
```

### [Check 5.7.3 检查 5.7.3](https://microk8s.io/docs/how-to-cis-harden#check-573)

> Apply SecurityContext to your Pods and Containers (Manual)
> 将 SecurityContext 应用于 Pod 和容器（手动）

**Remediation 修复**

Follow the Kubernetes documentation and apply SecurityContexts to your Pods. For a
按照 Kubernetes 文档将 SecurityContext 应用于你的 Pod。对于
 suggested list of SecurityContexts, you may refer to the CIS Security Benchmark for Docker
建议的 SecurityContext 列表，您可以参考 Docker 的 CIS 安全基准
 Containers. 器皿。

### [Check 5.7.4 检查 5.7.4](https://microk8s.io/docs/how-to-cis-harden#check-574)

> The default namespace should not be used (Manual)
> 不应使用默认命名空间（手动）

**Remediation 修复**

Ensure that namespaces are created to allow for appropriate segregation of Kubernetes
确保创建命名空间以允许 Kubernetes 的适当隔离
 resources and that all new resources are created in a specific namespace.
resources 的 URL，并且所有新资源都是在特定命名空间中创建的。

## [Further reading 延伸阅读](https://microk8s.io/docs/how-to-cis-harden#further-reading)

https://www.cisecurity.org/benchmark/kubernetes

# How to run a security scan with Trivy 如何使用 Trivy 运行安全扫描

#### On this page 本页内容

​                                                [Using the Trivy Operator 使用 Trivy 运算符](https://microk8s.io/docs/security-trivy#using-the-trivy-operator)                                                                                            [Vulnerability reports 漏洞报告](https://microk8s.io/docs/security-trivy#vulnerability-reports)                                                  [Run a configuration audit
运行配置审核](https://microk8s.io/docs/security-trivy#run-a-configuration-audit)                                                                                                    [Using the Trivy CLI 使用 Trivy CLI](https://microk8s.io/docs/security-trivy#using-the-trivy-cli)                                                                                            [Run a Trivy CLI vulnerability scan on MicroK8s
在 MicroK8s 上运行 Trivy CLI 漏洞扫描](https://microk8s.io/docs/security-trivy#run-a-trivy-cli-vulnerability-scan-on-microk8s)                                                  [Run a Trivy configuration scan with the CLI
使用 CLI 运行 Trivy 配置扫描](https://microk8s.io/docs/security-trivy#run-a-trivy-configuration-scan-with-the-cli)                                                  [Trivy CLI Secrets on MicroK8s
MicroK8s 上的 Trivy CLI 密钥](https://microk8s.io/docs/security-trivy#trivy-cli-secrets-on-microk8s)                                                                                                    [Summary 总结](https://microk8s.io/docs/security-trivy#summary)                                                      [Further reading 延伸阅读](https://microk8s.io/docs/security-trivy#further-reading)                                                              

The Trivy community addon for MicroK8s comprises the Trivy Operator and the Trivy CLI, both of which can be used to perform security scans on your  cluster.
MicroK8s 的 Trivy 社区插件包括 Trivy Operator 和 Trivy CLI，两者都可用于在集群上执行安全扫描。

This ‘how to’ guide assumes you already have a MicroK8s cluster installed and running on a local machine.
本“作方法”指南假设您已经在本地计算机上安装并运行了 MicroK8s 集群。

If you have not yet done so, enable the Trivy addon:
如果您还没有这样做，请启用 Trivy 插件：

```bash
microk8s enable community
microk8s enable trivy
```

Once the operator has been installed you can verify that it is running by inspecting the pods:
安装 Operator 后，您可以通过检查 Pod 来验证它是否正在运行：

```auto
microk8s kubectl get all -A
```

The output should show that the namespace ‘trivy-system’ and the pod ‘trivy-operator’ have been created, as shown below:
输出应显示命名空间 'trivy-system' 和 pod 'trivy-operator' 已创建，如下所示：

```no-highlight
NAMESPACE      NAME                                           READY   STATUS    RESTARTS      AGE
kube-system    pod/calico-node-clg22                          1/1     Running   3 (32h ago)   4d2h
kube-system    pod/calico-kube-controllers-79568db7f8-kn96d   1/1     Running   3 (32h ago)   4d2h
kube-system    pod/coredns-6f5f9b5d74-h445n                   1/1     Running   3 (32h ago)   4d2h
trivy-system   pod/trivy-operator-67f7c7f4d8-zq57g            1/1     Running   0             3m30s
```

## [Using the Trivy Operator 使用 Trivy 运算符](https://microk8s.io/docs/security-trivy#using-the-trivy-operator)

The Trivy-Operator runs trivy security tools and incorporates their outputs into Kubernetes CRDs (Custom Resource Definitions). From there,   security reports are accessible through the Kubernetes API, making it  eay for users to find and view the risks that relate to different  resources in a Kubernetes-native way.
Trivy-Operator 运行 trivy 安全工具并将其输出合并到 Kubernetes CRD（自定义资源定义）中。从那里，可以通过 Kubernetes API  访问安全报告，使用户可以轻松地以 Kubernetes 原生方式查找和查看与不同资源相关的风险。

In order to perform scans, Trivy needs to find resources to scan. By  default it is configured to scan resources in all namespaces.
为了执行扫描，Trivy 需要找到要扫描的资源。默认情况下，它配置为扫描所有命名空间中的资源。
 To test this, you can try deploying the Kubernetes bootcamp image:
要测试这一点，您可以尝试部署 Kubernetes bootcamp 镜像：

```bash
microk8s kubectl create deployment kubernetes-bootcamp --image=gcr.io/google-samples/kubernetes-bootcamp:v1
```

Then see the following sections for reviewing the reports
然后，请参阅以下部分以查看报告

### [Vulnerability reports 漏洞报告](https://microk8s.io/docs/security-trivy#vulnerability-reports)

Vulnerability reports are available within the cluster. A simple status can be found by running:
漏洞报告在集群中可用。可以通过运行以下命令找到一个简单的状态：

```bash
microk8s kubectl get vulnerabilityreports --all-namespaces -o wide
```

The output will list the vulnerability issues detected in each of the namespaces in the cluster:
输出将列出在集群中的每个命名空间中检测到的漏洞问题：

```no-highlight
NAMESPACE   NAME                                                            REPOSITORY                           TAG   SCANNER   AGE   CRITICAL   HIGH   MEDIUM   LOW   UNKNOWN
default     replicaset-kubernetes-bootcamp-5485cc6795-kubernetes-bootcamp   google-samples/kubernetes-bootcamp   v1    Trivy     28h   76         201    161      17    22
```

As Trivy exposes the details of scans through the API, you can use the ‘describe’ command to retrieve more details
由于 Trivy 通过 API 公开扫描的详细信息，因此您可以使用“describe”命令来检索更多详细信息

```bash
microk8s kubectl describe vulnerabilityreports --all-namespaces
```

In this case, for examle:
在这种情况下，例如：

```no-highlight
Vulnerability ID:   CVE-2019-3462
    Fixed Version:      1.0.9.8.4
    Installed Version:  1.0.9.8.3
    Links:
    Primary Link:       https://avd.aquasec.com/nvd/cve-2016-1252
    Resource:           apt
    Severity:           MEDIUM
    Target:             
    Title:              The apt package in Debian jessie before 1.0.9.8.4, in Debian unstable  ...
```

Searching for a specific vulnerability ID is fairly easy as there is a lot of  documentation associated to each vulnerability ID. In this example
搜索特定的漏洞 ID 相当容易，因为每个漏洞 ID 都有很多相关的文档。在此示例中

https://ubuntu.com/security/CVE-2019-3462

or 或

https://avd.aquasec.com/nvd/2019/cve-2019-3462/

### [Run a configuration audit 运行配置审核](https://microk8s.io/docs/security-trivy#run-a-configuration-audit)

As with vulnerability scans, configuratuion audits are exposed through the Kubernetes API. Run the command:
与漏洞扫描一样，配置审计通过 Kubernetes API 公开。运行命令：

```bash
microk8s kubectl get configauditreports --all-namespaces -o wide
```

…and the reports should be shown, as below in the case the example application:
…并且应显示报告，如下示例应用程序所示：

```bash
NAMESPACE   NAME                                        SCANNER   AGE     CRITICAL   HIGH   MEDIUM   LOW
default     replicaset-kubernetes-bootcamp-5485cc6795   Trivy     4m36s   0          0      2        10
```

This output shows the number configuration issues identified by Trivy. There are 2 medium and 10 low-security issues found. It is possible to get  more details about each of the issues detected by running the command  below.
此输出显示 Trivy 识别的数字配置问题。发现了 2 个中等安全问题和 10 个低安全问题。通过运行以下命令，可以获取有关检测到的每个问题的更多详细信息。

```bash
microk8s.kubectl describe configauditreports --all-namespaces
```

For example: 例如：

```no-highlight
Severity:     HIGH
    Success:      true
    Title:        Access to host network
    Category:     Kubernetes Security Check
    Check ID:     KSV018
    Description:  Enforcing memory limits prevents DoS via resource exhaustion.
```

The outcome of the configuration audit shows if the policy compliance is  committed (Success: True) or not. If you want to get more information  about some of the configuration policies you can search for policy  description on the Trivy Operator website.
配置审核的结果显示策略合规性是否已提交 （Success： True）。如果您想获取有关某些配置策略的更多信息，可以在 Trivy Operator 网站上搜索策略描述。

In our example “Enforcing memory limits”:
在我们的示例 “Enforcing memory limits” 中：

https://aquasecurity.github.io/trivy-operator/v0.11.0/docs/configuration-auditing/built-in-policies/

## [Using the Trivy CLI 使用 Trivy CLI](https://microk8s.io/docs/security-trivy#using-the-trivy-cli)

Trivy CLI runs from the MicroK8s cluster to scan workloads and get reports  about vulneratbilites, missconfigurations and secrets. However if you  want to have continuous cluster scanning it is recommended to use the  Trivy addon on MicroK8s as explained above.
Trivy CLI 从 MicroK8s 集群运行，以扫描工作负载并获取有关漏洞、错误配置和机密的报告。但是，如果您想进行连续集群扫描，建议如上所述在 MicroK8s 上使用 Trivy 插件。

> This example is based on Ubuntu 22.04. For more information about installing on different environments or to update to use the latest Trivy release, please check the link: [Installation - Trivy](https://aquasecurity.github.io/trivy/v0.41/getting-started/installation/)
> 此示例基于 Ubuntu 22.04。有关在不同环境中安装或更新以使用最新 Trivy 版本的更多信息，请查看链接：[安装 - Trivy](https://aquasecurity.github.io/trivy/v0.41/getting-started/installation/)

On the local host, run the following command to install Trivy v0.41.0.
在本地主机上，执行以下命令安装 Trivy v0.41.0。

```bash
wget https://github.com/aquasecurity/trivy/releases/download/v0.41.0/trivy_0.41.0_Linux-64bit.deb
sudo dpkg -i trivy_0.41.0_Linux-64bit.deb
```

Check the version: 检查版本：

```bash
trivy version
```

The output should correspond to the version above, and confirms the software has been installed.
输出应与上述版本相对应，并确认已安装软件。

The Trivy cli tool connects with the Kubernetes cluster by accessing the  local ‘~/.kube/config’ file for the current user. If you have not done  so already, you should copy the MicroK8s cluster configuration there:
Trivy cli 工具通过访问当前用户的本地 '~/.kube/config' 文件来连接 Kubernetes 集群。如果您还没有这样做，您应该将 MicroK8s 集群配置复制到那里：

```auto
sudo microk8s.kubectl config view --raw > $HOME/.kube/config
```

### [Run a Trivy CLI vulnerability scan on MicroK8s 在 MicroK8s 上运行 Trivy CLI 漏洞扫描](https://microk8s.io/docs/security-trivy#run-a-trivy-cli-vulnerability-scan-on-microk8s)

Run the following command to see a summary of the cluster scan.
运行以下命令以查看集群扫描的摘要。
 trivy k8s --report=summary cluster
trivy k8s --report=summary 集群



[![trivy CLi image](https://us1.discourse-cdn.com/flex016/uploads/kubernetes/optimized/2X/6/68502c7f0e056c7184b08d549cbb97d9f12f253a_2_690x236.png)](https://us1.discourse-cdn.com/flex016/uploads/kubernetes/original/2X/6/68502c7f0e056c7184b08d549cbb97d9f12f253a.png)



To dig down in one of the vulnerabilities with more description and filter by severity.
通过更多描述深入研究其中一个漏洞，并按严重性进行筛选。
 trivy k8s --severity=CRITICAL --report=all cluster
trivy k8s --severity=CRITICAL --report=all 集群

### [Run a Trivy configuration scan with the CLI 使用 CLI 运行 Trivy 配置扫描](https://microk8s.io/docs/security-trivy#run-a-trivy-configuration-scan-with-the-cli)

Scanning configuration issues works in a similar way to the Trivy Operator. Initiate the scan with:
扫描配置问题的工作方式与 Trivy 运算符类似。使用以下方法启动扫描：

```bash
trivy k8s --scanners=config --report=summary cluster
```



[![trivy cli image](https://us1.discourse-cdn.com/flex016/uploads/kubernetes/optimized/2X/6/68502c7f0e056c7184b08d549cbb97d9f12f253a_2_690x236.png)](https://us1.discourse-cdn.com/flex016/uploads/kubernetes/original/2X/6/68502c7f0e056c7184b08d549cbb97d9f12f253a.png)



### [Trivy CLI Secrets on MicroK8s MicroK8s 上的 Trivy CLI 密钥](https://microk8s.io/docs/security-trivy#trivy-cli-secrets-on-microk8s)

The CLI command also includes a scanner for exposed secrets. Use the command:
CLI 命令还包括用于公开密钥的扫描程序。使用命令：

```bash
trivy k8s --scanners=secret --report=summary cluster
```

## [Summary 总结](https://microk8s.io/docs/security-trivy#summary)

In this guide we covered how to enhance the security in a Kubernetes  cluster using Trivy Operator and/or Trivy CLI with full integration with MicroK8s. The MicroK8s team also encourage developers to scan OCI  images before deploying them into the clusters and also incorporate  MicroK8s and Trivy to their CI/CD processes.
在本指南中，我们介绍了如何使用 Trivy Operator 和/或 Trivy CLI 以及与 MicroK8s 完全集成来增强 Kubernetes  集群中的安全性。MicroK8s 团队还鼓励开发人员在将 OCI 映像部署到集群之前对其进行扫描，并将 MicroK8s 和 Trivy  整合到其 CI/CD 流程中。

## [Further reading 延伸阅读](https://microk8s.io/docs/security-trivy#further-reading)

- Trivy documentation for release 0.41 [Kubernetes - Trivy](https://aquasecurity.github.io/trivy/v0.41/docs/target/kubernetes/)
  Kubernetes 0.41 版本的 Trivy 文档 [- Trivy](https://aquasecurity.github.io/trivy/v0.41/docs/target/kubernetes/)
- Reach out MicroK8s team on Github [Issues · canonical/microk8s · GitHub](https://github.com/canonical/microk8s/issues)
  在 Github Issues 上联系 MicroK8s 团队 [·canonical/microk8s ·GitHub的](https://github.com/canonical/microk8s/issues)
- Share your comments during our Community Hours, every Friday 13:30 GMT https://meet.google.com/hjy-uogt-tax
  在我们的社区时间分享您的评论，每周五 13：30 GMT https://meet.google.com/hjy-uogt-tax