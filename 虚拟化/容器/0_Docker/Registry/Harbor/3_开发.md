建设、定制和为 Harbor 做出贡献

Build Harbor from Source Code      
从源代码构建 Harbor

This guide provides instructions for developers to build and run Harbor from source code.
本指南为开发人员提供了从源代码构建和运行 Harbor 的说明。

## Step 1: Prepare for a build environment for Harbor 第 1 步：为 Harbor 的构建环境做准备

Harbor is deployed as several Docker containers and most of the code is  written in Go language. The build environment requires Docker, Docker  Compose and golang development environment. Please install the below  prerequisites:
Harbor 被部署为多个 Docker 容器，大部分代码都是用 Go 语言编写的。构建环境需要 Docker、Docker Compose 和 golang 开发环境。请安装以下必备组件：

| Software 软件   | Required Version 所需版本 |
| --------------- | ------------------------- |
| docker 码头工人 | 17.05 +                   |
| docker-compose  | 1.18.0 +                  |
| python 蟒       | 2.7 +                     |
| git             | 1.9.1 +                   |
| make 做         | 3.81 +                    |
| golang* 戈朗*   | 1.15.6 +                  |

*optional, required if you use your own Golang environment.
*可选，如果您使用自己的 Golang 环境，则为必填项。

## Step 2: Getting the source code 第 2 步：获取源代码

```sh
git clone https://github.com/goharbor/harbor
```

## Step 3: Building and installing Harbor 第 3 步：构建和安装 Harbor

### Configuration 配置

Copy the file **make/harbor.yml.tmpl** to **make/harbor.yml**, and make necessary configuration changes such as hostname, admin password and mail server. Refer to  [Harbor Installation and Configuration](https://goharbor.io/docs/2.11.0/install-config/) for more info.
将文件 make/harbor.yml.tmpl 复制到 make/harbor.yml，并进行必要的配置更改，例如主机名、管理员密码和邮件服务器。有关详细信息，请参阅 Harbor 安装和配置。

```sh
cd harbor
vi make/harbor.yml
```

### Compiling and Running 编译和运行

You can compile the code by one of the two approaches:
您可以通过以下两种方法之一编译代码：

#### I. Build with official Golang image I. 使用 Golang 官方镜像构建

- Build, install and bring up Harbor:
  构建、安装并启动 Harbor：

  ```sh
  make install COMPILETAG=compile_golangimage
  ```

#### II. Compile code with your own Golang environment, then build Harbor 二、使用自己的 Golang 环境编译代码，然后构建 Harbor

- Move source code to `$GOPATH`:
  将源代码移至 `$GOPATH` ：

  ```sh
  mkdir $GOPATH/src/github.com/goharbor/
  cd ..
  mv harbor $GOPATH/src/github.com/goharbor/.
  ```

- Build, install and run Harbor:
  构建、安装和运行 Harbor：

  ```sh
  cd $GOPATH/src/github.com/goharbor/harbor
  $ make install
  ```

### Verify your installation 验证您的安装

If everything works properly, you will see this message:
如果一切正常，您将看到以下消息：

```sh
...
Start complete. You can visit harbor now.
```

Refer to  [Reconfigure Harbor and Manage the Harbor Lifecycle](https://goharbor.io/docs/2.11.0/install-config/reconfigure-manage-lifecycle/) for more information about managing your Harbor instance.
有关管理 Harbor 实例的更多信息，请参阅重新配置 Harbor 和管理 Harbor 生命周期。

## Appendix 附录

- Using the Makefile 使用 Makefile

The `Makefile` contains these configurable parameters:
包含 `Makefile` 以下可配置参数：

| Variable 变量       | Description 描述                                             |
| ------------------- | ------------------------------------------------------------ |
| BASEIMAGE           | Container base image, default: photon 容器基础镜像，默认：photon |
| DEVFLAG             | Build model flag, default: dev 构建模型标志，默认：dev       |
| COMPILETAG          | Compile model flag, default: compile_normal (local golang build) 编译模型标志，默认：compile_normal（本地golang build） |
| TRIVYFLAG           | Trivy mode flag, default: false Trivy 模式标志，默认值：false |
| HTTPPROXY           | NPM http proxy for Clarity UI builder 用于 Clarity UI 构建器的 NPM http 代理 |
| REGISTRYSERVER      | Remote registry server IP address 远程注册表服务器 IP 地址   |
| REGISTRYUSER        | Remote registry server user name 远程注册表服务器用户名      |
| REGISTRYPASSWORD    | Remote registry server user password 远程注册表服务器用户密码 |
| REGISTRYPROJECTNAME | Project name on remote registry server 远程注册表服务器上的项目名称 |
| VERSIONTAG          | Harbor images tag, default: dev Harbor images 标签，默认：dev |
| PKGVERSIONTAG       | Harbor online and offline version tag, default:dev Harbor 线上下线版本标签，默认：dev |

- Predefined targets: 预定义目标：

| Target 目标                                   | Description 描述                                             |
| --------------------------------------------- | ------------------------------------------------------------ |
| all 都                                        | prepare env, compile binaries, build images and install images 准备 env、编译二进制文件、构建镜像和安装镜像 |
| prepare 准备                                  | prepare env 准备环境                                         |
| compile 编译                                  | compile ui and jobservice code 编译 UI 和 JobService 代码    |
| compile_portal                                | compile portal code 编译门户代码                             |
| compile_ui                                    | compile ui binary 编译 UI 二进制文件                         |
| compile_jobservice                            | compile jobservice binary 编译 jobservice 二进制文件         |
| build 建                                      | build Harbor docker images (default: using build_photon) 构建 Harbor docker 镜像（默认：使用 build_photon） |
| build_photon                                  | build Harbor docker images from Photon OS base image 从 Photon OS 基础镜像构建 Harbor docker 镜像 |
| install 安装                                  | compile binaries, build images, prepare specific version of compose file and startup Harbor instance 编译二进制文件，构建镜像，准备特定版本的复合文件并启动 Harbor 实例 |
| start 开始                                    | startup Harbor instance 启动 Harbor 实例                     |
| down 下                                       | shutdown Harbor instance shutdown Harbor 实例                |
| package_online                                | prepare online install package 准备联机安装包                |
| package_offline                               | prepare offline install package 准备脱机安装包               |
| pushimage PushImage（推送图像）               | push Harbor images to specific registry server 将 Harbor 镜像推送到特定的注册服务器 |
| cleanall 清洁所有                             | remove binary, Harbor images, specific version docker-compose file, specific version tag and online/offline install package 移除二进制文件、Harbor 镜像、特定版本 docker-compose 文件、特定版本标签和在线/离线安装包 |
| cleanbinary 干净二进制                        | remove ui and jobservice binary 删除 UI 和 JobService 二进制文件 |
| cleanimage 清洁图像                           | remove Harbor images 删除 Harbor 图像                        |
| cleandockercomposefile cleandockercompose文件 | remove specific version docker-compose 删除特定版本 docker-compose |
| cleanversiontag cleanVersion标签              | remove specific version tag 删除特定版本标记                 |
| cleanpackage 清洁包装                         | remove online/offline install package 删除在线/离线安装包    |

#### EXAMPLE: 例：

#### Push Harbor images to specific registry server 将 Harbor 镜像推送到特定的注册表服务器

```sh
make pushimage -e DEVFLAG=false REGISTRYSERVER=[$SERVERADDRESS] REGISTRYUSER=[$USERNAME] REGISTRYPASSWORD=[$PASSWORD] REGISTRYPROJECTNAME=[$PROJECTNAME]
```

**Note**: need to add “/” at the end of REGISTRYSERVER. If REGISTRYSERVER is not set, images will be pushed directly to Docker Hub.
注意：需要在REGISTRYSERVER的末尾加上“/”。如果未设置 REGISTRYSERVER，则镜像将直接推送到 Docker Hub。

```sh
make pushimage -e DEVFLAG=false REGISTRYUSER=[$USERNAME] REGISTRYPASSWORD=[$PASSWORD] REGISTRYPROJECTNAME=[$PROJECTNAME]
```

#### Clean up binaries and images of a specific version 清理特定版本的二进制文件和图像

```sh
make clean -e VERSIONTAG=[TAG]
```

​                        

​                 If new code has been added to Github, the git commit TAG will  change. Better use this command to clean up images and files of the  previous TAG.      
如果已将新代码添加到 Github，则 git commit TAG 将更改。最好使用此命令来清理前一个 TAG 的图像和文件。

#### By default, the make process creates a development build. To create a release build of Harbor, set the below flag to false. 默认情况下，make 过程会创建开发版本。要创建 Harbor 的发布版本，请将以下标志设置为 false。

```sh
make XXXX -e DEVFLAG=false
```

​                                  On this page       本页内容    

​      [Step 1: Prepare for a build environment for Harbor
第 1 步：为 Harbor 的构建环境做准备](https://goharbor.io/docs/2.11.0/build-customize-contribute/compile-guide/#step-1-prepare-for-a-build-environment-for-harbor)    [Step 2: Getting the source code
第 2 步：获取源代码](https://goharbor.io/docs/2.11.0/build-customize-contribute/compile-guide/#step-2-getting-the-source-code)    [Step 3: Building and installing Harbor
第 3 步：构建和安装 Harbor](https://goharbor.io/docs/2.11.0/build-customize-contribute/compile-guide/#step-3-building-and-installing-harbor)              [Appendix 附录](https://goharbor.io/docs/2.11.0/build-customize-contribute/compile-guide/#appendix)            

​                                  Contributing       贡献    

​      

​        ![Harbor footer logo](https://goharbor.io/img/logos/harbor-horizontal-color.svg)      

​        [                                                           GitHub            GitHub的         ](https://github.com/goharbor/harbor)        
​        [                                                           Logos            标志         ](https://github.com/cncf/artwork/tree/master/projects/harbor)      

​        [                                                           Slack            ](https://cloud-native.slack.com/messages/harbor)

## Customize the Look and Feel of Harbor      
自定义 Harbor 的外观和感觉

The primary look & feel of Harbor supports to be customized with  several simple steps. All the relevant customization in configurations  are saved in the `setting.json` file under `$HARBOR_DIR/src/portal/src` folder with `json` format and will be loaded when Harbor is launched.
Harbor 的主要外观和感觉支持通过几个简单的步骤进行定制。配置中的所有相关自定义都保存在带有 `json` 格式的文件夹下的 `setting.json`  `$HARBOR_DIR/src/portal/src` 文件中，并将在启动 Harbor 时加载。

## Configure 配置

Open the `setting.json` file, you’ll see the default content as shown below:
打开该文件 `setting.json` ，您将看到如下所示的默认内容：

```json
{
  "headerBgColor": {
    "darkMode": "",
    "lightMode": ""
  },
  "loginBgImg": "",
  "loginTitle": "",
  "product": {
    "name": "",
    "logo": "",
    "introduction": ""
  }
}
```

Change the values of configuration if you want to override the default style to your own. Here are references:
如果要将默认样式覆盖为自己的样式，请更改配置的值。以下是参考资料：

- headerBgColor

  : The background color of the page header, support either HEX or RGB value. e.g: 

  ```
  #004a70
  ```

   and 

  ```
  rgb(210,110,235)
  ```

  .

  
  headerBgColor：页眉的背景色，支持HEX或RGB值。例如： `#004a70` 和 `rgb(210,110,235)` .

  - **darkMode**: The background color of the page header for the dark mode.
    darkMode：深色模式的页眉背景色。
  - **lightMode**: The background color of the page header for the light mode.
    lightMode：浅色模式的页眉的背景色。

- **loginBgImg**: The name path of the background image displayed in the login page, e.g: ‘login_bg.png’. The image file should be put in the `images` folder. Suggest the size of this image should be bigger than 800px*600px.
  loginBgImg：登录页面中显示的背景图片的名称路径，例如：“login_bg.png”。图像文件应放在文件夹中 `images` 。建议此图片的大小应大于 800px*600px。

- **loginTitle**: The full product title displayed in the login page.
  loginTitle：登录页面中显示的完整产品标题。

- Product

  : Contain metadata / description of the product.

  
  产品：包含产品的元数据/描述。

  - **name**: The name of the product.
    name：产品的名称。
  - **logo**: The name path of the product logo, e.g: ‘logo.png’. The image file should be put in the `images` folder.
    logo：产品徽标的名称路径，例如：“logo.png”。图像文件应放在文件夹中 `images` 。
  - **introductions**: The introduction about the product, which are displayed in the `About` dialog.
    introductions：关于产品的介绍，显示在 `About` 对话框中。

## Build 建

Once the `setting.json` configurations has been updated, re- [build](https://goharbor.io/docs/2.11.0/build-customize-contribute/customize-look-feel/#configure) your product to apply the new changes.
更新配置 `setting.json` 后，重新构建您的产品以应用新的更改。

## Developing for Internationalization      
为国际化而发展

​                        

​                 All the files you created should use UTF-8 encoding.      
您创建的所有文件都应使用 UTF-8 编码。

There are several translations available for the Harbor portal. See the available  [translation files](https://github.com/goharbor/harbor/tree/main/src/portal/src/i18n/lang) for a full list of available languages.
Harbor 门户有多种翻译版本可供选择。有关可用语言的完整列表，请参阅可用的翻译文件。

​                        

​                 Harbor only officially supports the English and Chinese  translations, and both languages are verified for each release. If you  plan to use another translation, its recommended that you verify the  translations are correct for your Harbor version before implementing.      
Harbor 仅官方支持英文和中文翻译，并且每个版本都验证了这两种语言。如果您计划使用其他翻译，建议您在实施之前验证翻译是否适用于您的 Harbor 版本。

Use the steps below to add a translation for a new language to the Harbor portal.
使用以下步骤将新语言的翻译添加到 Harbor 门户。

1. In the folder `src/portal/src/i18n/lang`, copy json file `en-us-lang.json` to a new file and rename it to `<language>-<locale>-lang.json` .
   在文件夹中 `src/portal/src/i18n/lang` ，将json文件 `en-us-lang.json` 复制到一个新文件并将其重命名为 `<language>-<locale>-lang.json` 。

   The file contains a JSON object including all the key-value pairs of UI strings:
   该文件包含一个 JSON 对象，其中包含 UI 字符串的所有键值对：

   ```javascript
   {
     "APP_TITLE": {
       "VMW_HARBOR": "Harbor",
       "HARBOR": "Harbor",
       // ...
     },
     // ...
   }
   ```

   In the file `<language>-<locale>-lang.json`, translate all the values into your language. Do not change any keys.
   在文件中 `<language>-<locale>-lang.json` ，将所有值翻译成您的语言。请勿更改任何密钥。

2. Add the language to the set of supported languages in `src/portal/src/app/shared/entities/shared.const.ts`:
   将语言添加到以下版本中的 `src/portal/src/app/shared/entities/shared.const.ts` 受支持语言集：

   ```typescript
   export const LANGUAGES = {
       'en-us': ['English', locale_en],
       'zh-cn': ['中文简体', locale_zh_CN],
       '<language>-<locale>': ['<DISPLAY_NAME>', '<LOCALE_DATA>'],
   } as const;
   ```

​                        

For `LOCALE_DATA`, You need to import it correctly:
为此 `LOCALE_DATA` ，您需要正确导入它：

```typescript
import locale_en 
  from '@angular/common/locales/en';
import locale_zh_CN 
  from '@angular/common/locales/zh-Hans';
```

1. Next, refer to  [Build Harbor from Source Code](https://goharbor.io/docs/2.11.0/build-customize-contribute/compile-guide/) to rebuild and restart Harbor.
   接下来，参考 从源代码构建 Harbor 来重建并重启 Harbor。

## Contributing localizations to Harbor 为 Harbor 提供本地化

If you’d like to  [contribute your localization file](https://github.com/goharbor/harbor/blob/main/CONTRIBUTING.md) to the Harbor project, please make a pull request with the changes from the instructions above. Please do your best to make sure your  translations are correct and easily understood by speakers of that  language.
如果您想将本地化文件贡献给 Harbor 项目，请根据上述说明中的更改提出拉取请求。请尽最大努力确保您的翻译正确无误，并且该语言的使用者易于理解。

Finding reviewers for a translation PR is best effort, maintainers may not be  able to review the pull request because they do not speak or read the  language of your contribution. If you know of another community member  who can help with reviewing the pull request, make sure to tag them when you open the PR. You should also plan to attend a community meeting to  raise awareness for your pull request and ask the community for help  reviewing.
为翻译 PR 寻找审阅者是最大的努力，维护者可能无法审阅拉取请求，因为他们不会说或读您贡献的语言。如果你知道另一个社区成员可以帮助审查拉取请求，请确保在打开 PR 时标记他们。您还应该计划参加社区会议，以提高对拉取请求的认识，并寻求社区帮助进行审查。

Your contribution may still be accepted without additional reviews even if  we aren’t able to find someone to review the translations in your pull  request.
即使我们无法找到某人来审查您的拉取请求中的翻译，您的贡献仍然可以被接受，而无需额外审查。

## Developing the Harbor Frontend      
开发 Harbor 前端

If you already have a harbor backend environment, you can build a frontend development environment with the following configuration.
如果您已经有了 Harbor 后端环境，则可以使用以下配置构建前端开发环境。

1. Open the terminal and run the following command to copy “proxy.config.mjs.temp” file to “proxy.config.mjs”.
   打开终端并运行以下命令，将“proxy.config.mjs.temp”文件复制到“proxy.config.mjs”。

   ```sh
   cd harbor/src/portal
   cp proxy.config.mjs.temp proxy.config.mjs
   ```

   **NOTE:** You should specify an available Harbor hostname. And you can specify the agent if you work behind a corporate proxy.
   注意：您应指定一个可用的 Harbor 主机名。如果您在公司代理后面工作，则可以指定代理。

```js
import HttpsProxyAgent from 'https-proxy-agent';
// Define the proxy configuration
const HarborProxyConfig = [
  {
    "context": [
      "/api",
      "/c",
      "/i18n",
      "/chartrepo",
      "/LICENSE",
      "/swagger.json",
      "/devcenter-api-2.0",
      "/swagger-ui.bundle.js"
    ],
    "target": "${A Harbor server}",
    "secure": false,
    "changeOrigin": true,
    "logLevel": "debug"
  }
];
// Define if you use agent
const useAgent = false;
// Specify an agent server, if empty, will read it from environment variable http_proxy or HTTP_PROXY
const specifiedAgentServer = "${An agent server}";

function setupForCorporateProxy(proxyConfig) {
  if (useAgent) {
    const agentServer = process.env.http_proxy || process.env.HTTP_PROXY || specifiedAgentServer;
    if (agentServer) {
      const agent = new HttpsProxyAgent(agentServer);
      console.log('Using corporate agent server: ' + agentServer);
      proxyConfig.forEach(function (entry) {
        entry.agent = agent;
      });
    }
  }
  return proxyConfig;
}

export default setupForCorporateProxy(HarborProxyConfig);  
```

1. Install npm packages and 3rd-party dependencies.
   安装 npm 包和第三方依赖项。

   ```sh
   npm install
   ```

2. Execute the following command，serve Harbor locally.
   执行以下命令，在本地服务 Harbor。

   ```sh
   npm run start
   ```

3. Then you can visit the Harbor by address: https://localhost:4200.
   然后，您可以通过地址访问港口：https://localhost:4200。

## Documentation Style Guide      
文档样式指南

*This style guide is adapted from the  [Kubernetes style guide](https://kubernetes.io/docs/contribute/style/style-guide/).
本风格指南改编自 Kubernetes 风格指南。*

This page outlines writing style guidelines for the Harbor documentation and you should use it as a reference as you write or edit content. These  are guidelines, not rules. Use your best judgment as you write  documentation, and feel free to propose changes to these guidelines.
本页概述了 Harbor 文档的写作风格指南，您在编写或编辑内容时应将其用作参考。这些是指导方针，而不是规则。在编写文档时，请运用您的最佳判断力，并随时对这些准则提出更改建议。

Changes to the style guide are made by the Harbor maintainers as a group. To propose a change or addition create an  [issue/PR](https://github.com/goharbor/harbor/issues), or come to a  [community meeting](https://goharbor.io/community/) to discuss your suggestions.
对样式指南的更改是由 Harbor 维护者作为一个小组进行的。要提出更改或添加建议，请创建问题/PR，或参加社区会议以讨论您的建议。

The Harbor documentation uses the  [Goldmark](https://gohugo.io/getting-started/configuration-markup/#goldmark) Markdown renderer.
Harbor 文档使用 Goldmark Markdown 渲染器。

## Content best practices 内容最佳做法

### Use present tense 使用现在时

| Do 做                                         | Don’t 不要                                              |
| --------------------------------------------- | ------------------------------------------------------- |
| This command starts a proxy. 此命令启动代理。 | This command will start a proxy. 此命令将启动一个代理。 |

Exception: Use future or past tense if it is required to convey the correct meaning.
例外：如果需要传达正确的含义，请使用将来时或过去时。

### Use active voice 使用主动语态

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| You can explore the API using a browser. 您可以使用浏览器浏览 API。 | The API can be explored using a browser. 可以使用浏览器浏览 API。 |
| The YAML file specifies the replica count. YAML 文件指定副本计数。 | The replica count is specified in the YAML file. 副本计数在 YAML 文件中指定。 |

Exception: Use passive voice if active voice leads to an awkward sentence construction.
例外：如果主动语态导致尴尬的句子结构，则使用被动语态。

### Use simple and direct language 使用简单直接的语言

Use simple and direct language. Avoid using unnecessary phrases, such as saying “please.”
使用简单直接的语言。避免使用不必要的短语，例如说“请”。

| Do 做                                            | Don’t 不要                                                   |
| ------------------------------------------------ | ------------------------------------------------------------ |
| To create a ReplicaSet, … 要创建 ReplicaSet，... | In order to create a ReplicaSet, … 为了创建 ReplicaSet，...  |
| See the configuration file. 请参阅配置文件。     | Please see the configuration file. 请参阅配置文件。          |
| View the Pods. 查看 Pod。                        | With this next command, we’ll view the Pods. 使用下一个命令，我们将查看 Pod。 |

### Address the reader as “you” 称呼读者为“您”

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| You can create a Deployment by … 您可以通过以下方式创建部署... | We’ll create a Deployment by … 我们将通过以下方式创建部署... |
| In the preceding output, you can see… 在前面的输出中，您可以看到... | In the preceding output, we can see … 在前面的输出中，我们可以看到... |

### Avoid Latin phrases 避免使用拉丁语短语

Prefer English terms over Latin abbreviations.
更喜欢英语术语而不是拉丁语缩写。

| Do 做                     | Don’t 不要           |
| ------------------------- | -------------------- |
| For example, … 例如。。。 | e.g., … 例如，...... |
| That is, … 那是。。。     | i.e., … 即，......   |

Exception: Use “etc.” for et cetera.
例外：使用“etc.”表示等。

## Patterns to avoid 要避免的模式

### Avoid using “we” 避免使用“我们”

Using “we” in a sentence can be confusing, because the reader might not know whether they’re part of the “we” you’re describing.
在句子中使用“我们”可能会令人困惑，因为读者可能不知道他们是否是你所描述的“我们”的一部分。

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| Version 1.4 includes … 版本 1.4 包括 ...                     | In version 1.4, we have added … 在版本 1.4 中，我们添加了 ... |
| Kubernetes provides a new feature for … Kubernetes 为...     | We provide a new feature … 我们提供了一个新功能...           |
| This page teaches you how to use Pods. 本页教你如何使用 Pods。 | In this page, we are going to learn about Pods. 在本页中，我们将了解 Pod。 |

### Avoid jargon and idioms 避免使用行话和习语

Many readers speak English as a second language. Avoid jargon and idioms to help them understand better.
许多读者将英语作为第二语言。避免使用行话和习语，以帮助他们更好地理解。

| Do 做                              | Don’t 不要                              |
| ---------------------------------- | --------------------------------------- |
| Internally, … 内部。。。           | Under the hood, … 在引擎盖下，......    |
| Create a new cluster. 创建新集群。 | Turn up a new cluster. 打开一个新集群。 |

### Avoid statements about the future or that will soon be out of date 避免关于未来或即将过时的陈述

Avoid making promises or giving hints about the future. If you need to talk about a beta feature, put the text under a heading that identifies it as beta information.
避免做出承诺或暗示未来。如果您需要谈论 beta 功能，请将文本放在将其标识为 beta 信息的标题下。

Also avoid words like “recently”, “currently” and “new.” A feature that is new today might not be considered new in a few months.
还要避免使用“最近”、“当前”和“新”等词语。今天是新功能的功能可能在几个月后就不会被视为新功能。

| Do 做                                             | Don’t 不要                                                |
| ------------------------------------------------- | --------------------------------------------------------- |
| In version 1.4, … 在版本 1.4 中，...              | In the current version, … 在当前版本中，...               |
| The Federation feature provides … 联合功能提供... | The new Federation feature provides … 新的联合功能提供... |

### Language 语言

This documentation uses U.S. English spelling and grammar.
本文档使用美国英语拼写和语法。

## Documentation formatting standards 文档格式标准

### Use angle brackets for placeholders 使用尖括号作为占位符

Use angle brackets for placeholders. Tell the reader what a placeholder represents.
使用尖括号作为占位符。告诉读者占位符代表什么。

1. Display information about a Pod:
   显示有关 Pod 的信息：

   ```
    kubectl describe pod <pod-name> -n <namespace>
   ```

   If the pod is in the default namespace, you can omit the ‘-n’ parameter.
   如果 pod 位于默认命名空间中，则可以省略 '-n' 参数。

### Use bold for user interface elements 对用户界面元素使用粗体

| Do 做                          | Don’t 不要                   |
| ------------------------------ | ---------------------------- |
| Click **Fork**. 单击 Fork。    | Click “Fork”. 点击“Fork”。   |
| Select **Other**. 选择“其他”。 | Select “Other”. 选择“其他”。 |

### Use code style for filenames, directories, paths, object field names and namespaces 对文件名、目录、路径、对象字段名称和命名空间使用代码样式

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| Open the `envars.yaml` file. 打开文件 `envars.yaml` 。       | Open the envars.yaml file. 打开 envars.yaml 文件。           |
| Go to the `/docs/tutorials` directory. 转到 `/docs/tutorials` 目录。 | Go to the /docs/tutorials directory. 转到 /docs/tutorials 目录。 |
| Open the `/_data/concepts.yaml` file. 打开文件 `/_data/concepts.yaml` 。 | Open the /_data/concepts.yaml file. 打开 /_data/concepts.yaml 文件。 |

### Use punctuation inside quotes 在引号内使用标点符号

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| events are recorded with an associated “stage.” 事件通过关联的“舞台”进行记录。 | events are recorded with an associated “stage”. 事件与关联的“阶段”一起记录。 |
| The copy is called a “fork.” 该副本称为“分叉”。              | The copy is called a “fork”. 该副本称为“分叉”。              |

Exception: When the quoted word is a user input.
异常：当引用的单词是用户输入时。

Example: 例：

- My user ID is “IM47g”.
  我的用户ID是“IM47g”。
- Did you try the password “mycatisawesome”?
  你试过密码“mycatisawesome”吗？

## Inline code formatting 内联代码格式

### Use code style for inline code and commands 对内联代码和命令使用代码样式

For inline code in an HTML document, use the `<code>` tag. In a Markdown document, use the backtick (```).
对于 HTML 文档中的内联代码，请使用标记 `<code>` 。在 Markdown 文档中，使用反引号 （ ``` ）。

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| The `kubectl run` command creates a Deployment. 该 `kubectl run` 命令创建部署。 | The “kubectl run” command creates a Deployment. “kubectl run”命令创建一个 Deployment。 |
| For declarative management, use `kubectl apply`. 对于声明式管理，请使用 `kubectl apply` . | For declarative management, use “kubectl apply”. 对于声明式管理，请使用“kubectl apply”。 |
| Use single backticks to enclose inline code. For example, `var example = true`. 使用单反引号将内联代码括起来。例如， `var example = true` . | Use two asterisks (`**`) or an underscore (`_`) to enclose inline code. For example, **var example = true**. 使用两个星号 （ `**` ） 或下划线 （ `_` ） 将内联代码括起来。例如，var example = true。 |
| Use triple backticks (```) before and after a multi-line block of code for fenced code blocks. 在多行代码块之前和之后使用三重反引号 （'''） 对于受防护的代码块。 | Use multi-line blocks of code to create diagrams, flowcharts, or other illustrations. 使用多行代码块创建图表、流程图或其他插图。 |
| Use meaningful variable names that have a context. 使用具有上下文的有意义的变量名称。 | Use variable names such as ‘foo’,‘bar’, and ‘baz’ that are not meaningful and lack context. 使用变量名称，例如 'foo'、'bar' 和 'baz'，这些名称没有意义且缺乏上下文。 |
| Remove trailing spaces in the code. 删除代码中的尾随空格。   | Add trailing spaces in the code, where these are important, because a screen reader will read out the spaces as well. 在代码中添加尾随空格，因为屏幕阅读器也会读出空格。 |

### Use normal style for string and integer field values 对字符串和整数字段值使用普通样式

For field values of type string or integer, use normal style without quotation marks.
对于字符串或整数类型的字段值，请使用不带引号的普通样式。

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| Set the value of `imagePullPolicy` to `Always`. 将 的值 `imagePullPolicy` 设置为 `Always` 。 | Set the value of `imagePullPolicy` to “Always”. 将值 `imagePullPolicy` 设置为“始终”。 |
| Set the value of `image` to `nginx:1.16`. 将 的值 `image` 设置为 `nginx:1.16` 。 | Set the value of `image` to nginx:1.16. 将的值 `image` 设置为 nginx：1.16。 |
| Set the value of the `replicas` field to `2`. 将 `replicas` 字段的值设置为 `2` 。 | Set the value of the `replicas` field to 2. 将 `replicas` 字段的值设置为 2。 |

## Code snippet formatting 代码片段格式设置

### Don’t include the command prompt 不包括命令提示符

| Do 做                              | Don’t 不要                            |
| ---------------------------------- | ------------------------------------- |
| kubectl get pods kubectl 获取 pods | $ kubectl get pods $ kubectl 获取 pod |

### Separate commands from output 将命令与输出分开

Verify that the Pod is running on your chosen node:
验证 Pod 是否正在您选择的节点上运行：

```fallback
kubectl get pods --output=wide
```

The output is similar to this:
输出类似于以下内容：

```fallback
NAME     READY     STATUS    RESTARTS   AGE    IP           NODE
nginx    1/1       Running   0          13s    10.200.0.4   worker0
```

## Harbor word list 港湾词表

A list of Harbor-specific terms and words to be used consistently across the site.
在整个站点中一致使用的特定于 Harbor 的术语和单词的列表。

| Trem 特雷姆        | Usage 用法                                                   |
| ------------------ | ------------------------------------------------------------ |
| Kubernetes         | Kubernetes should always be capitalized. Kubernetes 应始终大写。 |
| Harbor 港          | Harbor should always be capitalized. Harbor 应始终大写。     |
| Docker 码头工人    | Docker should always be capitalized. Docker 应始终大写。     |
| Allowlist 允许列表 | Use allowlist instead of whitelist. 使用白名单而不是白名单。 |
| Denylist 拒绝列表  | Use denylist instead of blacklist. 使用拒绝列表而不是黑名单。 |

## Markdown elements Markdown 元素

### Headings 标题

People accessing this documentation may use a screen reader or other assistive technology (AT).  [Screen readers](https://en.wikipedia.org/wiki/Screen_reader) are linear output devices, they output items on a page one at a time.  If there is a lot of content on a page, you can use headings to give the page an internal structure. A good page structure helps all readers to  easily navigate the page or filter topics of interest.
访问此文档的人员可以使用屏幕阅读器或其他辅助技术 （AT）。屏幕阅读器是线性输出设备，它们一次输出一个页面上的项目。如果页面上有很多内容，您可以使用标题为页面提供内部结构。一个好的页面结构可以帮助所有读者轻松浏览页面或过滤感兴趣的主题。

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| Include a title on each page or blog post. 在每页或博客文章中包含一个标题。 | Include more than one title headings (#) in a page. 在页面中包含多个标题 （#）。 |
| Use ordered headings to provide a meaningful high-level outline of your content. 使用有序的标题来提供有意义的内容高级大纲。 | Use headings level 4 through 6, unless it is absolutely necessary. If your  content is that detailed, it may need to be broken into separate  articles. 除非绝对必要，否则请使用 4 级到 6 级标题。如果你的内容那么详细，可能需要把它分成单独的文章。 |
| Use title case for headings. For example, **Extend Kubectl With Plugins** 使用标题大小写作为标题。例如，使用插件扩展 kubectl | Use sentence case for headings. For example, **Extend kubectl with plugins** 使用句子大小写作为标题。例如，使用插件扩展 kubectl |

### Paragraphs 段落

| Do 做                                                        | Don’t 不要                                                  |
| ------------------------------------------------------------ | ----------------------------------------------------------- |
| Try to keep paragraphs under 6 sentences. 尽量将段落保持在 6 句话以内。 | Write long-winded paragraphs. 写啰嗦的段落。                |
| Use three hyphens (`---`) to create a horizontal rule for breaks in paragraph content. 使用三个连字符 （ `---` ） 为段落内容中的分隔符创建水平规则。 | Use horizontal rules for decoration. 使用水平规则进行装饰。 |

### Links 链接

| Do 做                                                        | Don’t 不要                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| Write hyperlinks that give you context for the content they link to. For example: Certain ports are open on your machines. See  [check required ports](https://goharbor.io/docs/2.11.0/build-customize-contribute/style-guide/#check-required-ports) for more details. 编写超链接，为您提供它们链接到的内容的上下文。例如：您的计算机上的某些端口已打开。有关更多详细信息，请参阅检查所需端口。 | Use ambiguous terms such as “click here”. For example: Certain ports are open on your machines. See  [here](https://goharbor.io/docs/2.11.0/build-customize-contribute/style-guide/#check-required-ports) for more details. 使用模棱两可的术语，例如“单击此处”。例如：您的计算机上的某些端口已打开。有关详细信息，请参阅此处。 |
| Write Markdown-style links: `[link text](URL)`. For example: `[community meeting agenda](https://hackmd.io/Jq6F5zqZR7S80CeDWUklkA)` and the output is   [community meeting agenda](https://hackmd.io/Jq6F5zqZR7S80CeDWUklkA). 编写 Markdown 样式的链接： `[link text](URL)` .例如： `[community meeting agenda](https://hackmd.io/Jq6F5zqZR7S80CeDWUklkA)` 输出是社区会议议程。 | Write HTML-style links: `<a href="/media/examples/link-element-example.css" target="_blank">Visit our tutorial!</a>` 编写 HTML 样式的链接： `<a href="/media/examples/link-element-example.css" target="_blank">Visit our tutorial!</a>` |

### Lists 列表

Group items in a list that are related to each other and need to appear in a  specific order or to indicate a correlation between multiple items. When a screen reader comes across a list—whether it is an ordered or  unordered list—it will be announced to the user that there is a group of list items. The user can then use the arrow keys to move up and down  between the various items in the list. Website navigation links can also be marked up as list items; after all  they are nothing but a group of related links.
对列表中相互关联的项目进行分组，这些项目需要按特定顺序显示，或者需要指示多个项目之间的相关性。当屏幕阅读器遇到列表时（无论是有序列表还是无序列表），都会向用户宣布存在一组列表项。然后，用户可以使用箭头键在列表中的各个项目之间上下移动。网站导航链接也可以标记为列表项;毕竟，它们只不过是一组相关的链接。

- End each item in a list with a period if one or more items in the list are  complete sentences. For the sake of consistency, normally either all  items or none should be complete sentences.
  如果列表中的一个或多个项目是完整的句子，则用句点结束列表中的每个项目。为了保持一致性，通常所有项目或任何项目都应是完整的句子。
- Ordered lists that are part of an incomplete introductory sentence can be in  lowercase and punctuated as if each item was a part of the introductory  sentence.
  属于不完整介绍句的有序列表可以是小写的，也可以用标点符号括起来，就好像每个项目都是介绍句的一部分一样。
- Use the number one (`1.`) for ordered lists.
  使用数字 1 （ `1.` ） 表示有序列表。
- Use (`+`), (`*`), or (`-`) for unordered lists - be consistent within the same document.
  使用 （ `+` ）、（ `*` ） 或 （ `-` ） 表示无序列表 - 在同一文档中保持一致。
- Leave a blank line after each list.
  在每个列表后留一个空行。
- Indent nested lists with four spaces (for example, ⋅⋅⋅⋅).
  缩进包含四个空格的嵌套列表（例如，⋅⋅⋅⋅）。
- List items may consist of multiple paragraphs. Each subsequent paragraph in a list item must be indented by either four spaces or one tab.
  列表项可以由多个段落组成。列表项中的每个后续段落必须缩进四个空格或一个制表符。

### Tables 表

The semantic purpose of a data table is to present tabular data. Sighted  users can quickly scan the table but a screen reader goes through line  by line. A table  [caption](https://www.w3schools.com/tags/tag_caption.asp) is used to create a descriptive title for a data table. Assistive  technologies (AT) use the HTML table caption element to identify the  table contents to the user within the page structure.
数据表的语义用途是呈现表格数据。视力正常的用户可以快速扫描表格，但屏幕阅读器会逐行扫描。表标题用于为数据表创建描述性标题。辅助技术 （AT） 使用 HTML 表格标题元素在页面结构中向用户标识表格内容。

If you need to create a table, create the table in markdown and use the table  [Hugo shortcode](https://gohugo.io/content-management/shortcodes/) to include a caption.
如果需要创建表格，请在 markdown 中创建表格，并使用表格 Hugo 短代码来包含标题。

```fallback
{{< table caption="Configuration parameters" >}}
Parameter | Description | Default
:---------|:------------|:-------
`timeout` | The timeout for requests | `30s`
`logLevel` | The log level for log output | `INFO`
{{< /table >}}
```

**Note:** This shortcode does not support markdown reference-style links. Use inline-style links in tables. See more information about  [markdown link styles](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#links).
注意：此短代码不支持 markdown 引用样式链接。在表格中使用内联样式的链接。请参阅有关 Markdown 链接样式的更多信息。

## Registry Landscape       注册管理机构环境

The cloud native ecosystem is moving rapidly—registries and their feature  sets are no exception. We’ve made our best effort to survey the  container registry landscape and compare to our core feature set.
云原生生态系统正在迅速发展，注册管理机构及其功能集也不例外。我们已尽最大努力调查容器注册表环境，并与我们的核心功能集进行比较。

This table is maintained by contributions from the Harbor community. If you  find something outdated or outright erroneous, please submit a PR and  we’ll fix it right away.
此表由 Harbor 社区的贡献维护。如果您发现某些内容过时或完全错误，请提交 PR，我们将立即修复。

| Feature 特征                                                 | Harbor 港 | Docker Trusted Registry Docker 可信注册表 | Quay 码头    | Cloud Providers (GCP, AWS, Azure) 云提供商（GCP、AWS、Azure） | Distribution/Distribution 分销/分销 | Artifactory 工器， | GitLab GitLab的 |
| ------------------------------------------------------------ | --------- | ----------------------------------------- | ------------ | ------------------------------------------------------------ | ----------------------------------- | ------------------ | --------------- |
| Ability to Determine Version of Binaries in Containers 能够确定容器中二进制文件的版本 | ✓         | ✓                                         | ✓            | ✗                                                            | ✗                                   | ?                  | ?               |
| Artifact Repository (rpms, git, jar, etc) 工件仓库（rpms、git、jar 等） | ✗         | ✗                                         | ✗            | ✗                                                            | ✗                                   | ✓                  | partial 部分    |
| Audit Logs 审核日志                                          | ✓         | ✓                                         | ✓            | ✓                                                            | ✗                                   | ✓                  | ✓               |
| Content Trust and Validation 内容信任和验证                  | ✓         | ✓                                         | ✓            | ✗                                                            | partial 部分                        | partial 部分       | ✗               |
| Custom TLS Certificates 自定义 TLS 证书                      | ✓         | ✓                                         | ✓            | ✗                                                            | ✓                                   | ✓                  | ✓               |
| Helm Chart Repository Manager Helm Chart 仓库管理器          | ✓         | ✗                                         | partial 部分 | ✗                                                            | ✗                                   | ✓                  | ✗               |
| LDAP-based Auth 基于 LDAP 的身份验证                         | ✓         | ✓                                         | ✓            | partial 部分                                                 | ✗                                   | ✓                  | ✓               |
| Local Auth 本地身份验证                                      | ✓         | ✓                                         | ✓            | ✓                                                            | ✗                                   | ✓                  | ✓               |
| Metrics 指标                                                 | ✓         | ✓                                         | ✓            | ✓                                                            | ✓                                   | ✓                  | ✓               |
| Multi-Tenancy (projects, teams, namespaces, etc) 多租户（项目、团队、命名空间等） | ✓         | ✓                                         | ✓            | partial 部分                                                 | ✗                                   | ✓                  | ✓               |
| Open Source 开源                                             | ✓         | partial 部分                              | ✓            | ✗                                                            | ✓                                   | partial 部分       | partial 部分    |
| Project Quotas (by storage consumption) 项目配额（按存储消耗量） | ✓         | ✗                                         | ✓            | partial 部分                                                 | ✗                                   | ✗                  | ✗               |
| Replication between instances 实例之间的复制                 | ✓         | ✓                                         | ✓            | n/a 不适用                                                   | ✗                                   | ✓                  | ✗               |
| Replication between non-instances 非实例之间的复制           | ✓         | ✗                                         | ✓            | n/a 不适用                                                   | ✗                                   | ✗                  | ✗               |
| Robot Accounts for Helm Charts Helm Charts 的机器人帐户      | ✓         | ✗                                         | ✗            | ?                                                            | ✗                                   | ✗                  | ✗               |
| Robot Accounts for Images 机器人帐户用于图像                 | ✓         | ?                                         | ✓            | ?                                                            | ✗                                   | ?                  | ?               |
| Role-Based Access Control 基于角色的访问控制                 | ✓         | ✓                                         | ✓            | ✓                                                            | ✗                                   | ✓                  | ✗               |
| Single Sign On (OIDC) 单点登录 （OIDC）                      | ✓         | ✓                                         | ✓            | ✓                                                            | ✗                                   | partial 部分       | ✗               |
| Tag Retention Policy 标签保留政策                            | ✓         | ✗                                         | ✓            | ✗                                                            | ✗                                   | ✗                  | ✗               |
| Upstream Registry Proxy Cache 上游注册表代理缓存             | ✓         | ✓                                         | ✗            | ✗                                                            | ✓                                   | ✓                  | ✗               |
| Vulnerability Scanning & Monitoring 漏洞扫描和监控           | ✓         | ✓                                         | ✓            | ✗                                                            | ✗                                   | ✓                  | partial 部分    |
| Vulnerability Scanning Plugin Framework 漏洞扫描插件框架     | ✓         | ✗                                         | ✓            | ✗                                                            | ✗                                   | ✗                  | ✗               |
| Vulnerability Allowlisting 漏洞白名单                        | ✓         | ✗                                         | ✗            | ✗                                                            | ✗                                   | ✗                  | ✗               |
| Webhooks Webhook                                             | ✓         | ✓                                         | ✓            | ✓                                                            | ✓                                   | ✓                  | ✓               |

​                                  Contributing       贡献    

##       Using Make       使用 Make

## Variables 变量

| Variable 变量 | Description 描述                                             |
| ------------- | ------------------------------------------------------------ |
| BASEIMAGETAG  | The tag for base image, default:dev 基础镜像的标签，default：dev |
| VERSIONTAG    | The tag for harbor image, default:dev harbor image 的标签，default：dev |
| DEVFLAG       | Build model flag, default: true 构建模型标志，默认值：true   |
| GOBUILDIMAGE  | Golang image to compile harbor go source code. Golang 镜像编译 harbor go 源码。 |
| TRIVYFLAG     | Whether to enable trivy in harbor, default:false 是否在 harbor 中启用 trivy，默认：false |
| CHARTFLAG     | Whether to enable chartmuseum in harbor, default:false 是否在港口开启 chartmuseum，默认：false |
| HTTPPROXY     | Clarity proxy to build UI. 用于构建 UI 的清晰度代理。        |

## Targets 目标

| Target 目标                                   | Description 描述                                             |
| --------------------------------------------- | ------------------------------------------------------------ |
| all 都                                        | prepare env, compile binaries, build images and install images 准备 env、编译二进制文件、构建镜像和安装镜像 |
| prepare 准备                                  | prepare env 准备环境                                         |
| compile 编译                                  | compile core and jobservice code 编译 Core 和 JobService 代码 |
| compile_core                                  | compile core binary 编译核心二进制文件                       |
| compile_jobservice                            | compile jobservice binary 编译 jobservice 二进制文件         |
| build 建                                      | build Harbor docker images 构建 Harbor docker 镜像           |
| build_base_docker                             | build Harbor docker base images 构建 Harbor docker 基础镜像  |
| install 安装                                  | compile binaries, build images, prepare specific version of compose file and startup Harbor instance 编译二进制文件，构建镜像，准备特定版本的复合文件并启动 Harbor 实例 |
| start 开始                                    | startup Harbor instance 启动 Harbor 实例                     |
| down 下                                       | shutdown Harbor instance shutdown Harbor 实例                |
| package_online                                | prepare online install package 准备联机安装包                |
| package_offline                               | prepare offline install package 准备脱机安装包               |
| pushimage PushImage（推送图像）               | push Harbor images to specific registry server 将 Harbor 镜像推送到特定的注册服务器 |
| cleanall 清洁所有                             | remove binary, Harbor images, specific version docker-compose file, specific version tag and online/offline install package 移除二进制文件、Harbor 镜像、特定版本 docker-compose 文件、特定版本标签和在线/离线安装包 |
| cleanbinary 干净二进制                        | remove core and jobservice binary 删除 Core 和 JobService 二进制文件 |
| cleanimage 清洁图像                           | remove Harbor images 删除 Harbor 图像                        |
| cleandockercomposefile cleandockercompose文件 | remove specific version docker-compose 删除特定版本 docker-compose |
| cleanpackage 清洁包装                         | remove online/offline install package 删除在线/离线安装包    |

## Examples 例子

### Build and run harbor from source code 从源代码构建并运行 Harbor

```sh
make install
```

### Package offline installer 打包脱机安装程序

```sh
make package_offline
```