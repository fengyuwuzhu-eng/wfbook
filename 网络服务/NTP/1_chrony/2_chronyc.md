# chronyc

[TOC]

chronyc - command-line interface for chrony daemon

## 概要

```bash
chronyc [OPTION]... [COMMAND]...
```

## 描述

If no commands are specified on the command line, **chronyc** will expect input from the user. The prompt *chronyc>* will be displayed when it is being run from a terminal. If **chronyc**'s input or output are redirected from or to a file, the prompt will not be shown.
如果命令行上没有指定任何命令，chronyc 将需要来自用户的输入。从终端运行提示 chronyc> 时将显示提示符。如果chronyc的输入或输出是从文件重定向到文件或重定向到文件，则不会显示提示。

There are two ways **chronyc** can access **chronyd**. One is the Internet Protocol (IPv4 or IPv6) and the other is a Unix domain socket, which is accessible locally by the root or *chrony* user. By default, **chronyc** first tries to connect to the Unix domain socket. The compiled-in default path is */var/run/chrony/chronyd.sock*. If that fails (e.g. because **chronyc** is running under a non-root user), it will try to connect to 127.0.0.1 and then ::1.
chronyc 可以通过两种方式访问 chronyd。一种是 Internet 协议（IPv4 或 IPv6），另一种是 Unix 域套接字，可由 root  用户或长期用户在本地访问。默认情况下，chronyc 首先尝试连接到 Unix 域套接字。编译的默认路径是  /var/run/chrony/chronyd.sock。如果失败（例如，因为 chronyc 在非 root 用户下运行），它将尝试连接到  127.0.0.1，然后 ：：1。

Only the following monitoring commands, which do not affect the behaviour of **chronyd**, are allowed from the network: **activity**, **manual list**, **rtcdata**, **smoothing**, **sourcename**, **sources**, **sourcestats**, **tracking**, **waitsync**. The set of hosts from which **chronyd** will accept these commands can be configured with the [**cmdallow**](https://chrony-project.org/doc/4.5/chrony.conf.html#cmdallow) directive in the **chronyd**'s configuration file or the [**cmdallow**](https://chrony-project.org/doc/4.5/chronyc.html#cmdallow) command in **chronyc**. By default, the commands are accepted only from localhost (127.0.0.1 or ::1).
网络只允许使用以下不影响 chronyd 行为的监控命令：activity、manual  list、rtcdata、smoothing、sourcename、sources、sourcestats、tracking、waitsync。chronyd 将接受这些命令的主机集可以使用 chronyd 配置文件中的 cmdallow 指令或 chronyc 中的 cmdallow  命令进行配置。默认情况下，仅接受来自 localhost（127.0.0.1 或 ：：1）的命令。

All other commands are allowed only through the Unix domain socket. When sent over the network, **chronyd** will respond with a ‘Not authorised’ error, even if it is from localhost.
所有其他命令只允许通过 Unix 域套接字。当通过网络发送时，chronyd 将响应“未授权”错误，即使它来自 localhost。

Having full access to **chronyd** via **chronyc** is more or less equivalent to being able to modify the **chronyd**'s configuration file and restart it.
通过 chronyc 完全访问 chronyd 或多或少等同于能够修改 chronyd 的配置文件并重新启动它。

## 选项

- -4

  使用此选项，主机名将仅解析为 IPv4 地址。

- -6

  使用此选项，主机名将仅解析为 IPv6 地址。

- -n

  This option disables resolving of IP addresses to hostnames, e.g. to avoid slow DNS lookups. Long addresses will not be truncated to fit into the column. 此选项禁用将 IP 地址解析为主机名，例如避免缓慢的 DNS 查找。长地址不会被截断以适合该列。

- -N

  This option enables printing of original hostnames or IP addresses of NTP sources that were specified in the configuration file, or **chronyc** commands. Without the **-n** and **-N** option, the printed hostnames are obtained from reverse DNS lookups and can be different from the specified hostnames. 此选项允许打印配置文件或 chronyc 命令中指定的 NTP 源的原始主机名或 IP 地址。如果没有 -n 和 -N 选项，打印的主机名是从反向 DNS 查找中获取的，并且可能与指定的主机名不同。

- -c

  This option enables printing of reports in a comma-separated values (CSV) format. Reverse DNS lookups will be disabled, time will be printed as number of seconds since the epoch, and values in seconds will not be converted to other units. 此选项允许以逗号分隔值 （CSV） 格式打印报告。反向 DNS 查找将被禁用，时间将打印为自纪元以来的秒数，并且以秒为单位的值不会转换为其他单位。

- -e

  With this option each **chronyc** response will end with a line containing a single dot. 使用此选项，每个 chronyc 响应都将以包含单个点的行结尾。

- -d

  This option enables printing of debugging messages if **chronyc** was compiled with debugging support. 如果chronyc是使用调试支持编译的，则此选项允许打印调试消息。

- -m

  Normally, all arguments on the command line are interpreted as one command. With this option multiple commands can be specified. Each argument will be interpreted as a whole command. 通常，命令行上的所有参数都解释为一个命令。使用此选项，可以指定多个命令。每个参数都将被解释为一个完整的命令。

- -h host

  This option specifies the host to be contacted by **chronyc**. It can be specified with a hostname, IP address, or path to the local Unix domain socket. Multiple values can be specified as a comma-separated list to provide a fallback. 此选项指定 chronyc 要联系的主机。可以使用主机名、IP 地址或本地 Unix 域套接字的路径来指定它。可以将多个值指定为逗号分隔的列表以提供回退。 The default value is */var/run/chrony/chronyd.sock,127.0.0.1,::1*, i.e. the host where **chronyc** is being run. First, it tries to connect to the Unix domain socket and if that fails (e.g. due to running under a non-root user), it will try to connect to 127.0.0.1 and then ::1. 默认值为 /var/run/chrony/chronyd.sock，127.0.0.1，：：1，即运行 chronyc 的主机。首先，它尝试连接到  Unix 域套接字，如果失败（例如，由于在非 root 用户下运行），它将尝试连接到 127.0.0.1，然后 ：：1。

- -p port

  This option allows the user to specify the UDP port number which the target **chronyd** is using for its monitoring connections. This defaults to 323; there would rarely be a need to change this. 此选项允许用户指定目标 chronyd 用于其监控连接的 UDP 端口号。默认值为 323;很少需要改变这一点。

- -f file

  此选项将被忽略，仅出于兼容性而提供。

- -a

  此选项将被忽略，仅出于兼容性而提供。

- -v, --version

  使用此选项，chronyc 会在终端上显示其版本号并退出。

- --help

  使用此选项，chronyc 会在终端上显示一条帮助消息并退出。

## 命令

This section describes each of the commands available within the **chronyc** program.
本节介绍chronyc程序中可用的每个命令。

### System clock 系统时钟

- **tracking 跟踪**

  The **tracking** command displays parameters about the system’s clock performance. An example of the output is shown below. 跟踪命令显示有关系统时钟性能的参数。输出示例如下所示。  `Reference ID    : CB00710F (ntp1.example.net) Stratum         : 3 Ref time (UTC)  : Fri Jan 27 09:49:17 2017 System time     : 0.000006523 seconds slow of NTP time Last offset     : -0.000006747 seconds RMS offset      : 0.000035822 seconds Frequency       : 3.225 ppm slow Residual freq   : -0.000 ppm Skew            : 0.129 ppm Root delay      : 0.013639022 seconds Root dispersion : 0.001100737 seconds Update interval : 64.2 seconds Leap status     : Normal`  The fields are explained as follows: 这些字段解释如下：  **Reference ID 参考 ID** This is the reference ID and name (or IP address) of the server to which the computer is currently synchronised. For IPv4 addresses, the reference ID is equal to the address and for IPv6 addresses it is the first 32 bits of the MD5 sum of the address. 这是计算机当前同步到的服务器的引用 ID 和名称（或 IP 地址）。对于 IPv4 地址，引用 ID 等于地址，对于 IPv6 地址，引用 ID 是地址的 MD5 总和的前 32 位。 If the reference ID is *7F7F0101* and there is no name or IP address, it means the computer is not synchronised to any external source and that you have the *local* mode operating (via the [**local**](https://chrony-project.org/doc/4.5/chronyc.html#local) command in **chronyc**, or the [**local**](https://chrony-project.org/doc/4.5/chrony.conf.html#local) directive in the configuration file). 如果引用 ID 为 7F7F0101 并且没有名称或 IP 地址，则表示计算机未同步到任何外部源，并且您具有本地模式操作（通过 chronyc 中的 local 命令或配置文件中的 local 指令）。  The reference ID is printed as a hexadecimal number. Note that in older versions it used to be printed in quad-dotted notation and could be confused with an IPv4 address. 引用 ID 打印为十六进制数。请注意，在旧版本中，它曾经以四点符号打印，可能会与 IPv4 地址混淆。  **Stratum 地层** The stratum indicates how many hops away from a computer with an attached reference clock we are. Such a computer is a stratum-1 computer, so the computer in the example is two hops away (i.e. *ntp1.example.net* is a stratum-2 and is synchronised from a stratum-1). 该层表示我们距离带有参考时钟的计算机有多少跳。这样的计算机是 layer-1 计算机，因此示例中的计算机距离两个跃点（即 ntp1.example.net 是 layer-2 并且与 strat-1 同步）。 **Ref time 参考时间** This is the time (UTC) at which the last measurement from the reference source was processed. 这是处理来自参考源的最后一次测量值的时间 （UTC）。 **System time 系统时间** This is the current offset between the NTP clock and system clock. The NTP clock is a software (virtual) clock maintained by **chronyd**, which is synchronised to the configured time sources and provides time to NTP clients. The system clock is synchronised to the NTP clock. To avoid steps in the system time, which might have adverse consequences for certain applications, the system clock is normally corrected only by speeding up or slowing down (up to the rate configured by the [**maxslewrate**](https://chrony-project.org/doc/4.5/chrony.conf.html#maxslewrate) directive). If the offset is too large, this correction will take a very long time. A step can be forced by the [**makestep**](https://chrony-project.org/doc/4.5/chronyc.html#makestep) command, or the [**makestep**](https://chrony-project.org/doc/4.5/chrony.conf.html#makestep) directive in the configuration file. 这是NTP时钟和系统时钟之间的电流偏移。NTP时钟是由chronyd维护的软件（虚拟）时钟，它与配置的时间源同步，并为NTP客户端提供时间。系统时钟与 NTP 时钟同步。为了避免系统时间中的步骤（这可能会对某些应用程序产生不利影响），系统时钟通常只能通过加速或减慢（达到 maxslewrate 指令配置的速率）来校正。如果偏移量太大，则此校正将花费很长时间。可以通过 makestep 命令或配置文件中的 makestep  指令强制执行步骤。 Note that all other offsets reported by **chronyc** and most offsets in the log files are relative to the NTP clock, not the system clock. 请注意，chronyc 报告的所有其他偏移量和日志文件中的大多数偏移量都相对于 NTP 时钟，而不是系统时钟。  **Last offset 上次偏移** This is the estimated local offset on the last clock update. A positive value indicates the local time (as previously estimated true time) was ahead of the time sources. 这是上次时钟更新时估计的局部偏移量。正值表示本地时间（如先前估计的真实时间）领先于时间源。 **RMS offset RMS 偏移** This is a long-term average of the offset value. 这是偏移值的长期平均值。 **Frequency 频率** The ‘frequency’ is the rate by which the system’s clock would be wrong if **chronyd** was not correcting it. It is expressed in ppm (parts per million). For example, a value of 1 ppm would mean that when the system’s clock thinks it has advanced 1 second, it has actually advanced by 1.000001 seconds relative to true time. “频率”是如果chronyd没有纠正系统时钟，系统时钟出错的速率。它以 ppm（百万分之一）表示。例如，值为 1 ppm 意味着当系统时钟认为它前进了 1 秒时，它实际上相对于真实时间前进了 1.000001 秒。 **Residual freq 残余频率** This shows the ‘residual frequency’ for the currently selected reference source. This reflects any difference between what the measurements from the reference source indicate the frequency should be and the frequency currently being used. 这显示了当前所选参考源的“残余频率”。这反映了来自参考源的测量结果所指示的频率与当前使用的频率之间的任何差异。 The reason this is not always zero is that a smoothing procedure is applied to the frequency. Each time a measurement from the reference source is obtained and a new residual frequency computed, the estimated accuracy of this residual is compared with the estimated accuracy (see ‘skew’ next) of the existing frequency value. A weighted average is computed for the new frequency, with weights depending on these accuracies. If the measurements from the reference source follow a consistent trend, the residual will be driven to zero over time. 这并不总是为零的原因是将平滑程序应用于频率。每次从参考源获得测量值并计算新的残差频率时，都会将该残差的估计精度与现有频率值的估计精度（参见下文的“偏斜”）进行比较。计算新频率的加权平均值，权重取决于这些精度。如果来自参考源的测量结果遵循一致的趋势，则残差将随着时间的推移而降至零。  **Skew 扭曲** This is the estimated error bound on the frequency. 这是频率上的估计误差界限。 **Root delay 根延迟** This is the total of the network path delays to the stratum-1 computer from which the computer is ultimately synchronised. 这是到最终与计算机同步的 layer-1 计算机的网络路径延迟的总和。 **Root dispersion 根系分散** This is the total dispersion accumulated through all the computers back to the stratum-1 computer from which the computer is ultimately synchronised. Dispersion is due to system clock resolution, statistical measurement variations, etc. 这是通过所有计算机累积到最终与计算机同步的 layer-1 计算机的总离散度。色散是由于系统时钟分辨率、统计测量变化等造成的。 An absolute bound on the computer’s clock accuracy (assuming the stratum-1 computer is correct) is given by: 计算机时钟精度的绝对界限（假设 stratum-1 计算机是正确的）由下式给出：  `clock_error <= |system_time_offset| + root_dispersion + (0.5 * root_delay)`  **Update interval 更新间隔** This is the interval between the last two clock updates. 这是最近两次时钟更新之间的间隔。 **Leap status 飞跃状态** This is the leap status, which can be *Normal*, *Insert second*, *Delete second* or *Not synchronised*. 这是跳跃状态，可以是正常、插入秒、删除秒或不同步。

- **makestep Makestep的**

- **makestep** *threshold* *limit* makestep 阈值限制

  Normally **chronyd** will cause the system to gradually correct any time offset, by slowing down or speeding up the clock as required. In certain situations, the system clock might be so far adrift that this slewing process would take a very long time to correct the system clock. 通常，chronyd 将导致系统根据需要减慢或加快时钟速度来逐渐纠正任何时间偏移。在某些情况下，系统时钟可能会漂移得太远，以至于这个回转过程需要很长时间来纠正系统时钟。 The **makestep** command can be used in this situation. There are two forms of the command. The first form has no parameters. It tells **chronyd** to cancel any remaining correction that was being slewed and jump the system clock by the equivalent amount, making it correct immediately. 在这种情况下，可以使用 makestep 命令。该命令有两种形式。第一种窗体没有参数。它告诉chronyd取消任何剩余的修正，并将系统时钟跳转等量，使其立即纠正。  The second form configures the automatic stepping, similarly to the [**makestep**](https://chrony-project.org/doc/4.5/chrony.conf.html#makestep) directive. It has two parameters, stepping threshold (in seconds) and number of future clock updates for which the threshold will be active. This can be used with the [**burst**](https://chrony-project.org/doc/4.5/chronyc.html#burst) command to quickly make a new measurement and correct the clock by stepping if needed, without waiting for **chronyd** to complete the measurement and update the clock. 第二种形式配置自动步进，类似于 makestep 指令。它有两个参数，步进阈值（以秒为单位）和阈值将处于活动状态的未来时钟更新次数。这可以与突发命令一起使用，以快速进行新的测量，并在需要时通过步进校正时钟，而无需等待chronyd完成测量并更新时钟。  `makestep 0.1 1 burst 1/2`  BE WARNED: Certain software will be seriously affected by such jumps in the system time. (That is the reason why **chronyd** uses slewing normally.) 请注意：某些软件将受到系统时间的这种跳跃的严重影响。（这就是chronyd正常使用回转的原因。

- **maxupdateskew** *skew-in-ppm* maxupdateskew 偏斜 ppm

  This command has the same effect as the [**maxupdateskew**](https://chrony-project.org/doc/4.5/chrony.conf.html#maxupdateskew) directive in the configuration file. 此命令与配置文件中的 maxupdateskew 指令具有相同的效果。

- **waitsync** [*max-tries* [*max-correction* [*max-skew* [*interval*]]]]

  The **waitsync** command waits for **chronyd** to synchronise. waitsync 命令等待 chronyd 同步。 Up to four optional arguments can be specified. The first is the maximum number of tries before giving up and returning a non-zero error code. When 0 is specified, or there are no arguments, the number of tries will not be limited. 最多可以指定四个可选参数。第一个是放弃并返回非零错误代码之前的最大尝试次数。当指定 0 或没有参数时，尝试次数将不受限制。  The second and third arguments are the maximum allowed remaining correction of the system clock and the maximum allowed skew (in ppm) as reported by the [**tracking**](https://chrony-project.org/doc/4.5/chronyc.html#tracking) command in the **System time** and **Skew** fields. If not specified or zero, the value will not be checked. 第二个和第三个参数是系统时钟允许的最大剩余校正值和允许的最大偏斜（以 ppm 为单位），由“系统时间和偏斜”字段中的跟踪命令报告。如果未指定或为零，则不会检查该值。  The fourth argument is the interval specified in seconds in which the check is repeated. The interval is 10 seconds by default. 第四个参数是重复检查时指定的间隔（以秒为单位）。默认间隔为 10 秒。  An example is: 例如：  `waitsync 60 0.01`  which will wait up to about 10 minutes (60 times 10 seconds) for **chronyd** to synchronise to a source and the remaining correction to be less than 10 milliseconds. 这将等待大约 10 分钟（60 乘以 10 秒），以便 chronyd 与源同步，并且剩余的校正时间小于 10 毫秒。

### Time sources 时间来源

- **sources** [**-a**] [**-v**] 来源 [-a] [-v]

  This command displays information about the current time sources that **chronyd** is accessing. 此命令显示有关 chronyd 正在访问的当前时间源的信息。 If the **-a** option is specified, all sources are displayed, including those that do not have a known address yet. Such sources have an identifier in the format *ID#XXXXXXXXXX*, which can be used in other commands expecting a source address. 如果指定了 -a 选项，则会显示所有源，包括尚无已知地址的源。此类源具有格式为 ID#XXXXXXXXXX 的标识符，该标识符可用于需要源地址的其他命令。  The **-v** option enables a verbose output. In this case, extra caption lines are shown as a reminder of the meanings of the columns. -v 选项启用详细输出。在这种情况下，将显示额外的标题行，以提醒列的含义。  `MS Name/IP address         Stratum Poll Reach LastRx Last sample =============================================================================== #* GPS0                          0   4   377    11   -479ns[ -621ns] +/-  134ns ^? ntp1.example.net              2   6   377    23   -923us[ -924us] +/-   43ms ^+ ntp2.example.net              1   6   377    21  -2629us[-2619us] +/-   86ms`  The columns are as follows: 这些列如下：  **M** This indicates the mode of the source. *^* means a server, *=* means a peer and *#* indicates a locally connected reference clock. 这表示源的模式。^ 表示服务器，= 表示对等体，# 表示本地连接的参考时钟。 **S** This column indicates the selection state of the source. 此列指示源的选择状态。  *** indicates the best source which is currently selected for synchronisation. * 表示当前选择用于同步的最佳源。  *+* indicates other sources selected for synchronisation, which are combined with the best source. + 表示选择用于同步的其他源，这些源与最佳源相结合。  *-* indicates a source which is considered to be selectable for synchronisation, but not currently selected. - 表示被视为可选择用于同步但当前未选择的源。  *x* indicates a source which **chronyd** thinks is a falseticker (i.e. its time is inconsistent with a majority of other sources, or sources specified with the **trust** option). x 表示 chronyd 认为是虚假代码的来源（即它的时间与大多数其他来源不一致，或使用信任选项指定的来源）。  *~* indicates a source whose time appears to have too much variability. ~ 表示时间变化太大的来源。  *?* indicates a source which is not considered to be selectable for synchronisation for other reasons (e.g. unreachable, not synchronised, or does not have enough measurements). ?表示由于其他原因（例如无法访问、不同步或没有足够的测量值）而被认为无法选择同步的源。    The [**selectdata**](https://chrony-project.org/doc/4.5/chronyc.html#selectdata) command can be used to get more details about the selection state. selectdata 命令可用于获取有关选择状态的更多详细信息。 **Name/IP address 名称/IP 地址** This shows the name or the IP address of the source, or reference ID for reference clocks. 这将显示源的名称或 IP 地址，或参考时钟的参考 ID。 **Stratum 地层** This shows the stratum of the source, as reported in its most recently received sample. Stratum 1 indicates a computer with a locally attached reference clock. A computer that is synchronised to a stratum 1 computer is at stratum 2. A computer that is synchronised to a stratum 2 computer is at stratum 3, and so on. 这显示了源头的地层，如最近收到的样本中所报告的那样。第 1 层表示具有本地连接参考时钟的计算机。与第 1 层计算机同步的计算机位于第 2 层。与第 2 层计算机同步的计算机位于第 3 层，依此类推。 **Poll 民意调查** This shows the rate at which the source is being polled, as a base-2 logarithm of the interval in seconds. Thus, a value of 6 would indicate that a measurement is being made every 64 seconds. **chronyd** automatically varies the polling rate in response to prevailing conditions. 这显示了轮询源的速率，以秒为单位的间隔的以 2 为底的对数。因此，值为 6 表示每 64 秒进行一次测量。Chronyd会根据当前情况自动改变轮询率。 **Reach 达到** This shows the source’s reachability register printed as an octal number. The register has 8 bits and is updated on every received or missed packet from the source. A value of 377 indicates that a valid reply was received for all from the last eight transmissions. 这显示了源的可达性寄存器打印为八进制数。寄存器有 8 位，并在从源接收或错过的每个数据包上更新。值 377 表示已收到最近 8 次传输的所有有效回复。 **LastRx LastRx的** This column shows how long ago the last good sample (which is shown in the next column) was received from the source. Measurements that failed some tests are ignored. This is normally in seconds. The letters *m*, *h*, *d* or *y* indicate minutes, hours, days, or years. 此列显示从源接收最后一个良好样本（如下列所示）的时间。未通过某些测试的测量将被忽略。这通常以秒为单位。字母 m、h、d 或 y 表示分钟、小时、日或年。 **Last sample 最后一个示例** This column shows the offset between the local clock and the source at the last measurement. The number in the square brackets shows the actual measured offset. This can be suffixed by *ns* (indicating nanoseconds), *us* (indicating microseconds), *ms* (indicating milliseconds), or *s* (indicating seconds). The number to the left of the square brackets shows the original measurement, adjusted to allow for any slews applied to the local clock since. Positive offsets indicate that the local clock is ahead of the source. The number following the *+/-* indicator shows the margin of error in the measurement (NTP root distance). 此列显示上次测量时本地时钟与源之间的偏移。方括号中的数字表示实际测量的偏移量。这可以用 ns（表示纳秒）、us（表示微秒）、ms（表示毫秒）或  s（表示秒）作为后缀。方括号左侧的数字显示了原始测量值，并进行了调整，以允许此后应用于本地时钟的任何摆率。正偏移表示本地时钟领先于源。+/-  指示器后面的数字显示测量中的误差幅度（NTP 根距离）。

- **sourcestats** [**-a**] [**-v**] 来源统计 [-a] [-v]

  The **sourcestats** command displays information about the drift rate and offset estimation process for each of the sources currently being examined by **chronyd**. sourcestats 命令显示有关 chronyd 当前正在检查的每个源的漂移率和偏移估计过程的信息。 If the **-a** option is specified, all sources are displayed, including those that do not have a known address yet. Such sources have an identifier in the format *ID#XXXXXXXXXX*, which can be used in other commands expecting a source address. 如果指定了 -a 选项，则会显示所有源，包括尚无已知地址的源。此类源具有格式为 ID#XXXXXXXXXX 的标识符，该标识符可用于需要源地址的其他命令。  The **-v** option enables a verbose output. In this case, extra caption lines are shown as a reminder of the meanings of the columns. -v 选项启用详细输出。在这种情况下，将显示额外的标题行，以提醒列的含义。  An example report is: 报告示例如下：  `Name/IP Address            NP  NR  Span  Frequency  Freq Skew  Offset  Std Dev =============================================================================== ntp1.example.net           11   5   46m     -0.001      0.045      1us    25us`  The columns are as follows: 这些列如下：  **Name/IP Address 名称/IP 地址** This is the name or IP address of the NTP server (or peer) or reference ID of the reference clock to which the rest of the line relates. 这是 NTP 服务器（或对等体）的名称或 IP 地址，或与该行的其余部分相关的参考时钟的参考 ID。 **NP** This is the number of sample points currently being retained for the server. The drift rate and current offset are estimated by performing a linear regression through these points. 这是当前为服务器保留的采样点数。漂移率和电流失调是通过对这些点进行线性回归来估计的。 **NR** This is the number of runs of residuals having the same sign following the last regression. If this number starts to become too small relative to the number of samples, it indicates that a straight line is no longer a good fit to the data. If the number of runs is too low, **chronyd** discards older samples and re-runs the regression until the number of runs becomes acceptable. 这是上次回归后具有相同符号的残差的运行次数。如果此数字相对于样本数开始变得太小，则表明直线不再适合数据。如果运行次数太少，chronyd 会丢弃较旧的样本并重新运行回归，直到运行次数可以接受为止。 **Span 跨度** This is the interval between the oldest and newest samples. If no unit is shown the value is in seconds. In the example, the interval is 46 minutes. 这是最旧和最新样本之间的间隔。如果未显示单位，则该值以秒为单位。在此示例中，间隔为 46 分钟。 **Frequency 频率** This is the estimated residual frequency for the server, in parts per million. In this case, the computer’s clock is estimated to be running 1 part in 10^9 slow relative to the server. 这是服务器的估计残余频率，以百万分之一为单位。在这种情况下，计算机的时钟估计运行速度为相对于服务器慢 10^9 分之一。 **Freq Skew 频率偏斜** This is the estimated error bounds on **Freq** (again in parts per million). 这是 Freq 的估计误差范围（同样以百万分之一为单位）。 **Offset 抵消** This is the estimated offset of the source. 这是源的估计偏移量。 **Std Dev 标准开发** This is the estimated sample standard deviation. 这是估计的样本标准差。

- **selectdata** [**-a**] [**-v**] 选择数据 [-a] [-v]

  The **selectdata** command displays information specific to the selection of time sources. If the **-a** option is specified, all sources are displayed, including those that do not have a known address yet. With the **-v** option, extra caption lines are shown as a reminder of the meanings of the columns. selectdata 命令显示特定于选择时间源的信息。如果指定了 -a 选项，则会显示所有源，包括尚无已知地址的源。使用 -v 选项时，将显示额外的标题行，以提醒列的含义。 An example of the output is shown below. 输出示例如下所示。  `S Name/IP Address        Auth COpts EOpts Last Score     Interval  Leap ======================================================================= D ntp1.example.net          Y ----- --TR-    4   1.0   -61ms   +62ms  N * ntp2.example.net          N ----- -----    0   1.0 -6846us +7305us  N + ntp3.example.net          N ----- -----   10   1.0 -7381us +7355us  N`  The columns are as follows: 这些列如下：  **S** This column indicates the state of the source after the last source selection. It is similar to the state reported by the **sources** command, but more states are reported. 此列指示上次选择源之后源的状态。它类似于 sources 命令报告的状态，但报告的状态更多。  The following states indicate the source is not considered selectable for synchronisation: 以下状态表示源不被视为可选择进行同步：  *N* - has the **noselect** option. N - 具有 noselect 选项。  *s* - is not synchronised. s - 不同步。  *M* - does not have enough measurements. M - 没有足够的测量值。  *d* - has a root distance larger than the maximum distance (configured by the [**maxdistance**](https://chrony-project.org/doc/4.5/chrony.conf.html#maxdistance) directive). d - 根距离大于最大距离（由 maxdistance 指令配置）。  *~* - has a jitter larger than the maximum jitter (configured by the [**maxjitter**](https://chrony-project.org/doc/4.5/chrony.conf.html#maxjitter) directive). ~ - 抖动大于最大抖动（由 maxjitter 指令配置）。  *w* - waits for other sources to get out of the *M* state. w - 等待其他源退出 M 状态。  *S* - has older measurements than other sources. S - 比其他来源的测量值更老。  *O* - has a stratum equal or larger than the orphan stratum (configured by the [**local**](https://chrony-project.org/doc/4.5/chrony.conf.html#local) directive). O - 具有等于或大于孤儿层的层（由本地指令配置）。  *T* - does not fully agree with sources that have the **trust** option. T - 不完全同意具有信任选项的来源。  *x* - does not agree with other sources (falseticker). x - 不同意其他来源（falseticker）。    The following states indicate the source is considered selectable, but it is not currently used for synchronisation: 以下状态表示源被认为是可选的，但当前不用于同步：  *W* - waits for other sources to be selectable (required by the [**minsources**](https://chrony-project.org/doc/4.5/chrony.conf.html#minsources) directive, or the **require** option of another source). W - 等待其他源可选择（minsources 指令或另一个源的 require 选项要求）。  *P* - another selectable source is preferred due to the **prefer** option. P - 由于首选选项，另一个可选源是首选。  *U* - waits for a new measurement (after selecting a different best source). U - 等待新的测量（在选择不同的最佳源之后）。  *D* - has, or recently had, a root distance which is too large to be combined with other sources (configured by the [**combinelimit**](https://chrony-project.org/doc/4.5/chrony.conf.html#combinelimit) directive). D - 具有或最近具有根距离，该根距离太大而无法与其他源组合（由 combinelimit 指令配置）。    The following states indicate the source is used for synchronisation of the local clock: 以下状态表示源用于同步本地时钟：  *+* - combined with the best source. + - 结合最佳来源。  *** - selected as the best source to update the reference data (e.g. root delay, root dispersion). * - 被选为更新参考数据的最佳来源（例如根延迟、根分散）。   **Name/IP address 名称/IP 地址** This column shows the name or IP address of the source if it is an NTP server, or the reference ID if it is a reference clock. 如果源是 NTP 服务器，则此列显示源的名称或 IP 地址，如果源是参考时钟，则显示引用 ID。 **Auth 认证** This column indicites whether an authentication mechanism is enabled for the source. *Y* means yes and *N* means no. 此列指示是否为源启用了身份验证机制。Y 表示是，N 表示否。 **COpts 科普特斯** This column displays the configured selection options of the source. 此列显示源的已配置选择选项。  *N* indicates the **noselect** option. N 表示 noselect 选项。  *P* indicates the **prefer** option. P 表示首选选项。  *T* indicates the **trust** option. T 表示信任选项。  *R* indicates the **require** option. R 表示 require 选项。   **EOpts** This column displays the current effective selection options of the source, which can be different from the configured options due to the authentication selection mode (configured by the [**authselectmode**](https://chrony-project.org/doc/4.5/chrony.conf.html#authselectmode) directive). The symbols are the same as in the **COpts** column. 此列显示源的当前有效选择选项，由于身份验证选择模式（由 authselectmode 指令配置），这些选项可能与配置的选项不同。符号与 COpts 列中的符号相同。 **Last 最后** This column displays how long ago was the last measurement of the source made when the selection was performed. 此列显示执行选择时对源进行的最后一次测量是多久前。 **Score 得分** This column displays the current score against the source in the *** state. The scoring system avoids frequent reselection when multiple sources have a similar root distance. A value larger than 1 indicates this source was better than the *** source in recent selections. If the score reaches 10, the best source will be reselected and the scores will be reset to 1. 此列显示针对处于 * 状态的源的当前分数。当多个源具有相似的根距离时，评分系统可避免频繁的重新选择。大于 1 的值表示此源优于最近选择的 * 源。如果分数达到 10，将重新选择最佳来源，并将分数重置为 1。 **Interval 间隔** This column displays the lower and upper endpoint of the interval which was expected to contain the true offset of the local clock considering the root distance at the time of the selection. 此列显示区间的下限和上限端点，考虑到选择时的根距离，预计该区间将包含本地时钟的真实偏移量。 **Leap 飞跃** This column displays the current leap status of the source. 此列显示源的当前飞跃状态。  *N* indicates the normal status (no leap second). N 表示正常状态（无闰秒）。  *+* indicates that a leap second will be inserted at the end of the month. + 表示月底将插入闰秒。  *-* indicates that a leap second will be deleted at the end of the month. - 表示闰秒将在月底删除。  *?* indicates the unknown status (i.e. no valid measurement was made). ?表示未知状态（即未进行有效测量）。

- **selectopts** *address|refid* [*+|-option*]… selectopts address|refid [+|-option]...

  The **selectopts** command modifies the configured selection options of an NTP source specified by IP address (or the *ID#XXXXXXXXXX* identifier used for unknown addresses), or a reference clock specified by reference ID as a string. selectopts 命令修改由 IP 地址（或用于未知地址的 ID#XXXXXXXXXX 标识符）指定的 NTP 源或由引用 ID 指定为字符串的引用时钟的已配置选择选项。 The selection options can be added with the **+** symbol or removed with the **-** symbol. The **selectdata** command can be used to verify the configuration. The modified options will be applied in the next source selection, e.g. when a new measurement is made, or the **reselect** command is executed. 选择选项可以用 + 符号添加，也可以用 - 符号删除。selectdata 命令可用于验证配置。修改后的选项将应用于下一个源选择，例如，在进行新测量或执行重新选择命令时。  An example of using this command is shown below. 下面显示了使用此命令的示例。  `selectopts 1.2.3.4 -noselect +prefer selectopts GPS +trust`

- **reselect 重新选择**

  To avoid excessive switching between sources, **chronyd** can stay synchronised to a source even when it is not currently the best one among the available sources. 为了避免源之间的过度切换，chronyd 可以保持与源的同步，即使它目前不是可用源中最好的源。 The **reselect** command can be used to force **chronyd** to reselect the best synchronisation source. reselect 命令可用于强制 chronyd 重新选择最佳同步源。

- **reselectdist** *distance* 重新选择dist距离

  The **reselectdist** command sets the reselection distance. It is equivalent to the [**reselectdist**](https://chrony-project.org/doc/4.5/chrony.conf.html#reselectdist) directive in the configuration file. reselectdist 命令设置重新选择距离。它等同于配置文件中的 reselectdist 指令。

### NTP sources NTP 源

- **activity 活动**

  This command reports the number of servers and peers that are online and offline. If the **auto_offline** option is used in specifying some of the servers or peers, the **activity** command can be useful for detecting when all of them have entered the offline state after the network link has been disconnected. 此命令报告联机和脱机的服务器和对等体的数量。如果使用 auto_offline 选项来指定某些服务器或对等方，则 activity 命令可用于检测在断开网络链接后所有服务器或对等方何时都进入脱机状态。 The report shows the number of servers and peers in 5 states: 该报告显示了 5 个州的服务器和对等方的数量：  **online 在线** the server or peer is currently online (i.e. assumed by **chronyd** to be reachable) 服务器或对等节点当前处于在线状态（即 chronyd 假设是可访问的） **offline 离线** the server or peer is currently offline (i.e. assumed by **chronyd** to be unreachable, and no measurements from it will be attempted.) 服务器或对等体当前处于离线状态（即 chronyd 假设无法访问，并且不会尝试从中进行测量。 **burst_online** a burst command has been initiated for the server or peer and is being performed; after the burst is complete, the server or peer will be returned to the online state. 已为服务器或对等体启动并正在执行突发命令;突发完成后，服务器或对等体将返回到在线状态。 **burst_offline** a burst command has been initiated for the server or peer and is being performed; after the burst is complete, the server or peer will be returned to the offline state. 已为服务器或对等体启动并正在执行突发命令;突发完成后，服务器或对等体将返回到脱机状态。 **unresolved 解决** the name of the server or peer was not resolved to an address yet; this source is not visible in the **sources** and **sourcestats** reports. 服务器或对等体的名称尚未解析为地址;此源在“源”和“源统计”报告中不可见。

- **authdata** [**-a**] 身份验证数据 [-a]

  The **authdata** command displays information specific to authentication of NTP sources. If the **-a** option is specified, all sources are displayed, including those that do not have a known address yet. An example of the output is shown below. authdata 命令显示特定于 NTP 源身份验证的信息。如果指定了 -a 选项，则会显示所有源，包括尚无已知地址的源。输出示例如下所示。  `Name/IP address             Mode KeyID Type KLen Last Atmp  NAK Cook CLen ========================================================================= ntp1.example.net             NTS     1   15  256 135m    0    0    8  100 ntp2.example.net              SK    30   13  128    -    0    0    0    0 ntp3.example.net               -     0    0    0    -    0    0    0    0`  The columns are as follows: 这些列如下：  **Name/IP address 名称/IP 地址** This column shows the name or the IP address of the source. 此列显示源的名称或 IP 地址。 **Mode 模式** This column shows which mechanism authenticates NTP packets received from the source. *NTS* means Network Time Security, *SK* means a symmetric key, and *-* means authentication is disabled. 此列显示哪种机制对从源接收的 NTP 数据包进行身份验证。NTS 表示 Network Time Security，SK 表示对称密钥，- 表示禁用身份验证。 **KeyID 密钥 ID** This column shows an identifier of the key used for authentication. With a symmetric key, it is the ID from the [key file](https://chrony-project.org/doc/4.5/chrony.conf.html#keyfile). With NTS, it is a number starting at zero and incremented by one with each successful key establishment using the NTS-KE protocol, i.e. it shows how many times the key establishment was performed with this source. 此列显示用于身份验证的密钥的标识符。对于对称密钥，它是密钥文件中的 ID。对于 NTS，它是一个从零开始的数字，随着使用 NTS-KE 协议的每次成功密钥建立而递增 1，即它显示使用此源执行密钥建立的次数。 **Type 类型** This columns shows an identifier of the algorithm used for authentication. With a symmetric key, it is the hash function or cipher specified in the key file. With NTS, it is an authenticated encryption with associated data (AEAD) algorithm, which is negotiated in the NTS-KE protocol. The following values can be reported: 此列显示用于身份验证的算法的标识符。对于对称密钥，它是密钥文件中指定的哈希函数或密码。对于 NTS，它是一种经过身份验证的具有关联数据的加密 （AEAD） 算法，该算法在 NTS-KE 协议中协商。可以报告以下值：  1: MD5 1：MD5  2: SHA1 2：SHA1  3: SHA256 3：SHA256  4: SHA384 4：SHA384  5: SHA512 5：SHA512  6: SHA3-224 6：SHA3-224  7: SHA3-256 7：SHA3-256  8: SHA3-384 8：SHA3-384  9: SHA3-512 9：SHA3-512  10: TIGER 10：老虎  11: WHIRLPOOL 11：惠而浦  13: AES128 13：AES128  14: AES256 14：AES256  15: AEAD-AES-SIV-CMAC-256 15：AEAD-AES-SIV-CMAC-256  30: AEAD-AES-128-GCM-SIV 30：AEAD-AES-128-GCM-SIV   **KLen 克伦** This column shows the length of the key in bits. 此列显示密钥的长度（以位为单位）。 **Last 最后** This column shows how long ago the last successful key establishment was performed. It is in seconds, or letters *m*, *h*, *d* or *y* indicate minutes, hours, days, or years. 此列显示上一次成功建立密钥的时间。它以秒为单位，或字母 m、h、d 或 y 表示分钟、小时、天或年。 **Atmp ATMP的** This column shows the number of attempts to perform the key establishment since the last successful key establishment. A number larger than 1 indicates a problem with the network or server. 此列显示自上次成功建立密钥以来执行密钥建立的尝试次数。大于 1 的数字表示网络或服务器有问题。 **NAK** This column shows whether an NTS NAK was received since the last request. A NAK indicates that authentication failed on the server side due to **chronyd** using a cookie which is no longer valid and that it needs to perform the key establishment again in order to get new cookies. 此列显示自上次请求以来是否收到 NTS NAK。NAK 表示由于 chronyd 使用不再有效的 cookie，服务器端的身份验证失败，并且需要再次执行密钥建立才能获得新的 cookie。 **Cook 煮** This column shows the number of NTS cookies that **chronyd** currently has. If the key establishment was successful, a number smaller than 8 indicates a problem with the network or server. 此列显示chronyd当前拥有的NTS cookie数量。如果密钥建立成功，则小于 8 的数字表示网络或服务器有问题。 **CLen 克伦** This column shows the length in bytes of the NTS cookie which will be used in the next request. 此列显示将在下一个请求中使用的 NTS cookie 的长度（以字节为单位）。

- **ntpdata** [*address*] ntpdata [地址]

  The **ntpdata** command displays the last valid measurement and other NTP-specific information about the specified NTP source, or all NTP sources (with a known address) if no address was specified. An example of the output is shown below. ntpdata 命令显示有关指定 NTP 源的最后有效测量值和其他特定于 NTP 的信息，如果未指定地址，则显示所有 NTP 源（具有已知地址）。输出示例如下所示。  `Remote address  : 203.0.113.15 (CB00710F) Remote port     : 123 Local address   : 203.0.113.74 (CB00714A) Leap status     : Normal Version         : 4 Mode            : Server Stratum         : 1 Poll interval   : 10 (1024 seconds) Precision       : -24 (0.000000060 seconds) Root delay      : 0.000015 seconds Root dispersion : 0.000015 seconds Reference ID    : 47505300 (GPS) Reference time  : Fri Nov 25 15:22:12 2016 Offset          : -0.000060878 seconds Peer delay      : 0.000175634 seconds Peer dispersion : 0.000000681 seconds Response time   : 0.000053050 seconds Jitter asymmetry: +0.00 NTP tests       : 111 111 1111 Interleaved     : No Authenticated   : No TX timestamping : Kernel RX timestamping : Kernel Total TX        : 24 Total RX        : 24 Total valid RX  : 24 Total good RX   : 22`  The fields are explained as follows: 这些字段解释如下：  **Remote address 远程地址** The IP address of the NTP server or peer, and the corresponding reference ID. NTP 服务器或对等体的 IP 地址，以及相应的引用 ID。 **Remote port 远程端口** The UDP port number to which the request was sent. The standard NTP port is 123. 将请求发送到的 UDP 端口号。标准 NTP 端口为 123。 **Local address 本地地址** The local IP address which received the response, and the corresponding reference ID. 接收响应的本地 IP 地址，以及相应的引用 ID。 **Leap status 飞跃状态** **Version 版本** **Mode 模式** **Stratum 地层** **Poll interval 轮询间隔** **Precision 精度** **Root delay 根延迟** **Root dispersion 根系分散** **Reference ID 参考 ID** **Reference time 参考时间** The NTP values from the last valid response. 上次有效响应的 NTP 值。 **Offset 抵消** **Peer delay 对等延迟** **Peer dispersion 对等离散** The measured values. 测量值。 **Response time 响应时间** The time the server or peer spent in processing of the request and waiting before sending the response. 服务器或对等方在发送响应之前处理请求和等待所花费的时间。 **Jitter asymmetry 抖动不对称** The estimated asymmetry of network jitter on the path to the source. The asymmetry can be between -0.5 and 0.5. A negative value means the delay of packets sent to the source is more variable than the delay of packets sent from the source back. 源路径上网络抖动的估计不对称性。不对称性可以在 -0.5 和 0.5 之间。负值表示发送到源的数据包的延迟比从源发送回的数据包的延迟变化更大。 **NTP tests NTP 测试** Results of RFC 5905 tests 1 through 3, 5 through 7, and tests for maximum delay, delay ratio, delay dev ratio (or delay quantile), and synchronisation loop. RFC 5905 测试的结果 1 到 3、5 到 7，以及最大延迟、延迟比、延迟开发比（或延迟分位数）和同步循环的测试。 **Interleaved 交错** This shows if the response was in the interleaved mode. 这将显示响应是否处于交错模式。 **Authenticated 认证** This shows if the response was authenticated. 这将显示响应是否经过身份验证。 **TX timestamping TX 时间戳** The source of the local transmit timestamp. Valid values are *Daemon*, *Kernel*, and *Hardware*. 本地传输时间戳的来源。有效值为 Daemon、Kernel 和 Hardware。 **RX timestamping RX 时间戳** The source of the local receive timestamp. 本地接收时间戳的来源。 **Total TX 总TX** The number of packets sent to the source. 发送到源的数据包数。 **Total RX 总接收** The number of all packets received from the source. 从源接收的所有数据包的数量。 **Total valid RX 总有效接收** The number of packets which passed the first two groups of NTP tests. 通过前两组 NTP 测试的数据包数。 **Total good RX 总良好接收** The number of packets which passed all three groups of NTP tests, i.e. the NTP measurement was accepted. 通过所有三组 NTP 测试的数据包数，即 NTP 测量被接受。

- **add peer** *name* [*option*]… 添加对等名称 [选项]...

  The **add peer** command allows a new NTP peer to be added whilst **chronyd** is running. add peer 命令允许在 chronyd 运行时添加新的 NTP 对等体。 Following the words **add peer**, the syntax of the following parameters and options is identical to that for the [**peer**](https://chrony-project.org/doc/4.5/chrony.conf.html#peer) directive in the configuration file. 在单词 add peer 之后，以下参数和选项的语法与配置文件中 peer 指令的语法相同。  An example of using this command is shown below. 下面显示了使用此命令的示例。  `add peer ntp1.example.net minpoll 6 maxpoll 10 key 25`

- **add pool** *name* [*option*]… 添加池名称 [选项]...

  The **add pool** command allows a pool of NTP servers to be added whilst **chronyd** is running. add pool 命令允许在 chronyd 运行时添加 NTP 服务器池。 Following the words **add pool**, the syntax of the following parameters and options is identical to that for the [**pool**](https://chrony-project.org/doc/4.5/chrony.conf.html#pool) directive in the configuration file. 在单词 add pool 之后，以下参数和选项的语法与配置文件中 pool 指令的语法相同。  An example of using this command is shown below: 使用此命令的示例如下所示：  `add pool ntp1.example.net maxsources 3 iburst`

- **add server** *name* [*option*]… 添加服务器名称 [选项]...

  The **add server** command allows a new NTP server to be added whilst **chronyd** is running. add server 命令允许在 chronyd 运行时添加新的 NTP 服务器。 Following the words **add server**, the syntax of the following parameters and options is identical to that for the [**server**](https://chrony-project.org/doc/4.5/chrony.conf.html#server) directive in the configuration file. 在单词 add server 之后，以下参数和选项的语法与配置文件中 server 指令的语法相同。  An example of using this command is shown below: 使用此命令的示例如下所示：  `add server ntp1.example.net minpoll 6 maxpoll 10 key 25`

- **delete** *address* 删除地址

  The **delete** command allows an NTP server or peer to be removed from the current set of sources. delete 命令允许从当前源集中删除 NTP 服务器或对等体。

- **burst** *good*/*max* [*mask*/*masked-address*] 突发良好/最大值 [掩码/掩蔽地址]

- **burst** *good*/*max* [*masked-address*/*masked-bits*] 突发良好/最大值 [掩码地址/掩码位]

- **burst** *good*/*max* [*address*] 突发良好/最大值 [地址]

  The **burst** command tells **chronyd** to make a set of measurements to each of its NTP sources over a short duration (rather than the usual periodic measurements that it makes). After such a burst, **chronyd** will revert to the previous state for each source. This might be either online, if the source was being periodically measured in the normal way, or offline, if the source had been indicated as being offline. (A source can be switched between the online and offline states with the [**online**](https://chrony-project.org/doc/4.5/chronyc.html#online) and [**offline**](https://chrony-project.org/doc/4.5/chronyc.html#offline) commands.) 突发命令告诉chronyd在短时间内对其每个NTP源进行一组测量（而不是通常的定期测量）。在这样的突发之后，chronyd  将恢复到每个源的先前状态。这可能是在线的，如果源是以正常方式定期测量的，或者是离线的，如果源被指示为离线。（可以使用联机和脱机命令在联机和脱机状态之间切换源。 The *mask* and *masked-address* arguments are optional, in which case **chronyd** will initiate a burst for all of its currently defined sources. mask 和 masked-address 参数是可选的，在这种情况下，chronyd 将为其当前定义的所有源启动突发。  The arguments have the following meaning and format: 参数具有以下含义和格式：  *good 好* This defines the number of good measurements that **chronyd** will want to obtain from each source. A measurement is good if it passes certain tests, for example, the round trip time to the source must be acceptable. (This allows **chronyd** to reject measurements that are likely to be bogus.) 这定义了chronyd希望从每个来源获得的良好测量值的数量。如果测量通过某些测试，则测量良好，例如，到源的往返时间必须是可以接受的。（这允许chronyd拒绝可能是虚假的测量结果。 *max* This defines the maximum number of measurements that **chronyd** will attempt to make, even if the required number of good measurements has not been obtained. 这定义了chronyd将尝试进行的最大测量次数，即使尚未获得所需的良好测量次数。 *mask 面具* This is an IP address with which the IP address of each of **chronyd**'s sources is to be masked. 这是一个 IP 地址，chronyd 的每个源的 IP 地址都将被屏蔽。 *masked-address 掩码地址* This is an IP address. If the masked IP address of a source matches this value then the burst command is applied to that source. 这是一个 IP 地址。如果源的屏蔽 IP 地址与此值匹配，则 burst 命令将应用于该源。 *masked-bits 掩码位* This can be used with *masked-address* for CIDR notation, which is a shorter alternative to the form with mask. 这可以与 CIDR 表示法的掩码地址一起使用，这是带掩码的表单的更短的替代方案。 *address 地址* This is an IP address or a hostname. The burst command is applied only to that source. 这是 IP 地址或主机名。burst 命令仅应用于该源。

- 

  If no *mask* or *masked-address* arguments are provided, every source will be matched. 如果未提供掩码或掩码地址参数，则将匹配每个源。  An example of the two-argument form of the command is: 该命令的双参数形式的一个示例是：  `burst 2/10`  This will cause **chronyd** to attempt to get two good measurements from each source, stopping after two have been obtained, but in no event will it try more than ten probes to the source. 这将导致chronyd尝试从每个源获得两个良好的测量值，在获得两个测量值后停止，但在任何情况下它都不会尝试超过十个探测源。  Examples of the four-argument form of the command are: 命令的四参数形式的示例包括：  `burst 2/10 255.255.0.0/1.2.0.0 burst 2/10 2001:db8:789a::/48`  In the first case, the two out of ten sampling will only be applied to sources whose IPv4 addresses are of the form *1.2.x.y*, where *x* and *y* are arbitrary. In the second case, the sampling will be applied to sources whose IPv6 addresses have first 48 bits equal to *2001:db8:789a*. 在第一种情况下，十分之二的采样将仅应用于 IPv4 地址形式为 1.2.x.y 的源，其中 x 和 y 是任意的。在第二种情况下，采样将应用于 IPv6 地址的前 48 位等于 2001：db8：789a 的源。  Example of the three-argument form of the command is: 命令的三参数形式的示例如下：  `burst 2/10 ntp1.example.net`

- **maxdelay** *address* *delay* maxdelay 地址延迟

  This allows the **maxdelay** option for one of the sources to be modified, in the same way as specifying the **maxdelay** option for the [**server**](https://chrony-project.org/doc/4.5/chrony.conf.html#server) directive in the configuration file. 这允许修改其中一个源的 maxdelay 选项，就像在配置文件中指定 server 指令的 maxdelay 选项一样。

- **maxdelaydevratio** *address* *ratio* MaxDelayDevRatio 地址比率

  This allows the **maxdelaydevratio** option for one of the sources to be modified, in the same way as specifying the **maxdelaydevratio** option for the [**server**](https://chrony-project.org/doc/4.5/chrony.conf.html#server) directive in the configuration file. 这允许修改其中一个源的 maxdelaydevratio 选项，就像在配置文件中为服务器指令指定 maxdelaydevratio 选项一样。

- **maxdelayratio** *address* *ratio* maxdelayratio 地址比率

  This allows the **maxdelayratio** option for one of the sources to be modified, in the same way as specifying the **maxdelayratio** option for the [**server**](https://chrony-project.org/doc/4.5/chrony.conf.html#server) directive in the configuration file. 这允许修改其中一个源的 maxdelayratio 选项，就像在配置文件中指定服务器指令的 maxdelayratio 选项一样。

- **maxpoll** *address* *maxpoll* maxpoll 地址 maxpoll

  The **maxpoll** command is used to modify the maximum polling interval for one of the current set of sources. It is equivalent to the **maxpoll** option in the [**server**](https://chrony-project.org/doc/4.5/chrony.conf.html#server) directive in the configuration file. maxpoll 命令用于修改当前源集之一的最大轮询间隔。它等效于配置文件中 server 指令中的 maxpoll 选项。 Note that the new maximum polling interval only takes effect after the next measurement has been made. 请注意，新的最大轮询间隔仅在进行下一次测量后生效。

- **minpoll** *address* *minpoll* minpoll 地址 minpoll

  The **minpoll** command is used to modify the minimum polling interval for one of the current set of sources. It is equivalent to the **minpoll** option in the [**server**](https://chrony-project.org/doc/4.5/chrony.conf.html#server) directive in the configuration file. minpoll 命令用于修改当前源集之一的最小轮询间隔。它等效于配置文件中 server 指令中的 minpoll 选项。 Note that the new minimum polling interval only takes effect after the next measurement has been made. 请注意，新的最小轮询间隔仅在进行下一次测量后生效。

- **minstratum** *address* *minstratum* Minstratum 地址 Minstratum

  The **minstratum** command is used to modify the minimum stratum for one of the current set of sources. It is equivalent to the **minstratum** option in the [**server**](https://chrony-project.org/doc/4.5/chrony.conf.html#server) directive in the configuration file. minstratum 命令用于修改当前源集之一的最小层。它等效于配置文件中 server 指令中的 minstratum 选项。

- **offline** [*address*] offline [地址]

- **offline** [*masked-address*/*masked-bits*] 离线 [掩码地址/掩码位]

- **offline** [*mask*/*masked-address*] 离线 [掩码/掩码地址]

  The **offline** command is used to warn **chronyd** that the network connection to a particular host or hosts is about to be lost, e.g. on computers with intermittent connection to their time sources. 脱机命令用于警告chronyd与特定主机的网络连接即将丢失，例如，在与时间源断断续续的计算机上。 Another case where **offline** could be used is where a computer serves time to a local group of computers, and has a permanent connection to true time servers outside the organisation. However, the external connection is heavily loaded at certain times of the day and the measurements obtained are less reliable at those times. In this case, it is probably most useful to determine the gain or loss rate during the quiet periods and let the whole network coast through the loaded periods. The **offline** and **online** commands can be used to achieve this. 可以使用脱机的另一种情况是，计算机为本地计算机组提供时间，并且与组织外部的真实时间服务器具有永久连接。但是，外部连接在一天中的某些时间负载过重，并且在这些时间获得的测量值不太可靠。在这种情况下，确定静默期的增益或损失率，并让整个网络在加载期内滑行可能是最有用的。可以使用离线和联机命令来实现此目的。  There are four forms of the **offline** command. The first form is a wildcard, meaning all sources (including sources that do not have a known address yet). The second form allows an IP address mask and a masked address to be specified. The third form uses CIDR notation. The fourth form uses an IP address or a hostname. These forms are illustrated below. 脱机命令有四种形式。第一种形式是通配符，表示所有源（包括尚无已知地址的源）。第二种形式允许指定 IP 地址掩码和掩码地址。第三种形式使用 CIDR 表示法。第四种形式使用 IP 地址或主机名。这些表格如下图所示。  `offline offline 255.255.255.0/1.2.3.0 offline 2001:db8:789a::/48 offline ntp1.example.net`  The second form means that the **offline** command is to be applied to any source whose IPv4 address is in the *1.2.3* subnet. (The host’s address is logically and-ed with the mask, and if the result matches the *masked-address* the host is processed.) The third form means that the command is to be applied to all sources whose IPv6 addresses have their first 48 bits equal to *2001:db8:789a*. The fourth form means that the command is to be applied only to that one source. 第二种形式意味着脱机命令将应用于其 IPv4 地址位于 1.2.3  子网中的任何源。（主机的地址在逻辑上与掩码一起编辑，如果结果与掩码地址匹配，则处理主机。第三种形式意味着该命令将应用于 IPv6 地址的前 48 位等于 2001：db8：789a 的所有源。第四种形式意味着该命令仅应用于该一个源。  The wildcard form of the address is equivalent to: 地址的通配符形式等效于：  `offline 0.0.0.0/0.0.0.0 offline ::/0`

- **online** [*address*] 在线 [地址]

- **online** [*masked-address*/*masked-bits*] 在线 [掩码地址/掩码位]

- **online** [*mask*/*masked-address*] 在线 [mask/masked-address]

  The **online** command is opposite in function to the [**offline**](https://chrony-project.org/doc/4.5/chronyc.html#offline) command. It is used to advise **chronyd** that network connectivity to a particular source or sources has been restored. 联机命令在功能上与离线命令相反。它用于通知chronyd与一个或多个特定源的网络连接已恢复。 The syntax is identical to that of the [**offline**](https://chrony-project.org/doc/4.5/chronyc.html#offline) command. 语法与脱机命令的语法相同。

- **onoffline 在线离线**

  The **onoffline** command tells **chronyd** to switch all sources that have a known address to the online or offline status according to the current network configuration. A source is considered online if it is possible to send requests to it, i.e. a network route to the source is present. onoffline 命令告诉 chronyd 根据当前网络配置将所有具有已知地址的源切换为在线或离线状态。如果可以向源发送请求，即存在指向源的网络路由，则将其视为在线源。

- **polltarget** *address* *polltarget* polltarget 地址 polltarget

  The **polltarget** command is used to modify the poll target for one of the current set of sources. It is equivalent to the **polltarget** option in the [**server**](https://chrony-project.org/doc/4.5/chrony.conf.html#server) directive in the configuration file. polltarget 命令用于修改当前源集之一的轮询目标。它等同于配置文件中 server 指令中的 polltarget 选项。

- **refresh 刷新**

  The **refresh** command can be used to force **chronyd** to resolve the names of configured NTP sources to IP addresses again and replace any addresses missing in the list of resolved addresses. refresh 命令可用于强制 chronyd 再次将配置的 NTP 源的名称解析为 IP 地址，并替换解析地址列表中缺少的任何地址。 Sources that stop responding are replaced with newly resolved addresses automatically after 8 polling intervals. This command can be used to replace them immediately, e.g. after suspending and resuming the machine in a different network. 停止响应的源将在 8 次轮询间隔后自动替换为新解析的地址。此命令可用于立即替换它们，例如，在不同网络中挂起和恢复计算机后。  Note that with pools which have more than 16 addresses, or not all IPv4 or IPv6 addresses are included in a single DNS response (e.g. pool.ntp.org), this command might replace the addresses even if they are still in the pool. 请注意，对于具有 16 个以上地址的池，或者并非所有 IPv4 或 IPv6 地址都包含在单个 DNS 响应中（例如 pool.ntp.org），此命令可能会替换这些地址，即使它们仍在池中。

- **reload** **sources** 重新加载源

  The **reload sources** command causes **chronyd** to re-read all **.sources* files from the directories specified by the [**sourcedir**](https://chrony-project.org/doc/4.5/chrony.conf.html#sourcedir) directive. reload sources 命令使 chronyd 从 sourcedir 指令指定的目录中重新读取所有 *.sources 文件。 Note that modified sources (e.g. specified with a new option) are not modified in memory. They are removed and added again, which causes them to lose old measurements and reset the selection state. 请注意，修改后的源（例如，使用新选项指定）不会在内存中修改。它们被删除并再次添加，这会导致它们丢失旧测量值并重置选择状态。

- **sourcename** *address* 源名称地址

  The **sourcename** command prints the original hostname or address that was specified for an NTP source in the configuration file, or the **add** command. This command is an alternative to the **-N** option, which can be useful in scripts. sourcename 命令打印在配置文件或 add 命令中为 NTP 源指定的原始主机名或地址。此命令是 -N 选项的替代方法，该选项在脚本中很有用。 Note that different NTP sources can share the same name, e.g. servers from a pool. 请注意，不同的 NTP 源可以共享相同的名称，例如池中的服务器。

### Manual time input 手动时间输入

- **manual** **on** 手动开启

- **manual** **off** 手动关闭

- **manual** **delete** *index* 手动删除索引

- **manual** **list** 手册列表

- **manual** **reset** 手动复位

  The manual command enables and disables use of the [**settime**](https://chrony-project.org/doc/4.5/chronyc.html#settime) command, and is used to modify the behaviour of the manual clock driver. 手动命令启用和禁用 settime 命令，并用于修改手动时钟驱动程序的行为。 The **on** form of the command enables use of the **settime** command. 该命令的 on 形式允许使用 settime 命令。  The **off** form of the command disables use of the **settime** command. 命令的 off 形式禁止使用 settime 命令。  The **list** form of the command lists all the samples currently stored in **chronyd**. The output is illustrated below. 该命令的列表形式列出了当前存储在 chronyd 中的所有样本。输出如下图所示。  `210 n_samples = 1 #    Date  Time(UTC)    Slewed   Original   Residual ==================================================== 0 27Jan99 22:09:20       0.00       0.97       0.00`  The columns are as as follows: 这些列如下所示：   The sample index (used for the **manual delete** command). 示例索引（用于手动删除命令）。  The date and time of the sample. 示例的日期和时间。  The system clock error when the timestamp was entered, adjusted to allow for changes made to the system clock since. 输入时间戳时的系统时钟错误，调整以允许此后对系统时钟所做的更改。  The system clock error when the timestamp was entered, as it originally was (without allowing for changes to the system clock since). 输入时间戳时的系统时钟错误，就像它原来一样（此后不允许更改系统时钟）。  The regression residual at this point, in seconds. This allows ‘outliers’ to be easily spotted, so that they can be deleted using the **manual delete** command. 此时的回归残差，以秒为单位。这样可以很容易地发现“异常值”，以便可以使用手动删除命令将其删除。

- 

  The **delete** form of the command deletes a single sample. The parameter is the index of the sample, as shown in the first column of the output from **manual list**. Following deletion of the data point, the current error and drift rate are re-estimated from the remaining data points and the system clock trimmed if necessary. This option is intended to allow ‘outliers’ to be discarded, i.e. samples where the administrator realises they have entered a very poor timestamp. 命令的删除形式删除单个示例。该参数是示例的索引，如手动列表输出的第一列所示。删除数据点后，根据剩余数据点重新估计当前误差和漂移率，并在必要时调整系统时钟。此选项旨在允许丢弃“异常值”，即管理员意识到他们输入的时间戳非常差的样本。  The **reset** form of the command deletes all samples at once. The system clock is left running as it was before the command was entered. 命令的重置形式一次删除所有样本。系统时钟保持运行状态，就像输入命令之前一样。

- **settime** *time* settime 时间

  The **settime** command allows the current time to be entered manually, if this option has been configured into **chronyd**. (It can be configured either with the [**manual**](https://chrony-project.org/doc/4.5/chrony.conf.html#manual) directive in the configuration file, or with the [**manual**](https://chrony-project.org/doc/4.5/chronyc.html#manual) command of **chronyc**.) settime 命令允许手动输入当前时间（如果此选项已配置到 chronyd 中）。（可以使用配置文件中的手动指令进行配置，也可以使用 chronyc 的手动命令进行配置。 It should be noted that the computer’s sense of time will only be as accurate as the reference you use for providing this input (e.g. your watch), as well as how well you can time the press of the return key. 应该注意的是，计算机的时间感只会与您用于提供此输入的参考（例如您的手表）以及您按下返回键的时间一样准确。  Providing your computer’s time zone is set up properly, you will be able to enter a local time (rather than UTC). 如果计算机的时区设置正确，您将能够输入本地时间（而不是 UTC）。  The response to a successful **settime** command indicates the amount that the computer’s clock was wrong. It should be apparent from this if you have entered the time wrongly, e.g. with the wrong time zone. 对成功的 settime 命令的响应指示计算机的时钟错误量。如果您输入了错误的时间，例如错误的时区，则应该很明显。  The rate of drift of the system clock is estimated by a regression process using the entered measurement and all previous measurements entered during the present run of **chronyd**. However, the entered measurement is used for adjusting the current clock offset (rather than the estimated intercept from the regression, which is ignored). Contrast what happens with the [**manual delete**](https://chrony-project.org/doc/4.5/chronyc.html#manual) command, where the intercept is used to set the current offset (since there is no measurement that has just been entered in that case). 系统时钟的漂移率是通过回归过程估计的，使用输入的测量值和在当前 chronyd  运行期间输入的所有先前测量值。但是，输入的测量值用于调整当前时钟偏移（而不是从回归中估计的截距，该截距将被忽略）。与手动删除命令相比，其中截距用于设置电流偏移（因为在这种情况下没有刚刚输入的测量值）。  The time is parsed by the public domain *getdate* algorithm. Consequently, you can only specify time to the nearest second. 时间由公共领域 getdate 算法解析。因此，您只能将时间指定到最接近的秒。  Examples of inputs that are valid are shown below: 有效输入的示例如下所示：  `settime 16:30 settime 16:30:05 settime Nov 21, 2015 16:30:05`  For a full description of getdate, see the getdate documentation (bundled, for example, with the source for GNU tar). 有关 getdate 的完整描述，请参见 getdate 文档（例如，与 GNU tar 的源代码捆绑在一起）。

### NTP access NTP 接入

- **accheck** *address* ACCHECK地址

  This command allows you to check whether client NTP access is allowed from a particular host. 此命令允许您检查是否允许从特定主机进行客户端 NTP 访问。 Examples of use, showing a named host and a numeric IP address, are as follows: 显示命名主机和数字 IP 地址的使用示例如下：  `accheck ntp1.example.net accheck 1.2.3.4 accheck 2001:db8::1`  This command can be used to examine the effect of a series of **allow**, **allow all**, **deny**, and **deny all** commands specified either via **chronyc**, or in **chronyd**'s configuration file. 此命令可用于检查通过 chronyc 或 chronyd 配置文件指定的一系列 allow、allow all、deny 和 deny all 命令的效果。

- **clients** [**-p** *packets*] [**-k**] [**-r**] 客户端 [-p 数据包] [-k] [-r]

  This command shows a list of clients that have accessed the server, through the NTP, command, or NTS-KE port. It does not include accesses over the Unix domain command socket. 此命令显示已通过 NTP、命令或 NTS-KE 端口访问服务器的客户端列表。它不包括对 Unix 域命令套接字的访问。 The **-p** option specifies the minimum number of received NTP or command packets, or accepted NTS-KE connections, needed to include a client in the list. The default value is 0, i.e. all clients are reported. With the **-k** option the last four columns will show the NTS-KE accesses instead of command accesses. If the **-r** option is specified, **chronyd** will reset the counters of received and dropped packets or connections after reporting the current values. -p 选项指定将客户端包含在列表中所需的接收的 NTP 或命令数据包或接受的 NTS-KE 连接的最小数目。默认值为 0，即报告所有客户端。使用  -k 选项时，最后四列将显示 NTS-KE 访问，而不是命令访问。如果指定了 -r 选项，chronyd  将在报告当前值后重置接收和丢弃的数据包或连接的计数器。  An example of the output is: 输出的一个示例是：  `Hostname                      NTP   Drop Int IntL Last     Cmd   Drop Int  Last =============================================================================== localhost                       2      0   2   -   133      15      0  -1     7 ntp1.example.net               12      0   6   -    23       0      0   -     -`  Each row shows the data for a single host. Only hosts that have passed the host access checks (set with the [**allow**](https://chrony-project.org/doc/4.5/chronyc.html#allow), [**deny**](https://chrony-project.org/doc/4.5/chronyc.html#deny), [**cmdallow**](https://chrony-project.org/doc/4.5/chronyc.html#cmdallow) and [**cmddeny**](https://chrony-project.org/doc/4.5/chronyc.html#cmddeny) commands or configuration file directives) are logged. The intervals are displayed as a power of 2 in seconds. 每行显示单个主机的数据。仅记录已通过主机访问检查（使用 allow、deny、cmdallow 和 cmddeny 命令或配置文件指令设置）的主机。间隔显示为 2 的幂（以秒为单位）。  The columns are as follows: 这些列如下：   The hostname of the client. 客户端的主机名。  The number of NTP packets received from the client. 从客户端接收的 NTP 数据包数。  The number of NTP packets dropped to limit the response rate. 为限制响应速率而丢弃的 NTP 数据包数。  The average interval between NTP packets. NTP 数据包之间的平均间隔。  The average interval between NTP packets after limiting the response rate. 限制响应速率后 NTP 数据包之间的平均间隔。  Time since the last NTP packet was received 自收到最后一个 NTP 数据包以来的时间  The number of command packets or NTS-KE connections received/accepted from the client. 从客户端接收/接受的命令数据包或 NTS-KE 连接数。  The number of command packets or NTS-KE connections dropped to limit the response rate. 为限制响应速率而丢弃的命令数据包或 NTS-KE 连接数。  The average interval between command packets or NTS-KE connections. 命令数据包或 NTS-KE 连接之间的平均间隔。  Time since the last command packet or NTS-KE connection was received/accepted. 自上次命令数据包或 NTS-KE 连接被接收/接受以来的时间。

- **serverstats 服务器统计**

  The **serverstats** command displays NTP and command server statistics. serverstats 命令显示 NTP 和命令服务器统计信息。 An example of the output is shown below. 输出示例如下所示。  `NTP packets received       : 1598 NTP packets dropped        : 8 Command packets received   : 19 Command packets dropped    : 0 Client log records dropped : 0 NTS-KE connections accepted: 3 NTS-KE connections dropped : 0 Authenticated NTP packets  : 189 Interleaved NTP packets    : 43 NTP timestamps held        : 44 NTP timestamp span         : 120 NTP daemon RX timestamps   : 0 NTP daemon TX timestamps   : 1537 NTP kernel RX timestamps   : 1590 NTP kernel TX timestamps   : 43 NTP hardware RX timestamps : 0 NTP hardware TX timestamps : 0`  The fields have the following meaning: 这些字段具有以下含义：  **NTP packets received 收到的 NTP 数据包** The number of valid NTP requests received by the server. 服务器收到的有效 NTP 请求数。 **NTP packets dropped NTP 数据包丢弃** The number of NTP requests dropped by the server due to rate limiting (configured by the [**ratelimit**](https://chrony-project.org/doc/4.5/chrony.conf.html#ratelimit) directive). 服务器因速率限制而丢弃的 NTP 请求数（由 ratelimit 指令配置）。 **Command packets received 接收的命令数据包** The number of command requests received by the server. 服务器接收的命令请求数。 **Command packets dropped 丢弃的命令数据包** The number of command requests dropped by the server due to rate limiting (configured by the [**cmdratelimit**](https://chrony-project.org/doc/4.5/chrony.conf.html#cmdratelimit) directive). 服务器由于速率限制而丢弃的命令请求数（由 cmdratelimit 指令配置）。 **Client log records dropped 客户端日志记录已删除** The number of client log records dropped by the server to limit the memory use (configured by the [**clientloglimit**](https://chrony-project.org/doc/4.5/chrony.conf.html#clientloglimit) directive). 服务器为限制内存使用而丢弃的客户机日志记录数（由 clientloglimit 指令配置）。 **NTS-KE connections accepted 接受NTS-KE连接** The number of NTS-KE connections accepted by the server. 服务器接受的 NTS-KE 连接数。 **NTS-KE connections dropped NTS-KE连接断开** The number of NTS-KE connections dropped by the server due to rate limiting (configured by the [**ntsratelimit**](https://chrony-project.org/doc/4.5/chrony.conf.html#ntsratelimit) directive). 由于速率限制（由 ntsratelimit 指令配置）而丢弃的服务器丢弃的 NTS-KE 连接数。 **Authenticated NTP packets 经过身份验证的 NTP 数据包** The number of received NTP requests that were authenticated (with a symmetric key or NTS). 已通过身份验证（使用对称密钥或 NTS）的已接收 NTP 请求数。 **Interleaved NTP packets 交错的 NTP 数据包** The number of received NTP requests that were detected to be in the interleaved mode. 检测到处于交错模式的已接收 NTP 请求数。 **NTP timestamps held 保留的 NTP 时间戳** The number of pairs of receive and transmit timestamps that the server is currently holding in memory for clients using the interleaved mode. 服务器当前在内存中为使用交错模式的客户端保存的接收和发送时间戳对数。 **NTP timestamp span NTP 时间戳跨度** The interval (in seconds) covered by the currently held NTP timestamps. 当前持有的 NTP 时间戳所涵盖的时间间隔（以秒为单位）。 **NTP daemon RX timestamps NTP 守护程序 RX 时间戳** The number of NTP responses which included a receive timestamp captured by the daemon. NTP 响应数，其中包括守护程序捕获的接收时间戳。 **NTP daemon TX timestamps NTP 守护程序 TX 时间戳** The number of NTP responses which included a transmit timestamp captured by the daemon. NTP 响应数，其中包括守护程序捕获的传输时间戳。 **NTP kernel RX timestamps NTP 内核 RX 时间戳** The number of NTP responses which included a receive timestamp captured by the kernel. 包含内核捕获的接收时间戳的 NTP 响应数。 **NTP kernel TX timestamps NTP 内核 TX 时间戳** The number of NTP responses (in the interleaved mode) which included a transmit timestamp captured by the kernel. NTP 响应的数量（在交错模式下），其中包括内核捕获的传输时间戳。 **NTP hardware RX timestamps NTP 硬件 RX 时间戳** The number of NTP responses which included a receive timestamp captured by the NIC. 包含 NIC 捕获的接收时间戳的 NTP 响应数。 **NTP hardware TX timestamps NTP 硬件 TX 时间戳** The number of NTP responses (in the interleaved mode) which included a transmit timestamp captured by the NIC. NTP 响应数（在交错模式下），其中包括 NIC 捕获的传输时间戳。

- **allow** [**all**] [*subnet*] 允许 [全部] [子网]

  The effect of the allow command is identical to the [**allow**](https://chrony-project.org/doc/4.5/chrony.conf.html#allow) directive in the configuration file. allow 命令的效果与配置文件中的 allow 指令相同。 The syntax is illustrated in the following examples: 以下示例说明了语法：  `allow 1.2.3.4 allow all 3.4.5.0/24 allow 2001:db8:789a::/48 allow 0/0 allow ::/0 allow allow all`

- **deny** [**all**] [*subnet*] 拒绝 [全部] [子网]

  The effect of the allow command is identical to the [**deny**](https://chrony-project.org/doc/4.5/chrony.conf.html#deny) directive in the configuration file. allow 命令的效果与配置文件中的 deny 指令相同。 The syntax is illustrated in the following examples: 以下示例说明了语法：  `deny 1.2.3.4 deny all 3.4.5.0/24 deny 2001:db8:789a::/48 deny 0/0 deny ::/0 deny deny all`

- **local** [*option*]… 本地 [选项]...

- **local** **off** 本地关闭

  The **local** command allows **chronyd** to be told that it is to appear as a reference source, even if it is not itself properly synchronised to an external source. This can be used on isolated networks, to allow a computer to be the primary time server for other computers. 本地命令允许告诉 chronyd 它将显示为参考源，即使它本身没有正确同步到外部源。这可以在隔离的网络上使用，以允许计算机成为其他计算机的主要时间服务器。 The first form enables the local reference mode on the host. The syntax is identical to the [**local**](https://chrony-project.org/doc/4.5/chrony.conf.html#local) directive in the configuration file. 第一种表单在主机上启用本地引用模式。语法与配置文件中的本地指令相同。  The second form disables the local reference mode. 第二种形式禁用本地引用模式。

- **smoothing 平滑**

  The **smoothing** command displays the current state of the NTP server time smoothing, which can be enabled with the [**smoothtime**](https://chrony-project.org/doc/4.5/chrony.conf.html#smoothtime) directive. An example of the output is shown below. smoothing 命令显示 NTP 服务器时间平滑的当前状态，可以使用 smoothtime 指令启用该状态。输出示例如下所示。  `Active         : Yes Offset         : +1.000268817 seconds Frequency      : -0.142859 ppm Wander         : -0.010000 ppm per second Last update    : 17.8 seconds ago Remaining time : 19988.4 seconds`  The fields are explained as follows: 这些字段解释如下：  **Active 积极** This shows if the server time smoothing is currently active. Possible values are *Yes* and *No*. If the **leaponly** option is included in the **smoothtime** directive, *(leap second only)* will be shown on the line. 这将显示服务器时间平滑当前是否处于活动状态。可能的值为 Yes 和 No。如果 leaponly 选项包含在 smoothtime 指令中，则（仅闰秒）将显示在行上。 **Offset 抵消** This is the current offset applied to the time sent to NTP clients. Positive value means the clients are getting time that’s ahead of true time. 这是应用于发送到 NTP 客户端的时间的当前偏移量。正值意味着客户获得的时间领先于真实时间。 **Frequency 频率** The current frequency offset of the served time. Negative value means the time observed by clients is running slower than true time. 服务时间的当前频率偏移。负值表示客户端观察到的时间比真实时间慢。 **Wander 徘徊** The current frequency wander of the served time. Negative value means the time observed by clients is slowing down. 服务时间的当前频率漂移。负值表示客户端观察到的时间正在减慢。 **Last update 最后更新** This field shows how long ago the time smoothing process was updated, e.g. **chronyd** accumulated a new measurement. 此字段显示时间平滑过程在多长时间前更新，例如 chronyd 累积了新的测量值。 **Remaining time 剩余时间** The time it would take for the smoothing process to get to zero offset and frequency if there were no more updates. 如果没有更多更新，平滑过程达到零偏移和频率所需的时间。

- **smoothtime** **activate** SmoothTime 激活

- **smoothtime** **reset** SmoothTime 重置

  The **smoothtime** command can be used to activate or reset the server time smoothing process if it is configured with the [**smoothtime**](https://chrony-project.org/doc/4.5/chrony.conf.html#smoothtime) directive. 如果使用 smoothtime 指令配置了 smoothtime 命令，则可以使用 smoothtime 命令来激活或重置服务器时间平滑过程。

### Monitoring access 监控访问

- **cmdaccheck** *address* cmdaccheck 地址

  This command is similar to the [**accheck**](https://chrony-project.org/doc/4.5/chronyc.html#accheck) command, except that it is used to check whether monitoring access is permitted from a named host. 此命令与 accheck 命令类似，不同之处在于它用于检查是否允许来自指定主机的监视访问。 Examples of use are as follows: 使用示例如下：  `cmdaccheck ntp1.example.net cmdaccheck 1.2.3.4 cmdaccheck 2001:db8::1`

- **cmdallow** [**all**] [*subnet*] cmdallow [全部] [子网]

  This is similar to the [**allow**](https://chrony-project.org/doc/4.5/chronyc.html#allow) command, except that it is used to allow particular hosts or subnets to use **chronyc** to monitor with **chronyd** on the current host. 这与 allow 命令类似，不同之处在于它用于允许特定主机或子网使用 chronyc 在当前主机上使用 chronyd 进行监控。

- **cmddeny** [**all**] [*subnet*] cmddeny [全部] [子网]

  This is similar to the [**deny**](https://chrony-project.org/doc/4.5/chronyc.html#deny) command, except that it is used to allow particular hosts or subnets to use **chronyc** to monitor **chronyd** on the current host. 这与 deny 命令类似，只不过它用于允许特定主机或子网使用 chronyc 来监视当前主机上的 chronyd。

### Real-time clock (RTC) 实时时钟 （RTC）

- **rtcdata RTCData（RTCDATA数据）**

  The **rtcdata** command displays the current RTC parameters. rtcdata 命令显示当前 RTC 参数。 An example output is shown below. 下面显示了一个示例输出。  `RTC ref time (GMT) : Sat May 30 07:25:56 2015 Number of samples  : 10 Number of runs     : 5 Sample span period :  549 RTC is fast by     :    -1.632736 seconds RTC gains time at  :  -107.623 ppm`  The fields have the following meaning: 这些字段具有以下含义：  **RTC ref time (GMT) RTC 参考时间 （GMT）** This is the RTC reading the last time its error was measured. 这是上次测量其误差时的 RTC 读数。 **Number of samples 样本数量** This is the number of previous measurements being used to determine the RTC gain or loss rate. 这是用于确定RTC增益或损耗率的先前测量次数。 **Number of runs 运行次数** This is the number of runs of residuals of the same sign following the regression fit for (RTC error) versus (RTC time). A value which is small indicates that the measurements are not well approximated by a linear model, and that the algorithm will tend to delete the older measurements to improve the fit. 这是回归拟合（RTC 误差）与（RTC 时间）之后同一符号的残差的运行次数。如果值较小，则表示线性模型不能很好地近似测量值，并且算法倾向于删除较旧的测量值以改善拟合。 **Sample span period 采样跨度周期** This is the period that the measurements span (from the oldest to the newest). Without a unit the value is in seconds; suffixes *m* for minutes, *h* for hours, *d* for days or *y* for years can be used. 这是测量跨越的时间段（从最旧到最新）。如果没有单位，则该值以秒为单位;可以使用后缀 M 表示分钟，h 表示小时，D 表示天，y 表示年份。 **RTC is fast by RTC 速度很快** This is the estimate of how many seconds fast the RTC when it thought the time was at the reference time (above). If this value is large, you might (or might not) want to use the [**trimrtc**](https://chrony-project.org/doc/4.5/chronyc.html#trimrtc) command to bring the RTC into line with the system clock. (Note, a large error will not affect **chronyd**'s operation, unless it becomes so big as to start causing rounding errors.) 这是 RTC 认为时间在参考时间（上图）时快了多少秒的估计值。如果此值很大，您可能（也可能不希望）希望使用 trimrtc 命令使 RTC 与系统时钟保持一致。（注意，大错误不会影响 chronyd 的操作，除非它变得如此之大以至于开始导致舍入错误。 **RTC gains time at RTC 在** This is the amount of time gained (positive) or lost (negative) by the real time clock for each second that it ticks. It is measured in parts per million. So if the value shown was +1, suppose the RTC was exactly right when it crosses a particular second boundary. Then it would be 1 microsecond fast when it crosses its next second boundary. 这是实时时钟每秒滴答作响所获得（正）或损失（负）的时间量。它以百万分之一为单位。因此，如果显示的值为 +1，则假设 RTC 在穿过特定的第二个边界时完全正确。然后，当它越过下一个秒边界时，它将快 1 微秒。

- **trimrtc 特里姆RTC**

  The **trimrtc** command is used to correct the system’s real-time clock (RTC) to the main system clock. It has no effect if the error between the two clocks is currently estimated at less than a second. trimrtc 命令用于将系统的实时时钟 （RTC） 校正为主系统时钟。如果两个时钟之间的误差当前估计值小于一秒，则该错误无效。 The command takes no arguments. It performs the following steps (if the RTC is more than 1 second away from the system clock): 该命令不接受任何参数。它执行以下步骤（如果 RTC 与系统时钟的距离超过 1 秒）：   Remember the currently estimated gain or loss rate of the RTC and flush the previous measurements. 记住当前估计的 RTC 增益或损耗率，并刷新之前的测量值。  Step the real-time clock to bring it within a second of the system clock. 步进实时时钟，使其在系统时钟的一秒内。  Make several measurements to accurately determine the new offset between the RTC and the system clock (i.e. the remaining fraction of a second error). 进行多次测量，以准确确定RTC和系统时钟之间的新偏移（即秒误差的剩余部分）。  Save the RTC parameters to the RTC file (specified with the [**rtcfile**](https://chrony-project.org/doc/4.5/chrony.conf.html#rtcfile) directive in the configuration file). 将 RTC 参数保存到 RTC 文件（使用配置文件中的 rtcfile 指令指定）。

- 

  The last step is done as a precaution against the computer suffering a power failure before either the daemon exits or the [**writertc**](https://chrony-project.org/doc/4.5/chronyc.html#writertc) command is issued. 最后一步是为了防止计算机在守护程序退出或发出 writertc 命令之前发生电源故障。  **chronyd** will still work perfectly well both whilst operating and across machine reboots even if the **trimrtc** command is never used (and the RTC is allowed to drift away from true time). The **trimrtc** command is provided as a method by which it can be corrected, in a manner compatible with **chronyd** using it to maintain accurate time across machine reboots. 即使从未使用 trimrtc 命令（并且允许 RTC 偏离真实时间），chronyd 在操作和机器重新启动时仍将完美运行。trimrtc 命令是一种可以纠正它的方法，其方式与 chronyd 兼容，使用它来保持计算机重新启动之间的准确时间。  The **trimrtc** command can be executed automatically by **chronyd** with the [**rtcautotrim**](https://chrony-project.org/doc/4.5/chrony.conf.html#rtcautotrim) directive in the configuration file. chronyd 可以使用配置文件中的 rtcautotrim 指令自动执行 trimrtc 命令。

- **writertc 作家TC**

  The **writertc** command writes the currently estimated error and gain or loss rate parameters for the RTC to the RTC file (specified with the [**rtcfile**](https://chrony-project.org/doc/4.5/chrony.conf.html#rtcfile) directive). This information is also written automatically when **chronyd** is killed (by the SIGHUP, SIGINT, SIGQUIT or SIGTERM signals) or when the [**trimrtc**](https://chrony-project.org/doc/4.5/chronyc.html#trimrtc) command is issued. writertc 命令将 RTC 的当前估计误差和增益或丢失率参数写入 RTC 文件（使用 rtcfile 指令指定）。当 chronyd 被杀死（通过  SIGHUP、SIGINT、SIGQUIT 或 SIGTERM 信号）或发出 trimrtc 命令时，此信息也会自动写入。

### Other daemon commands 其他守护程序命令

- **cyclelogs 周期日志**

  The **cyclelogs** command causes all of **chronyd**'s open log files to be closed and re-opened. This allows them to be renamed so that they can be periodically purged. An example of how to do this is shown below. cyclelogs 命令会导致 chronyd 的所有打开日志文件被关闭并重新打开。这允许重命名它们，以便可以定期清除它们。下面显示了如何执行此操作的示例。  `# mv /var/log/chrony/measurements.log /var/log/chrony/measurements1.log # chronyc cyclelogs # rm /var/log/chrony/measurements1.log`

- **dump 转 储**

  The **dump** command causes **chronyd** to write its current history of measurements for each of its sources to dump files in the directory specified in the configuration file by the [**dumpdir**](https://chrony-project.org/doc/4.5/chrony.conf.html#dumpdir) directive and also write server NTS keys and client NTS cookies to the directory specified by the [**ntsdumpdir**](https://chrony-project.org/doc/4.5/chrony.conf.html#ntsdumpdir1) directive. Note that **chronyd** does this automatically when it exits. This command is mainly useful for inspection whilst **chronyd** is running. dump 命令使 chronyd 写入其每个源的当前测量历史记录，以将文件转储到 dumpdir 指令在配置文件中指定的目录中，并将服务器 NTS  密钥和客户端 NTS cookie 写入 ntsdumpdir 指令指定的目录。请注意，chronyd 在退出时会自动执行此操作。此命令主要用于 chronyd 运行时的检查。

- **rekey 重新生成密钥**

  The **rekey** command causes **chronyd** to re-read the key file specified in the configuration file by the [**keyfile**](https://chrony-project.org/doc/4.5/chrony.conf.html#keyfile) directive. It also re-reads the server NTS keys if [**ntsdumpdir**](https://chrony-project.org/doc/4.5/chrony.conf.html#ntsdumpdir2) is specified and [automatic rotation](https://chrony-project.org/doc/4.5/chrony.conf.html#ntsrotate) is disabled in the configuration file. rekey 命令使 chronyd 重新读取 keyfile 指令在配置文件中指定的密钥文件。如果指定了 ntsdumpdir 并在配置文件中禁用了自动轮换，它还会重新读取服务器 NTS 密钥。

- **reset** **sources** 复位源

  The **reset sources** command causes **chronyd** to drop all measurements and switch to the unsynchronised state. This command can help **chronyd** with recovery when the measurements are known to be no longer valid or accurate, e.g. due to moving the computer to a different network, or resuming the computer from a low-power state (which resets the system clock). **chronyd** will drop the measurements automatically when it detects the clock has made an unexpected jump, but the detection is not completely reliable. reset sources 命令使 chronyd  丢弃所有测量并切换到不同步状态。当已知测量不再有效或不准确时，例如，由于将计算机移动到其他网络，或将计算机从低功耗状态恢复（这会重置系统时钟），此命令可以帮助进行恢复。当Chronyd检测到时钟发生意外跳转时，它会自动删除测量值，但检测并不完全可靠。

- **shutdown 关闭**

  The **shutdown** command causes **chronyd** to exit. This is equivalent to sending the process the SIGTERM signal. shutdown 命令会导致 chronyd 退出。这相当于向进程发送 SIGTERM 信号。

### Client commands 客户端命令

- **dns** *option* DNS 选项

  The **dns** command configures how hostnames and IP addresses are resolved in **chronyc**. IP addresses can be resolved to hostnames when printing results of [**sources**](https://chrony-project.org/doc/4.5/chronyc.html#sources), [**sourcestats**](https://chrony-project.org/doc/4.5/chronyc.html#sourcestats), [**tracking**](https://chrony-project.org/doc/4.5/chronyc.html#tracking) and [**clients**](https://chrony-project.org/doc/4.5/chronyc.html#clients) commands. Hostnames are resolved in commands that take an address as argument. dns 命令配置如何在 chronyc 中解析主机名和 IP 地址。在打印源、sourcestats、tracking 和 clients 命令的结果时，可以将 IP 地址解析为主机名。主机名在以地址为参数的命令中解析。 There are five options: 有五个选项：  **dns -n** Disables resolving IP addresses to hostnames. Raw IP addresses will be displayed. 禁止将 IP 地址解析为主机名。将显示原始 IP 地址。 **dns +n** Enables resolving IP addresses to hostnames. This is the default unless **chronyc** was started with **-n** option. 允许将 IP 地址解析为主机名。这是默认设置，除非 chronyc 是用 -n 选项启动的。 **dns -4 DNS的-4** Resolves hostnames only to IPv4 addresses. 仅将主机名解析为 IPv4 地址。 **dns -6 DNS接口-6** Resolves hostnames only to IPv6 addresses. 仅将主机名解析为 IPv6 地址。 **dns -46** Resolves hostnames to both address families. This is the default behaviour unless **chronyc** was started with the **-4** or **-6** option. 将主机名解析为两个地址系列。这是默认行为，除非 chronyc 是以 -4 或 -6 选项启动的。

- **timeout** *timeout* 超时超时

  The **timeout** command sets the initial timeout for **chronyc** requests in milliseconds. If no response is received from **chronyd**, the timeout is doubled and the request is resent. The maximum number of retries is configured with the [**retries**](https://chrony-project.org/doc/4.5/chronyc.html#retries) command. timeout 命令设置 chronyc 请求的初始超时（以毫秒为单位）。如果未收到来自 chronyd 的响应，则超时将加倍并重新发送请求。最大重试次数是使用 retries 命令配置的。 By default, the timeout is 1000 milliseconds. 默认情况下，超时为 1000 毫秒。

- **retries** *retries* 重试 重试

  The **retries** command sets the maximum number of retries for **chronyc** requests before giving up. The response timeout is controlled by the [**timeout**](https://chrony-project.org/doc/4.5/chronyc.html#timeout) command. retries 命令设置放弃前 chronyc 请求的最大重试次数。响应超时由 timeout 命令控制。 The default is 2. 默认值为 2。

- **keygen** [*id* [*type* [*bits*]]] 注册机 [ID [类型 [位]]]

  The **keygen** command generates a key that can be added to the key file (specified with the [**keyfile**](https://chrony-project.org/doc/4.5/chrony.conf.html#keyfile) directive) to allow NTP authentication between server and client, or peers. The key is generated from the */dev/urandom* device and it is printed to standard output. keygen 命令生成一个密钥，该密钥可以添加到密钥文件（使用 keyfile 指令指定）中，以允许服务器和客户端或对等方之间的 NTP 身份验证。密钥从 /dev/urandom 设备生成，并打印到标准输出。 The command has three optional arguments. The first argument is the key number (by default 1), which will be specified with the **key** option of the **server** or **peer** directives in the configuration file. The second argument is the name of the hash function or cipher (by default SHA1, or MD5 if SHA1 is not available). The third argument is the length of the key in bits if a hash function was selected, between 80 and 4096 bits (by default 160 bits). 该命令有三个可选参数。第一个参数是密钥编号（默认为 1），它将使用配置文件中服务器或对等指令的密钥选项指定。第二个参数是哈希函数或密码的名称（默认为 SHA1，如果 SHA1 不可用，则为  MD5）。第三个参数是密钥的长度（以位为单位，如果选择了哈希函数），介于 80 到 4096 位之间（默认为 160 位）。  An example is: 例如：  `keygen 73 SHA1 256`  which generates a 256-bit SHA1 key with number 73. The printed line should then be securely transferred and added to the key files on both server and client, or peers. A different key should be generated for each client or peer. 它生成一个编号为 73 的 256 位 SHA1 密钥。然后，应安全地传输打印的行，并将其添加到服务器和客户端或对等方上的密钥文件中。应为每个客户端或对等体生成不同的密钥。  An example using the AES128 cipher is: 使用 AES128 密码的示例如下：  `keygen 151 AES128`

- **exit 退出**

- **quit 退出**

  The **exit** and **quit** commands exit from **chronyc** and return the user to the shell. exit 和 quit 命令从 chronyc 退出并将用户返回到 shell。

  help

  The **help** command displays a summary of the commands and their arguments. help 命令显示命令及其参数的摘要。