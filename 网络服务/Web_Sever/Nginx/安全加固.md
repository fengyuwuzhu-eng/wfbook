# 安全加固

[TOC]

## 隐藏 Banner

Nginx 服务的 Banner 隐藏状态。

1. 打开`conf/nginx.conf`配置文件
2. 在 server 栏目下，配置 `server_tokens` 项为  `server_tokens off;` 。

## Nginx 后端服务指定的 Header 隐藏状态

隐藏 Nginx 后端服务 X-Powered-By 头

1. 打开 `conf/nginx.conf` 配置文件（或主配置文件中的inlude文件）；

2. 在 `http` 下配置 `proxy_hide_header` 项； 增加或修改为

   ```ini
   proxy_hide_header X-Powered-By;
   proxy_hide_header Server;
   ```


## 禁用 OPTIONS

在 nginx.conf 配置文件中，增加如下内容：

```bash
if ($request_method ~* OPTIONS) {
        return 403;
}
```

效果如下：

 ![](../../../Image/n/nginx_sec_1.png)

 重启 nginx 服务

```bash
systemctl restart nginx
```

 功能验证

```bash
curl -v -X OPTIONS http://localhost:8080/
```

## 检测到目标 Strict-Transport-Security 响应头缺失

```bash
add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload";
```

## 错误页面web应用服务器版本信息泄露

http{} 语句体里面加入

```bash
server_tokens off;
```

## 检测到目标X-Content-Type-Options响应头缺失

```bash
add_header 'Referrer-Policy' 'origin';
```

## 检测到目标 X-Permitted-Cross-Domain-Policies 响应头缺失

```bash
add_header X-Permitted-Cross-Domain-Policies master-only;
```

## 检测到目标 X-Download-Options 响应头缺失

```bash
add_header X-Download-Options "noopen";
```

## 检测到目标X-XSS-Protection响应头缺失

```bash
add_header X-XSS-Protection 1;
```

## 检测到目标 Referrer-Policy 响应头缺失

```bash
add_header Referrer-Policy origin;
```

## 检测到目标Content-Security-Policy响应头缺失

```bash
add_header Content-Security-Policy "default-src 'self'; style-src * 'unsafe-inline'; img-src * data:; object-src 'self'; script-src * 'unsafe-eval' 'unsafe-inline'; font-src * data:; worker-src * blob:;";
```

## 点击劫持：X-Frame-Options未配置

```bash
add_header X-Frame-Options SAMEORIGIN;
```

