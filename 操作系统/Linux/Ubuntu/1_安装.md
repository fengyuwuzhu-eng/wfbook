# 安装

[TOC]

## 系统要求 

Ubuntu Server 为您的解决方案提供了一个灵活的基础，可以在各种硬件上运行，从小型虚拟机到企业级计算机。

硬需求取决于场景，但它们通常受到以下建议值的约束。 

### 架构 

Ubuntu Server 支持各种 64 位架构和 32 位ARM。 

- amd64 (64-bit Intel/AMD) 
- arm64 (64-bit Arm) 
- ppc64el (POWER8 and POWER9)
- s390x (IBM Z and LinuxONE)
- 
- riscv64 (64-bit RISC-V) riscv 64（64位RISC-V） 
- s390x (64-bit Mainframe)
  s390 x（64位大型机） 

对于特定的平台，请参阅 Ubuntu 认证服务器列表 [Ubuntu certified servers](https://ubuntu.com/certified/servers) 。 

### Memory

最小 RAM：2 GiB

It’s likely that your system might need more memory than that if you, for  instance, have more hardware to initialise, have more complex setup  plans, or are using other architectures. To cover better for any of  those scenarios:
例如，如果您有更多的硬件要初始化，有更复杂的设置计划，或者使用其他架构，那么您的系统可能需要更多的内存。为了更好地覆盖任何这些场景： 

**Suggested minimum RAM**: 3 GB or more
建议最小RAM：3 GB或以上

Upper limits depend on the system hardware and setup.
上限取决于系统硬件和设置。 

### 存储 

最小存储空间：5 GiB（ISO 安装）

最小存储空间：4 GiB（云镜像）

It’s quite likely that your system might need more memory than that. Your  setup plans could be more complex or you need more software to be  installed, that could lead to increased storage needs. To cover better  for any of those scenarios:
您的系统很可能需要比这更多的内存。您的安装计划可能会更复杂，或者您需要安装更多的软件，这可能会导致存储需求增加。为了更好地覆盖任何这些场景： 

**Suggested minimum storage**: 25 GB or more
建议最小存储空间：25 GB或以上

## 备份

在安装 Ubuntu Server Edition 之前，应确保系统上的所有数据都已备份。

如果这不是第一次在计算机上安装操作系统，则可能需要重新分区磁盘以为 Ubuntu 腾出空间。

每当对磁盘进行分区时，如果在分区过程中出错或出现问题，都应做好磁盘上的所有内容丢失的准备。安装中使用的程序非常可靠，大多数已经使用了多年，但它们也会执行破坏性操作。

## 准备安装介质

可以从 https://releases.ubuntu.com/ 获取安装介质。选择要安装的版本，然后选择“服务器安装映像”下载。请注意，服务器下载包括安装程序。

以下平台上有特定于平台的安装指南：

- [s390x LPAR](https://ubuntu.com/server/docs/interactive-live-server-installation-on-ibm-z-lpar-s390x)
- [z/VM](https://ubuntu.com/server/docs/interactive-live-server-installation-on-ibm-z-vm-s390x)
- [ppc64el](https://ubuntu.com/server/docs/how-to-start-a-live-server-installation-on-ibm-power-ppc64el-with-a-virtual-cd-rom-and-petitboot)

## 创建可启动的 USB



## 引导安装程序

将 U 盘插入要安装的系统并启动它。

大多数计算机将自动从 USB 或 DVD 启动，但在某些情况下会禁用此功能以缩短启动时间。如果没有看到启动消息和应在其后面显示的“欢迎”屏幕，则需要将计算机设置为从安装介质启动。

当计算机开始告诉您按什么键进行设置或启动菜单时，屏幕上应该会出现一条消息。根据制造商的不同，这可能是 Escape 、 F2  、F10 或 F12 。只需重新启动计算机并按住此键直到出现启动菜单，然后选择带有 Ubuntu 安装介质的驱动器。

片刻之后，安装程序将在其语言选择屏幕中启动。

 ![](../../../Image/9/1060878-20191022163359616-1696111822.png)

## 使用安装程序

安装程序设计为易于使用并具有合理的默认值，因此对于第一次安装，通常只能接受最直接安装的默认值：

- 选择语言。
- 更新安装程序（如果提供）。
- 选择键盘布局。
- 不要配置网络（安装程序尝试通过 DHCP 配置有线网络接口，但如果失败，则可以在不联网的情况下继续）。
- 除非必须在网络中配置代理或自定义镜像，否则不要配置代理或自定义镜像。
- 对于存储，请选中“使用整个磁盘”，然后选择要安装的磁盘，然后在配置屏幕上选择“完成”并确认安装。
- 输入用户名、主机名和密码。
- 在 SSH 和快照屏幕上，选择“完成”。
- 现在，将在安装完成时看到日志消息。
- 完成后选择重新启动，然后使用提供的用户名和密码登录。

# 在 amd64 上对服务器安装程序进行网络启动

amd64 systems boot in either UEFI or legacy (“BIOS”) mode, and many systems  can be configured to boot in either mode. The precise details depend on  the system firmware, but both modes usually support the “Preboot  eXecution Environment” (PXE) specification, which allows the  provisioning of a bootloader over the network.
amd64 系统以 UEFI 或传统 （“BIOS”） 模式启动，许多系统可以配置为以任一模式启动。确切的细节取决于系统固件，但这两种模式通常都支持“预引导执行环境”（PXE）规范，该规范允许通过网络配置引导加载程序。

## Steps needed 所需步骤

The process for network booting the live server installer is similar for both modes and goes like this:
两种模式下，实时服务器安装程序的网络启动过程是相似的，如下所示：

1. The to-be-installed machine boots, and is directed to network boot.
   要安装的计算机将启动，并被定向到网络启动。
2. The DHCP/BOOTP server tells the machine its network configuration and where to get the bootloader.
   DHCP/BOOTP 服务器告诉机器其网络配置以及从何处获取引导加载程序。
3. The machine’s firmware downloads the bootloader over TFTP and executes it.
   计算机的固件通过 TFTP 下载引导加载程序并执行它。
4. The bootloader downloads configuration, also over TFTP, telling it where to download the kernel, RAM Disk and kernel command line to use.
   引导加载程序也通过 TFTP 下载配置，告诉它在哪里下载内核、RAM 磁盘和内核命令行以使用。
5. The RAM Disk looks at the kernel command line to learn how to configure the network and where to download the server ISO from.
   RAM 磁盘查看内核命令行，以了解如何配置网络以及从哪里下载服务器 ISO。
6. The RAM Disk downloads the ISO and mounts it as a loop device.
   RAM 磁盘下载 ISO 并将其挂载为环路设备。
7. From this point on the install follows the same path as if the ISO was on a local block device.
   从此时开始，安装将遵循与 ISO 在本地块设备上相同的路径。

The difference between UEFI and legacy modes is that in UEFI mode the  bootloader is an EFI executable, signed so that is accepted by Secure  Boot, and in legacy mode it is [PXELINUX](https://wiki.syslinux.org/wiki/index.php?title=PXELINUX). Most DHCP/BOOTP servers can be configured to serve the right bootloader to a particular machine.
UEFI 模式和旧模式之间的区别在于，在 UEFI 模式下，引导加载程序是 EFI 可执行文件，经过签名，因此被安全启动接受，而在旧模式下，它是 PXELINUX。大多数 DHCP/BOOTP 服务器可以配置为为特定计算机提供正确的引导加载程序。

## Configure DHCP/BOOTP and TFTP 配置 DHCP/BOOTP 和 TFTP

There are several implementations of the DHCP/BOOTP and TFTP protocols  available. This document will briefly describe how to configure `dnsmasq` to perform both of these roles.
DHCP/BOOTP 和 TFTP 协议有多种实现可用。本文档将简要介绍如何配置 `dnsmasq` 以执行这两个角色。

1. Install `dnsmasq` with: 安装 `dnsmasq` 方式：

   ```auto
   sudo apt install dnsmasq
   ```

2. Put something like this in `/etc/dnsmasq.conf.d/pxe.conf`:
   将类似的东西放入 `/etc/dnsmasq.conf.d/pxe.conf` ：

   ```auto
   interface=<your interface>,lo
   bind-interfaces
   dhcp-range=<your interface>,192.168.0.100,192.168.0.200
   dhcp-boot=pxelinux.0
   dhcp-match=set:efi-x86_64,option:client-arch,7
   dhcp-boot=tag:efi-x86_64,bootx64.efi
   enable-tftp
   tftp-root=/srv/tftp
   ```

> **Note**: 注意：
>  This assumes several things about your network; read `man dnsmasq` or the default `/etc/dnsmasq.conf` for many more options.
> 这假设了您的网络有几件事;读取 `man dnsmasq` 或更多选项的默认 `/etc/dnsmasq.conf` 值。

1. Restart `dnsmasq` with: 重新启动 `dnsmasq` ：

   ```auto
   sudo systemctl restart dnsmasq.service
   ```

## Serve the bootloaders and configuration. 提供引导加载程序和配置。

**We need to make this section possible to write sanely
我们需要使这一部分能够理智地写作**

Ideally this would be something like:
理想情况下，这将是这样的：

```auto
apt install cd-boot-images-amd64
ln -s /usr/share/cd-boot-images-amd64 /srv/tftp/boot-amd64
```

### Mode-independent set up 与模式无关的设置

1. Download the latest live server ISO for the release you want to install:
   下载要安装的版本的最新实时服务器 ISO：

   ```auto
   wget http://cdimage.ubuntu.com/ubuntu-server/daily-live/current/focal-live-server-amd64.iso
   ```

2. Mount it: 挂载它：

   ```auto
   mount ubuntu-19.10-live-server-amd64.iso /mnt
   ```

3. Copy the kernel and `initrd` from it to where the `dnsmasq` serves TFTP from:
   将内核复制并 `initrd` 从内核复制到 `dnsmasq` 提供 TFTP 的位置：

   ```auto
   cp /mnt/casper/{vmlinuz,initrd} /srv/tftp/
   ```

### Set up the files for UEFI booting 设置用于 UEFI 启动的文件

1. Copy the signed shim binary into place:
   将已签名的填充码二进制文件复制到位：

   ```auto
   apt download shim-signed
   dpkg-deb --fsys-tarfile shim-signed*deb | tar x ./usr/lib/shim/shimx64.efi.signed -O > /srv/tftp/bootx64.efi
   ```

2. Copy the signed GRUB binary into place:
   将已签名的 GRUB 二进制文件复制到位：

   ```auto
   apt download grub-efi-amd64-signed
   dpkg-deb --fsys-tarfile grub-efi-amd64-signed*deb | tar x ./usr/lib/grub/x86_64-efi-signed/grubnetx64.efi.signed -O > /srv/tftp/grubx64.efi
   ```

3. GRUB also needs a font to be available over TFTP:
   GRUB 还需要一种可以通过 TFTP 使用的字体：

   ```auto
   apt download grub-common
   dpkg-deb --fsys-tarfile grub-common*deb | tar x ./usr/share/grub/unicode.pf2 -O > /srv/tftp/unicode.pf2
   ```

4. Create `/srv/tftp/grub/grub.cfg` that contains:
   创建包含以下内容的： `/srv/tftp/grub/grub.cfg` 

   ```auto
    set default="0"
    set timeout=-1
        
    if loadfont unicode ; then
      set gfxmode=auto
      set locale_dir=$prefix/locale
      set lang=en_US
    fi
    terminal_output gfxterm
        
    set menu_color_normal=white/black
    set menu_color_highlight=black/light-gray
    if background_color 44,0,30; then
      clear
    fi
        
    function gfxmode {
            set gfxpayload="${1}"
            if [ "${1}" = "keep" ]; then
                    set vt_handoff=vt.handoff=7
            else
                    set vt_handoff=
            fi
    }
        
    set linux_gfx_mode=keep
        
    export linux_gfx_mode
        
    menuentry 'Ubuntu 20.04' {
            gfxmode $linux_gfx_mode
            linux /vmlinux $vt_handoff quiet splash
            initrd /initrd
    }
   ```

### Set up the files for legacy boot 设置旧版启动的文件

1. Download `pxelinux.0` and put it into place:
   下载 `pxelinux.0` 并安装到位：

   ```auto
   wget http://archive.ubuntu.com/ubuntu/dists/eoan/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/pxelinux.0
   mkdir -p /srv/tftp
   mv pxelinux.0 /srv/tftp/
   ```

2. Make sure to have installed package `syslinux-common` and then:
   确保已安装软件包 `syslinux-common` ，然后：

   ```auto
   cp /usr/lib/syslinux/modules/bios/ldlinux.c32 /srv/tftp/
   ```

3. Create `/srv/tftp/pxelinux.cfg/default` containing:
   创建 `/srv/tftp/pxelinux.cfg/default` 包含：

   ```auto
    DEFAULT install
    LABEL install
      KERNEL vmlinuz
      INITRD initrd
      APPEND root=/dev/ram0 ramdisk_size=1500000 ip=dhcp url=http://cdimage.ubuntu.com/ubuntu-server/daily-live/current/focal-live-server-amd64.iso
   ```

As you can see, this downloads the ISO from Ubuntu’s servers. You may want to host it somewhere on your infrastructure and change the URL to  match.
如您所见，这会从 Ubuntu 的服务器下载 ISO。您可能希望将其托管在基础结构上的某个位置，并更改要匹配的 URL。

This configuration is very simple. PXELINUX has many, many options, and you can [consult its documentation](https://wiki.syslinux.org/wiki/index.php?title=PXELINUX) for more.
此配置非常简单。PXELINUX 有很多很多选项，您可以查阅其文档了解更多信息。

# 通过 ARM（aarch64、arm64）和 x86_64 （amd64） 上的 UEFI PXE 对服务器安装程序进行网络启动

This document provides the steps needed to install a system via netbooting  and the live server installer (Subiquity) in UEFI mode with Ubuntu 20.04 (or later).
本文档提供了在 Ubuntu 20.04（或更高版本）的 UEFI 模式下通过网络启动和实时服务器安装程序 （Subiquity） 安装系统所需的步骤。

The process described here is applicable to both arm64 and amd64 architectures. The process is inspired by [this Ubuntu Discourse post](https://discourse.ubuntu.com/t/netbooting-the-live-server-installer/14510) for **legacy mode**, which is UEFI’s predecessor. Focal (20.04, 20.04.5) and Groovy (20.10) have been tested with the following method.
此处描述的过程适用于 arm64 和 amd64 体系结构。该过程的灵感来自这篇针对遗留模式的 Ubuntu Discourse 帖子，这是 UEFI  的前身。Focal （20.04， 20.04.5） 和 Groovy （20.10） 已使用以下方法进行了测试。

## Configure TFTP 配置 TFTP

This article assumes that you have set up your TFTP (and/or DHCP/bootp if  necessary, depending on your LAN configuration) by following [the method described here](https://discourse.ubuntu.com/t/-/14510). You could also build your own TFTP in this way if your DNS and DHCP are already well configured:
本文假定您已按照此处描述的方法设置了 TFTP（和/或 DHCP/bootp，如有必要，具体取决于您的 LAN 配置）。如果您的 DNS 和 DHCP 已经配置良好，您也可以以这种方式构建自己的 TFTP：

```auto
$ sudo apt install tftpd-hpa
```

If the installation is successful, check that the corresponding TFTP service is active using this command:
如果安装成功，请使用以下命令检查相应的 TFTP 服务是否处于活动状态：

```auto
$ systemctl status tftpd-hpa.service
```

It is expected to show **active (running)** in the output messages. We will also assume your TFTP root path is `/var/lib/tftpboot` for the remainder of this article.
它应该在输出消息中显示活动（正在运行）。我们还将假定您的 TFTP 根路径适用于 `/var/lib/tftpboot` 本文的其余部分。

## How to serve files 如何提供文件

You can **skip the whole section** of the following manual set up instruction by using [this non-official tool](https://github.com/dannf/ubuntu-server-netboot). The tool will setup your TFTP server to serve necessary files for netbooting.
您可以使用此非官方工具跳过以下手动设置说明的整个部分。该工具将设置您的 TFTP 服务器以提供网络启动所需的文件。

### Necessary files 必要文件

The following files are needed for this process:
此过程需要以下文件：

- Ubuntu live server image:

  
  Ubuntu 实时服务器镜像：

  - For arm64 architectures, the image name has the suffix `-arm64`. For example, `ubuntu-20.04.5-live-server-arm64.iso`.
    对于 arm64 体系结构，映像名称的后缀 `-arm64` 为 。例如， `ubuntu-20.04.5-live-server-arm64.iso` .
  - For amd64 architectures, the image name has the suxxif `-amd64`. For example, `ubuntu-20.04.5-live-server-amd64.iso`.
    对于 amd64 架构，映像名称具有 suxxif `-amd64` 。例如， `ubuntu-20.04.5-live-server-amd64.iso` .

- GRUB EFI binary (and the corresponding 

  ```
  grub.cfg
  ```

   text file):

  
  GRUB EFI 二进制文件（以及相应的 `grub.cfg` 文本文件）：

  - For arm64 architectures, this is called `grubnetaa64.efi.signed`.
    对于 arm64 架构，这称为 `grubnetaa64.efi.signed` .
  - For amd64 architectures, this is called `grubnetx64.efi.signed`.
    对于 amd64 架构，这称为 `grubnetx64.efi.signed` .

- `initrd` extracted from your target Ubuntu live server image (use `hwe-initrd` instead if you want to boot with the HWE kernel).
   `initrd` 从目标 Ubuntu 实时服务器映像中提取（如果要使用 HWE 内核启动，请改用 `hwe-initrd` ）。

- `vmlinuz` extracted from your target Ubuntu live server image (use `hwe-vmlinuz` instead if you want to boot with the HWE kernel).
   `vmlinuz` 从目标 Ubuntu 实时服务器映像中提取（如果要使用 HWE 内核启动，请改用 `hwe-vmlinuz` ）。

### Examples 例子

In the following sections, we will use an arm64 image as an example. This means the following files are used:
在以下各节中，我们将使用 arm64 图像作为示例。这意味着使用以下文件：

- Ubuntu 20.04.5 live server image [ubuntu-20.04.5-live-server-arm64.iso](https://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-arm64.iso)
  Ubuntu 20.04.5 实时服务器镜像ubuntu-20.04.5-live-server-arm64.iso
- GRUB EFI binary [grubnetaa64.efi.signed](http://ports.ubuntu.com/ubuntu-ports/dists/focal/main/uefi/grub2-arm64/current/grubnetaa64.efi.signed)
  GRUB EFI 二进制 grubnetaa64.efi.signed
- `initrd` extracted from `ubuntu-20.04.5-live-server-arm64.iso`
   `initrd` 提取自 `ubuntu-20.04.5-live-server-arm64.iso` 
- `vmlinuz` extracted from `ubuntu-20.04.5-live-server-arm64.iso`
   `vmlinuz` 提取自 `ubuntu-20.04.5-live-server-arm64.iso` 

Replace the corresponding files if you want to work on an amd64 image. For example, your files may be:
如果要处理 amd64 映像，请替换相应的文件。例如，您的文件可能是：

- Ubuntu 20.04.5 live server image [ubuntu-20.04.5-live-server-amd64.iso](https://releases.ubuntu.com/20.04.5/ubuntu-20.04.5-live-server-amd64.iso)
  Ubuntu 20.04.5 实时服务器镜像ubuntu-20.04.5-live-server-amd64.iso
- GRUB EFI binary [grubnetx64.efi.signed](http://archive.ubuntu.com/ubuntu/dists/focal/main/uefi/grub2-amd64/current/grubnetx64.efi.signed)
  GRUB EFI 二进制 grubnetx64.efi.signed
- `initrd` extracted from `ubuntu-20.04.5-live-server-amd64.iso`
   `initrd` 提取自 `ubuntu-20.04.5-live-server-amd64.iso` 
- `vmlinuz` extracted from `ubuntu-20.04.5-live-server-amd64.iso`
   `vmlinuz` 提取自 `ubuntu-20.04.5-live-server-amd64.iso` 

### Download and serve the GRUB EFI binary 下载并提供 GRUB EFI 二进制文件

The GRUB binary helps us redirect the download path to the target files via `grub.cfg`. Refer to [the instructions here](https://discourse.ubuntu.com/t/-/14510) to get more information about the PXE process and why we need this binary.
GRUB 二进制文件帮助我们通过 `grub.cfg` 将下载路径重定向到目标文件。请参阅此处的说明，以获取有关 PXE 进程以及为什么需要此二进制文件的详细信息。

```auto
$ sudo wget http://ports.ubuntu.com/ubuntu-ports/dists/focal/main/uefi/grub2-arm64/current/grubnetaa64.efi.signed -O /var/lib/tftpboot/grubnetaa64.efi.signed
```

> **Note**: 注意：
>  You may need to change **the archive distribution’s name** from `Focal` to your target distribution name.
> 您可能需要将存档分发的名称从 `Focal` 更改为目标分发名称。

### Download and serve more files 下载并提供更多文件

Fetch the installer by downloading an Ubuntu ARM server ISO, e.g. the [20.04.5 live server arm64 ISO](http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-arm64.iso). Note that the prefix “live” is significant. We will need the files available only in the live version.
通过下载 Ubuntu ARM 服务器 ISO 获取安装程序，例如 20.04.5 实时服务器 arm64 ISO。请注意，前缀“live”很重要。我们将需要仅在实时版本中可用的文件。

Mount the ISO and copy the target files we need over to the TFTP folder:
挂载 ISO 并将我们需要的目标文件复制到 TFTP 文件夹：

```auto
$ sudo mount ./ubuntu-20.04.5-live-server-arm64.iso /mnt
$ sudo mkdir /var/lib/tftpboot/grub /var/lib/tftpboot/casper
$ sudo cp /mnt/boot/grub/grub.cfg /var/lib/tftpboot/grub/
$ sudo cp /mnt/casper/initrd /var/lib/tftpboot/casper/
$ sudo cp /mnt/casper/vmlinuz /var/lib/tftpboot/casper/
```

So, the TFTP root folder should look like this now:
因此，TFTP 根文件夹现在应该如下所示：

```auto
$ find /var/lib/tftpboot/
/var/lib/tftpboot/
/var/lib/tftpboot/grub
/var/lib/tftpboot/grub/grub.cfg
/var/lib/tftpboot/grubnetaa64.efi.signed
/var/lib/tftpboot/casper
/var/lib/tftpboot/casper/initrd
/var/lib/tftpboot/casper/vmlinuz
```

Finally, let’s customise the GRUB menu so we can install our target image by fetching it directly over the internet.
最后，让我们自定义 GRUB 菜单，以便我们可以通过直接通过 Internet 获取目标图像来安装它。

```auto
$ sudo chmod +w /var/lib/tftpboot/grub/grub.cfg
$ sudo vi /var/lib/tftpboot/grub/grub.cfg
```

Add a new entry:
添加新条目：

```auto
menuentry "Install Ubuntu Server (Focal 20.04.5) (Pull the iso from web)" {
        set gfxpayload=keep
        linux   /casper/vmlinuz url=http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-arm64.iso only-ubiquity ip=dhcp ---
        initrd  /casper/initrd
}
```

Note that here: 请注意，这里：

- `ip=dhcp` is for the DHCP management setup in the lab.
   `ip=dhcp` 用于实验室中的 DHCP 管理设置。
- `url` is used to point to your target image download URL. Remember to change them according to your scenario.
   `url` 用于指向目标图像下载 URL。请记住根据您的方案更改它们。

If everything goes well, you should get into the expected GRUB menu of the ephemeral live prompt. Select the entry you just put in `grub.cfg`, which is `Install Ubuntu Server (Focal 20.04.5) (Pull the ISO from web)` in our example. Wait for the ISO to download, and then you will see the Subiquity welcome message. Enjoy the installation!
如果一切顺利，您应该进入临时实时提示的预期 GRUB 菜单。选择您刚刚输入 `grub.cfg` 的条目，在我们的示例 `Install Ubuntu Server (Focal 20.04.5) (Pull the ISO from web)` 中。等待 ISO 下载，然后您将看到 Subiquity 欢迎消息。享受安装！

## Appendix 附录

### Always check the serving file names 始终检查服务文件名

For example, always make sure the target file name for `linux` and `initrd` is correct. For example, the default `initrd` binary file name of 20.04.5 is `initrd`, and it is `initrd.lz` for 20.10. Always make sure you serve the correct file names, since  this is a frequent troubleshooting issue. Paying attention to this  detail could save you a lot of time.
例如，始终确保 和 `linux` `initrd` 的目标文件名正确无误。例如，20.04.5 的默认 `initrd` 二进制文件名是 `initrd` ，它是 `initrd.lz` 20.10 的。始终确保提供正确的文件名，因为这是一个常见的故障排除问题。注意这个细节可以为您节省大量时间。

### Booting screenshots 启动屏幕截图

If your setup is correct, your `grub.cfg` should redirect the process to an ephemeral environment where your  target image is downloaded and assigned in the GRUB entry of `grub.cfg`. You will see a screen like this if you are able to access the console or monitor device of your target machine:
如果设置正确， `grub.cfg` 则应将该过程重定向到一个临时环境，在该环境中下载目标映像并在 的 `grub.cfg` GRUB 条目中分配。如果您能够访问目标计算机的控制台或监视设备，您将看到如下屏幕：

![Downloading target image](https://assets.ubuntu.com/v1/fbdff13b-downloading_image.png)

Wait for the download to complete. If you see this Subiquity welcome page,  the installer successfully launched via your UEFI PXE setup.  Congratulations!
等待下载完成。如果您看到此 Subiquity 欢迎页面，则表示安装程序已通过 UEFI PXE 设置成功启动。祝贺！

![Subiquity welcome page](https://assets.ubuntu.com/v1/ef037190-subiquity_welcome_page.png)

# 使用 Petitboot 对 IBM Power （ppc64el） 上的实时服务器安装程序进行网络启动

Open a terminal window on your workstation and make sure the ‘ipmitool’ package is installed.
在工作站上打开终端窗口，确保已安装“ipmitool”软件包。

Verify if you can reach the BMC of the IBM Power system via `ipmitool` with a simple `ipmitool` call like:
验证您是否 `ipmitool` 可以通过以下方式通过以下简单 `ipmitool` 调用访问 IBM Power 系统的 BMC：

```auto
$ ipmitool -I lanplus -H Power9Box -U <user> -P <password> power status 
Chassis Power is off
```

or:

```auto
$ ipmitool -I lanplus -H Power9Box -U <user> -P <password> fru print 47
  Product Name          : OpenPOWER Firmware
  Product Version       : open-power-SUPERMICRO-P9DSU-V2.12-20190404-prod
  Product Extra         : 	op-build-1b9269e
  Product Extra         : 	buildroot-2018.11.3-12-g222837a
  Product Extra         : 	skiboot-v6.0.19
  Product Extra         : 	hostboot-c00d44a-pb1307d7
  Product Extra         : 	occ-8fa3854
  Product Extra         : 	linux-4.19.30-openpower1-p22d1df8
  Product Extra         : 	petitboot-v1.7.5-p8f5fc86
```

or:

```auto
$ ipmitool -I lanplus -H Power9Box -U <user> -P <password> sol info
  Set in progress                 : set-complete
  Enabled                         : true
  Force Encryption                : false
  Force Authentication            : false
  Privilege Level                 : OPERATOR
  Character Accumulate Level (ms) : 0
  Character Send Threshold        : 0
  Retry Count                     : 0
  Retry Interval (ms)             : 0
  Volatile Bit Rate (kbps)        : 115.2
  Non-Volatile Bit Rate (kbps)    : 115.2
  Payload Channel                 : 1 (0x01)
  Payload Port                    : 623
```

## Activate serial-over-LAN 激活 Serial-over-LAN

Open a second terminal and activate serial-over-LAN (SOL), so that you have two terminal windows open:
打开第二个终端并激活 serial-over-LAN （SOL），以便打开两个终端窗口：

1. to control the BMC via IPMI
   通过IPMI控制BMC
2. for the serial-over-LAN console
   用于 Serial-over-LAN 控制台

Activate serial-over-LAN:
激活 serial-over-LAN：

```auto
$ ipmitool -I lanplus -H Power9Box -U <user> -P <password> sol activate
...
```

Power the system on in the ‘control terminal’ and watch the SOL console:
在“控制终端”中打开系统电源并观看 SOL 控制台：

```auto
$ ipmitool -I lanplus -H Power9Box -U <user> -P <password> power on
...
```

It takes some time to see the first lines in the SOL console:
在 SOL 控制台中查看第一行需要一些时间：

```auto
[SOL Session operational.  Use ~? for help]
--== Welcome to Hostboot  ==--

  2.77131|secure|SecureROM valid - enabling functionality
  3.15860|secure|Booting in secure mode.
  5.59684|Booting from SBE side 0 on master proc=00050000
  5.60502|ISTEP  6. 5 - host_init_fsi
  5.87228|ISTEP  6. 6 - host_set_ipl_parms
  6.11032|ISTEP  6. 7 - host_discover_targets
  6.67868|HWAS|PRESENT> DIMM[03]=A0A0000000000000
  6.67870|HWAS|PRESENT> Proc[05]=8800000000000000
  6.67871|HWAS|PRESENT> Core[07]=3FFF0C33FFC30000
  6.98988|ISTEP  6. 8 - host_update_master_tpm
  7.22711|SECURE|Security Access Bit> 0xC000000000000000
  7.22711|SECURE|Secure Mode Disable (via Jumper)> 0x0000000000000000
  7.22731|ISTEP  6. 9 - host_gard
  7.43353|HWAS|FUNCTIONAL> DIMM[03]=A0A0000000000000
  7.43354|HWAS|FUNCTIONAL> Proc[05]=8800000000000000
  7.43356|HWAS|FUNCTIONAL> Core[07]=3FFF0C33FFC30000
  7.44509|ISTEP  6.10 - host_revert_sbe_mcs_setup
…
```

After a moment the system reaches the Petitboot screen:
过了一会儿，系统到达 Petitboot 屏幕：

```auto
Petitboot (v1.7.5-p8f5fc86)                                   9006-12P 1302NXA 
  ─────────────────────────────────────────────────
 [Network: enP2p1s0f0 / 0c:c4:7a:87:04:d8]
   Execute
   netboot enP2p1s0f0 (pxelinux.0)
 [CD/DVD: sr0 / 2019-10-17-13-35-12-00]
   Install Ubuntu Server
 [Disk: sda2 / 295f571b-b731-4ebb-b752-60aadc80fc1b]
   Ubuntu, with Linux 5.4.0-14-generic (recovery mode)
   Ubuntu, with Linux 5.4.0-14-generic
   Ubuntu
  
 System information
 System configuration
 System status log
 Language
 Rescan devices
 Retrieve config from URL
 Plugins (0)
  
   *Exit to shell                                        
   ─────────────────────────────────────────────────
Enter=accept, e=edit, n=new, x=exit, l=language, g=log, h=help
```

Select “*Exit to shell”.
选择“*退出 shell”。

> **Note**: 注意：
>  Make sure you really watch the SOL, since the Petitboot screen (above)  has a time out (usually 10 or 30 seconds) and afterwards it  automatically proceeds and tries to boot from the configured devices  (usually disk). This can be prevented by just navigating in Petitboot.
> 确保您真的观看了 SOL，因为 Petitboot 屏幕（上图）有一个超时（通常为 10 或 30 秒），然后它会自动继续并尝试从配置的设备（通常是磁盘）启动。这可以通过在 Petitboot 中导航来防止。
>  The petitboot shell is small Linux based OS:
> petitboot shell 是基于 Linux 的小型操作系统：
>
> ```auto
> ...
> Exiting petitboot. Type 'exit' to return.
> You may run 'pb-sos' to gather diagnostic data
> ```

> **Note**: 注意：
>  In case one needs to gather system details and diagnostic data for IBM support, this can be done here by running ‘pb-sos’ (see `msg`).
> 如果需要收集系统详细信息和诊断数据以供 IBM 支持，可以通过运行“pb-sos”（请参阅 `msg` ）来完成此操作。

## Download the ISO 下载 ISO

Now download the ‘live-server’ ISO image (notice that  ‘focal-live-server-ppc64el.iso’ uses the liver server installer,  Subiquity, while ‘focal-server-s390x.iso’ uses `d-i`).
现在下载“live-server”ISO映像（请注意，“focal-live-server-ppc64el.iso”使用肝服务器安装程序Subiquity，而“focal-server-s390x.iso”使用 `d-i` ）。

Again, for certain web locations a proxy needs to be used:
同样，对于某些 Web 位置，需要使用代理：

```auto
/ # export http_proxy=http://squid.proxy:3128   # in case a proxy is required
/ # 
/ # wget http://cdimage.ubuntu.com/ubuntu-server/daily-live/current/focal-live-server-ppc64el.iso
Connecting to <proxy-ip>:3128 (<proxy-ip>:3128)
focal-live-server-pp 100% |....................|  922M  0:00:00 ETA
```

Next we need to loop-back mount the ISO:
接下来，我们需要环回挂载 ISO：

```auto
/ # mkdir iso
/ # mount -o loop focal-live-server-ppc64el.iso iso
```

Or, in case autodetect of type iso9660 is not supported or not working, you should explicitly specify the ‘iso9660’ type:
或者，如果不支持或无法正常工作 iso9660 类型的自动检测，则应显式指定“iso9660”类型：

```auto
/ # mount -t iso9660 -o loop focal-live-server-ppc64el.iso iso
```

Now load kernel and initrd from the loop-back mount, specify any needed kernel parameters and get it going:
现在从环回挂载加载内核和 initrd，指定任何需要的内核参数并启动它：

```auto
/ # kexec -l ./iso/casper/vmlinux --initrd=./iso/casper/initrd.gz --append="ip=dhcp url=http://cdimage.ubuntu.com/ubuntu-server/daily-live/current/focal-live-server-ppc64el.iso http_proxy=http://squid.proxy:3128 --- quiet"
/ # kexec -e
The system is going down NOW!
Sent SIGTERM to all processes
Sent SIGKILL to all processes
...
```

> **Note**: 注意：
>  In order to boot with and install the HWE kernel (if available), substitute `vmlinux` with `vmlinux-hwe` in the first `kexec` line.
> 为了引导和安装 HWE 内核（如果可用），请在第一 `kexec` 行 `vmlinux` 中替换 with `vmlinux-hwe` 。

The system now performs the initial boot of the installer:
系统现在执行安装程序的初始引导：

```auto
[ 1200.687004] kexec_core: Starting new kernel
[ 1277.493883374,5] OPAL: Switch to big-endian OS
[ 1280.465061219,5] OPAL: Switch to little-endian OS
ln: /tmp/mountroot-fail-hooks.d//scripts/init-premount/lvm2: No such file or directory
Internet Systems Consortium DHCP Client 4.4.1
Copyright 2004-2018 Internet Systems Consortium.
All rights reserved.
For info, please visit https://www.isc.org/software/dhcp/
Listening on LPF/enP2p1s0f3/0c:c4:7a:87:04:db
Sending on   LPF/enP2p1s0f3/0c:c4:7a:87:04:db
Listening on LPF/enP2p1s0f2/0c:c4:7a:87:04:da
Sending on   LPF/enP2p1s0f2/0c:c4:7a:87:04:da
Listening on LPF/enP2p1s0f1/0c:c4:7a:87:04:d9
Sending on   LPF/enP2p1s0f1/0c:c4:7a:87:04:d9
Listening on LPF/enP2p1s0f0/0c:c4:7a:87:04:d8
Sending on   LPF/enP2p1s0f0/0c:c4:7a:87:04:d8
Sending on   Socket/fallback
DHCPDISCOVER on enP2p1s0f3 to 255.255.255.255 port 67 interval 3
(xid=0x8d5704c)
DHCPDISCOVER on enP2p1s0f2 to 255.255.255.255 port 67 interval 3
(xid=0x94b25b28)
DHCPDISCOVER on enP2p1s0f1 to 255.255.255.255 port 67 interval 3
(xid=0x4edd0558)
DHCPDISCOVER on enP2p1s0f0 to 255.255.255.255 port 67 interval 3
(xid=0x61c90d28)
DHCPOFFER of 10.245.71.102 from 10.245.71.3
DHCPREQUEST for 10.245.71.102 on enP2p1s0f0 to 255.255.255.255 port 67
(xid=0x280dc961)
DHCPACK of 10.245.71.102 from 10.245.71.3 (xid=0x61c90d28)
bound to 10.245.71.102 -- renewal in 236 seconds.
Connecting to 91.189.89.11:3128 (91.189.89.11:3128)
focal-live-server-pp   1% |                                | 14.0M  0:01:04 ETA
focal-live-server-pp   4% |*                               | 45.1M  0:00:38 ETA
focal-live-server-pp   8% |**                              | 76.7M  0:00:33 ETA
focal-live-server-pp  11% |***                             |  105M  0:00:31 ETA
focal-live-server-pp  14% |****                            |  133M  0:00:29 ETA
focal-live-server-pp  17% |*****                           |  163M  0:00:27 ETA
focal-live-server-pp  20% |******                          |  190M  0:00:26 ETA
focal-live-server-pp  24% |*******                         |  222M  0:00:25 ETA
focal-live-server-pp  27% |********                        |  253M  0:00:23 ETA
focal-live-server-pp  30% |*********                       |  283M  0:00:22 ETA
focal-live-server-pp  34% |**********                      |  315M  0:00:21 ETA
focal-live-server-pp  37% |***********                     |  343M  0:00:20 ETA
focal-live-server-pp  39% |************                    |  367M  0:00:19 ETA
focal-live-server-pp  42% |*************                   |  392M  0:00:18 ETA
focal-live-server-pp  45% |**************                  |  420M  0:00:17 ETA
focal-live-server-pp  48% |***************                 |  451M  0:00:16 ETA
focal-live-server-pp  52% |****************                |  482M  0:00:15 ETA
focal-live-server-pp  55% |*****************               |  514M  0:00:14 ETA
focal-live-server-pp  59% |******************              |  546M  0:00:13 ETA
focal-live-server-pp  62% |********************            |  578M  0:00:11 ETA
focal-live-server-pp  65% |*********************           |  607M  0:00:10 ETA
focal-live-server-pp  69% |**********************          |  637M  0:00:09 ETA
focal-live-server-pp  72% |***********************         |  669M  0:00:08 ETA
focal-live-server-pp  75% |************************        |  700M  0:00:07 ETA
focal-live-server-pp  79% |*************************       |  729M  0:00:06 ETA
focal-live-server-pp  82% |**************************      |  758M  0:00:05 ETA
focal-live-server-pp  85% |***************************     |  789M  0:00:04 ETA
focal-live-server-pp  88% |****************************    |  817M  0:00:03 ETA
focal-live-server-pp  91% |*****************************   |  842M  0:00:02 ETA
focal-live-server-pp  93% |******************************  |  867M  0:00:01 ETA
focal-live-server-pp  97% |******************************* |  897M  0:00:00 ETA
focal-live-server-pp 100% |********************************|  922M  0:00:00 ETA
mount: mounting /cow on /root/cow failed: No such file or directory
Connecting to plymouth: Connection refused
passwd: password expiry information changed.
[   47.202736] /dev/loop3: Can't open blockdev
[   52.672550] cloud-init[3759]: Cloud-init v. 20.1-10-g71af48df-0ubuntu1 running
 'init-local' at Wed, 18 Mar 2020 15:18:07 +0000. Up 51.87 seconds.
...
```

Once it has completed, you will reach the initial Subiquity installer screen:
完成后，您将进入初始 Subiquity 安装程序屏幕：

```auto
▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
    Willkommen! Bienvenue! Welcome! Добро пожаловать! Welkom          
▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
    Use UP, DOWN and ENTER keys to select your language.                        
  
                  [ English                                    ▸ ]              
                  [ Asturianu                                  ▸ ]              
                  [ Català                                     ▸ ]              
                  [ Hrvatski                                   ▸ ]              
                  [ Nederlands                                 ▸ ]              
                  [ Suomi                                      ▸ ]              
                  [ Français                                   ▸ ]              
                  [ Deutsch                                    ▸ ]              
                  [ Ελληνικά                                   ▸ ]              
                  [ Magyar                                     ▸ ]              
                  [ Latviešu                                   ▸ ]              
                  [ Norsk bokmål                               ▸ ]              
                  [ Polski                                     ▸ ]              
                  [ Русский                                    ▸ ]              
                  [ Español                                    ▸ ]              
                  [ Українська                                 ▸ ]              
```

From this point, you can follow the normal Subiquity installation. For more details, refer to the [Subquity installer documentation](https://canonical-subiquity.readthedocs-hosted.com/en/latest/index.html).
从这一点开始，您可以遵循正常的 Subiquity 安装。有关更多详细信息，请参阅 Subquity 安装程序文档。

# How to start a live server installation on IBM Power (ppc64el) with a virtual CD-ROM and Petitboot 如何使用虚拟 CD-ROM 和 Petitboot 在 IBM Power （ppc64el） 上启动实时服务器安装

> **Note**: 注意：
>  Not all IBM Power machines come with the capability of installing via a virtual CD-ROM! However, it is also possible to [boot the installer over the network](https://ubuntu.com/server/docs/netboot-the-live-server-installer-on-ibm-power-ppc64el-with-petitboot).
> 并非所有 IBM Power 机器都具有通过虚拟 CD-ROM 进行安装的功能！但是，也可以通过网络启动安装程序。

A separate system (ideally in the same network, because of `ipmitool`) is needed to host the ppc64el ISO image file, which is later used as the virtual CD-ROM.
需要一个单独的系统（理想情况下在同一网络中，因为 `ipmitool` ）来托管 ppc64el ISO 映像文件，该文件稍后用作虚拟 CD-ROM。

## Install ipmitool and Samba 安装 ipmitool 和 Samba

Log in to this separate host and make sure that the `ipmitool` package is installed:
登录到此单独的主机，并确保已安装软件 `ipmitool` 包：

```auto
$ sudo apt install ipmitool
```

as well as Samba:
以及桑巴舞：

```auto
$ sudo apt install samba
```

## Configure Samba 配置 Samba

Next, set up and configure Samba:
接下来，设置和配置 Samba：

```auto
$ sudo touch /etc/samba/smb.conf && sudo tee -a /etc/samba/smb.conf <<EOF
[winshare]
  path=/var/winshare
  browseable = yes
  read only = no
  guest ok = yes
EOF
```

And do a quick verification that the required lines are present:
并快速验证是否存在所需的行：

```auto
$ tail -n 5 /etc/samba/smb.conf
[winshare]
  path=/var/winshare
  browseable = yes
  read only = no
  guest ok = yes
```

> **Optional step 可选步骤**
>  For downloading the image you may have to use a proxy server:
> 要下载图像，您可能需要使用代理服务器：
>
> ```auto
> $ sudo touch ~/.wgetrc && sudo tee -a ~/.wgetrc <<EOF
> use_proxy=yes
> http_proxy=squid.proxy:3128
> https_proxy=squid.proxy:3128
> EOF
> ```

## Download the ISO image 下载 ISO 映像

The ISO image needs to be downloaded now:
现在需要下载 ISO 映像：

```auto
$ wget http://cdimage.ubuntu.com/ubuntu/releases/focal/release/ubuntu-20.04-live-server-ppc64el.iso --directory-prefix=/var/winshare
```

The proxy can also be passed over as a `wget` argument, like this:
代理也可以作为 `wget` 参数传递，如下所示：

```auto
$ wget -e use_proxy=yes -e http_proxy=squid.proxy:3128 http://cdimage.ubuntu.com/ubuntu/releases/focal/release/ubuntu-20.04-live-server-ppc64el.iso --directory-prefix=/var/winshare
```

Change the file mode of the ISO image file:
更改 ISO 映像文件的文件模式：

```auto
$ sudo chmod -R 755 /var/winshare/
$ ls -l /var/winshare/
-rwxr-xr-x 1 ubuntu ubuntu  972500992 Mar 23 08:02 focal-live-server-ppc64el.iso
```

## Restart and check Samba 重新启动并检查 Samba

Next we need to restart and check the Samba service:
接下来我们需要重新启动并检查 Samba 服务：

```auto
$ sudo service smbd restart
$ sudo service smbd status
● smbd.service - Samba SMB Daemon
   Loaded: loaded (/lib/systemd/system/smbd.service; enabled; vendor 
preset: ena
   Active: active (running) since Tue 2020-02-04 15:17:12 UTC; 4s ago
     Docs: man:smbd(8)
           man:samba(7)
           man:smb.conf(5)
 Main PID: 6198 (smbd)
   Status: "smbd: ready to serve connections..."
    Tasks: 4 (limit: 19660)
   CGroup: /system.slice/smbd.service
           ├─6198 /usr/sbin/smbd --foreground --no-process-group
           ├─6214 /usr/sbin/smbd --foreground --no-process-group
           ├─6215 /usr/sbin/smbd --foreground --no-process-group
           └─6220 /usr/sbin/smbd --foreground --no-process-group
Feb 04 15:17:12 host systemd[1]: Starting Samba SMB Daemon…
Feb 04 15:17:12 host systemd[1]: Started Samba SMB Daemon.
```

Test Samba share: Test Samba 分享：

```auto
ubuntu@host:~$ smbclient -L localhost
WARNING: The "syslog" option is deprecated
Enter WORKGROUP\ubuntu's password: 
	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	winshare        Disk      
	IPC$            IPC       IPC Service (host server (Samba, Ubuntu))
	Reconnecting with SMB1 for workgroup listing.
	Server               Comment
	---------            -------
	Workgroup            Master
	---------            -------
	WORKGROUP            host
```

Get the IP address of the Samba host:
获取 Samba 主机的 IP 地址：

```auto
$ ip -4 -brief address show
lo               UNKNOWN        127.0.0.1/8 
ibmveth2         UNKNOWN        10.245.246.42/24 
```

> **Optional step**: 可选步骤：
>  Additional testing to make certain the Samba share is accessible from remote:
> 确保可从远程访问 Samba 共享的其他测试：
>
> ```auto
> user@workstation:~$ mkdir -p /tmp/test
> user@workstation:~$ sudo mount -t cifs -o 
> username=guest,password=guest //10.245.246.42/winshare /tmp/test/
> user@workstation:~$ ls -la /tmp/test/
> total 1014784
> drwxr-xr-x  2 root root          0 May  4 15:46 .
> drwxrwxrwt 18 root root        420 May  4 19:25 ..
> -rwxr-xr-x  1 root root 1038249984 May  3 19:37 ubuntu-20.04-live-server-ppc64el.iso
> ```

Now use a browser and navigate to the BMC of the Power system, which should be installed (let’s assume the BMC’s IP address is `10.245.246.247`):
现在使用浏览器并导航到应该安装的 Power 系统的 BMC（假设 BMC 的 IP 地址是 `10.245.246.247` ）：

```auto
firefox http://10.245.246.247/ 
```

Log into the BMC, then find and select:
登录 BMC，然后找到并选择：

> Virtual Media → CD-ROM
> 虚拟媒体→CD-ROM

Enter the IP address of the Samba share:
输入 Samba 共享的 IP 地址：

> 10.245.246.42

and the path to the Samba share:
以及通往 Samba 分享的道路：

```auto
\winshare\focal-live-server-ppc64el.iso
```

Click “Save and Mount”. Make sure that the virtual CD-ROM is really properly mounted!
单击“保存并安装”。确保虚拟 CD-ROM 确实安装正确！

```auto
CD-ROM Image:
  
This option allows you to share a CD-ROM image over a Windows Share with a
maximum size of 4.7GB. This image will be emulated to the host as USB device.
  
Device 1	There is an iso file mounted.
Device 2	No disk emulation set.
Device 3	No disk emulation set.
<Refresh Status>
Share host: 10.245.246.42
Path to image: \winshare\focal-live-server-ppc64el.iso
User (optional):
Password (optional):
<Save> <Mount> <Unmount>
```

> **Note**: 注意：
>  It’s important that you see a status like this:
> 请务必看到如下状态：
>
> ```auto
> Device 1 There is an iso file mounted
> ```
>
> Then the virtual CD-ROM is properly mounted and you will see the boot/install from CD-ROM entry in Petitboot:
> 然后正确挂载虚拟 CD-ROM，您将在 Petitboot 中看到从 CD-ROM 启动/安装条目：
>
> ```auto
> [CD/DVD: sr0 / 2020-03-23-08-02-42-00]
>   Install Ubuntu Server
> ```

## Boot into the Petitboot loader 引导进入 Petitboot 加载程序

Now use `ipmitool` to boot the system into the Petitboot loader:
现在用于 `ipmitool` 将系统引导到 Petitboot 加载程序中：

```auto
$ ipmitool -I lanplus -H 10.245.246.247 -U ADMIN -P <password> power status
$ ipmitool -I lanplus -H 10.245.246.247 -U ADMIN -P <password> sol activate
$ ipmitool -I lanplus -H 10.245.246.247 -U ADMIN -P <password> power on
Chassis Power Control: Up/On
```

And reach the Petitboot screen:
并到达 Petitboot 屏幕：

```auto
Petitboot (v1.7.5-p8f5fc86)                                   9006-12C BOS0026
 ─────────────────────────────────────────────
  [Network: enP2p1s0f0 / ac:1f:6b:09:c0:52]
    execute
    netboot enP2p1s0f0 (pxelinux.0)
  
  System information
  System configuration
  System status log
  Language
  Rescan devices
  Retrieve config from URL
 *Plugins (0)                              
  Exit to shell
─────────────────────────────────────────────
 Enter=accept, e=edit, n=new, x=exit, l=language, g=log, h=help
 Default boot cancelled
```

Make sure that booting from CD-ROM is enabled:
确保已启用从 CD-ROM 引导：

```auto
Petitboot (v1.7.5-p8f5fc86)                                   9006-12C BOS0026 
─────────────────────────────────────────────
  [Network: enP2p1s0f0 / ac:1f:6b:09:c0:52]
    Execute
    netboot enP2p1s0f0 (pxelinux.0)
  [Disk: sda2 / ebdb022b-96b2-4f4f-ae63-69300ded13f4]
    Ubuntu, with Linux 5.4.0-12-generic (recovery mode)
    Ubuntu, with Linux 5.4.0-12-generic
    Ubuntu
    
  System information
  System configuration
  System status log
  Language
  Rescan devices
  Retrieve config from URL
 *Plugins (0)                                          
  Exit to shell
  
─────────────────────────────────────────────
 Enter=accept, e=edit, n=new, x=exit, l=language, g=log, h=help
 [sda3] Processing new Disk device
Petitboot System Configuration
   
──────────────────────────────────────────────
  
  Autoboot:      ( ) Disabled
                 (*) Enabled
  
  Boot Order:    (0) Any CD/DVD device
                 (1) disk: sda2 [uuid: ebdb022b-96b2-4f4f-ae63-69300ded13f4]
                 (2) net:  enP2p1s0f0 [mac: ac:1f:6b:09:c0:52]
  
                 [     Add Device     ]
                 [  Clear & Boot Any  ]
                 [       Clear        ]
    
  Timeout:       30    seconds
    
    
  Network:       (*) DHCP on all active interfaces
                 ( ) DHCP on a specific interface
                 ( ) Static IP configuration
    
─────────────────────────────────────────────
 tab=next, shift+tab=previous, x=exit, h=help
Petitboot System Configuration
─────────────────────────────────────────────
  Network:       (*) DHCP on all active interfaces
                 ( ) DHCP on a specific interface
                 ( ) Static IP configuration
  
  DNS Server(s):                                   (eg. 192.168.0.2)
                 (if not provided by DHCP server)
  HTTP Proxy:                                    
  HTTPS Proxy:                                   
  
  Disk R/W:      ( ) Prevent all writes to disk
                 (*) Allow bootloader scripts to modify disks
  
  Boot console:  (*) /dev/hvc0 [IPMI / Serial]
                 ( ) /dev/tty1 [VGA]
                 Current interface: /dev/hvc0
  
                 [    OK    ]  [   Help   ]  [  Cancel  ]
  
───────────────────────────────────────────
 tab=next, shift+tab=previous, x=exit, h=help
```

Now select the ‘Install Ubuntu Server’ entry below the CD/DVD entry:
现在选择CD / DVD条目下方的“安装Ubuntu Server”条目：

```auto
  [CD/DVD: sr0 / 2020-03-23-08-02-42-00]
  *  Install Ubuntu Server                              
```

And let Petitboot boot from the (virtual) CD-ROM image:
并让 Petitboot 从（虚拟）CD-ROM 映像启动：

```auto
Sent SIGKILL to all processes
[  119.355371] kexec_core: Starting new kernel
[  194.483947394,5] OPAL: Switch to big-endian OS
[  197.454615202,5] OPAL: Switch to little-endian OS
```

The initial Subiquity installer screen will show up in the console:
初始 Subiquity 安装程序屏幕将显示在控制台中：

```auto
▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  Willkommen! Bienvenue! Welcome! Добро пожаловать! Welkom
▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
  Use UP, DOWN and ENTER keys to select your language.                        
  
                [ English                                    ▸ ]              
                [ Asturianu                                  ▸ ]              
                [ Català                                     ▸ ]              
                [ Hrvatski                                   ▸ ]              
                [ Nederlands                                 ▸ ]              
                [ Suomi                                      ▸ ]              
                [ Français                                   ▸ ]              
                [ Deutsch                                    ▸ ]              
                [ Ελληνικά                                   ▸ ]              
                [ Magyar                                     ▸ ]              
                [ Latviešu                                   ▸ ]              
                [ Norsk bokmål                               ▸ ]              
                [ Polski                                     ▸ ]              
                [ Русский                                    ▸ ]              
                [ Español                                    ▸ ]              
                [ Українська                                 ▸ ]              
```

From this point, you can follow the normal Subiquity installation. For more details, refer to the [Subquity installer documentation](https://canonical-subiquity.readthedocs-hosted.com/en/latest/index.html).
从这一点开始，您可以遵循正常的 Subiquity 安装。有关更多详细信息，请参阅 Subquity 安装程序文档。

------

# Interactive live server installation on IBM z/VM (s390x) IBM z/VM 上的交互式实时服务器安装 （s390x）

Doing an interactive (manual) live installation as described here - meaning  without specifying a parmfile - has been supported in Ubuntu Server  since LTS 20.04.5 (‘Focal’).
自 LTS 20.04.5（“Focal”）以来，Ubuntu Server 支持执行此处所述的交互式（手动）实时安装 - 这意味着无需指定 parmfile。

The following guide assumes that a z/VM guest has been defined, and that it is able to either reach the public `cdimage.ubuntu.com` server or an internal FTP or HTTP server that hosts an Ubuntu Server 20.04 installer image, like this [20.04 (a.k.a. Focal) daily live image](http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-s390x.iso)
以下指南假定已定义 z/VM 客户机，并且它能够访问公共 `cdimage.ubuntu.com` 服务器或托管 Ubuntu Server 20.04 安装程序映像的内部 FTP 或 HTTP 服务器，例如此 20.04（又名 Focal）每日实时映像

Find a place to download the installer image:
查找下载安装程序映像的位置：

```bash
user@workstation:~$ wget 
http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-s390x.iso
--2020-08-08 16:01:52--  
http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-s390x.iso
Resolving cdimage.ubuntu.com (cdimage.ubuntu.com)... 2001:67c:1560:8001::1d, 2001:67c:1360:8001::27, 2001:67c:1360:8001::28, ...
Connecting to cdimage.ubuntu.com 
(cdimage.ubuntu.com)|2001:67c:1560:8001::1d|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 705628160 (673M) [application/x-iso9660-image]
Saving to: ‘ubuntu-20.04.5-live-server-s390x.iso’

ubuntu-20.04.5-live 100%[===================>] 672.94M  37.1MB/s    in 
17s     

2020-08-08 16:02:10 (38.8 MB/s) - ‘ubuntu-20.04.5-live-server-s390x.iso’ saved 
[705628160/705628160]
```

Now loop-back mount the ISO to extract four files that are needed for a z/VM guest installation:
现在，环回挂载 ISO 以提取 z/VM 客户机安装所需的四个文件：

```bash
user@workstation:~$ mkdir iso
user@workstation:~$ sudo mount -o loop ubuntu-20.04.5-live-server-s390x.iso iso
user@workstation:~$ 

user@workstation:~$ ls -1 ./iso/boot/{ubuntu.exec,parmfile.*,kernel.u*,initrd.u*}
./iso/boot/initrd.ubuntu
./iso/boot/kernel.ubuntu
./iso/boot/parmfile.ubuntu
./iso/boot/ubuntu.exec
```

Now transfer these four files to your z/VM guest (for example to its ‘A’  file mode), using either the 3270 terminal emulator or FTP.
现在，使用 3270 终端仿真器或 FTP 将这四个文件传输到 z/VM 客户机（例如，传输到其“A”文件模式）。

Then log on to the z/VM guest that you want to use for the installation. In this example it will be guest ‘10.222.111.24’.
然后登录到要用于安装的 z/VM 客户机。在此示例中，它将是客户机“10.222.111.24”。

Execute the `ubuntu` REXX script to kick-off the installation:
执行 `ubuntu` REXX 脚本以启动安装：

```plaintext
ubuntu
00: 0000004 FILES PURGED
00: RDR FILE 0125 SENT FROM 10.222.111.24  PUN WAS 0125 RECS 101K CPY  001 A NOHOLD NO
KEEP
00: RDR FILE 0129 SENT FROM 10.222.111.24  PUN WAS 0129 RECS 0001 CPY  001 A NOHOLD NO
KEEP
00: RDR FILE 0133 SENT FROM 10.222.111.24  PUN WAS 0133 RECS 334K CPY  001 A NOHOLD NO
KEEP
00: 0000003 FILES CHANGED
00: 0000003 FILES CHANGED
01: HCPGSP2627I The virtual machine is placed in CP mode due to a SIGP initial CPU reset from CPU 00.
02: HCPGSP2627I The virtual machine is placed in CP mode due to a SIGP initial CPU reset from CPU 00.
03: HCPGSP2627I The virtual machine is placed in CP mode due to a SIGP initial CPU reset from CPU 00.
¬    0.390935| Initramfs unpacking failed: Decoding failed 
Unable to find a medium container a live file system 
```

In the usual case that no parmfile was configured, the installation system now offers to interactively configure the basic network:
在通常没有配置 parmfile 的情况下，安装系统现在提供交互式配置基本网络：

```plaintext
Attempt interactive netboot from a URL? 
yes no (default yes): yes
Available qeth devices: 
0.0.0600 0.0.0603 
zdev to activate (comma separated, optional): 0600
QETH device 0.0.0600:0.0.0601:0.0.0602 configured 
Two methods available for IP configuration: 
  * static: for static IP configuration 
  * dhcp: for automatic IP configuration 
static dhcp (default 'dhcp'): static
ip: 10.222.111.24
gateway (default 10.222.111.1): .
dns (default .): 
vlan id (optional): 
 http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-s390x.iso (default) 
url: ftp://10.11.12.2:21/ubuntu-live-server-20.04.5/ubuntu-20.04.5-live-server-s390x.iso
http_proxy (optional):  
```

Ensure that the same version of the ISO image that was used to extract the  installer files – kernel and initrd – is referenced at the ‘url:’  setting. It can be at a different location, for example directly  referencing the public `cdimage.ubuntu.com` server: http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-s390x.iso
确保在“url：”设置中引用了用于提取安装程序文件的相同版本的 ISO 映像（kernel 和 initrd）。它可以位于不同的位置，例如直接引用公共 `cdimage.ubuntu.com` 服务器：http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-s390x.iso

The boot-up of the live-server installation now completes:
实时服务器安装的启动现在完成：

```plaintext
Configuring networking... 
QETH device 0.0.0600:0.0.0601:0.0.0602 already configured 
IP-Config: enc600 hardware address 02:28:0a:00:00:39 mtu 1500 
IP-Config: enc600 guessed broadcast address 10.222.111255 
IP-Config: enc600 complete: 
 address: 10.222.111.24    broadcast: 10.222.111255   netmask: 255.255.255.0   
 
 gateway: 10.222.111.1     dns0     : 10.222.111.1     dns1   : 0.0.0.0         
 
 rootserver: 0.0.0.0 rootpath:  
 filename  :  
Connecting to 10.11.12.2:21 (10.11.12.2:21) 
focal-live-server-s   5% !*                               ! 35.9M  0:00:17 ETA 
focal-live-server-s  19% !******                          !  129M  0:00:08 ETA 
focal-live-server-s  33% !**********                      !  225M  0:00:05 ETA 
focal-live-server-s  49% !***************                 !  330M  0:00:04 ETA 
focal-live-server-s  60% !*******************             !  403M  0:00:03 ETA 
focal-live-server-s  76% !************************        !  506M  0:00:01 ETA 
focal-live-server-s  89% !****************************    !  594M  0:00:00 ETA 
focal-live-server-s 100% !********************************!  663M  0:00:00 ETA 
passwd: password expiry information changed. 
QETH device 0.0.0600:0.0.0601:0.0.0602 already configured 
no search or nameservers found in /run/net-enc600.conf /run/net-*.conf /run/net6
-*.conf 
¬  594.766372| /dev/loop3: Can't open blockdev 
¬  595.610434| systemd¬1|: multi-user.target: Job getty.target/start deleted to 
break ordering cycle starting with multi-user.target/start 
¬ ¬0;1;31m SKIP  ¬0m| Ordering cycle found, skipping  ¬0;1;39mLogin Prompts ¬0m 
¬  595.623027| systemd¬1|: Failed unmounting /cdrom. 
¬ ¬0;1;31mFAILED ¬0m| Failed unmounting  ¬0;1;39m/cdrom ¬0m. 
 
¬  598.973538| cloud-init¬1256|: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 runnin
g 'init-local' at Thu, 04 Jun 2020 12:06:46 +0000. Up 598.72 seconds. 
¬  599.829069| cloud-init¬1288|: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 runnin
g 'init' at Thu, 04 Jun 2020 12:06:47 +0000. Up 599.64 seconds. 
¬  599.829182| cloud-init¬1288|: ci-info: ++++++++++++++++++++++++++++++++++++Ne
t device info+++++++++++++++++++++++++++++++++++++ 
¬  599.829218| cloud-init¬1288|: ci-info: +--------+------+---------------------
----+---------------+--------+-------------------+ 
¬  599.829255| cloud-init¬1288|: ci-info: ! Device !  Up  !         Address     
    !      Mask     ! Scope  !     Hw-Address    ! 
¬  599.829292| cloud-init¬1288|: ci-info: +--------+------+---------------------
----+---------------+--------+-------------------+ 
¬  599.829333| cloud-init¬1288|: ci-info: ! enc600 ! True !      10.222.111.24  
    ! 255.255.255.0 ! global ! 02:28:0a:00:00:39 ! 
¬  599.829376| cloud-init¬1288|: ci-info: ! enc600 ! True ! fe80::28:aff:fe00:3
/64 !       .       !  link  ! 02:28:0a:00:00:39 ! 
¬  599.829416| cloud-init¬1288|: ci-info: !   lo   ! True !        127.0.0.1    
    !   255.0.0.0   !  host  !         .         ! 
¬  599.829606| cloud-init¬1288|: ci-info: !   lo   ! True !         ::1/128     
    !       .       !  host  !         .         ! 
¬  599.829684| cloud-init¬1288|: ci-info: +--------+------+---------------------
----+---------------+--------+-------------------+ 
¬  599.829721| cloud-init¬1288|: ci-info: ++++++++++++++++++++++++++++++Route IP
v4 info++++++++++++++++++++++++++++++ 
¬  599.829754| cloud-init¬1288|: ci-info: +-------+--------------+--------------
+---------------+-----------+-------+ 
¬  599.829789| cloud-init¬1288|: ci-info: ! Route ! Destination  !   Gateway    
!    Genmask    ! Interface ! Flags ! 
¬  599.829822| cloud-init¬1288|: ci-info: +-------+--------------+--------------
+---------------+-----------+-------+ 
¬  599.829858| cloud-init¬1288|: ci-info: !   0   !   0.0.0.0    ! 10.222.111.1 
!    0.0.0.0    !   enc600  !   UG  ! 
¬  599.829896| cloud-init¬1288|: ci-info: !   1   ! 10.222.1110 !   0.0.0.0    
! 255.255.255.0 !   enc600  !   U   ! 
¬  599.829930| cloud-init¬1288|: ci-info: +-------+--------------+--------------
+---------------+-----------+-------+ 
¬  599.829962| cloud-init¬1288|: ci-info: +++++++++++++++++++Route IPv6 info++++
+++++++++++++++ 
¬  599.829998| cloud-init¬1288|: ci-info: +-------+-------------+---------+-----
------+-------+ 
¬  599.830031| cloud-init¬1288|: ci-info: ! Route ! Destination ! Gateway ! Inte
rface ! Flags ! 
¬  599.830064| cloud-init¬1288|: ci-info: +-------+-------------+---------+-----
------+-------+ 
¬  599.830096| cloud-init¬1288|: ci-info: !   1   !  fe80::/64  !    ::   !   en
c600  !   U   ! 
¬  599.830131| cloud-init¬1288|: ci-info: !   3   !    local    !    ::   !   en
c600  !   U   ! 
¬  599.830164| cloud-init¬1288|: ci-info: !   4   !   ff00::/8  !    ::   !   en
c600  !   U   ! 
¬  599.830212| cloud-init¬1288|: ci-info: +-------+-------------+---------+-----
------+-------+ 
¬  601.077953| cloud-init¬1288|: Generating public/private rsa key pair. 
¬  601.078101| cloud-init¬1288|: Your identification has been saved in /etc/ssh/
ssh_host_rsa_key 
¬  601.078136| cloud-init¬1288|: Your public key has been saved in /etc/ssh/ssh
host_rsa_key.pub 
¬  601.078170| cloud-init¬1288|: The key fingerprint is: 
¬  601.078203| cloud-init¬1288|: SHA256:kHtkABZwk8AE80fy0KPzTRcYpht4iXdZmJ37Cgi3
fJ0 root§ubuntu-server 
¬  601.078236| cloud-init¬1288|: The key's randomart image is: 
¬  601.078274| cloud-init¬1288|: +---¬RSA 3072|----+ 
¬  601.078307| cloud-init¬1288|: !o+*+B++*..       ! 
¬  601.078340| cloud-init¬1288|: ! o.X+=+=+        ! 
¬  601.078373| cloud-init¬1288|: !  +.O.= oo       ! 
¬  601.078406| cloud-init¬1288|: !  ++.+.=o        ! 
¬  601.078439| cloud-init¬1288|: !   *.=.oSo       ! 
¬  601.078471| cloud-init¬1288|: !    = +.E .      ! 
¬  601.078503| cloud-init¬1288|: !     . . .       ! 
¬  601.078537| cloud-init¬1288|: !        .        ! 
¬  601.078570| cloud-init¬1288|: !                 ! 
¬  601.078602| cloud-init¬1288|: +----¬SHA256|-----+ 
¬  601.078635| cloud-init¬1288|: Generating public/private dsa key pair. 
¬  601.078671| cloud-init¬1288|: Your identification has been saved in /etc/ssh/
ssh_host_dsa_key 
¬  601.078704| cloud-init¬1288|: Your public key has been saved in /etc/ssh/ssh_
host_dsa_key.pub 
¬  601.078736| cloud-init¬1288|: The key fingerprint is: 
¬  601.078767| cloud-init¬1288|: SHA256:ZBNyksVVYZVhKJeL+PWKpsdUcn21yiceX/DboXQd
Pq0 root§ubuntu-server 
¬  601.078800| cloud-init¬1288|: The key's randomart image is: 
¬  601.078835| cloud-init¬1288|: +---¬DSA 1024|----+ 
¬  601.078867| cloud-init¬1288|: !      o++...+=+o ! 
¬  601.078899| cloud-init¬1288|: !      .+....+.. .! 
¬  601.078932| cloud-init¬1288|: !        +. + o  o! 
¬  601.078964| cloud-init¬1288|: !       o..o = oo.! 
¬  601.078996| cloud-init¬1288|: !        S. =..o++! 
¬  601.079029| cloud-init¬1288|: !          o  *.*=! 
¬  601.079061| cloud-init¬1288|: !         o .o.B.*! 
¬  601.079094| cloud-init¬1288|: !          = .oEo.! 
¬  601.079135| cloud-init¬1288|: !        .+       ! 
¬  601.079167| cloud-init¬1288|: +----¬SHA256|-----+ 
¬  601.079199| cloud-init¬1288|: Generating public/private ecdsa key pair. 
¬  601.079231| cloud-init¬1288|: Your identification has been saved in /etc/ssh/
ssh_host_ecdsa_key 
¬  601.079263| cloud-init¬1288|: Your public key has been saved in /etc/ssh/ssh_
host_ecdsa_key.pub 
¬  601.079295| cloud-init¬1288|: The key fingerprint is: 
¬  601.079327| cloud-init¬1288|: SHA256:Bitar9fVHUH2FnYVSJJnldprdAcM5Est0dmRWFTU
i8k root§ubuntu-server 
¬  601.079362| cloud-init¬1288|: The key's randomart image is: 
¬  601.079394| cloud-init¬1288|: +---¬ECDSA 256|---+ 
¬  601.079426| cloud-init¬1288|: !           o**O%&! 
¬  601.079458| cloud-init¬1288|: !           o.OB+=! 
¬  601.079491| cloud-init¬1288|: !      .     B *o+! 
¬  601.079525| cloud-init¬1288|: !       o   . E.=o! 
¬  601.079557| cloud-init¬1288|: !    o . S  .....+! 
¬  601.079589| cloud-init¬1288|: !   o o .  . . .o ! 
¬  601.079621| cloud-init¬1288|: !  .   .. .    .  ! 
¬  601.079653| cloud-init¬1288|: !     .. .        ! 
¬  601.079685| cloud-init¬1288|: !    ..           ! 
¬  601.079717| cloud-init¬1288|: +----¬SHA256|-----+ 
¬  601.079748| cloud-init¬1288|: Generating public/private ed25519 key pair. 
¬  601.079782| cloud-init¬1288|: Your identification has been saved in /etc/ssh/
ssh_host_ed25519_key 
¬  601.079814| cloud-init¬1288|: Your public key has been saved in /etc/ssh/ssh_
host_ed25519_key.pub 
¬  601.079847| cloud-init¬1288|: The key fingerprint is: 
¬  601.079879| cloud-init¬1288|: SHA256:yWsZ/5+7u7D3SIcd7HYnyajXyeWnt5nQ+ZI3So3b
eN8 root§ubuntu-server 
¬  601.079911| cloud-init¬1288|: The key's randomart image is: 
¬  601.079942| cloud-init¬1288|: +--¬ED25519 256|--+ 
¬  601.079974| cloud-init¬1288|: !                 ! 
¬  601.080010| cloud-init¬1288|: !                 ! 
¬  601.080042| cloud-init¬1288|: !                 ! 
¬  601.080076| cloud-init¬1288|: !       . .    .  ! 
¬  601.080107| cloud-init¬1288|: !        S      o ! 
¬  601.080139| cloud-init¬1288|: !         =   o=++! 
¬  601.080179| cloud-init¬1288|: !        + . o**§=! 
¬  601.080210| cloud-init¬1288|: !       .   oo+&B%! 
¬  601.080244| cloud-init¬1288|: !          ..o*%/E! 
¬  601.080289| cloud-init¬1288|: +----¬SHA256|-----+ 
¬  612.293731| cloud-init¬2027|: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 runnin
g 'modules:config' at Thu, 04 Jun 2020 12:06:59 +0000. Up 612.11 seconds. 
¬  612.293866| cloud-init¬2027|: Set the following 'random' passwords 
¬  612.293940| cloud-init¬2027|: installer:wgYsAPzYQbFYqU2X2hYm 
ci-info: no authorized SSH keys fingerprints found for user installer. 
<14>Jun  4 12:07:00 ec2:  
<14>Jun  4 12:07:00 ec2: #######################################################
###### 
<14>Jun  4 12:07:00 ec2: -----BEGIN SSH HOST KEY FINGERPRINTS----- 
<14>Jun  4 12:07:00 ec2: 1024 SHA256:ZBNyksVVYZVhKJeL+PWKpsdUcn21yiceX/DboXQdPq0
 root§ubuntu-server (DSA) 
<14>Jun  4 12:07:00 ec2: 256 SHA256:Bitar9fVHUH2FnYVSJJnldprdAcM5Est0dmRWFTUi8k 
root§ubuntu-server (ECDSA) 
<14>Jun  4 12:07:00 ec2: 256 SHA256:yWsZ/5+7u7D3SIcd7HYnyajXyeWnt5nQ+ZI3So3beN8 
root§ubuntu-server (ED25519) 
<14>Jun  4 12:07:00 ec2: 3072 SHA256:kHtkABZwk8AE80fy0KPzTRcYpht4iXdZmJ37Cgi3fJ0
 root§ubuntu-server (RSA) 
<14>Jun  4 12:07:00 ec2: -----END SSH HOST KEY FINGERPRINTS----- 
<14>Jun  4 12:07:00 ec2: #######################################################
###### 
-----BEGIN SSH HOST KEY KEYS----- 
ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIXM6t1/
35ot/aPI59ThIJBzg+qGJJ17+1ZVHfzMEDbsTwpM7e9pstPZUM7W1IHWqDvLQDBm/hGg4u8ZGEqmIMI=
 root§ubuntu-server 
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIN7QtU+en+RGruj2zuxWgkMqLmh+35/GR/OEOD16k4nA
 root§ubuntu-server 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDJdKT7iUAvSjkUqI1l3fHysE+Gj7ulwGgGjYh639px
kcHEbbS3V48eROY9BmDISEHfjYXGY2wEH0tGJjNRROGJhZJVNR+qAqJBioj9d/TwXEgwLP8eAy9aVtJB
K1rIylnMQltx/SIhgiymjHLCtKlVoIS4l0frT9FiF54Qi/JeJlwGJIW3W2XgcY9ODT0Q5g3PSmlZ8KTR
imTf9Fy7WJEPA08b3fimYWsz9enuS/gECEUGV3M1MvrzpAQju27NUEOpSMZHR62IMxGvIjYIu3dUkAzm
MBdwxHdLMQ8rI8PehyHDiFr6g2Ifxoy5QLmb3hISKlq/R6pLLeXbb748gN2i8WCvK0AEGfa/kJDW3RNU
VYd+ACBBzyhVbiw7W1CQW/ohik3wyosUyi9nJq2IqOA7kkGH+1XoYq/e4/MoqxhIK/oaiudYAkaCWmP1
r/fBa3hlf0f7mVHvxA3tWZc2wYUxFPTmePvpydP2PSctHMhgboaHrGIY2CdSqg8SUdPKrOE= root§ub
untu-server 
-----END SSH HOST KEY KEYS----- 
¬  612.877357| cloud-init¬2045|: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 runnin
g 'modules:final' at Thu, 04 Jun 2020 12:07:00 +0000. Up 612.79 seconds. 
¬  612.877426| cloud-init¬2045|: ci-info: no authorized SSH keys fingerprints fo
und for user installer. 
¬  612.877468| cloud-init¬2045|: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 finish
ed at Thu, 04 Jun 2020 12:07:00 +0000. Datasource DataSourceNoCloud ¬seed=/var/l
ib/cloud/seed/nocloud|¬dsmode=net|.  Up 612.87 seconds 
¬  612.877509| cloud-init¬2045|: Welcome to Ubuntu Server InstallerÜ 
¬  612.877551| cloud-init¬2045|: Above you will find SSH host keys and a random 
password set for the `installer` user. You can use these credentials to ssh-in a
nd complete the installation. If you provided SSH keys in the cloud-init datasou
rce, they were also provisioned to the installer user. 
¬  612.877634| cloud-init¬2045|: If you have access to the graphical console, li
ke TTY1 or HMC ASCII terminal you can complete the installation there too. 
 
It is possible to connect to the installer over the network, which 
might allow the use of a more capable terminal.  
 
To connect, SSH to installer§10.222.111.24. 
 
The password you should use is "KRuXtz5dURAyPkcjcUvA". 
 
The host key fingerprints are: 
 
    RSA     SHA256:3IvYMkU05lQSKBxOVZUJMzdtXpz3RJl3dEQsg3UWc54 
    ECDSA   SHA256:xd1xnkBpn49DUbuP8uWro2mu1GM4MtnqR2WEWg1fS3o 
    ED25519 SHA256:Hk3+/4+X7NJBHl6/e/6xFhNXsbHBsOvt6i8YEFUepko 
  
Ubuntu Focal Fossa (development branch) ubuntu-server ttyS0
```

The next step is to remotely connect to the install system and to proceed with the Subiquity installer.
下一步是远程连接到安装系统并继续执行 Subiquity 安装程序。

Notice that at the end of the installer boot-up process, all necessary data is provided to proceed with running the installer in a remote SSH shell.  The command to execute locally is:
请注意，在安装程序启动过程结束时，将提供所有必要的数据，以便在远程 SSH shell 中继续运行安装程序。要在本地执行的命令是：

```bash
user@workstation:~$ ssh installer@10.222.111.24
```

A temporary random password for the installation was created and shared  as well, which should be used without the leading and trailing double  quotes:
还创建并共享了安装的临时随机密码，该密码应不带前导引号和尾随双引号：

```plaintext
  "KRuXtz5dURAyPkcjcUvA"
user@workstation:~$ ssh installer@10.222.111.24
The authenticity of host '10.222.111.24 (10.222.111.24)' can't be established.
ECDSA key fingerprint is 
SHA256:xd1xnkBpn49DUbuP8uWro2mu1GM4MtnqR2WEWg1fS3o.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.222.111.24' (ECDSA) to the list of known hosts.
installer@10.222.111.24's password: KRuXtz5dURAyPkcjcUvA
```

You may now temporarily see some login messages like these:
您现在可能会暂时看到一些登录消息，如下所示：

```auto
Welcome to Ubuntu Focal Fossa (development branch) (GNU/Linux 5.4.0-42-generic s390x)
  
  * Documentation:  https://help.ubuntu.com
  * Management:     https://landscape.canonical.com
  * Support:        https://ubuntu.com/pro
  
  System information as of Wed Jun  3 17:32:10 UTC 2020
  
  System load:    0.0       Memory usage: 2%   Processes:       146
  Usage of /home: unknown   Swap usage:   0%   Users logged in: 0
  
0 updates can be installed immediately.
0 of these updates are security updates.
  
The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.
  
Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law.
```

Eventually, the initial Subiquity installer screen appears:
最终，将出现初始 Subiquity 安装程序屏幕：

```plaintext
====================================================================
  Willkommen! Bienvenue! Welcome! ????? ??????????! Welkom!       
====================================================================
  Use UP, DOWN and ENTER keys to select your language.                        
                                                                              
                [ English                                    > ]              
                [ Asturianu                                  > ]              
                [ Cataln                                     > ]              
                [ Hrvatski                                   > ]              
                [ Nederlands                                 > ]              
                [ Suomi                                      > ]              
                [ Francais                                   > ]              
                [ Deutsch                                    > ]              
                [ Magyar                                     > ]              
                [ Latvie?u                                   > ]              
                [ Norsk bokm?l                               > ]              
                [ Polski                                     > ]              
                [ Espanol                                    > ]              
```

From this point, you can follow the normal Subiquity installation. For more details, refer to the [Subquity installer documentation](https://canonical-subiquity.readthedocs-hosted.com/en/latest/index.html).
从这一点开始，您可以遵循正常的 Subiquity 安装。有关更多详细信息，请参阅 Subquity 安装程序文档。

```plaintext
 ====================================================================
  Keyboard configuration                                           ====================================================================
  Please select your keyboard layout below, or select "Identify keyboard" to  
  detect your layout automatically.                                           
                                                                              
                 Layout:  [ English (US)                     v ]              
                                                                              
                                                                              
                Variant:  [ English (US)                     v ]              
                                                                              
                                                                              
                             [ Identify keyboard ]                            
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
 ====================================================================
  Zdev setup                                                      
====================================================================
  ID                          ONLINE  NAMES                                  ^
                                                                             │
  generic-ccw                                                                │
  0.0.0009                                    >                              │
  0.0.000c                                    >                              │
  0.0.000d                                    >                              │
  0.0.000e                                    >                              │
                                                                             │
  dasd-eckd                                                                  │
  0.0.0190                                    >                              │
  0.0.0191                                    >                              │
  0.0.019d                                    >                              │
  0.0.019e                                    >                               
  0.0.0200                                    >                               
  0.0.0300                                    >                               
  0.0.0400                                    >                               
  0.0.0592                                    >                              v
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
```

- If the list is long, hit the End key that will automatically scroll you down to the bottom of the Z devices list and screen.
  如果列表很长，请点击该 End 键，该键会自动将您向下滚动到 Z 设备列表和屏幕的底部。

```plaintext
====================================================================
  Zdev setup                                                      
====================================================================
  ID                          ONLINE  NAMES                                  ^
                                                                             │
  generic-ccw                                                                │
  0.0.0009                                    >                              │
  0.0.000c                                    >                              │
  0.0.000d                                    >                              │
  0.0.000e                                    >                              │
                                                                             │
  dasd-eckd                                                                  │
  0.0.0190                                    >                              │
  0.0.0191                                    >                              │
  0.0.019d                                    >                              │
  0.0.019e                                    >┌────────────┐                 
  0.0.0200                                    >│< (close)   │                 
  0.0.0300                                    >│  Enable    │                 
  0.0.0400                                    >│  Disable   │                 
  0.0.0592                                    >└────────────┘                v
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
====================================================================
  Zdev setup                                                      
====================================================================
  ID                          ONLINE  NAMES                                  ^
                                                                             │
  generic-ccw                                                                │
  0.0.0009                                    >                              │
  0.0.000c                                    >                              │
  0.0.000d                                    >                              │
  0.0.000e                                    >                              │
                                                                             │
  dasd-eckd                                                                  │
  0.0.0190                                    >                              │
  0.0.0191                                    >                              │
  0.0.019d                                    >                              │
  0.0.019e                                    >                               
  0.0.0200                    online  dasda   >                               
  0.0.0300                                    >                               
  0.0.0400                                    >                               
  0.0.0592                                    >                              v
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
====================================================================
  Zdev setup                                                      
====================================================================
                                                                             ^
  dasd-eckd                                                                   
  0.0.0190                                    >                               
  0.0.0191                                    >                               
  0.0.019d                                    >                               
  0.0.019e                                    >                              │
  0.0.0200                    online  dasda   >                              │
  0.0.0300                                    >                              │
  0.0.0400                                    >                              │
  0.0.0592                                    >                              │
                                                                             │
  qeth                                                                       │
  0.0.0600:0.0.0601:0.0.0602          enc600  >                              │
  0.0.0603:0.0.0604:0.0.0605                  >                              │
                                                                             │
  dasd-eckd                                                                  │
  0.0.1607                                    >                              v
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
====================================================================
  Network connections                                             
====================================================================
  Configure at least one interface this server can use to talk to other       
  machines, and which preferably provides sufficient access for updates.      
                                                                              
    NAME    TYPE  NOTES                                                       
  [ enc600  eth   -                > ]                                        
    static  10.222.111.24/24                                                  
    02:28:0a:00:00:39 / Unknown Vendor / Unknown Model                        
                                                                              
  [ Create bond > ]                                                           
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Configure proxy                                                 
====================================================================
  If this system requires a proxy to connect to the internet, enter its       
  details here.                                                               
                                                                              
  Proxy address:                                                              
                  If you need to use a HTTP proxy to access the outside world,
                  enter the proxy information here. Otherwise, leave this     
                  blank.                                                      
                                                                              
                  The proxy information should be given in the standard form  
                  of "http://[[user][:pass]@]host[:port]/".                   
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Configure Ubuntu archive mirror                                 
====================================================================
  If you use an alternative mirror for Ubuntu, enter its details here.        
                                                                              
  Mirror address:  http://ports.ubuntu.com/ubuntu-ports                       
                   You may provide an archive mirror that will be used instead
                   of the default.                                            
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Guided storage configuration                                    
====================================================================
  Configure a guided storage layout, or create a custom one:                  
                                                                              
  (X)  Use an entire disk                                                     
                                                                              
       [ 0X0200       local disk 6.876G                                    v ]
                                                                              
       [ ]  Set up this disk as an LVM group                                  
                                                                              
            [ ]  Encrypt the LVM group with LUKS                              
                                                                              
                         Passphrase:                                          
                                                                              
                                                                              
                 Confirm passphrase:                                          
                                                                              
                                                                              
  ( )  Custom storage layout                                                  
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Storage configuration                                           
====================================================================
  FILE SYSTEM SUMMARY                                                        ^
                                                                             │
    MOUNT POINT     SIZE    TYPE      DEVICE TYPE                            │
  [ /               6.875G  new ext4  new partition of local disk > ]        │
                                                                             │
                                                                             │
  AVAILABLE DEVICES                                                          │
                                                                             │
    No available devices                                                     │
                                                                             │
  [ Create software RAID (md) > ]                                            │
  [ Create volume group (LVM) > ]                                            │
                                                                              
                                                                              
  USED DEVICES                                                                
                                                                             v
                                                                              
                                 [ Done       ]                               
                                 [ Reset      ]                               
                                 [ Back       ]                               
====================================================================
  Storage configuration                                           
====================================================================
  FILE SYSTEM SUMMARY                                                        ^
                                                                             │

   ┌────────────────────── Confirm destructive action ──────────────────────┐
   │                                                                        │
   │  Selecting Continue below will begin the installation process and      │
   │  result in the loss of data on the disks selected to be formatted.     │
   │                                                                        │
   │  You will not be able to return to this or a previous screen once the  │
   │  installation has started.                                             │
   │                                                                        │
   │  Are you sure you want to continue?                                    │
   │                                                                        │
   │                             [ No         ]                             │
   │                             [ Continue   ]                             │
   │                                                                        │
   └────────────────────────────────────────────────────────────────────────┘

                                 [ Reset      ]                               
                                 [ Back       ]                               
====================================================================
  Profile setup                                                   
====================================================================
  Enter the username and password you will use to log in to the system. You   
  can configure SSH access on the next screen but a password is still needed  
  for sudo.                                                                   
                                                                              
              Your name:  Ed Example                                          
                                                                              
                                                                              
     Your server's name:  10.222.111.24                                             
                          The name it uses when it talks to other computers.  
                                                                              
        Pick a username:  ubuntu                                              
                                                                              
                                                                              
      Choose a password:  ********                                            
                                                                              
                                                                              
  Confirm your password:  ********                                            
                                                                              
                                                                              
                                 [ Done       ]                               
====================================================================
  SSH Setup                                                       
====================================================================
  You can choose to install the OpenSSH server package to enable secure remote
  access to your server.                                                      
                                                                              
                   [ ]  Install OpenSSH server                                
                                                                              
                                                                              
  Import SSH identity:  [ No             v ]                                  
                        You can import your SSH keys from Github or Launchpad.
                                                                              
      Import Username:                                                        
                                                                              
                                                                              
                   [X]  Allow password authentication over SSH                
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
```

- It’s a nice and convenient new feature to add the user’s SSH keys during the installation to the system, since that makes the system login  password-less on the initial login!
  在安装到系统期间将用户的 SSH 密钥添加到系统是一个很好且方便的新功能，因为这会使系统登录在初始登录时无密码！

```plaintext
====================================================================
  SSH Setup                                                       
====================================================================
  You can choose to install the OpenSSH server package to enable secure remote
  access to your server.                                                      
                                                                              
                   [X]  Install OpenSSH server                                
                                                                              
                                                                              
  Import SSH identity:  [ from Launchpad v ]                                  
                        You can import your SSH keys from Github or Launchpad.
                                                                              
   Launchpad Username:  user                                               
                        Enter your Launchpad username.                        
                                                                              
                   [X]  Allow password authentication over SSH                
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  SSH Setup                                                       
====================================================================
  You can choose to install the OpenSSH server package to enable secure remote
  access to your server.                                                      

   ┌─────────────────────────── Confirm SSH keys ───────────────────────────┐
   │                                                                        │
   │  Keys with the following fingerprints were fetched. Do you want to     │
   │  use them?                                                             │
   │                                                                        │
   │  2048 SHA256:joGsdfW7NbJRkg17sRyXaegoR0iZEdDWdR9Hpbc2KIw user@W520  │
   │   (RSA)                                                                │
   │  521 SHA256:T3JzxvB6K1GzXJpP5NFgX4yXvk0jhhgvbw01F7/fZ2c                │
   │  frank.heimes@canonical.com  (ECDSA)                                   │
   │                                                                        │
   │                             [ Yes        ]                             │
   │                             [ No         ]                             │
   │                                                                        │
   └────────────────────────────────────────────────────────────────────────┘

                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Featured Server Snaps                                           
====================================================================
  These are popular snaps in server environments. Select or deselect with     
  SPACE, press ENTER to see more details of the package, publisher and        
  versions available.                                                         
                                                                              
  [ ] kata-containers Lightweight virtual machines that seamlessly plug into >
  [ ] docker          Docker container runtime                               >
  [ ] mosquitto       Eclipse Mosquitto MQTT broker                          >
  [ ] etcd            Resilient key-value store by CoreOS                    >
  [ ] stress-ng       A tool to load, stress test and benchmark a computer s >
  [ ] sabnzbd         SABnzbd                                                >
  [ ] wormhole        get things from one computer to another, safely        >
  [ ] slcli           Python based SoftLayer API Tool.                       >
  [ ] doctl           DigitalOcean command line tool                         >
  [ ] keepalived      High availability VRRP/BFD and load-balancing for Linu >
  [ ] juju            Simple, secure and stable devops. Juju keeps complexit >
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Install complete!                                               
====================================================================
  ┌──────────────────────────────────────────────────────────────────────────┐
  │          configuring raid (mdadm) service                               ^│
  │          installing kernel                                               │
  │          setting up swap                                                 │
  │          apply networking config                                         │
  │          writing etc/fstab                                               │
  │          configuring multipath                                           │
  │          updating packages on target system                              │
  │          configuring pollinate user-agent on target                      │
  │          updating initramfs configuration                                │
  │    finalizing installation                                               │
  │      running 'curtin hook'                                               │
  │        curtin command hook                                               │
  │    executing late commands                                               │
  │final system configuration                                                │
  │  configuring cloud-init                                                 ││
  │  installing openssh-server |                                            v│
  └──────────────────────────────────────────────────────────────────────────┘

                               [ View full log ]
====================================================================
  Installation complete!                                          
====================================================================
  ┌──────────────────────────── Finished install! ───────────────────────────┐
  │          apply networking config                                        ^│
  │          writing etc/fstab                                               │
  │          configuring multipath                                           │
  │          updating packages on target system                              │
  │          configuring pollinate user-agent on target                      │
  │          updating initramfs configuration                                │
  │    finalizing installation                                               │
  │      running 'curtin hook'                                               │
  │        curtin command hook                                               │
  │    executing late commands                                               │
  │final system configuration                                                │
  │  configuring cloud-init                                                  │
  │  installing openssh-server                                               │
  │  restoring apt configuration                                            ││
  │downloading and installing security updates                              v│
  └──────────────────────────────────────────────────────────────────────────┘

                               [ View full log ]
                               [ Reboot        ]
  Installation complete!                                          
====================================================================
  ┌──────────────────────────── Finished install! ───────────────────────────┐
  │          apply networking config                                        ^│
  │          writing etc/fstab                                               │
  │          configuring multipath                                           │
  │          updating packages on target system                              │
  │          configuring pollinate user-agent on target                      │
  │          updating initramfs configuration                                │
  │    finalizing installation                                               │
  │      running 'curtin hook'                                               │
  │        curtin command hook                                               │
  │    executing late commands                                               │
  │final system configuration                                                │
  │  configuring cloud-init                                                  │
  │  installing openssh-server                                               │
  │  restoring apt configuration                                            ││
  │downloading and installing security updates                              v│
  └──────────────────────────────────────────────────────────────────────────┘

                               [ Connection to 10.222.111.24 closed by remote host.                            [ Rebooting...  ]
Connection to 10.222.111.24 closed.
user@workstation:~$ 
```

Type `reset` to clear the screen and to revert it back to the defaults.
键入 `reset` 以清除屏幕并将其恢复为默认值。

Now remove the old host key, since the system got a new one during the installation:
现在删除旧的主机密钥，因为系统在安装过程中获得了一个新密钥：

```bash
user@workstation:~$ ssh-keygen -f "/home/user/.ssh/known_hosts" -R "10.222.111.24"
# Host 10.222.111.24 found: line 159
/home/user/.ssh/known_hosts updated.
Original contents retained as /home/user/.ssh/known_hosts.old
user@workstation:~$
```

And finally login to the newly installed z/VM guest:
最后登录到新安装的 z/VM 客户机：

```bash
user@workstation:~$ ssh ubuntu@10.222.111.24
Warning: Permanently added the ECDSA host key for IP address
'10.222.111.24' to the list of known hosts.
Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-42-generic s390x)
  
  * Documentation:  https://help.ubuntu.com
  * Management:     https://landscape.canonical.com
  * Support:        https://ubuntu.com/pro

  System information as of Wed 03 Jun 2020 05:50:05 PM UTC
  
  System load: 0.08              Memory usage: 2%   Processes:       157
  Usage of /:  18.7% of 6.70GB   Swap usage:   0%   Users logged in: 0
  
0 updates can be installed immediately.
0 of these updates are security updates.
  
The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright.
  
Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law.
  
To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.
  
ubuntu@10.222.111.24:~$ uptime
 17:50:09 up 1 min,  1 user,  load average: 0.08, 0.11, 0.05
ubuntu@10.222.111.24:~$ lsb_release -a
No LSB modules are available.
Distributor ID:	Ubuntu
Description: Ubuntu 20.04.5 LTS
Release:	20.04
Codename:	focal
ubuntu@10.222.111.24:~$ uname -a
Linux 10.222.111.24 5.4.0-42-generic #30-Ubuntu SMP Wed Aug 05 16:57:22 UTC 2020 s390x s390x s390x GNU/Linux
ubuntu@10.222.111.24:~$ exit
logout
Connection to 10.222.111.24 closed.
user@workstation:~$
```

Done! 做！

------

# Non-interactive IBM z/VM (s390x) autoinstallation 非交互式 IBM z/VM （s390x） 自安装

This non-interactive installation uses ‘autoinstall’, which can be  considered the successor to the Debian installer (d-i) and preseed on  Ubuntu. This is a detailed step-by-step guide, including output and logs (which are partially a bit shortened, as indicated by ‘…’, to limit the size of this document).
这个非交互式安装使用“自动安装”，它可以被认为是 Debian 安装程序 （d-i） 的继任者，并在 Ubuntu 上预置。这是一个详细的分步指南，包括输出和日志（部分缩短，如“...”所示，以限制本文档的大小）。

The example z/VM guest here uses a direct-access storage device (DASD) and is connected to a regular (non-VLAN) network.
此处的示例 z/VM 客户机使用直接访问存储设备 （DASD），并连接到常规（非 VLAN）网络。

For a zFCP and a VLAN network example, please see the [non-interactive IBM LPAR (s390x) installation using autoinstall](https://ubuntu.com/server/docs/non-interactive-ibm-z-lpar-autoinstall-s390x) guide.
有关 zFCP 和 VLAN 网络示例，请参阅使用自动安装进行非交互式 IBM LPAR （s390x） 安装指南。

- Start with the preparation of the (FTP) install server (if it doesn’t already exist).
  从准备 （FTP） 安装服务器（如果尚不存在）开始。

  ```bash
  user@local:~$ ssh admin@installserver.local
  admin@installserver:~$ mkdir -p /srv/ftp/ubuntu-daily-live-server-20.04
  admin@installserver:~$ wget http://cdimage.ubuntu.com/ubuntu-server/focal/daily-live/current/focal-live-server-s390x.iso --directory-prefix=/srv/ftp/ubuntu-daily-live-server-20.04
  --2020-06-26 12:18:48--  http://cdimage.ubuntu.com/ubuntu-server/focal/daily-live/current/focal-live-server-s390x.iso
  Resolving cdimage.ubuntu.com (cdimage.ubuntu.com)... 2001:67c:1560:8001::1d, 2001:67c:1360:8001::28, 2001:67c:1360:8001::27, 
   ...
  Connecting to cdimage.ubuntu.com (cdimage.ubuntu.com)|2001:67c:1560:8001::1d|:80... connected.
  HTTP request sent, awaiting response... 200 OK
  Length: 700952576 (668M) [application/x-iso9660-image]
  Saving to: ‘focal-live-server-s390x.iso’
  
  focal-live-server-s 100%[===================>] 668.48M  2.73MB/s    in 4m 54s  
  
  2020-06-26 12:23:42 (2.27 MB/s) - ‘focal-live-server-s390x.iso’ saved [700952576/700952576]
  admin@installserver:~$
  ```

- The ISO image needs to be extracted now. Since files in the boot folder  need to be modified, loopback mount is not an option here:
  现在需要提取 ISO 映像。由于需要修改引导文件夹中的文件，因此此处不选择环回挂载：

  ```bash
  admin@installserver:~$ cd /srv/ftp/ubuntu-daily-live-server-20.04
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ mkdir iso
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ sudo mount -o loop ./focal-live-server-s390x.iso ./iso
  [sudo] password for admin: 
  mount: /home/user/iso-test/iso: WARNING: device write-protected, mounted read-only.
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ ls -l
  total 684530
  -rw-rw-r--  1 user user 700952576 Jun 26 10:12 focal-live-server-s390x.iso
  dr-xr-xr-x 10 root    root         2048 Jun 26 10:12 iso
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$
  ```

- Now make sure an FTP server is running in the *installserver* with `/srv/ftp` as ftp-server root (as used in this example).
  现在，确保FTP服务器在安装服务器 `/srv/ftp` 中以ftp-server root身份运行（如本例中使用）。

- Next, prepare an *autoinstall* (HTTP) server. This hosts the configuration data for the non-interactive installation.
  接下来，准备自动安装 （HTTP） 服务器。这将托管非交互式安装的配置数据。

  ```bash
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ mkdir -p /srv/www/autoinstall/zvmguest
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ cd /srv/www/autoinstall/zvmguest
  admin@installserver:/srv/www/autoinstall/zvmguest$ 
  admin@installserver:/srv/www/autoinstall/zvmguest$ echo "instance-id: $(uuidgen || openssl rand -base64 8)" > meta-data
  admin@installserver:/srv/www/autoinstall/zvmguest$ cat meta-data
  instance-id: 2c2215fb-6a38-417f-b72f-376b1cc44f01
  admin@installserver:/srv/www/autoinstall/zvmguest$
  ```

  ```bash
  admin@installserver:/srv/www/autoinstall/zvmguest$ vi user-data
  admin@installserver:/srv/www/autoinstall/zvmguest$ cat user-data
  #cloud-config
  autoinstall:
    version: 1
    refresh-installer:
      update: yes
    reporting:
      builtin:
        type: print
    apt:
      preserve_sources_list: false
      primary:
      - arches: [amd64, i386]
        uri: http://archive.ubuntu.com/ubuntu
      - arches: [default]
        uri: http://ports.ubuntu.com/ubuntu-ports
    keyboard:
      layout: en
      variant: us
    locale: en_US
    identity:
      hostname: zvmguest
      password: 
  "$6$ebJ1f8wxED22bTL4F46P0"
        username: ubuntu
      user-data:
        timezone: America/Boston
        users:
          - name: ubuntu
            password: 
  "$6$KwuxED22bTL4F46P0"
            lock_passwd: false
      early-commands:
        - touch /tmp/lets_activate_the_s390x_devices
        - chzdev dasd -e 1f00
        - touch /tmp/s390x_devices_activation_done
      network:
        version: 2
        ethernets:
          enc600:
            addresses: [10.11.12.23/24]
            gateway4: 10.11.12.1
            nameservers:
              addresses: [10.11.12.1]
      ssh:
        install-server: true
        allow-pw: true
        authorized-keys: ['ssh-rsa  meQwtZ user@workstation # ssh-import-id lp:user']
    admin@installserver:~$
  ```

- For s390x installations, the `early-commands` section is the interesting part:
  对于 s390x 安装，该 `early-commands` 部分是有趣的部分：

  ```bash
  early-commands:
    - touch /tmp/lets_activate_the_s390x_devices
    - chzdev dasd -e 1f00
    - touch /tmp/s390x_devices_activation_done
  ```

  The first and last `early-commands` are optional; they only frame and indicate the real s390x command activation.
  第一个和最后一个 `early-commands` 是可选的;它们仅帧并指示真正的 S390X 命令激活。

  In this particular example a single DASD ECKD disk with the address `1f00` is enabled. zFCP disk storage can be enabled via their host (host-bus-adapters) addresses, for example *e000* (`chzdev zfcp -e e000`) and *e100* (`chzdev zfcp -e e000`). These have certain Logical Unit Numbers (LUNs) assigned, which are all automatically discovered and activated by `chzdev zfcp-lun -e --online`. Activation of a qeth device would look like this: `chzdev qeth -e 0600`.
  在此特定示例中，启用了具有该地址 `1f00` 的单个 DASD ECKD 磁盘。zFCP 磁盘存储可以通过其主机 （host-bus-adapters） 地址启用，例如 e000 （ `chzdev zfcp -e e000` ） 和 e100 （ `chzdev zfcp -e e000` ）。它们分配了某些逻辑单元号 （LUN），这些逻辑单元号都由 `chzdev zfcp-lun -e --online` 自动发现并激活。qeth 设备的激活如下所示： `chzdev qeth -e 0600` .

- For more details about the autoinstall config options, please have a look at the [autoinstall reference](https://ubuntu.com/server/docs/install/autoinstall-reference) and [autoinstall schema](https://ubuntu.com/server/docs/install/autoinstall-schema) page.
  有关自动安装配置选项的更多详细信息，请查看自动安装参考和自动安装架构页面。

- Now make sure a HTTP server is running with `/srv/www` as web-server root (in this particular example).
  现在，确保 HTTP 服务器以 `/srv/www` Web 服务器根目录（在此特定示例中）运行。

- Log in to your z/VM system using your preferred 3270 client – for example x3270 or c3270.
  使用首选的 3270 客户机（例如 x3270 或 c3270）登录到 z/VM 系统。

- Transfer the installer kernel, initrd, parmfile and exec file to the z/VM system that is used for the installation. Put these files (for example) on  File Mode (Fm) *A* (a.k.a disk *A*):
  将安装程序内核、initrd、parmfile 和 exec 文件传输到用于安装的 z/VM 系统。将这些文件（例如）放在文件模式 （Fm） A（又名磁盘 A）上：

  ```auto
  listfiles
  UBUNTU    EXEC     A1
  KERNEL    UBUNTU   A1
  INITRD    UBUNTU   A1
  PARMFILE  UBUNTU   A1
  ```

- Now specify the necessary autoinstall parameters in the parmfile:
  现在在 parmfile 中指定必要的自动安装参数：

  ```auto
  xedit PARMFILE  UBUNTU   A
   PARMFILE UBUNTU   O1  F 80  Trunc=80 Size=3 Line=0 Col=1 Alt=0
  00000 * * * Top of File * * *
  00001 ip=10.11.12.23::10.11.12.1:255.255.255.0:zvmguest:enc600:none:10.11.12.1  
  00002 url=ftp://installserver.local:21/ubuntu-daily-live-server-20.04/focal-li
  ve-ser
  00003 ver-s390x.iso autoinstall ds=nocloud-net;s=http://installserver.local:80
  00004 /autoinstall/zvmguest/ --- quiet                            
  00005 * * * End of File * * * 
  ```

> **Note**: 注意：
>  In case of any issues hitting the 80-character-per-line limit of the  file, you can write parameters across two lines as long as there are no  unwanted white spaces. To view all 80 characters in one line, disable  the prefix area on the left. “prefix off | on” will be  your friend –  use it in the command area.
> 如果遇到任何问题，达到文件的每行 80 个字符的限制，只要没有不需要的空格，就可以跨两行写入参数。若要在一行中查看所有 80 个字符，请禁用左侧的前缀区域。“前缀关闭 |on“将是你的朋友 - 在命令区使用它。

- You can now start the z/VM installation by executing the `UBUNTU REXX` script with `UBUNTU`.
  现在，您可以通过使用 执行 `UBUNTU REXX` 脚本 `UBUNTU` 来启动 z/VM 安装。

- Now monitor the initial program load (IPL) – a.k.a. the boot-up process –  of the install system. This is quite crucial, because during this  process a temporary installation password is generated and displayed.  The line(s) look similar to this:
  现在监控安装系统的初始程序加载 （IPL） – 又称启动过程。这一点非常重要，因为在此过程中会生成并显示临时安装密码。这些行如下所示：

  ```auto
  ...
  |37.487141| cloud-init¬1873|: Set the following 'random' passwords
  |37.487176| cloud-init¬1873|: installer: **i7UFdP8fhiVVMme3qqH8**
  ...
  ```

  This password is needed for remotely connecting to the installer via SSH in the next step.
  在下一步中，通过 SSH 远程连接到安装程序时需要此密码。

- So, start the `REXX` script:
  因此，启动 `REXX` 脚本：

  ```auto
  UBUNTU
  00: 0000004 FILES PURGED
  00: RDR FILE 1254 SENT FROM zvmguest  PUN WAS 1254 RECS 102K CPY  
  001 A NOHOLD NO
  KEEP
  00: RDR FILE 1258 SENT FROM zvmguest  PUN WAS 1258 RECS 0003 CPY  
  001 A NOHOLD NO
  KEEP
  00: RDR FILE 1262 SENT FROM zvmguest  PUN WAS 1262 RECS 303K CPY  
  001 A NOHOLD NO
  KEEP
  00: 0000003 FILES CHANGED
  00: 0000003 FILES CHANGED
  01: HCPGSP2627I The virtual machine is placed in CP mode due to a SIGP 
  initial C
  PU reset from CPU 00.
  02: HCPGSP2627I The virtual machine is placed in CP mode due to a SIGP 
  initial C
  PU reset from CPU 00.
  03: HCPGSP2627I The virtual machine is placed in CP mode due to a SIGP 
  initial C
  PU reset from CPU 00.
  ¬    0.403380| Initramfs unpacking failed: Decoding failed
  ln: /tmp/mountroot-fail-hooks.d//scripts/init-premount/lvm2: No such file or dir
  ectory
  QETH device 0.0.0600:0.0.0601:0.0.0602 configured
  IP-Config: enc600 hardware address 02:28:0b:00:00:51 mtu 1500
  IP-Config: enc600 guessed broadcast address 10.11.12.255
  IP-Config: enc600 complete:
   address: 10.11.12.23    broadcast: 10.210.210.255   netmask: 255.255.255.0  
  
   gateway: 10.11.12.1     dns0     : 10.11.12.1     dns1   : 0.0.0.0        
  
   host   : zvmguest                                                         
   rootserver: 0.0.0.0 rootpath: 
   filename  : 
  Connecting to installserver.local:21 (10.11.12.2:21)
  focal-live-server-s3   2% !                                ! 15.2M  0:00:48 ETA
  focal-live-server-s3  16% !*****                           !  126M  0:00:09 ETA
  focal-live-server-s3  31% !**********                      !  236M  0:00:06 ETA
  focal-live-server-s3  46% !**************                  !  347M  0:00:04 ETA
  focal-live-server-s3  60% !*******************             !  456M  0:00:03 ETA
  focal-live-server-s3  74% !***********************         !  563M  0:00:02 ETA
  focal-live-server-s3  88% !****************************    !  667M  0:00:00 ETA
  focal-live-server-s3 100% !********************************!  752M  0:00:00 ETA
  mount: mounting /cow on /root/cow failed: No such file or directory
  Connecting to plymouth: Connection refused
  passwd: password expiry information changed.
  ¬   16.748137| /dev/loop3: Can't open blockdev
  ¬   17.908156| systemd¬1|: Failed unmounting /cdrom.
  ¬ ¬0;1;31mFAILED ¬0m| Failed unmounting  ¬0;1;39m/cdrom ¬0m.
  ¬ ¬0;32m  OK   ¬0m| Listening on  ¬0;1;39mJournal Socket ¬0m.
           Mounting  ¬0;1;39mHuge Pages File System ¬0m...
           Mounting  ¬0;1;39mPOSIX Message Queue File System ¬0m...
           Mounting  ¬0;1;39mKernel Debug File System ¬0m...
           Starting  ¬0;1;39mJournal Service ¬0m...
  ...
  [   61.190916] cloud-init[2076]: Cloud-init v. 20.1-10-g71af48df-0ubuntu5 running
  'modules:final' at Fri, 26 Jun 2020 11:02:01 +0000. Up 61.09 seconds.
  [   61.191002] cloud-init[2076]: ci-info: no authorized SSH keys fingerprints fo
  und for user installer.
  [   61.191071] cloud-init[2076]: Cloud-init v. 20.1-10-g71af48df-0ubuntu5 finished at Fri, 26 Jun 2020 11:02:01 +0000.
  Datasource DataSourceNoCloudNet [seed=cmdline,
  /var/lib/cloud/seed/nocloud,
  http://installserver.local:80/autoinstall/zvmguest/]
  [dsmode=net].  Up 61.18 seconds
  [   61.191136] cloud-init[2076]: Welcome to Ubuntu Server Installer!
  [   61.191202] cloud-init[2076]: Above you will find SSH host keys and a random
  password set for the `installer` user. You can use these credentials to ssh-in
  and complete the installation. If you provided SSH keys in the cloud-init datasource,
  they were also provisioned to the installer user.
  [   61.191273] cloud-init[2076]: If you have access to the graphical console,
  like TTY1 or HMC ASCII terminal you can complete the installation there too.
  
  It is possible to connect to the installer over the network, which
  might allow the use of a more capable terminal.
  
  To connect, SSH to installer@10.11.12.23.
  
  The password you should use is ''i7UFdP8fhiVVMme3qqH8''.
  
  The host key fingerprints are:
  
  RSA     SHA256:rBXLeUke3D4gKdsruKEajHjocxc9hr3PI
  ECDSA   SHA256:KZZYFswtKxFXWQPuQS9QpOBUoS6RHswis
  ED25519 SHA256:s+5tZfagx0zffC6gYRGW3t1KcBH6f+Vt0
  
  Ubuntu 20.04 LTS ubuntu-server sclp_line0
  ```

- At short notice, you can even log in to the system with the user  ‘installer’ and the temporary password that was given at the end of the  boot-up process (see above) of the installation system:
  在短时间内，您甚至可以使用用户“安装程序”和在安装系统启动过程结束时提供的临时密码（见上文）登录系统：

  ```auto
  user@workstation:~$ ssh installer@zvmguest
  The authenticity of host 'zvmguest (10.11.12.23)' can't be established.
  ECDSA key fingerprint is SHA256:O/dU/D8jJAEGQcbqKGE9La24IRxUPLpzzs5li9F6Vvk.
  Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
  Warning: Permanently added 'zvmguest,10.11.12.23' (ECDSA) to the list of known hosts.
  installer@zvmguest's password: 
  Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-37-generic s390x)
  
   * Documentation:  https://help.ubuntu.com
   * Management:     https://landscape.canonical.com
   * Support:        https://ubuntu.com/pro
  
    System information as of Fri Jun 26 11:08:18 UTC 2020
  
    System load:    1.25      Memory usage: 4%   Processes:       192
    Usage of /home: unknown   Swap usage:   0%   Users logged in: 0
  
  0 updates can be installed immediately.
  0 of these updates are security updates.
  
  
  The list of available updates is more than a week old.
  To check for new updates run: sudo apt update
  
  
  The programs included with the Ubuntu system are free software;
  the exact distribution terms for each program are described in the
  individual files in /usr/share/doc/*/copyright.
  
  Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
  applicable law.
  
  the installer running on /dev/tty1 will perform the autoinstall
  
  press enter to start a shell
  ```

- Please note that it informs you about a currently-running autoinstall process:
  请注意，它会通知您当前正在运行的自动安装过程：

  ```auto
  the installer running on /dev/tty1 will perform the autoinstall
  ```

- Nevertheless, we can quickly check some things – although, only until the autoinstall process is finished and the post-install reboot has been triggered:
  尽管如此，我们还是可以快速检查一些事情——不过，只有在自动安装过程完成并触发安装后重新启动之前：

  ```auto
  root@ubuntu-server:/# ls -l /tmp/lets_activate_the_s390x_devices 
  -rw-r--r-- 1 root root 0 Jun 26 11:08 /tmp/lets_activate_the_s390x_devices
  -rw-r--r-- 1 root root 0 Jun 26 11:09 /tmp/s390x_devices_activation_done
  
  root@ubuntu-server:/# lszdev | grep yes
  dasd-eckd    0.0.1f00                                        yes  yes   
  qeth         0.0.0600:0.0.0601:0.0.0602                      yes  no    enc600
  root@ubuntu-server:/# 
  ```

- If you wait long enough, you’ll see that the remote session gets closed:
  如果等待足够长的时间，则会看到远程会话已关闭：

  ```auto
  root@ubuntu-server:/# Connection to zvmguest closed by remote host.
  Connection to zvmguest closed.
  user@workstation:~$ 
  ```

- As well as at the console:
  以及在控制台上：

  ```auto
  ubuntu-server login:
  
  [[0;1;31mFAILED[0m] Failed unmounting [0;1;39m/cdrom[0m.
  [  169.161139] sd-umoun[15600]: Failed to unmount /oldroot: Device or resource busy
  [  169.161550] sd-umoun[15601]: Failed to unmount /oldroot/cdrom: Device or resource busy
  [  169.168118] shutdown[1]: Failed to finalize  file systems, loop devices, ignoring
  Total: 282 Selected: 0
  
  Command:
  ```

- …and that the post-install reboot got triggered:
  ...并且触发了安装后重新启动：

  ```auto
  Message
  Mounting [0;1;39mKernel Configuration File System[0m...
  Starting [0;1;39mApply Kernel Variables[0m...
  [[0;32m  OK  [0m] Finished [0;1;39mRemount Root and Kernel File Systems[0m.
  [[0;32m  OK  [0m] Finished [0;1;39mUncomplicated firewall[0m.
  [[0;32m  OK  [0m] Mounted [0;1;39mFUSE Control File System[0m.
  [[0;32m  OK  [0m] Mounted [0;1;39mKernel Configuration File System[0m.
  ...
  [   35.378928] cloud-init[2565]: Cloud-init v. 20.1-10-g71af48df-0ubuntu5 runnin
  g 'modules:final' at Fri, 26 Jun 2020 11:10:44 +0000. Up 35.29 seconds.
  [   35.378978] cloud-init[2565]: Cloud-init v. 20.1-10-g71af48df-0ubuntu5 finish
  ed at Fri, 26 Jun 2020 11:10:44 +0000. Datasource DataSourceNone.  Up 35.37 seconds
  [   35.379008] cloud-init[2565]: 2020-06-26 11:10:44,359 - cc_final_message.py[W
  ARNING]: Used fallback datasource
  [[0;32m  OK  [0m] Finished [0;1;39mExecute cloud user/final scripts[0m.
  [[0;32m  OK  [0m] Reached target [0;1;39mCloud-init target[0m.
  
  zvmguest login:
  ```

- With the completion of the reboot the autoinstall is finished and the z/VM guest is ready to use:
  重新引导完成后，自动安装完成，z/VM 客户机可供使用：

  ```auto
  user@workstation:~$ ssh-keygen -f "/home/user/.ssh/known_hosts" -R "zvmguest"
  # Host zvmguest found: line 163
  /home/user/.ssh/known_hosts updated.
  Original contents retained as /home/user/.ssh/known_hosts.old
  user@workstation:~$ ssh ubuntu@zvmguest
  The authenticity of host 'zvmguest (10.11.12.23)' can't be established.
  ECDSA key fingerprint is SHA256:iGtCArEg+ZnoZlgtOkvmyy0gPY8UEI+f7zoISOF+m/0.
  Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
  Warning: Permanently added 'zvmguest,10.11.12.23' (ECDSA) to the list of known hosts.
  Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-39-generic s390x)
  
   * Documentation:  https://help.ubuntu.com
   * Management:     https://landscape.canonical.com
   * Support:        https://ubuntu.com/pro
  
    System information as of Fri 26 Jun 2020 11:12:23 AM UTC
  
    System load: 0.21               Memory usage: 3%   Processes:       189
    Usage of /:  28.2% of 30.88GB   Swap usage:   0%   Users logged in: 0
  
  10 updates can be installed immediately.
  0 of these updates are security updates.
  To see these additional updates run: apt list --upgradable
  
  The programs included with the Ubuntu system are free software;
  the exact distribution terms for each program are described in the
  individual files in /usr/share/doc/*/copyright.
  
  Ubuntu comes with ABSOLUTELY NO WARRANTY,
  to the extent permitted by applicable law.
  
  To run a command as administrator (user "root"), use "sudo <command>".
  See "man sudo_root" for details.
  
  ubuntu@zvmguest:~$ uptime
   11:12:35 up 2 min,  1 user,  load average: 0.18, 0.17, 0.08
  ubuntu@zvmguest:~$ lsb_release -a
  No LSB modules are available.
  Distributor ID:	Ubuntu
  Description:	Ubuntu 20.04 LTS
  Release:	20.04
  Codename:	focal
  ubuntu@zvmguest:~$ uname -a
  Linux zvmguest 5.4.0-39-generic #43-Ubuntu SMP Fri Jun 19 10:27:17
  UTC 2020 s390x s390x s390x 
  GNU/Linux
  ubuntu@zvmguest:~$ lszdev | grep yes
  dasd-eckd    0.0.1f00                                        yes  yes   
  qeth         0.0.0600:0.0.0601:0.0.0602                      yes  yes   enc600
  ubuntu@zvmguest:~$ exit
  logout
  Connection to zvmguest closed.
  user@workstation:~$
  ```

## Some closing notes 一些结束语

- It’s always best to use the latest installer and autoinstall components:  either make sure the installer gets updated to the latest level, or just use a current daily live-server image.
  最好始终使用最新的安装程序和自动安装组件：确保安装程序更新到最新级别，或者仅使用当前的每日实时服务器映像。
- The ISO image specified with the kernel parameters needs to fit in the boot folder. Its kernel and initrd are specified in the ‘Load from Removable Media and Server’ task at the hardware management console (HMC).
  使用内核参数指定的 ISO 映像需要适合 boot 文件夹。其内核和 initrd 在硬件管理控制台 （HMC） 的“从可移动媒体和服务器装入”任务中指定。
- In addition to activating disk storage resources in `early-commands`, other devices like OSA/qeth can be added and activated there, too. This is not needed for the basic network device, as specified in the kernel  parameters that are used for the installation (that one is automatically handled).
  除了激活磁盘 `early-commands` 存储资源外，还可以在那里添加和激活其他设备，如 OSA/qeth。基本网络设备不需要此功能，如用于安装的内核参数中指定的那样（自动处理该参数）。
- If everything is properly set up – FTP server for the image, HTTP server  for the autoinstall config files – the installation can be as quick as 2 to 3 minutes (depending on the complexity of the autoinstall YAML  file).
  如果一切都设置正确 - 映像的FTP服务器，自动安装配置文件的HTTP服务器 - 安装可以快至2到3分钟（取决于自动安装YAML文件的复杂性）。
- There is a simple way of generating a sample autoinstall YAML file: one can  perform an interactive Subiquity installation, grab the file `/var/log/installer/autoinstall-user-data`, and use it as an example – but beware that the `early-commands` entries to activate the s390x-specific devices need to be added manually!
  有一种简单的方法可以生成示例自动安装 YAML 文件：可以执行交互式 Subiquity 安装，抓取文件 `/var/log/installer/autoinstall-user-data` 并将其用作示例 – 但请注意，需要手动添加激活 s390x 特定设备 `early-commands` 的条目！

------

# Interactive live server installation on IBM Z LPAR (s390x) IBM Z LPAR （s390x） 上的交互式实时服务器安装

Doing an interactive (manual) live installation as described here - meaning  without specifying a parmfile - has been supported in Ubuntu Server  since LTS 20.04.5 (‘Focal’).
自 LTS 20.04.5（“Focal”）以来，Ubuntu Server 支持执行此处所述的交互式（手动）实时安装 - 这意味着无需指定 parmfile。

The following guide assumes that an FTP server to host the installation  files is in place, which can be used by the ‘Load from Removable Media  and Server’ task of the Hardware Management Console (HMC).
以下指南假定用于托管安装文件的 FTP 服务器已到位，硬件管理控制台 （HMC） 的“从可移动媒体和服务器装入”任务可以使用该服务器。

## Download and mount the ISO 下载并挂载 ISO

Download the [‘focal daily live image’ (later 20.04.5 image)](http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-s390x.iso).
下载“焦点每日实时图像”（20.04.5 更新的图像）。

Now loop-back mount the ISO to extract the four files that are needed for the installation:
现在环回挂载 ISO 以提取安装所需的四个文件：

```bash
user@workstation:~$ mkdir iso
user@workstation:~$ sudo mount -o loop ubuntu-20.04.5-live-server-s390x.iso iso
user@workstation:~$ 

user@workstation:~$ ls -1 ./iso/boot/{ubuntu.exec,parmfile.*,kernel.u*,initrd.u*}
./iso/boot/initrd.ubuntu
./iso/boot/kernel.ubuntu
./iso/boot/parmfile.ubuntu
./iso/boot/ubuntu.exec
```

## Make the files available via your FTP server. 通过FTP服务器提供文件。

- Open the IBM Z HMC and navigate to ‘Systems Management’ on your machine.
  打开 IBM Z HMC 并导航到计算机上的“系统管理”。

- Select the LPAR that you are going to install Ubuntu Server on. In this example we use LPAR `s1lp11`.
  选择要安装 Ubuntu Server 的 LPAR。在此示例中，我们使用 LPAR `s1lp11` 。

- Now select menu: ‘Recovery’ → ‘Load from Removable Media or Server’ task.
  现在选择菜单：“恢复”→“从可移动媒体或服务器加载”任务。

- Fill out the ‘Load from Removable Media or Server’ form as follows (adapt  the settings to your particular installation environment):
  按如下方式填写“从可移动介质或服务器加载”表单（根据您的特定安装环境调整设置）：

  ```plaintext
  Load from Removable Media, or Server - <machine>:s1lp11
  Use this task to load operating system software or utility programs 
  from a CD / DVD-ROM or a server that can be accessed using FTP.
  Select the source of the software:
  o Hardware Management Console CD / DVD-ROM 
  o Hardware Management Console CD / DVD-ROM and assign for operating system use 
  o Hardware Management Console USB flash memory drive 
  o Hardware Management Console USB flash memory drive and assign for operating system use 
  * FTP Source 
     Host computer:	install-server
     User ID:	ftpuser
     Password: ********
     Account (optional):	
     File location (optional): ubuntu-live-server-20.04.5/boot
  ```

  You may need to adjust the file’s location according to your install server environment.
  您可能需要根据安装服务器环境调整文件的位置。

- Confirm the entered data:
  确认输入的数据：

  ```plaintext
  Load from Removable Media or Server - Select Software to Install - 
  <machine>:s1lp11
  Select the software to install.
  Select   Name                                         Description
  *  ubuntu-live-server-20.04.5/boot/ubuntu.ins     Ubuntu for IBM Z (default kernel)
  ```

- Confirm again that jobs might be cancelled if proceeding:
  再次确认，如果继续以下操作，作业可能会被取消：

  ```plaintext
  Load from Removable Media or Server Task Confirmation - 
  <machine>:s1lp11
  Load will cause jobs to be cancelled.
  Do you want to continue with this task?
  ACT33501
  ```

- And confirm a last time that it’s understood that the task is disruptive:
  并确认最后一次理解该任务是破坏性的：

  ```plaintext
  Disruptive Task Confirmation : Load from Removable Media or Server - 
  <machine>:s1lp11
  
  Attention: The Load from Removable Media or Server task is disruptive.		 
  
  Executing the Load from Removable Media or Server task may
  adversely affect the objects listed below. Review the confirmation text
  for each object before continuing with the Load from Removable Media 
  or Server task.
  
  Objects that will be affected by the Load from Removable Media or
  Server task
  
  System Name       Type     OS Name     Status      Confirmation Text
  <machine>:s1lp11   Image                Operating   Load from Removable Media 
  or Server causes operations to be disrupted, since the target is
  currently in use and operating normally.
  
  Do you want to execute the Load from Removable Media or Server task?
  ```

- The ‘Load from Removable media or Server’ task is now executed:
  现在执行“从可移动媒体或服务器加载”任务：

  ```plaintext
  Load from Removable media or Server Progress - P00B8F67:S1LPB	 
  Turn on context sensitive help. 	 
  Function duration time:	00:55:00
  Elapsed time: 00:00:04
  Select      Object Name       Status
  *           <machine> s1lp11   Please wait while the image is being loaded.
  ```

- This may take a moment, but you will soon see:
  这可能需要一些时间，但您很快就会看到：

  ```auto
  Load from Removable media or Server Progress - <machine>:s1lp11
  Function duration time:	00:55:00
  Elapsed time:	00:00:21
  Select      Object Name       Status
  *           <machine> s1lp11   Success
  ```

- Close the ‘Load from Removable media or Server’ task and open the console  a.k.a. ‘Operating System Messages’ instead. If no parmfile was  configured or provided, you will find the following lines in the  ‘Operating System Messages’ task:
  关闭“从可移动媒体或服务器加载”任务，然后打开控制台，也称为“操作系统消息”。如果未配置或提供 parmfile，您将在“操作系统消息”任务中找到以下行：

  ```plaintext
  Operating System Messages - <machine>:s1lp11
  	
  Message
  
  Unable to find a medium container a live file system
  Attempt interactive netboot from a URL?
  yes no (default yes):
  ```

- By default, you will now see the interactive network configuration menu  (again, only if no parmfile was prepared with sufficient network  configuration information).
  默认情况下，您现在将看到交互式网络配置菜单（同样，仅当没有准备具有足够网络配置信息的 parmfile 时）。

- Proceed with the interactive network configuration – in this case in a VLAN environment:
  继续进行交互式网络配置 - 在本例中为 VLAN 环境中：

  ```plaintext
  Unable to find a medium container a live file system
  Attempt interactive netboot from a URL?
  yes no (default yes):
  yes
  Available qeth devices:
  0.0.c000 0.0.c003 0.0.c006 0.0.c009 0.0.c00c 0.0.c00f
  zdev to activate (comma separated, optional):
  0.0.c000
  QETH device 0.0.c000:0.0.c001:0.0.c002 configured
  Two methods available for IP configuration:
  * static: for static IP configuration
  * dhcp: for automatic IP configuration
  static dhcp (default 'dhcp'):
  static
  ip:
  10.222.111.11
  gateway (default 10.222.111.1):
  10.222.111.1
  dns (default 10.222.111.1):
  10.222.111.1
  vlan id (optional):
  1234
  http://cdimage.ubuntu.com/ubuntu/releases/20.04.5/release/ubuntu-20.04.5-live-server-s390x.iso (default)
  url:
  ftp://10.11.12.2:21/ubuntu-live-server-20.04.5/ubuntu-20.04.5-live-server-s390x.iso
  http_proxy (optional):
  ```

- After the last interactive step here (that this is about an optional proxy  configuration), the installer will complete its boot-up process:
  在最后一个交互步骤（这是关于可选的代理配置）之后，安装程序将完成其启动过程：

```plaintext
Configuring networking...
IP-Config: encc000.1234 hardware address 3e:00:10:55:00:ff mtu 1500
IP-Config: encc000.1234 guessed broadcast address 10.222.111.255
IP-Config: encc000.1234 complete:
address: 10.222.111.11    broadcast: 10.222.111.255   netmask: 255.255.255.0
 
gateway: 10.222.111.1     dns0     : 10.222.111.1     dns1   : 0.0.0.0
 
rootserver: 0.0.0.0 rootpath:
filename  :
Connecting to 10.11.12.2:21 (10.11.12.2:21)
focal-live-server-s  10% |***                             | 72.9M  0:00:08 ETA
focal-live-server-s  25% |********                        |  168M  0:00:05 ETA
focal-live-server-s  42% |*************                   |  279M  0:00:04 ETA
focal-live-server-s  58% |******************              |  390M  0:00:02 ETA
focal-live-server-s  75% |************************        |  501M  0:00:01 ETA
focal-live-server-s  89% |****************************    |  595M  0:00:00 ETA
focal-live-server-s  99% |******************************* |  662M  0:00:00 ETA
focal-live-server-s 100% |********************************|  663M  0:00:00 ETA
ip: RTNETLINK answers: File exists
no search or nameservers found in /run/net-encc000.1234.conf / run/net-*.conf /run/net6-*.conf
[  399.808930] /dev/loop3: Can't open blockdev
[[0;1;31m SKIP [0m] Ordering cycle found, skipping [0;1;39mLogin Prompts[0m
[  401.547705] systemd[1]: multi-user.target: Job getty.target/start deleted to
break ordering cycle starting with multi-user.target/start
[  406.241972] cloud-init[1321]: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 running
'init-local' at Wed, 03 Jun 2020 17:07:39 +0000. Up 406.00 seconds.
[  407.025557] cloud-init[1348]: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 running
'init' at Wed, 03 Jun 2020 17:07:40 +0000. Up 406.87 seconds.
[  407.025618] cloud-init[1348]: ci-info:   ++++Net device info++++
[  407.025658] cloud-init[1348]: ci-info: +--------------+------+---------------
---------------+---------------+--------+-------------------+
[  407.025696] cloud-init[1348]: ci-info: |    Device    |  Up  |           Addr
ess            |      Mask     | Scope  |     Hw-Address    |
[  407.025731] cloud-init[1348]: ci-info: +--------------+------+---------------
---------------+---------------+--------+-------------------+
[  407.025766] cloud-init[1348]: ci-info: |   encc000    | True | fe80::3ca7:10f
f:fea5:c69e/64 |       .       |  link  | 72:5d:0d:09:ea:76 |
[  407.025802] cloud-init[1348]: ci-info: | encc000.1234 | True |        10.245.
236.11         | 255.255.255.0 | global | 72:5d:0d:09:ea:76 |
[  407.025837] cloud-init[1348]: ci-info: | encc000.1234 | True | fe80::3ca7:10f
f:fea5:c69e/64 |       .       |  link  | 72:5d:0d:09:ea:76 |
[  407.025874] cloud-init[1348]: ci-info: |      lo      | True |          127.0
.0.1           |   255.0.0.0   |  host  |         .         |
[  407.025909] cloud-init[1348]: ci-info: |      lo      | True |           ::1/
128            |       .       |  host  |         .         |
[  407.025944] cloud-init[1348]: ci-info: +--------------+------+---------------
---------------+---------------+--------+-------------------+
[  407.025982] cloud-init[1348]: ci-info: +++++++++++++Route I
Pv4 info++++++++++++++
[  407.026017] cloud-init[1348]: ci-info: +-------+--------------+--------------
+---------------+--------------+-------+
[  407.026072] cloud-init[1348]: ci-info: | Route | Destination  |   Gateway
|    Genmask    |  Interface   | Flags |
[  407.026107] cloud-init[1348]: ci-info: +-------+--------------+--------------
+---------------+--------------+-------+
[  407.026141] cloud-init[1348]: ci-info: |   0   |   0.0.0.0    | 10.222.111.1
|    0.0.0.0    | encc000.1234 |   UG  |
[  407.026176] cloud-init[1348]: ci-info: |   1   | 10.222.111.0 |   0.0.0.0
| 255.255.255.0 | encc000.1234 |   U   |
[  407.026212] cloud-init[1348]: ci-info: +-------+--------------+--------------
+---------------+--------------+-------+
[  407.026246] cloud-init[1348]: ci-info: ++++++++++++++++++++Route IPv6 info+++
++++++++++++++++++
[  407.026280] cloud-init[1348]: ci-info: +-------+-------------+---------+-----
---------+-------+
[  407.026315] cloud-init[1348]: ci-info: | Route | Destination | Gateway |  Int
erface   | Flags |
[  407.026355] cloud-init[1348]: ci-info: +-------+-------------+---------+-----
---------+-------+
[  407.026390] cloud-init[1348]: ci-info: |   1   |  fe80::/64  |    ::   |   en
cc000    |   U   |
[  407.026424] cloud-init[1348]: ci-info: |   2   |  fe80::/64  |    ::   | encc
000.1234 |   U   |
[  407.026458] cloud-init[1348]: ci-info: |   4   |    local    |    ::   |   en
cc000    |   U   |
[  407.026495] cloud-init[1348]: ci-info: |   5   |    local    |    ::   | encc
000.1234 |   U   |
[  407.026531] cloud-init[1348]: ci-info: |   6   |   ff00::/8  |    ::   |   en
cc000    |   U   |
[  407.026566] cloud-init[1348]: ci-info: |   7   |   ff00::/8  |    ::   | encc
000.1234 |   U   |
[  407.026600] cloud-init[1348]: ci-info: +-------+-------------+---------+-----
---------+-------+
[  407.883058] cloud-init[1348]: Generating public/private rsa key pair.
[  407.883117] cloud-init[1348]: Your identification has been saved in /etc/ssh/
ssh_host_rsa_key
[  407.883154] cloud-init[1348]: Your public key has been saved in /etc/ssh/ssh_
host_rsa_key.pub
[  407.883190] cloud-init[1348]: The key fingerprint is:
[  407.883232] cloud-init[1348]: SHA256:KX5cHC4YL9dXpvhnP6eSfS+J/zmKgg9zdlEzaEb+
RTA root@ubuntu-server
[  407.883267] cloud-init[1348]: The key's randomart image is:
[  407.883302] cloud-init[1348]: +---[RSA 3072]----+
[  407.883338] cloud-init[1348]: |           . E.. |
[  407.883374] cloud-init[1348]: |          o . o  |
[  407.883408] cloud-init[1348]: |      .   .= +o. |
[  407.883443] cloud-init[1348]: |       + =ooo++  |
[  407.883478] cloud-init[1348]: |      + S *.o.   |
[  407.883512] cloud-init[1348]: |     . = o o.    |
[  407.883546] cloud-init[1348]: |      .o+o ..+o. |
[  407.883579] cloud-init[1348]: |       o=.. =o+++|
[  407.883613] cloud-init[1348]: |        .... ++*O|
[  407.883648] cloud-init[1348]: +----[SHA256]-----+
[  407.883682] cloud-init[1348]: Generating public/private dsa key pair.
[  407.883716] cloud-init[1348]: Your identification has been saved in /etc/ssh/
ssh_host_dsa_key
[  407.883750] cloud-init[1348]: Your public key has been saved in /etc/ssh/ssh_
host_dsa_key.pub
[  407.883784] cloud-init[1348]: The key fingerprint is:
[  407.883817] cloud-init[1348]: SHA256:xu3vlG1BReKDy3DsuMZc/lg5y/+nhzlEmLDk/qFZ
Am0 root@ubuntu-server
[  407.883851] cloud-init[1348]: The key's randomart image is:
[  407.883905] cloud-init[1348]: +---[DSA 1024]----+
[  407.883941] cloud-init[1348]: |              ..o|
[  407.883975] cloud-init[1348]: |          o. o o |
[  407.884008] cloud-init[1348]: |         +.o+o+  |
[  407.884042] cloud-init[1348]: |       ...E*oo.. |
[  407.884076] cloud-init[1348]: |        S+o =..  |
[  407.884112] cloud-init[1348]: |       . +o+oo.o |
[  407.884145] cloud-init[1348]: |          **+o*o |
[  407.884179] cloud-init[1348]: |         .oo.*+oo|
[  407.884212] cloud-init[1348]: |           .+ ===|
[  407.884246] cloud-init[1348]: +----[SHA256]-----+
[  407.884280] cloud-init[1348]: Generating public/private ecdsa key pair.
[  407.884315] cloud-init[1348]: Your identification has been saved in /etc/ssh/
ssh_host_ecdsa_key
[  407.884352] cloud-init[1348]: Your public key has been saved in /etc/ssh/ssh_
host_ecdsa_key.pub
[  407.884388] cloud-init[1348]: The key fingerprint is:
[  407.884422] cloud-init[1348]: SHA256:P+hBF3fj/pu6+0KaywUYii3Lyuc09Za9/a2elCDO
gdE root@ubuntu-server
[  407.884456] cloud-init[1348]: The key's randomart image is:
[  407.884490] cloud-init[1348]: +---[ECDSA 256]---+
[  407.884524] cloud-init[1348]: |                 |
[  407.884558] cloud-init[1348]: |         .       |
[  407.884591] cloud-init[1348]: |        ..E . o  |
[  407.884625] cloud-init[1348]: |      o .ooo o . |
[  407.884660] cloud-init[1348]: |     o +S.+.. .  |
[  407.884694] cloud-init[1348]: |    . +..*oo.+ . |
[  407.884728] cloud-init[1348]: |     =  o+=.+.+  |
[  407.884762] cloud-init[1348]: |  . o......++o oo|
[  407.884795] cloud-init[1348]: |   oo.  .  +.*@*+|
[  407.884829] cloud-init[1348]: +----[SHA256]-----+
[  407.884862] cloud-init[1348]: Generating public/private ed25519 key pair.
[  407.884896] cloud-init[1348]: Your identification has been saved in /etc/ssh/
ssh_host_ed25519_key
[  407.884930] cloud-init[1348]: Your public key has been saved in /etc/ssh/ssh_
host_ed25519_key.pub
[  407.884966] cloud-init[1348]: The key fingerprint is:
[  407.884999] cloud-init[1348]: SHA256:CbZpkR9eFHuB1sCDZwSdSdwJzy9FpsIWRIyc9ers
hZ0 root@ubuntu-server
[  407.885033] cloud-init[1348]: The key's randomart image is:
[  407.885066] cloud-init[1348]: +--[ED25519 256]--+
[  407.885100] cloud-init[1348]: |       ../%X..o  |
[  407.885133] cloud-init[1348]: |       .=o&*+=   |
[  407.885167] cloud-init[1348]: |      = .+*.* .  |
[  407.885200] cloud-init[1348]: |     . B = + o   |
[  407.885238] cloud-init[1348]: |      + S . . .  |
[  407.885274] cloud-init[1348]: |     .   o o o   |
[  407.885308] cloud-init[1348]: |          + E    |
[  407.885345] cloud-init[1348]: |         . .     |
[  407.885378] cloud-init[1348]: |          .      |
[  407.885420] cloud-init[1348]: +----[SHA256]-----+
[  418.521933] cloud-init[2185]: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 runnin
g 'modules:config' at Wed, 03 Jun 2020 17:07:52 +0000. Up 418.40 seconds.
[  418.522012] cloud-init[2185]: Set the following 'random' passwords
[  418.522053] cloud-init[2185]: installer:C7BZrW76s4mJzmpf4eUy
ci-info: no authorized SSH keys fingerprints found for user installer.
<14>Jun  3 17:07:52 ec2:
<14>Jun  3 17:07:52 ec2: #######################################################
######
<14>Jun  3 17:07:52 ec2: -----BEGIN SSH HOST KEY FINGERPRINTS-----
<14>Jun  3 17:07:52 ec2: 1024 SHA256:xu3vlG1BReKDy3DsuMZc/lg5y/+nhzlEmLDk/qFZAm0
root@ubuntu-server (DSA)
<14>Jun  3 17:07:52 ec2: 256 SHA256:P+hBF3fj/pu6+0KaywUYii3Lyuc09Za9/a2elCDOgdE
root@ubuntu-server (ECDSA)
<14>Jun  3 17:07:52 ec2: 256 SHA256:CbZpkR9eFHuB1sCDZwSdSdwJzy9FpsIWRIyc9ershZ0
root@ubuntu-server (ED25519)
<14>Jun  3 17:07:52 ec2: 3072 SHA256:KX5cHC4YL9dXpvhnP6eSfS+J/zmKgg9zdlEzaEb+RTA
root@ubuntu-server (RSA)
<14>Jun  3 17:07:52 ec2: -----END SSH HOST KEY FINGERPRINTS-----
<14>Jun  3 17:07:52 ec2: #######################################################
######
-----BEGIN SSH HOST KEY KEYS-----
ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBC2zp4Fq
r1+NJOIEQIISbX+EzeJ6ucXSLi2xEvurgwq8iMYT6yYOXBOPc/XzeFa6vBCDZk3SSSW6Lq83y7VmdRQ=
root@ubuntu-server
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJFzgips94nJNoR4QumiyqlJoSlZ48P+NVrd7zgD5k4T
root@ubuntu-server
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQChKo06O715FAjd6ImK7qZbWnL/cpgQ2A2gQEqFNO+1
joF/41ygxuw5aG0IQObWFpV9jDsMF5z4qHKzX8tFCpKC0s4uR8QBxh1dDm4wcwcgtAfVLqh7S4/R9Sqa
IFnkCzxThhNeMarcRrutY0mIzspmCg/QvfE1wrXJzl+RtOJ7GiuHHqpm76fX+6ZF1BYhkA87dXQiID2R
yUubSXKGg0NtzlgSzPqD3GB+HxRHHHLT5/Xq+njPq8jIUpqSoHtkBupsyVmcD9gDbz6vng2PuBHwZP9X
17QtyOwxddxk4xIXaTup4g8bH1oF/czsWqVxNdfB7XqzROFUOD9rMIB+DwBihsmH1kRik4wwLi6IH4hu
xrykKvfb1xcZe65kR42oDI7JbBwxvxGrOKx8DrEXnBpOWozS0IDm2ZPh3ci/0uCJ4LTItByyCfAe/gyR
5si4SkmXrIXf5BnErZRgyJnfxKXmsFaSh7wf15w6GmsgzyD9sI2jES9+4By32ZzYOlDpi0s= root@ub
untu-server
-----END SSH HOST KEY KEYS-----
[  418.872320] cloud-init[2203]: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 runnin
g 'modules:final' at Wed, 03 Jun 2020 17:07:52 +0000. Up 418.79 seconds.
[  418.872385] cloud-init[2203]: ci-info: no authorized SSH keys fingerprints fo
und for user installer.
[  418.872433] cloud-init[2203]: Cloud-init v. 20.2-45-g5f7825e2-0ubuntu1 finish
ed at Wed, 03 Jun 2020 17:07:52 +0000. Datasource DataSourceNoCloud [seed=/var/l
ib/cloud/seed/nocloud][dsmode=net].  Up 418.86 seconds
[  418.872484] cloud-init[2203]: Welcome to Ubuntu Server Installer!
[  418.872529] cloud-init[2203]: Above you will find SSH host keys and a random
password set for the `installer` user. You can use these credentials to ssh-in a
nd complete the installation. If you provided SSH keys in the cloud-init datasou
rce, they were also provisioned to the installer user.
[  418.872578] cloud-init[2203]: If you have access to the graphical console, li
ke TTY1 or HMC ASCII terminal you can complete the installation there too.
 
It is possible to connect to the installer over the network, which
might allow the use of a more capable terminal.
 
To connect, SSH to installer@10.222.111.11.
 
The password you should use is "C7BZrW76s4mJzmpf4eUy".
 
The host key fingerprints are:
 
RSA     SHA256:KX5cHC4YL9dXpvhnP6eSfS+J/zmKgg9zdlEzaEb+RTA
ECDSA   SHA256:P+hBF3fj/pu6+0KaywUYii3Lyuc09Za9/a2elCDOgdE
ED25519 SHA256:CbZpkR9eFHuB1sCDZwSdSdwJzy9FpsIWRIyc9ershZ0
 
Ubuntu Focal Fossa (development branch) ubuntu-server sclp_line0
ubuntu-server login:
```

- At this point you can proceed with the regular installation either by  using ‘Recovery’ → ‘Integrated ASCII Console’ or with a remote SSH  session.
  此时，您可以使用“恢复”→“集成 ASCII 控制台”或远程 SSH 会话继续进行常规安装。
- If the ‘Integrated ASCII Console’ was opened (you can hit F3to refresh the task), the initial Subiquity installation screen is presented, which looks like this:
  如果打开了“集成 ASCII 控制台”（您可以点击 F3 刷新任务），则会显示初始 Subiquity 安装屏幕，如下所示：

```auto
================================================================================
  Willkommen! Bienvenue! Welcome! ????? ??????????! Welkom!           [ Help ]  
================================================================================
  Use UP, DOWN and ENTER keys to select your language.
                [ English                                    > ]
                [ Asturianu                                  > ]
                [ Cataln                                     > ]
                [ Hrvatski                                   > ]
                [ Nederlands                                 > ]
                [ Suomi                                      > ]
                [ Francais                                   > ]
                [ Deutsch                                    > ]
                [ Magyar                                     > ]
                [ Latvie?u                                   > ]
                [ Norsk bokm?l                               > ]
                [ Polski                                     > ]
                [ Espanol                                    > ]
```

- Since the user experience is nicer in a remote SSH session, we recommend using that.
  由于远程 SSH 会话中的用户体验更好，因此我们建议使用它。
   However, with certain network environments it’s just not possible to use a remote shell, and the ‘Integrated ASCII Console’ will be the only  option.
  但是，在某些网络环境中，无法使用远程 shell，而“集成 ASCII 控制台”将是唯一的选择。

> **Note**: 注意：
>  At the end of the installer boot-up process, **all** necessary information is provided to proceed with a remote shell.
> 在安装程序启动过程结束时，将提供继续执行远程 shell 所需的所有信息。

- The command to execute locally is:
  要在本地执行的命令是：

  ```bash
  user@workstation:~$ ssh installer@10.222.111.11
  ```

- A temporary random password for the installation was created and shared  as well, which you should use without the leading and trailing double  quotes:
  还创建并共享了安装的临时随机密码，您应该在不带前导和尾随双引号的情况下使用该密码：

```plaintext
"C7BZrW76s4mJzmpf4eUy"
```

- Hence the remote session for the installer can be opened by:
  因此，可以通过以下方式打开安装程序的远程会话：

```bash
user@workstation:~$ ssh installer@10.222.111.11
The authenticity of host '10.222.111.11 (10.222.111.11)' can't be established.
ECDSA key fingerprint is SHA256:P+hBF3fj/pu6+0KaywUYii3Lyuc09Za9/a2elCDOgdE.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.222.111.11' (ECDSA) to the list of known hosts.
installer@10.222.111.11's password: C7BZrW76s4mJzmpf4eUy
```

- One may swiftly see some login messages like the following ones:
  人们可能会很快看到一些登录消息，如下所示：

```auto
Welcome to Ubuntu Focal Fossa (development branch) (GNU/Linux 5.4.0-42-generic s390x)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

  System information as of Wed Jun  3 17:32:10 UTC 2020

  System load:    0.0       Memory usage: 2%   Processes:       146
  Usage of /home: unknown   Swap usage:   0%   Users logged in: 0

0 updates can be installed immediately.
0 of these updates are security updates.

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.
```

Eventually you’ll reach the initial Subiquity installer screen:
最终，您将到达初始 Subiquity 安装程序屏幕：

```auto
====================================================================
  Willkommen! Bienvenue! Welcome! ????? ??????????! Welkom!       
====================================================================
  Use UP, DOWN and ENTER keys to select your language.                        
                                                                              
                [ English                                    > ]              
                [ Asturianu                                  > ]              
                [ Cataln                                     > ]              
                [ Hrvatski                                   > ]              
                [ Nederlands                                 > ]              
                [ Suomi                                      > ]              
                [ Francais                                   > ]              
                [ Deutsch                                    > ]              
                [ Magyar                                     > ]              
                [ Latvie?u                                   > ]              
                [ Norsk bokm?l                               > ]              
                [ Polski                                     > ]              
                [ Espanol                                    > ]                                             
```

- From this point, you can follow the normal Subiquity installation. For more details, refer to the [Subquity installer documentation](https://canonical-subiquity.readthedocs-hosted.com/en/latest/index.html).
  从这一点开始，您可以遵循正常的 Subiquity 安装。有关更多详细信息，请参阅 Subquity 安装程序文档。

(I’m leaving some pretty standard screenshots here just to give an example for a basic installation …)
（我在这里留下一些非常标准的屏幕截图，只是为了给出一个基本安装的例子......

```auto
====================================================================
  Keyboard configuration                                          
====================================================================
  Please select your keyboard layout below, or select "Identify keyboard" to  
  detect your layout automatically.                                           
                                                                              
                 Layout:  [ English (US)                     v ]              
                                                                              
                                                                              
                Variant:  [ English (US)                     v ]              
                                                                              
                                                                              
                             [ Identify keyboard ]                            
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Zdev setup                                                      
====================================================================
  ID                          ONLINE  NAMES                                  ^
                                                                             │
  dasd-eckd                                                                   
  0.0.1600                                     >                              
  0.0.1601                                     >                              
  0.0.1602                                     >                              
  0.0.1603                                     >                              
  0.0.1604                                     >                              
  0.0.1605                                     >                              
  0.0.1606                                     >                              
  0.0.1607                                     >                              
  0.0.1608                                     >                              
  0.0.1609                                     >                              
  0.0.160a                                     >                              
  0.0.160b                                     >                              
  0.0.160c                                     >                              
  0.0.160d                                     >                             v
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
====================================================================
  Zdev setup                                                      
====================================================================
  ID                          ONLINE  NAMES                                  ^
                                                                             │
  dasd-eckd                                                                   
  0.0.1600                                     >┌────────────┐                
  0.0.1601                                     >│< (close)   │                
  0.0.1602                                     >│  Enable    │                
  0.0.1603                                     >│  Disable   │                
  0.0.1604                                     >└────────────┘                
  0.0.1605                                     >                              
  0.0.1606                                     >                              
  0.0.1607                                     >                              
  0.0.1608                                     >                              
  0.0.1609                                     >                              
  0.0.160a                                     >                              
  0.0.160b                                     >                              
  0.0.160c                                     >                              
  0.0.160d                                     >                             v
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
====================================================================
  Zdev setup                                                      
====================================================================
  ID                          ONLINE  NAMES                                  ^
                                                                             │
  dasd-eckd                                                                   
  0.0.1600                                     >                              
  0.0.1601                    online  dasda    >                              
  0.0.1602                                     >                              
  0.0.1603                                     >                              
  0.0.1604                                     >                              
  0.0.1605                                     >                              
  0.0.1606                                     >                              
  0.0.1607                                     >                              
  0.0.1608                                     >                              
  0.0.1609                                     >                              
  0.0.160a                                     >                              
  0.0.160b                                     >                              
  0.0.160c                                     >                              
  0.0.160d                                     >                             v
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
```

- One may hit the End key here – that will automatically scroll down to the bottom of the Z devices list and screen:
  可以在此处按 End 下键 - 它将自动向下滚动到 Z 设备列表和屏幕的底部：

```auto
====================================================================
  Zdev setup                                                      
====================================================================
  0.0.f1de:0.0.f1df                            >                             ^
  0.0.f1e0:0.0.f1e1                            >                              
  0.0.f1e2:0.0.f1e3                            >                              
  0.0.f1e4:0.0.f1e5                            >                              
  0.0.f1e6:0.0.f1e7                            >                              
  0.0.f1e8:0.0.f1e9                            >                              
  0.0.f1ea:0.0.f1eb                            >                              
  0.0.f1ec:0.0.f1ed                            >                              
  0.0.f1ee:0.0.f1ef                            >                              
  0.0.f1f0:0.0.f1f1                            >                              
  0.0.f1f2:0.0.f1f3                            >                              
  0.0.f1f4:0.0.f1f5                            >                              
  0.0.f1f6:0.0.f1f7                            >                              
  0.0.f1f8:0.0.f1f9                            >                              
  0.0.f1fa:0.0.f1fb                            >                              
  0.0.f1fc:0.0.f1fd                            >                             │
  0.0.f1fe:0.0.f1ff                            >                             v
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
====================================================================
  Network connections                                             
====================================================================
  Configure at least one interface this server can use to talk to other       
  machines, and which preferably provides sufficient access for updates.      
                                                                              
    NAME          TYPE  NOTES                                                 
  [ encc000       eth   -                > ]                                  
    72:00:bb:00:aa:11 / Unknown Vendor / Unknown Model                        
                                                                              
  [ encc000.1234  vlan  -                > ]                                  
    static        10.222.111.11/24                                            
    VLAN 1234 on interface encc000                                            
                                                                              
  [ Create bond > ]                                                           
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Continue   ]                               
                                 [ Back       ]                               
```

- Depending on the installer version you are using you may face a little bug here.
  根据您使用的安装程序版本，您可能会在这里遇到一个小错误。
   In that case the button will be named ‘Continue without network’, but  the network is there. If you see that, just ignore it and continue …
  在这种情况下，该按钮将被命名为“在没有网络的情况下继续”，但网络就在那里。如果您看到这一点，请忽略它并继续......
   (If you wait long enough the label will be refreshed and corrected.)
  （如果等待的时间足够长，标签将被刷新和更正。

```auto
====================================================================
  Configure proxy                                                 
====================================================================
  If this system requires a proxy to connect to the internet, enter its       
  details here.                                                               
                                                                              
  Proxy address:                                                              
                  If you need to use a HTTP proxy to access the outside world,
                  enter the proxy information here. Otherwise, leave this     
                  blank.                                                      
                                                                              
                  The proxy information should be given in the standard form  
                  of "http://[[user][:pass]@]host[:port]/".                   
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Configure Ubuntu archive mirror                                 
====================================================================
  If you use an alternative mirror for Ubuntu, enter its details here.        
                                                                              
  Mirror address:  http://ports.ubuntu.com/ubuntu-ports                       
                   You may provide an archive mirror that will be used instead
                   of the default.                                            
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Guided storage configuration                                    
====================================================================
  Configure a guided storage layout, or create a custom one:                  
                                                                              
  (X)  Use an entire disk                                                     
                                                                              
       [ 0X1601       local disk 6.877G                                    v ]
                                                                              
       [ ]  Set up this disk as an LVM group                                  
                                                                              
            [ ]  Encrypt the LVM group with LUKS                              
                                                                              
                         Passphrase:                                          
                                                                              
                                                                              
                 Confirm passphrase:                                          
                                                                              
                                                                              
  ( )  Custom storage layout                                                  
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Storage configuration                                           
====================================================================
  FILE SYSTEM SUMMARY                                                        ^
                                                                             │
    MOUNT POINT     SIZE    TYPE      DEVICE TYPE                            │
  [ /               6.875G  new ext4  new partition of local disk > ]        │
                                                                             │
                                                                             │
  AVAILABLE DEVICES                                                          │
                                                                             │
    No available devices                                                     │
                                                                             │
  [ Create software RAID (md) > ]                                            │
  [ Create volume group (LVM) > ]                                            │
                                                                              
                                                                              
  USED DEVICES                                                                
                                                                             v
                                                                              
                                 [ Done       ]                               
                                 [ Reset      ]                               
                                 [ Back       ]                               
====================================================================
  Storage configuration                                           
====================================================================
  FILE SYSTEM SUMMARY                                                        ^
                                                                             │

   ┌────────────────────── Confirm destructive action ──────────────────────┐
   │                                                                        │
   │  Selecting Continue below will begin the installation process and      │
   │  result in the loss of data on the disks selected to be formatted.     │
   │                                                                        │
   │  You will not be able to return to this or a previous screen once the  │
   │  installation has started.                                             │
   │                                                                        │
   │  Are you sure you want to continue?                                    │
   │                                                                        │
   │                             [ No         ]                             │
   │                             [ Continue   ]                             │
   │                                                                        │
   └────────────────────────────────────────────────────────────────────────┘

                                 [ Reset      ]                               
                                 [ Back       ]                               
====================================================================
  Profile setup                                                   
====================================================================
  Enter the username and password you will use to log in to the system. You   
  can configure SSH access on the next screen but a password is still needed  
  for sudo.                                                                   
                                                                              
              Your name:  Ed Example                                              
                                                                              
                                                                              
     Your server's name:  s1lp11                                              
                          The name it uses when it talks to other computers.  
                                                                              
        Pick a username:  ubuntu                                              
                                                                              
                                                                              
      Choose a password:  ********                                            
                                                                              
                                                                              
  Confirm your password:  ********                                            
                                                                              
                                                                              
                                 [ Done       ]                               
====================================================================
  SSH Setup                                                       
====================================================================
  You can choose to install the OpenSSH server package to enable secure remote
  access to your server.                                                      
                                                                              
                   [ ]  Install OpenSSH server                                
                                                                              
                                                                              
  Import SSH identity:  [ No             v ]                                  
                        You can import your SSH keys from Github or Launchpad.
                                                                              
      Import Username:                                                        
                                                                              
                                                                              
                   [X]  Allow password authentication over SSH                
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
```

- It’s a nice and convenient new feature to add the user’s SSH keys during the installation to the system, since that makes the system login  password-less for the initial login!
  在安装过程中将用户的 SSH 密钥添加到系统是一个很好且方便的新功能，因为这会使系统登录在初始登录时无密码！

```auto
====================================================================
  SSH Setup                                                       
====================================================================
  You can choose to install the OpenSSH server package to enable secure remote
  access to your server.                                                      
                                                                              
                   [X]  Install OpenSSH server                                
                                                                              
                                                                              
  Import SSH identity:  [ from Launchpad v ]                                  
                        You can import your SSH keys from Github or Launchpad.
                                                                              
   Launchpad Username:  user                                               
                        Enter your Launchpad username.                        
                                                                              
                   [X]  Allow password authentication over SSH                
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  SSH Setup                                                       
====================================================================
  You can choose to install the OpenSSH server package to enable secure remote
  access to your server.                                                      

   ┌─────────────────────────── Confirm SSH keys ───────────────────────────┐
   │                                                                        │
   │  Keys with the following fingerprints were fetched. Do you want to     │
   │  use them?                                                             │
   │                                                                        │
   │  2048 SHA256:joGscmiamcaoincinaäonnväineorviZEdDWdR9Hpbc2KIw user@W520  │
   │   (RSA)                                                                │
   │  521 SHA256:T3JzxvB6K1Gzidvoidhoidsaoicak0jhhgvbw01F7/fZ2c                │
   │  ed.example@acme.com  (ECDSA)                                   │
   │                                                                        │
   │                             [ Yes        ]                             │
   │                             [ No         ]                             │
   │                                                                        │
   └────────────────────────────────────────────────────────────────────────┘

                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Featured Server Snaps                                           
====================================================================
  These are popular snaps in server environments. Select or deselect with     
  SPACE, press ENTER to see more details of the package, publisher and        
  versions available.                                                         
                                                                              
  [ ] kata-containers Lightweight virtual machines that seamlessly plug into >
  [ ] docker          Docker container runtime                               >
  [ ] mosquitto       Eclipse Mosquitto MQTT broker                          >
  [ ] etcd            Resilient key-value store by CoreOS                    >
  [ ] stress-ng       A tool to load, stress test and benchmark a computer s >
  [ ] sabnzbd         SABnzbd                                                >
  [ ] wormhole        get things from one computer to another, safely        >
  [ ] slcli           Python based SoftLayer API Tool.                       >
  [ ] doctl           DigitalOcean command line tool                         >
  [ ] keepalived      High availability VRRP/BFD and load-balancing for Linu >
  [ ] juju            Simple, secure and stable devops. Juju keeps complexit >
                                                                              
                                                                              
                                                                              
                                 [ Done       ]                               
                                 [ Back       ]                               
====================================================================
  Install complete!                                               
====================================================================
  ┌──────────────────────────────────────────────────────────────────────────┐
  │          configuring raid (mdadm) service                               ^│
  │          installing kernel                                               │
  │          setting up swap                                                 │
  │          apply networking config                                         │
  │          writing etc/fstab                                               │
  │          configuring multipath                                           │
  │          updating packages on target system                              │
  │          configuring pollinate user-agent on target                      │
  │          updating initramfs configuration                                │
  │    finalizing installation                                               │
  │      running 'curtin hook'                                               │
  │        curtin command hook                                               │
  │    executing late commands                                               │
  │final system configuration                                                │
  │  configuring cloud-init                                                 ││
  │  installing openssh-server \                                            v│
  └──────────────────────────────────────────────────────────────────────────┘

                               [ View full log ]
====================================================================
  Installation complete!                                          
====================================================================
  ┌──────────────────────────── Finished install! ───────────────────────────┐
  │          apply networking config                                        ^│
  │          writing etc/fstab                                               │
  │          configuring multipath                                           │
  │          updating packages on target system                              │
  │          configuring pollinate user-agent on target                      │
  │          updating initramfs configuration                                │
  │    finalizing installation                                               │
  │      running 'curtin hook'                                               │
  │        curtin command hook                                               │
  │    executing late commands                                               │
  │final system configuration                                                │
  │  configuring cloud-init                                                  │
  │  installing openssh-server                                               │
  │  restoring apt configuration                                            ││
  │downloading and installing security updates                              v│
  └──────────────────────────────────────────────────────────────────────────┘

                               [ View full log ]
                               [ Reboot        ]
  Installation complete!                                          
====================================================================
  ┌──────────────────────────── Finished install! ───────────────────────────┐
  │          apply networking config                                        ^│
  │          writing etc/fstab                                               │
  │          configuring multipath                                           │
  │          updating packages on target system                              │
  │          configuring pollinate user-agent on target                      │
  │          updating initramfs configuration                                │
  │    finalizing installation                                               │
  │      running 'curtin hook'                                               │
  │        curtin command hook                                               │
  │    executing late commands                                               │
  │final system configuration                                                │
  │  configuring cloud-init                                                  │
  │  installing openssh-server                                               │
  │  restoring apt configuration                                            ││
  │downloading and installing security updates                              v│
  └──────────────────────────────────────────────────────────────────────────┘

                               [ Connection to 10.222.111.11 closed by remote host.                            [ Rebooting...  ]
Connection to 10.222.111.11 closed.
user@workstation:~$ 
```

- Now type `reset` to clear the screen and reset it to its defaults.
  现在键入 `reset` 以清除屏幕并将其重置为默认值。

- Before proceeding one needs to remove the old, temporary host key of the  target system, since it was only for use during the installation:
  在继续操作之前，需要删除目标系统的旧临时主机密钥，因为它仅供在安装期间使用：

  ```auto
  user@workstation:~$ ssh-keygen -f "/home/user/.ssh/known_hosts" -R "s1lp11"
  # Host s1lp11 found: line 159
  /home/user/.ssh/known_hosts updated.
  Original contents retained as /home/user/.ssh/known_hosts.old
  user@workstation:~$
  ```

- And assuming the post-installation reboot is done, one can now login:
  假设安装后重新启动完成，现在可以登录：

  ```auto
  user@workstation:~$ ssh ubuntu@s1lp11
  Warning: Permanently added the ECDSA host key for IP address
  '10.222.111.11' to the list of known hosts.
  Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-42-generic s390x)
   
   * Documentation:  https://help.ubuntu.com
   * Management:     https://landscape.canonical.com
   * Support:        https://ubuntu.com/pro
  
    System information as of Wed 03 Jun 2020 05:50:05 PM UTC
  
    System load: 0.08              Memory usage: 2%   Processes:       157
    Usage of /:  18.7% of 6.70GB   Swap usage:   0%   Users logged in: 0
  
  0 updates can be installed immediately.
  0 of these updates are security updates.
  
  The programs included with the Ubuntu system are free software;
  the exact distribution terms for each program are described in the
  individual files in /usr/share/doc/*/copyright.
  
  Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law.
  
  To run a command as administrator (user "root"), use "sudo <command>".
  See "man sudo_root" for details.
  
  ubuntu@s1lp11:~$ uptime
   17:50:09 up 1 min,  1 user,  load average: 0.08, 0.11, 0.05
  ubuntu@s1lp11:~$ lsb_release -a
  No LSB modules are available.
  Distributor ID:	Ubuntu
  Description:	Ubuntu 20.04.5 LTS
  Release:	20.04
  Codename:	focal
  ubuntu@s1lp11:~$ uname -a
  Linux s1lp11 5.4.0-42-generic #30-Ubuntu SMP Wed Aug 05 16:57:22 UTC 2020 s390x s390x s390x GNU/Linux
  ubuntu@s1lp11:~$ exit
  logout
  Connection to s1lp11 closed.
  user@workstation:~$
  ```

Done ! 做！

------

# Non-interactive IBM Z LPAR (s390x) installation using autoinstall 使用自动安装进行非交互式 IBM Z LPAR （s390x） 安装

This non-interactive installation uses ‘autoinstall’, which can be  considered the successor to the Debian installer (d-i) and preseed on  Ubuntu. This is a detailed step-by-step guide, including output and logs (which are partially a bit shortened, as indicated by ‘…’, to limit the size of this document).
这个非交互式安装使用“自动安装”，它可以被认为是 Debian 安装程序 （d-i） 的继任者，并在 Ubuntu 上预置。这是一个详细的分步指南，包括输出和日志（部分缩短，如“...”所示，以限制本文档的大小）。

The example logical partition (LPAR) here uses zFCP storage and is connected to a VLAN network.
此处的示例逻辑分区 （LPAR） 使用 zFCP 存储并连接到 VLAN 网络。
 For a DASD and a non-VLAN network example, please see the [non-interactive IBM z/VM (s390x) autoinstallation](https://ubuntu.com/server/docs/non-interactive-ibm-z-vm-autoinstall-s390x) guide.
有关 DASD 和非 VLAN 网络示例，请参阅非交互式 IBM z/VM （s390x） 自动安装指南。

- Start with the preparation of the (FTP) install server (if it doesn’t already exist).
  从准备 （FTP） 安装服务器（如果尚不存在）开始。

  ```bash
  user@local:~$ ssh admin@installserver.local
  admin@installserver:~$ mkdir -p /srv/ftp/ubuntu-daily-live-server-20.04
  admin@installserver:~$ wget http://cdimage.ubuntu.com/ubuntu-server/focal/daily-live/current/focal-live-server-s390x.iso --directory-prefix=/srv/ftp/ubuntu-daily-live-server-20.04
  --2020-06-26 12:18:48--  http://cdimage.ubuntu.com/ubuntu-server/focal/daily-live/current/focal-live-server-s390x.iso
  Resolving cdimage.ubuntu.com (cdimage.ubuntu.com)... 2001:67c:1560:8001::1d, 2001:67c:1360:8001::28, 2001:67c:1360:8001::27, 
   ...
  Connecting to cdimage.ubuntu.com (cdimage.ubuntu.com)|2001:67c:1560:8001::1d|:80... connected.
  HTTP request sent, awaiting response... 200 OK
  Length: 700952576 (668M) [application/x-iso9660-image]
  Saving to: ‘focal-live-server-s390x.iso’
  
  focal-live-server-s 100%[===================>] 668.48M  2.73MB/s    in 4m 54s  
  
  2020-06-26 12:23:42 (2.27 MB/s) - ‘focal-live-server-s390x.iso’ saved [700952576/700952576]
  admin@installserver:~$
  ```

- The ISO image needs to be extracted now. Since files in its boot folder  need to be modified, loopback mount is not an option here:
  现在需要提取 ISO 映像。由于需要修改其启动文件夹中的文件，因此此处无法选择环回挂载：

  ```bash
  admin@installserver:~$ cd /srv/ftp/ubuntu-daily-live-server-20.04
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ mkdir iso
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ sudo mount -o loop ./focal-live-server-s390x.iso ./iso
  [sudo] password for admin: 
  mount: /home/user/iso-test/iso: WARNING: device write-protected, mounted read-only.
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ ls -l
  total 684530
  -rw-rw-r--  1 user user 700952576 Jun 26 10:12 focal-live-server-s390x.iso
  dr-xr-xr-x 10 root    root         2048 Jun 26 10:12 iso
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ rsync -rtvz ./iso/ . && sync
  sending incremental file list
  skipping non-regular file "ubuntu"
  skipping non-regular file "ubuntu-ports"
  ./
  README.diskdefines
  boot.catalog
  md5sum.txt
  ubuntu.ins
  skipping non-regular file "dists/stable"
  skipping non-regular file "dists/unstable"
  .disk/
  .disk/base_installable
  .disk/casper-uuid-generic
  .disk/cd_type
  .disk/info
  boot/
  boot/README.boot
  boot/initrd.off
  boot/initrd.siz
  boot/initrd.ubuntu
  boot/kernel.ubuntu
  boot/parmfile.ubuntu
  boot/ubuntu.exec
  boot/ubuntu.ikr
  boot/ubuntu.ins
  casper/
    ...
  sent 681,509,758 bytes  received 1,857 bytes  22,344,643.11 bytes/sec
  total size is 700,317,941  speedup is 1.03
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ ls -l
  total 684578
  dr-xr-xr-x  2 user user      4096 Jun 26 10:12 boot
  -r--r--r--  1 user user      2048 Jun 26 10:12 boot.catalog
  dr-xr-xr-x  3 user user      4096 Jun 26 10:12 casper
  dr-xr-xr-x  3 user user      4096 Jun 26 10:11 dists
  -rw-rw-r--  1 user user 700952576 Jun 26 10:12 focal-live-server-s390x.iso
  dr-xr-xr-x  2 user user      4096 Jun 26 10:11 install
  dr-xr-xr-x 10 root    root         2048 Jun 26 10:12 iso
  -r--r--r--  1 user user      4944 Jun 26 10:12 md5sum.txt
  dr-xr-xr-x  2 user user      4096 Jun 26 10:11 pics
  dr-xr-xr-x  3 user user      4096 Jun 26 10:11 pool
  dr-xr-xr-x  2 user user      4096 Jun 26 10:11 preseed
  -r--r--r--  1 user user       236 Jun 26 10:11 README.diskdefines
  -r--r--r--  1 user user       185 Jun 26 10:12 ubuntu.ins
  ```

- Now create ins and parm files dedicated to the LPAR that will be installed (here `zlinlpar`), based on the default ins and parm files that are shipped with the ISO image:
  现在，根据 ISO 映像附带的默认 ins 和 parm 文件，创建专用于将要安装的 LPAR 的 ins 和 parm 文件（此处 `zlinlpar` ）：

  ```bash
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ chmod -R +rw ./boot
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ cp ./boot/ubuntu.ins ./boot/ubuntu_zlinlpar.ins
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ cp ./boot/parmfile.ubuntu ./boot/parmfile.zlinlpar
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ 
  ```

  ```bash
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ vi ./boot/ubuntu_zlinlpar.ins
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ cat ./boot/ubuntu_zlinlpar.ins
  * Ubuntu for z Series (default kernel)
  kernel.ubuntu 0x00000000
  initrd.off 0x0001040c
  initrd.siz 0x00010414
  parmfile.zlinlpar 0x00010480
  initrd.ubuntu 0x01000000
  admin@installserver:~$ 
  ```

  ```bash
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ vi ./boot/parmfile.zlinlpar
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ cat ./boot/parmfile.zlinlpar
  ```

  ```bash
  ip=10.11.12.42::10.11.12.1:255.255.255.0:zlinlpar:encc000.4711:none:10.11.12.1 vlan=encc000.4711:encc000 url=http://installserver.local:80/ubuntu-daily-live-server-20.04/focal-live-server-s390x.iso autoinstall ds=nocloud-net;s=http://installserver.local:80/autoinstall/zlinlpar/ --- quiet
  ```

- Now make sure an FTP server is running in the *installserver* with `/srv/ftp` as ftp-server root (as used in this example).
  现在，确保FTP服务器在安装服务器 `/srv/ftp` 中以ftp-server root身份运行（如本例中使用）。

- Now prepare an *autoinstall* (HTTP) server, which hosts the configuration data for the non-interactive installation.
  现在准备一个自动安装 （HTTP） 服务器，该服务器承载非交互式安装的配置数据。

  ```bash
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ mkdir -p /srv/www/autoinstall/zlinlpar
  admin@installserver:/srv/ftp/ubuntu-daily-live-server-20.04$ cd /srv/www/autoinstall/zlinlpar
  admin@installserver:/srv/www/autoinstall/zlinlpar$ 
  admin@installserver:/srv/www/autoinstall/zlinlpar$ echo "instance-id: $(uuidgen || openssl rand -base64 8)" > meta-data
  admin@installserver:/srv/www/autoinstall/zlinlpar$ cat meta-data
  instance-id: 2c2215fb-6a38-417f-b72f-376b1cc44f01
  admin@installserver:/srv/www/autoinstall/zlinlpar$
  ```

  ```bash
  admin@installserver:/srv/www/autoinstall/zlinlpar$ vi user-data
  admin@installserver:/srv/www/autoinstall/zlinlpar$ cat user-data
  #cloud-config
  autoinstall:
    version: 1
    refresh-installer:
      update: yes
    reporting:
      builtin:
        type: print
    apt:
      preserve_sources_list: false
      primary:
      - arches: [amd64, i386]
        uri: http://archive.ubuntu.com/ubuntu
      - arches: [default]
        uri: http://ports.ubuntu.com/ubuntu-ports
    keyboard:
      layout: en
      variant: us
    locale: en_US
    identity:
      hostname: zlinlpar
      password: 
  "$6$ebJ1f8wxED22bTL4F46P0"
        username: ubuntu
      user-data:
        timezone: America/Boston
        users:
          - name: ubuntu
            password: 
  "$6$KwuxED22bTL4F46P0"
            lock_passwd: false
      early-commands:
        - touch /tmp/lets_activate_the_s390x_devices
        - chzdev zfcp -e e000
        - chzdev zfcp -e e100
        - chzdev zfcp-lun -e --online
        - touch /tmp/s390x_devices_activation_done
      network:
        ethernets:
          encc000: {}
        version: 2
        vlans:
          encc000.4711:
            addresses: [10.11.12.42/24]
            gateway4: 10.11.12.1
            id: 4711
            link: encc000
            nameservers:
              addresses: [10.11.12.1]
      ssh:
        install-server: true
        allow-pw: true
        authorized-keys: ['ssh-rsa  meQwtZ user@workstation # ssh-import-id lp:user']
    admin@installserver:~$
  ```

- For s390x installations the `early-commands` section is the interesting part:
  对于 s390x 安装，该 `early-commands` 部分是有趣的部分：

  ```bash
  early-commands:
    - touch /tmp/lets_activate_the_s390x_devices
    - chzdev zfcp -e e000
    - chzdev zfcp -e e100
    - chzdev zfcp-lun -e --online
    - touch /tmp/s390x_devices_activation_done
  ```

  The first and last `early-commands` are optional; they only frame and indicate the real s390x command activation.
  第一个和最后一个 `early-commands` 是可选的;它们仅帧并指示真正的 S390X 命令激活。

  In this particular example, two zFCP hosts (host-bus-adapters) are enabled via their addresses *e000* (`chzdev zfcp -e e000`) and *e100* (`chzdev zfcp -e e000`). These have certain logical unit numbers (LUNs) assigned that are all automatically discovered and activated by `chzdev zfcp-lun -e --online`.
  在此特定示例中，两个 zFCP 主机（主机总线适配器）通过其地址 e000 （ `chzdev zfcp -e e000` ） 和 e100 （ `chzdev zfcp -e e000` ）启用。它们分配了某些逻辑单元号 （LUN），这些逻辑单元号都由 `chzdev zfcp-lun -e --online` 自动发现和激活。

  Activation of a direct-access storage device (DASD) would look like this: `chzdev dasd -e 1f00`, and a qeth device activation looks like: `chzdev qeth -e c000`.
  直接访问存储设备 （DASD） 的激活如下所示： `chzdev dasd -e 1f00` ，qeth 设备激活如下所示： `chzdev qeth -e c000` 。

> **See also**: 另请参阅：
>  For more details about the autoinstall config options, please have a look at the [autoinstall reference](https://ubuntu.com/server/docs/install/autoinstall-reference) and [autoinstall schema](https://ubuntu.com/server/docs/install/autoinstall-schema) pages.
> 有关自动安装配置选项的更多详细信息，请查看自动安装参考和自动安装架构页面。

- Now make sure a HTTP server is running with `/srv/www` as web-server root (in this particular example).
  现在，确保 HTTP 服务器以 `/srv/www` Web 服务器根目录（在此特定示例中）运行。

- Next steps need to be done at the hardware management console (HMC). First,  connect to the HMC and proceed with the ‘Load From Removable Media and  Server’ task.
  后续步骤需要在硬件管理控制台 （HMC） 上完成。首先，连接到 HMC 并继续执行“从可移动介质和服务器装入”任务。

- Then, start the ‘Load from Removable Media or Server’ task under ‘Recovery’ → ‘Load from Removable Media or Server’ on your specific LPAR that you  are going to install, and fill out the following fields (the contents  will be of course different on your system):
  然后，在要安装的特定LPAR上启动“恢复”下→“从可移动媒体或服务器加载”下的“从可移动媒体或服务器加载”任务，并填写以下字段（内容当然会有所不同）：

  ```bash
  FTP Source 	
  Host computer:	installserver.local
  User ID:	ftpuser
  Password: ********
  Account (optional):	
  File location (optional): ubuntu-daily-live-server-20.04/boot
  ```

- Now confirm the entered data and click ‘OK’.
  现在确认输入的数据，然后单击“确定”。

- At the ‘Load from Removable Media or Server - Select Software to Install’  screen, choose the LPAR that is going to be installed, here:
  在“从可移动媒体或服务器加载 - 选择要安装的软件”屏幕中，选择要安装的 LPAR，如下所示：

  ```bash
  ubuntu-daily-live-server-20.04/boot/ubuntu_zlinlpar.ins   Ubuntu for z Series (default kernel)
  ```

- Confirm again with ‘OK’.
  再次用“确定”确认。

- And another confirmation about the ‘Load will cause jobs to be cancelled’.
  另一个关于“加载将导致作业被取消”的确认。

- Then, another ‘Yes’ – understanding that it’s a disruptive task:
  然后，另一个“是”——理解这是一项破坏性的任务：

  ```bash
  Disruptive Task Confirmation : Load from Removable Media or Server
  ```

- Now monitor the ‘Load from Removable media or Server Progress’ screen and  confirm it once again when the status changes from ‘Please wait while  the image is being loaded.’ to ‘Success’.
  现在监视“从可移动媒体或服务器进度加载”屏幕，并在状态从“加载图像时请稍候”更改为“成功”时再次确认。

- Then navigate to ‘Daily’ → ‘Operating System Messages’ to monitor the initial program load (IPL) of the install system …
  然后导航到“每日”→“操作系统消息”以监视安装系统的初始程序加载 （IPL） ...

  ```bash
  Message
  chzdev: Unknown device type or device ID format: c000.4711
  Use 'chzdev --help' for more information
  QETH device 0.0.c000:0.0.c001:0.0.c002 configured
  IP-Config: encc000.4711 hardware address 1a:3c:99:55:2a:ef mtu 1500
  IP-Config: encc000.4711 guessed broadcast address 10.11.12.255
  IP-Config: encc000.4711 complete:
  address: 10.11.12.42    broadcast: 10.11.12.255   netmask: 255.255.255.0
  
  gateway: 10.11.12.1     dns0     : 10.11.12.1     dns1   : 0.0.0.0
  
  host   : zlinlpar
  rootserver: 0.0.0.0 rootpath:
  filename  :
  Connecting to installserver.local:80 (installserver.local:80)
  focal-live-server-s3   5% |*                               | 39.9M  0:00:15 ETA
  focal-live-server-s3  22% |*******                         |  147M  0:00:07 ETA
  focal-live-server-s3  38% |************                    |  254M  0:00:04 ETA
  focal-live-server-s3  53% |*****************               |  355M  0:00:03 ETA
  focal-live-server-s3  67% |*********************           |  453M  0:00:02 ETA
  focal-live-server-s3  81% |**************************      |  545M  0:00:01 ETA
  focal-live-server-s3  94% |*****************************  |  633M  0:00:00 ETA
  focal-live-server-s3 100% |******************************|  668M  0:00:00 ETA
  mount: mounting /cow on /root/cow failed: No such file or directory
  Connecting to plymouth: Connection refused
  passwd: password expiry information changed.
  Using CD-ROM mount point /cdrom/
  Identifying... [5d25356068b713167814807dd678c261-2]
  Scanning disc for index files...
  Found 2 package indexes, 0 source indexes, 0 translation indexes and 1 signature
  Found label 'Ubuntu-Server 20.04 LTS _Focal Fossa_ - Release s390x (20200616)'
  This disc is called:
  'Ubuntu-Server 20.04 LTS _Focal Fossa_ - Release s390x (20200616)'
  ...
  [   61.190916] cloud-init[2076]: Cloud-init v. 20.1-10-g71af48df-0ubuntu5 running
  'modules:final' at Fri, 26 Jun 2020 11:02:01 +0000. Up 61.09 seconds.
  [   61.191002] cloud-init[2076]: ci-info: no authorized SSH keys fingerprints fo
  und for user installer.
  [   61.191071] cloud-init[2076]: Cloud-init v. 20.1-10-g71af48df-0ubuntu5 finished at Fri, 26 Jun 2020 11:02:01 +0000.
  Datasource DataSourceNoCloudNet [seed=cmdline,
  /var/lib/cloud/seed/nocloud,
  http://installserver.local:80/autoinstall/zlinlpar/]
  [dsmode=net].  Up 61.18 seconds
  [   61.191136] cloud-init[2076]: Welcome to Ubuntu Server Installer!
  [   61.191202] cloud-init[2076]: Above you will find SSH host keys and a random
  password set for the `installer` user. You can use these credentials to ssh-in
  and complete the installation. If you provided SSH keys in the cloud-init datasource,
  they were also provisioned to the installer user.
  [   61.191273] cloud-init[2076]: If you have access to the graphical console,
  like TTY1 or HMC ASCII terminal you can complete the installation there too.
  
  It is possible to connect to the installer over the network, which
  might allow the use of a more capable terminal.
  
  To connect, SSH to installer@10.11.12.42.
  
  The password you should use is ''i7UFdP8fhiVVMme3qqH8''.
  
  The host key fingerprints are:
  
  RSA     SHA256:rBXLeUke3D4gKdsruKEajHjocxc9hr3PI
  ECDSA   SHA256:KZZYFswtKxFXWQPuQS9QpOBUoS6RHswis
  ED25519 SHA256:s+5tZfagx0zffC6gYRGW3t1KcBH6f+Vt0
  
  Ubuntu 20.04 LTS ubuntu-server sclp_line0
  ```

- At short notice, you can even log in to the system with the user  ‘installer’ and the temporary password that was given at the end of the  boot-up process (see above) of the installation system:
  在短时间内，您甚至可以使用用户“安装程序”和在安装系统启动过程结束时提供的临时密码（见上文）登录系统：

  ```bash
  user@workstation:~$ ssh installer@zlinlpar
  The authenticity of host 'zlinlpar (10.11.12.42)' can't be established.
  ECDSA key fingerprint is SHA256:O/dU/D8jJAEGQcbqKGE9La24IRxUPLpzzs5li9F6Vvk.
  Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
  Warning: Permanently added 'zlinlpar,10.11.12.42' (ECDSA) to the list of known hosts.
  installer@zlinlpar's password: 
  Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-37-generic s390x)
  
   * Documentation:  https://help.ubuntu.com
   * Management:     https://landscape.canonical.com
   * Support:        https://ubuntu.com/pro
  
    System information as of Fri Jun 26 11:08:18 UTC 2020
  
    System load:    1.25      Memory usage: 4%   Processes:       192
    Usage of /home: unknown   Swap usage:   0%   Users logged in: 0
  
  0 updates can be installed immediately.
  0 of these updates are security updates.
  
  
  The list of available updates is more than a week old.
  To check for new updates run: sudo apt update
  
  
  The programs included with the Ubuntu system are free software;
  the exact distribution terms for each program are described in the
  individual files in /usr/share/doc/*/copyright.
  
  Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
  applicable law.
  
  the installer running on /dev/tty1 will perform the autoinstall
  
  press enter to start a shell
  ```

- Notice that it informs you about a currently-running autoinstall process:
  请注意，它会通知您当前正在运行的自动安装过程：

  ```bash
  the installer running on /dev/tty1 will perform the autoinstall
  ```

- Nevertheless, we can quickly check some things – though only until the autoinstall  process has finished and the post-install reboot has been triggered:
  尽管如此，我们还是可以快速检查一些事情——但前提是要完成自动安装过程并触发安装后重启：

  ```auto
  root@ubuntu-server:/# ls -l /tmp/lets_activate_the_s390x_devices 
  -rw-r--r-- 1 root root 0 Jun 26 11:08 /tmp/lets_activate_the_s390x_devices
  -rw-r--r-- 1 root root 0 Jun 26 11:09 /tmp/s390x_devices_activation_done
  
  root@ubuntu-server:/# lszdev | grep yes
  zfcp-host    0.0.e000                                        yes  yes   
  zfcp-host    0.0.e100                                        yes  yes   
  zfcp-lun     0.0.e000:0x50050763060b16b6:0x4026400200000000  yes  yes   sdb sg1
  zfcp-lun     0.0.e000:0x50050763061b16b6:0x4026400200000000  yes  yes   sda sg0
  zfcp-lun     0.0.e100:0x50050763060b16b6:0x4026400200000000  yes  yes   sdd sg3
  zfcp-lun     0.0.e100:0x50050763061b16b6:0x4026400200000000  yes  yes   sdc sg2
  qeth         0.0.c000:0.0.c001:0.0.c002                      yes  no    encc000
  root@ubuntu-server:/# 
  ```

- If you wait long enough you’ll see the remote session get closed:
  如果等待的时间足够长，则会看到远程会话被关闭：

  ```bash
  root@ubuntu-server:/# Connection to zlinlpar closed by remote host.
  Connection to zlinlpar closed.
  user@workstation:~$ 
  ```

- As well as at the console:
  以及在控制台上：

  ```bash
  ubuntu-server login:
  
  [[0;1;31mFAILED[0m] Failed unmounting [0;1;39m/cdrom[0m.
  [  169.161139] sd-umoun[15600]: Failed to unmount /oldroot: Device or resource busy
  [  169.161550] sd-umoun[15601]: Failed to unmount /oldroot/cdrom: Device or resource busy
  [  169.168118] shutdown[1]: Failed to finalize  file systems, loop devices, ignoring
  Total: 282 Selected: 0
  
  Command:
  ```

- …and that the post-install reboot gets triggered:
  ...并且会触发安装后重新启动：

  ```bash
  Message
  Mounting [0;1;39mKernel Configuration File System[0m...
  Starting [0;1;39mApply Kernel Variables[0m...
  [[0;32m  OK  [0m] Finished [0;1;39mRemount Root and Kernel File Systems[0m.
  [[0;32m  OK  [0m] Finished [0;1;39mUncomplicated firewall[0m.
  [[0;32m  OK  [0m] Mounted [0;1;39mFUSE Control File System[0m.
  [[0;32m  OK  [0m] Mounted [0;1;39mKernel Configuration File System[0m.
  ...
  [   35.378928] cloud-init[2565]: Cloud-init v. 20.1-10-g71af48df-0ubuntu5 runnin
  g 'modules:final' at Fri, 26 Jun 2020 11:10:44 +0000. Up 35.29 seconds.
  [   35.378978] cloud-init[2565]: Cloud-init v. 20.1-10-g71af48df-0ubuntu5 finish
  ed at Fri, 26 Jun 2020 11:10:44 +0000. Datasource DataSourceNone.  Up 35.37 seconds
  [   35.379008] cloud-init[2565]: 2020-06-26 11:10:44,359 - cc_final_message.py[W
  ARNING]: Used fallback datasource
  [[0;32m  OK  [0m] Finished [0;1;39mExecute cloud user/final scripts[0m.
  [[0;32m  OK  [0m] Reached target [0;1;39mCloud-init target[0m.
  
  zlinlpar login:
  ```

- With the completion of the reboot, the autoinstall is finished and the LPAR is ready to use:
  重新启动完成后，自动安装完成，LPAR 可供使用：

  ```auto
  user@workstation:~$ ssh-keygen -f "/home/user/.ssh/known_hosts" -R "zlinlpar"
  # Host zlinlpar found: line 163
  /home/user/.ssh/known_hosts updated.
  Original contents retained as /home/user/.ssh/known_hosts.old
  user@workstation:~$ ssh ubuntu@zlinlpar
  The authenticity of host 'zlinlpar (10.11.12.42)' can't be established.
  ECDSA key fingerprint is SHA256:iGtCArEg+ZnoZlgtOkvmyy0gPY8UEI+f7zoISOF+m/0.
  Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
  Warning: Permanently added 'zlinlpar,10.11.12.42' (ECDSA) to the list of known hosts.
  Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-39-generic s390x)
  
   * Documentation:  https://help.ubuntu.com
   * Management:     https://landscape.canonical.com
   * Support:        https://ubuntu.com/pro
  
    System information as of Fri 26 Jun 2020 11:12:23 AM UTC
  
    System load: 0.21               Memory usage: 3%   Processes:       189
    Usage of /:  28.2% of 30.88GB   Swap usage:   0%   Users logged in: 0
  
  10 updates can be installed immediately.
  0 of these updates are security updates.
  To see these additional updates run: apt list --upgradable
  
  The programs included with the Ubuntu system are free software;
  the exact distribution terms for each program are described in the
  individual files in /usr/share/doc/*/copyright.
  
  Ubuntu comes with ABSOLUTELY NO WARRANTY,
  to the extent permitted by applicable law.
  
  To run a command as administrator (user "root"), use "sudo <command>".
  See "man sudo_root" for details.
  
  ubuntu@zlinlpar:~$ uptime
   11:12:35 up 2 min,  1 user,  load average: 0.18, 0.17, 0.08
  ubuntu@zlinlpar:~$ lsb_release -a
  No LSB modules are available.
  Distributor ID:	Ubuntu
  Description:	Ubuntu 20.04 LTS
  Release:	20.04
  Codename:	focal
  ubuntu@zlinlpar:~$ uname -a
  Linux zlinlpar 5.4.0-39-generic #43-Ubuntu SMP Fri Jun 19 10:27:17
  UTC 2020 s390x s390x s390x 
  GNU/Linux
  ubuntu@zlinlpar:~$ lszdev | grep yes
  zfcp-host    0.0.e000                                        yes  yes   
  zfcp-host    0.0.e100                                        yes  yes   
  zfcp-lun     0.0.e000:0x50050763060b16b6:0x4026400200000000  yes  yes   
  sdb sg1
  zfcp-lun     0.0.e000:0x50050763061b16b6:0x4026400200000000  yes  yes   
  sda sg0
  zfcp-lun     0.0.e100:0x50050763060b16b6:0x4026400200000000  yes  yes   
  sdc sg2
  zfcp-lun     0.0.e100:0x50050763061b16b6:0x4026400200000000  yes  yes   
  sdd sg3
  qeth         0.0.c000:0.0.c001:0.0.c002                      yes  yes   encc000
  ubuntu@zlinlpar:~$ exit
  logout
  Connection to zlinlpar closed.
  user@workstation:~$
  ```

## Some closing notes 一些结束语

- 最好始终使用最新的安装程序和自动安装组件。请务必将安装程序更新到最新版本，或者仅使用当前的每日实时服务器映像。
- The ISO image specified with the kernel parameters needs to fit in the boot folder. Its kernel and initrd are specified in the ‘Load from Removable Media and Server’ task at the hardware management console (HMC).
  使用内核参数指定的 ISO 映像需要适合 boot 文件夹。其内核和 initrd 在硬件管理控制台 （HMC） 的“从可移动媒体和服务器装入”任务中指定。
- In addition to activating disk storage resources in `early-commands`, other devices like OSA/qeth can be added and activated there, too. This is not needed for the basic network device, as specified in the kernel  parameters used for the installation (that one is automatically  handled).
  除了激活磁盘 `early-commands` 存储资源外，还可以在那里添加和激活其他设备，如 OSA/qeth。基本网络设备不需要这样做，如用于安装的内核参数中指定的那样（自动处理该参数）。
- If everything is properly set up – FTP server for the image, HTTP server  for the autoinstall config files – the installation can be as quick as 2 to 3 minutes. Of course this depends on the complexity of the  autoinstall YAML file.
  如果一切设置正确 - 用于映像的FTP服务器，用于自动安装配置文件的HTTP服务器 - 安装速度可以快至2到3分钟。当然，这取决于自动安装 YAML 文件的复杂性。
- There is a simple way of generating a sample autoinstall YAML file; one can  perform an interactive Subiquity installation, grab the file `/var/log/installer/autoinstall-user-data`, and use it as an example – but beware that the `early-commands` entries to activate the s390x-specific devices need to be added manually!
  有一种简单的方法可以生成示例自动安装 YAML 文件;可以执行交互式 Subiquity 安装，抓取文件 `/var/log/installer/autoinstall-user-data` 并将其用作示例 - 但请注意，需要手动添加激活 s390x 特定设备 `early-commands` 的条目！
