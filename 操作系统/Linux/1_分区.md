## 分区

Partitioning will allow the installation of several operating systems because it is impossible to have several of them cohabit on the same  logical drive. Partitioning also allows the separation of data logically (security, access optimization, ...).

The division of the physical disk into partitioned volumes is  recorded in the partition table, stored in the first sector of the disk  (MBR: *Master Boot Record*).

!!! Warning There can be only one extended partition per physical  disk. In order to benefit from additional drives, the extended partition can be split into logical partitions

The *devices* are the files identifying the various hardware detected by the motherboard. These files are stored without `/dev`. The service which detects new devices and gives them names is called *udev*.

They are identified by their type.

Storage devices are named *hd* for IDE hard drives and *sd* for other media. Then comes a letter that starts with *a* for the first device, then *b*, *c*, ...

Finally we will find a number that defines the partitioned volume: *1* for the first primary partition, ...

!!! Warning Beware, the extended partition, which does not support a file system, still has a number.







最开始的时候，硬盘分区只有一种类型，就是主分区，但是由于 MBR（主引导记录）中只保留了 64B 存储空间，而每个分区要用 16B，所以一块硬盘只能分成 4个主分区。当硬盘很小的时候，4 个主分区足够使用。

 ![](../../Image/0/07-file-systems-001.png)

但是随着硬盘容量的不断增加，4 个分区已经不能满足需要了。这时为了分配更多的分区，就出现了扩展分区和逻辑分区。

 ![](../../Image/0/07-file-systems-002.png)

* 主分区 Primary 。由于 MBR 的限制，最多只能分配 4 个主分区。

* 扩展分区 Extended 。

  扩展分区在一块硬盘上只能有 1 个，而且扩展分区和主分区是平级的，也就是说，主分区加扩展分区最多只能有 4 个。扩展分区不能直接写入数据，也不能格式化，需要在扩展分区中再划分出逻辑分区才能使用。

* 逻辑分区。

  逻辑分区是在扩展分区中再划分出来的。在 Linux 系统中，IDE 硬盘最多有 59 个逻辑分区（加 4 个主分区最多能识别 63 个分区），SCSI 硬盘最多有 11 个逻辑分区（加 4 个主分区最多能识别 15 个分区）。

 ![](../../Image/0/07-file-systems-003.png)

There are at least two commands for partitioning a disk: `fdisk` and `cfdisk`. Both commands have an interactive menu. `cfdisk` is more reliable and better optimized, so it is best to use it.

The only reason to use `fdisk` is when you want to list all logical devices with the `-l` option.

```
sudo fdisk -l
sudo fdisk -l /dev/sdc
sudo fdisk -l /dev/sdc2
```

### `parted` command[¶](https://docs.rockylinux.org/zh/books/admin_guide/07-file-systems/#parted-command)

The `parted` (*partition editor*) command is able to partition a disk.

```
parted [-l] [device]
```

It also has a recovery function capable of rewriting a deleted partition table.

Under graphical interface, there is the very complete `gparted` tool: *G*nome *PAR*tition *ED*itor.

The `gparted -l` command lists all logical devices on a computer.

The `gparted` command alone will return to an interactive mode with its own internal options:

- `help` or an incorrect command will display these options.
- `print all` in this mode will have the same result as `gparted -l` on the command line.
- `quit` to return to the prompt.

### `cfdisk` command[¶](https://docs.rockylinux.org/zh/books/admin_guide/07-file-systems/#cfdisk-command)

The `cfdisk` command is used to manage partitions.

```
cfdisk device
```

Example:

```
$ sudo cfdisk /dev/sda
                                 Disk: /dev/sda
               Size: 16 GiB, 17179869184 bytes, 33554432 sectors
                       Label: dos, identifier: 0xcf173747
    Device        Boot       Start        End    Sectors   Size   Id Type
>>  /dev/sda1     *           2048    2099199    2097152     1G   83 Linux
    /dev/sda2              2099200   33554431   31455232    15G   8e Linux LVM
 lqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqk
 x Partition type: Linux (83)                                                 x
 x     Attributes: 80                                                         x
 xFilesystem UUID: 54a1f5a7-b8fa-4747-a87c-2dd635914d60                       x
 x     Filesystem: xfs                                                        x
 x     Mountpoint: /boot (mounted)                                            x
 mqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqj
     [Bootable]  [ Delete ]  [ Resize ]  [  Quit  ]  [  Type  ]  [  Help  ]
     [  Write ]  [  Dump  ]
```

The preparation, without *LVM*, of the physical media goes through five steps:

- Setting up the physical disk;
- Partitioning of the volumes (geographical division of the disk, possibility of installing several systems, ...);
- Creation of the file systems (allows the operating system to manage the files, the tree structure, the rights, ...);
- Mounting of file systems (registration of the file system in the tree structure);
- Manage user access.