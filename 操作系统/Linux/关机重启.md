# Linux 关机和重启

[TOC]

## 概述

正确的关机流程为：sync > shutdown > reboot > halt、

sync 将数据由内存同步到硬盘中。

## shutdown

shutdown 会给系统计划一个时间关机。可以被用于停止、关机、重启机器。

可以指定一个时间字符串（通常是 now 或者用 hh:mm 指定小时/分钟）作为第一个参数。额外地，也可以设置一个广播信息在系统关闭前发送给所有已登录的用户。

重要：如果使用了时间参数，系统关机前 5 分钟，会创建 `/run/nologin` 文件，以确保没有人可以再登录。

```bash
shutdown
shutdown now
shutdown 13:20  
shutdown -p now                                          # 关闭机器
shutdown -h now                                          # 停止机器      
shutdown -r 09:35                                        # 在 09:35am 重启机器
shutdown -c                                              # 取消即将进行的关机
shutdown –h 10 ‘This server will shutdown after 10 mins’ # 计算机将在10分钟后关机，并且会显示在登陆用户的当前屏幕中。
shutdown –h 20:25                                        # 系统会在今天20:25关机
shutdown –h +10                                          # 十分钟后关机
```

## halt

通知硬件来停止所有的 CPU 功能，但是仍然保持通电。可以用它使系统处于低层维护状态。注意在有些情况会它会完全关闭系统。

等同于 shutdown –h now 和 poweroff

```bash
halt               # 停止机器
halt -p            # 关闭机器
halt --reboot      # 重启机器
```

## poweroff

poweroff 会发送一个 ACPI 信号来通知系统关机。

```bash
poweroff           # 关闭机器
poweroff --halt    # 停止机器
poweroff --reboot  # 重启机器
```

## reboot

reboot 通知系统重启。

等同于 shutdown –r now 。

```bash
reboot             # 重启机器
reboot --halt      # 停止机器
reboot -p          # 关闭机器
```





