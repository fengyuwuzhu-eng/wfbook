# 安装

[TOC]

## 安装前准备

### 支持的构架

- AMD、Intel 和 ARM 64 位架构
- IBM Power Systems, Little Endian    (ppc64le)
  - IBM Power System LC 服务器 							
  - IBM Power System AC 服务器 							
  - IBM Power System L 服务器 							
- 64-bit IBM Z		                                  (s390x)

### 安装方法

- 基于 GUI 的安装

  * 使用客户门户网站中的 ISO 镜像安装 RHEL 。系统注册会在 GUI 安装完成后进行。Kickstart 支持该安装方法。
  * 从 Content Delivery Network 注册并安装 RHEL 。建议使用 Boot ISO 镜像文件作为引导，安装源默认为 CDN 。注册是在从 CDN 下载并安装软件包前执行的。Kickstart 支持该安装方法。
  * 使用 VNC 执行远程 RHEL 安装。安装程序提供两种 VNC 安装模式： Direct 和 Connect。建立连接后，这两种模式不会有所不同。选择的模式取决于环境。
  * 使用 PXE 从网络安装 RHEL。网络安装可将 Red Hat Enterprise Linux 安装到可访问安装服务器的系统。网络安装至少需要两个系统。 				

- 系统或云镜像安装

  只能在虚拟和云环境中使用系统或云镜像安装方法。要执行系统或基于云镜像的安装，需用 Red Hat Image Builder（红帽镜像构建器）。镜像构建器创建 Red Hat Enterprise Linux 的自定义系统镜像，包括用于云部署的系统镜像。 	

- 高级安装

  * 使用 Kickstart 执行自动 RHEL 安装。

  * 从 Content Delivery Network 注册并安装。


### ISO 类型

有两种可用安装 ISO 镜像。 			

- DVD ISO 镜像文件

  一个包含 BaseOS 和 AppStream 软件仓库的完整的安装程序，允许您在没有其它软件仓库的情况下完成安装。

- Boot ISO 镜像文件

  是一个最小的安装，可用来以两种不同的方式安装 RHEL：
  
  *  从内容交付网络(CDN)注册并安装 RHEL 时。
  * 作为最小镜像，需要访问 BaseOS 和 AppStream 软件仓库来安装软件包。软件仓库是 DVD ISO 镜像的一部分，下载并解包 DVD ISO 镜像来访问软件仓库。

| 构架              | 安装 DVD    | 引导 DVD     |
| ----------------- | ----------- | ------------ |
| AMD64 和 Intel 64 | x86_64 DVD  | x86_64 Boot  |
| ARM 64            | AArch64 DVD | AArch64 Boot |
| IBM POWER         | ppc64le DVD | ppc64le Boot |
| 64-bit IBM Z      | s390x DVD   | s390x Boot   |

## 使用图形用户界面安装

### 引导安装	

当系统完成载入引导介质后，使用 **GRand Unified Bootloader 版本 2** (GRUB2)显示 Red Hat Enterprise Linux 引导菜单。

引导菜单除启动安装程序外还提供一些选项。如果没有在 60 秒内进行选择，则将运行默认引导选项（高亮）。要选择不同的选项，使用键盘中的箭头键进行选择，然后按 **Enter** 键。 			

可以为某个特定菜单条目自定义引导选项： 			

- **在基于 BIOS 的系统上：** 按 **Tab** 键并在命令行中添加自定义引导选项。您还可以 **按 Esc 键** 访问 `boot:` 提示,但不会预先设置所需引导选项。在这种情况下，您必须总是在使用其它引导选项前指定 Linux 选项。 					
- **在基于 UEFI 的系统上：** 按 **e** 键并在命令行中添加自定义引导选项。准备好按 **Ctrl**+**X** 引导修改选项后。 					

| 引导菜单选项                                  | 描述                                                        |
| --------------------------------------------- | ----------------------------------------------------------- |
| Install Red Hat Enterprise Linux 8            | 使用这个选项使用图形安装程序安装 Red Hat Enterprise Linux。 |
| 测试这个介质并安装 Red Hat Enterprise Linux 8 | 使用这个选项检查安装介质的完整性。                          |
| Troubleshooting >                             | 使用这个选项解决各种安装问题。按 **Enter** 显示它的内容。   |

| 故障排除选项                                              | 描述                                                         |
| --------------------------------------------------------- | ------------------------------------------------------------ |
| Install Red Hat Enterprise Linux 8 in basic graphics mode | 这个选项使用图形模式安装红帽企业版 Linux,即使安装程序无法为您的显卡载入正确驱动程序。 |
| Rescue a Red Hat Enterprise Linux system                  | 使用这个选项修复所有阻止您引导的问题。                       |
| Run a memory test                                         | 使用这个选项在您的系统中运行内存测试。按 **Enter** 显示它的内容。 |
| Boot from local drive                                     | 使用这个选项从第一个安装的磁盘引导系统。如果您意外启动了这个磁盘，使用该选项立即从硬盘引导而不启动安装程序。 |

#### 引导选项类型

​					有两种引导选项： 带有 "=" 和没有带有 "=" 。引导选项会附加到引导命令行中，而且多个选项必须以单一空格分开。安装程序专用的引导选项总是以 `inst` 开始 。 			

- 带有 "=" 的选项

  ​								您必须为使用该 `=` 符号的引导选项指定一个值。例如，该 `inst.vncpassword=` 选项必须包含一个值，在本例中是一个密码。这个示例的正确语法是 `inst.vncpassword=password`。 						

- 没有 "=" 的选项

  ​								该引导选项不接受任何值或参数。例如：该 `rd.live.check` 选项强制安装程序在开始安装前验证安装介质。如果使用了这个选项，则执行验证; 如果没有使用这个选项，则会跳过验证。 						

### 编辑引导选项

​					本节介绍您从引导菜单中编辑引导选项的不同方法。引导菜单在您引导安装介质后打开。 			

#### 编辑 BIOS 中的 boot: 提示符

​					使用 `boot:` 提示符时，第一个选项必须总是指定您要载入的安装程序镜像文件。在大多数情况下，您可以使用关键字来指定镜像。您可以根据要求指定附加选项。 			

**先决条件**

- ​							已创建了可引导安装介质（USB、CD 或者 DVD）。 					
- ​							已使用该介质引导安装，并打开了安装引导菜单。 					

**流程**

1. ​							打开引导菜单后，按键盘上的 **Esc** 键。 					
2. ​							`boot:` 提示现在可以访问。 					
3. ​							按 **Tab** 键显示帮助命令。 					
4. ​							按 **Enter** 键启动安装。要从提示符 `boot:` 返回到引导菜单，请重启系统并再次从安装介质引导。 					

注意

​						`boot:` 提示也接受 `dracut` 内核选项。`dracut.cmdline(7)` man page 中包括了选项列表。 				

#### 编辑 > 提示符

​					您可以使用 `>` 提示编辑预定义的引导选项。例如： 在引导菜单中选择 **Test this media and install Red Hat Enterprise Linux 8.1** 来显示完整的选项。 			

注意

​						这个过程用于使用 BIOS 的 AMD64 和 Intel 64 系统。 				

**先决条件**

- ​							已创建了可引导安装介质（USB、CD 或者 DVD）。 					
- ​							已使用该介质引导安装，并打开了安装引导菜单。 					

**流程**

1. ​							在引导菜单中选择一个选项，然后按键盘上的 **Tab** 键。可访问该 `>` 提示符并显示可用选项。 					
2. ​							在提示符后附加您需要的选项 `>`。 					
3. ​							按 **Enter** 键开始安装。 					
4. ​							按 **Esc** 键取消编辑并返回引导菜单。 					

#### 编辑 GRUB2 菜单

​					基于 UEFI 的 AMD64、Intel 64 和 64 位 ARM 系统上有 GRUB2 菜单。 			

**先决条件**

- ​							已创建了可引导安装介质（USB、CD 或者 DVD）。 					
- ​							已使用该介质引导安装，并打开了安装引导菜单。 					

**流程**

1. ​							在引导菜单窗口中选择所需选项，然后在键盘中按 **e** 键。 					
2. ​							移动光标到内核命令行。在 UEFI 系统中，内核命令行以 `linuxefi` 开始。 					
3. ​							将光标移动到 `linuxefi` 内核命令行的末尾。 					
4. ​							根据需要编辑参数。例如：要配置一个或多个网络接口，在 `linuxefi` 内核命令行末尾添加 `ip=` 参数，后接所需的值。 					
5. ​							完成编辑后，按组合键 **Ctrl**+**X** 启动安装。 					

## 7.4. 使用 USB、CD 或者 DVD 引导安装

​					按照以下步骤使用 USB、CD 或者 DVD 引导 Red Hat Enterprise Linux 安装。以下步骤是通用的。具体步骤请参考您的硬件厂商文档。 			

**先决条件**

​						已创建了可引导安装介质（USB、CD 或者 DVD）。如需更多信息 [,请参阅创建可引导 DVD 或者 CD](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-an-installation-cd-or-dvd_assembly_creating-a-bootable-installation-medium)。 				

**流程**

1. ​							关闭您要安装 Red Hat Enterprise Linux 的系统。 					

2. ​							断开任何与系统的驱动器连接。 					

3. ​							打开系统。 					

4. ​							插入可引导安装介质（USB、DVD 或者 CD）。 					

5. ​							关闭系统但不删除引导介质。 					

6. ​							打开系统。 					

   注意

   ​								您可能需要按特定密钥或组合密钥从介质引导,或者配置系统的基本输入/输出系统(BIOS)以便从介质引导。如需更多信息，请参阅您系统附带的文档。 						

7. ​							**Red Hat Enterprise Linux 引导** 窗口会打开并显示有关各种可用引导选项的信息。 					

8. ​							使用键盘中的箭头键选择您需要的引导选项，然后按 **Enter** 键选择引导选项。**Welcome to Red Hat Enterprise Linux** 窗口将打开，您可以使用图形用户界面安装 Red Hat Enterprise Linux。 					

   注意

   ​								如果在 60 秒之内引导窗口中没有执行任何动作，安装程序会自动开始。 						

9. ​							（可选）编辑可用的引导选项： 					

   1. ​									**基于 UEFI 的系统：** 按 **E** 进入编辑模式。更改预定义的命令行以添加或删除引导选项。按 **Enter** 键确认您的选择。 							
   2. ​									**基于 BIOS 的系统：** 按键盘中的 **Tab 键** 进入编辑模式。更改预定义的命令行以添加或删除引导选项。按 **Enter** 键确认您的选择。 							

**其它资源**

- ​							有关使用图形用户界面安装 Red Hat Enterprise Linux 的详情请参考 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 					
- ​							有关您可以在引导命令行中使用的可用引导选项列表的详情请参考 [附录 C, *引导选项参考*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#custom-boot-options_installing-RHEL)。 					

## 7.5. 使用 PXE 从网络引导安装

​					同时在大量系统中安装 Red Hat Enterprise Linux 时，最好的方法是从 PXE 服务器引导，并从共享网络位置的源安装。按照以下介绍的步骤，使用 PXE 引导 Red Hat Enterprise Linux 安装。 			

注意

​						要使用 PXE 从网络引导安装过程，您必须使用物理网络连接，如以太网。您不能使用无线连接引导安装过程。 				

**先决条件**

- ​							您已经配置了 TFTP 服务器，同时系统中也有支持 PXE 的网络接口。如需更多信息，请参阅**附加资源**。 					
- ​							已将您的系统配置为从网络接口引导。这个选项在 BIOS 中，可标记为 **Network Boot** 或 **Boot Services**。 					
- ​							您已确认将 BIOS 配置为从指定的网络接口引导。一些 BIOS 将网络接口指定为可能的引导设备，但不支持 PXE  标准。如需更多信息，请参阅您的硬件文档。当您正确启用了 PXE 引导时，该系统可在没有任何介质的情况下引导 Red Hat Enterprise Linux 安装程序。 					

**流程**

1. ​							验证是否连接了网络电缆。网络插槽上的连接显示灯应该是亮的，即使没有开机也是如此。 					

2. ​							打开系统。 					

   ​							根据您的硬件，在系统连接到 PXE 服务器之前，会显示一些网络设置和诊断信息。连接后，会根据 PXE 服务器配置显示菜单。 					

3. ​							按下所需选项对应的数字键。 					

   注意

   ​								在某些情况下，引导选项不会被显示。如果发生了这种情况，按 **Enter** 键，或者等到引导窗口打开。 						

   ​							**Red Hat Enterprise Linux 引导** 窗口会打开并显示有关各种可用引导选项的信息。 					

4. ​							使用键盘中的箭头键选择您需要的引导选项，然后按 **Enter** 键选择引导选项。**Welcome to Red Hat Enterprise Linux** 窗口将打开，您可以使用图形用户界面安装 Red Hat Enterprise Linux。 					

   注意

   ​								如果在 60 秒之内引导窗口中没有执行任何动作，安装程序会自动开始。 						

5. ​							（可选）编辑可用的引导选项： 					

   1. ​									**基于 UEFI 的系统：** 按 **E** 进入编辑模式。更改预定义的命令行以添加或删除引导选项。按 **Enter** 键确认您的选择。 							
   2. ​									**基于 BIOS 的系统：** 按键盘中的 **Tab 键** 进入编辑模式。更改预定义的命令行以添加或删除引导选项。按 **Enter** 键确认您的选择。 							

**其它资源**

- ​							有关使用图形用户界面安装 Red Hat Enterprise Linux 的详情请参考 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 					
- ​							有关如何使用 PXE 准备从网络安装 Red Hat Enterprise Linux 的详情，请参考 [*执行高级 RHEL 安装文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/)。 					
- ​							有关您可以在引导命令行中使用的可用引导选项列表的详情请参考 [附录 C, *引导选项参考*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#custom-boot-options_installing-RHEL)。 					

## 第 8 章 使用客户门户网站中的 ISO 镜像安装 RHEL

​				使用客户门户网站中下载的 Binary DVD ISO 镜像安装 RHEL。这些步骤提供按照 RHEL 安装程序的说明。 		

警告

​					当使用 Binary DVD ISO 镜像文件执行 GUI 安装时,安装程序的一个竞争条件有时会阻止安装,直到您使用连接到红帽功能注册系统为止。如需更多信息,请参阅 [*RHEL 8.2 发行注记*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/8.2_release_notes/index) 文档中的已知问题部分中的 BZ#1823578。 			

**先决条件**

- ​						您已经从客户门户网站下载了 Binary DVD ISO 镜像文件。如需更多信息,请参阅 [第 3 章 *下载 RHEL 安装 ISO 镜像*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 				
- ​						您已创建了可引导安装介质。如需更多信息 [,请参阅创建可引导 DVD 或者 CD](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-an-installation-cd-or-dvd_assembly_creating-a-bootable-installation-medium)。 				
- ​						您已引导安装程序，此时会显示引导菜单。如需更多信息,请参阅 [第 7 章 *引导安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#booting-the-installer_installing-RHEL)。 				

**流程**

1. ​						在引导菜单中选择 **Install Red Hat Enterprise Linux 8**,然后按 **Enter** 键。 				

2. ​						在 **Welcome to Red Hat Enterprise Linux 8** 窗口中,选择您的语言和位置,然后点 Continue。**安装概述** 窗口将打开并显示每个设置的默认值。 				

3. ​						选择 **System > Installation Destination**,然后在 **Local Standard Disks** 窗格中选择目标磁盘,然后点 Done。为存储配置选择默认设置。有关自定义存储设置的详情请参考 [第 10.4 节 “配置软件选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-software-settings_graphical-installation)、[第 10.5 节 “配置存储设备”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#storage-devices_graphical-installation)、[第 10.6 节 “配置手动分区”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#manual-partitioning_graphical-installation)。 				

4. ​						选择 **System > Network & Host Name**。此时会打开 **Network and Hostname** 窗口。 				

5. ​						在 **Network and Hostname** 窗口中,将 **以太网** 开关切换为 **ON**,然后点 Done。安装程序连接到可用网络并配置网络中可用设备。如果需要,您可以在可用网络列表中选择所需的网络并配置那个网络中可用的设备。有关配置网络或网络设备的详情请参考 [第 10.3.3 节 “配置网络和主机名选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#network-hostname_configuring-system-settings)。 				

6. ​						选择 **User Settings > Root 密码**。此时会打开 **Root 密码** 窗口。 				

7. ​						在 **Root 密码** 窗口中输入您要为 root 帐户设置的密码,然后点 Done。需要 root 密码才能完成安装过程,并登录到系统管理员用户帐户。有关创建密码的要求和建议的详情请参考 [第 10.7 节 “配置一个根密码”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-a-root-password_graphical-installation)。 				

8. ​						可选： 选择 **User Settings > User Creation** 来为安装过程创建用户帐户。用这个用户帐户替换 root 帐户来执行任何系统管理任务。 				

9. ​						在 **Create User** 窗口中执行以下操作,然后点 Done。 				

   1. ​								为您要创建的帐户输入名称和用户名。 						
   2. ​								选择 **Make this user administrator** and **Require a password to use this account** 复选框。安装程序将用户添加到 wheel 组中,并创建一个带有默认设置的密码保护用户帐户。建议您创建一个密码保护的管理用户帐户。有关编辑用户帐户默认设置的详情请参考 [第 10.8 节 “创建用户帐户”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#creating-a-user-account_graphical-installation)。 						

10. ​						点击 Begin Installation 启动安装并等待安装完成。它可能需要几分钟时间。 				

11. ​						安装过程完成后,点 重启 系统。 				

12. ​						如果安装介质在重新引导时没有被自动弹出，则需要删除它。 				

    ​						Red Hat Enterprise Linux8 在系统正常的开机序列完成后启动。如果系统安装在一个使用 X Window  系统的工作站，配置系统的应用程序就会启动。这些应用程序指导您完成初始配置,您可以设置系统时间和日期,并在红帽中注册您的系统,等等。如果没有安装 X 窗口系统,则会显示 `login:` 提示符。 				

    注意

    ​							如果您已经安装了 Red Hat Enterprise Linux Beta 发行版本,在启用了 UEFI 安全引导的系统中,将 Beta 公钥添加到系统的 Machine Owner Key(MOK)列表中。 					

13. ​						在 **Initial Setup** 窗口中接受许可协议并注册您的系统。 				

**其它资源**

- ​						要了解如何自定义您的网络、连接到红帽、系统目的、安装目的地、KDUMP 和安全策略的信息,请参阅 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 				
- ​						要了解更多有关如何注册您的系统的信息,请参阅 [第 11 章 *完成安装后的任务*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#post-installation-tasks_installing-RHEL)。 				

## 第 9 章 使用 GUI 通过 CDN 注册并安装 RHEL

​				本节介绍如何使用 GUI 注册您的系统、附加 RHEL 订阅和从 Red Hat Content Delivery Network(CDN)安装 RHEL。 		

## 9.1. 什么是 Content Delivery Network

​					Red Hat Content Delivery Network(CDN)（ cdn.redhat.com）是一  个分布式的静态网页服务器,包含系统消耗的内容和勘误。可直接使用该内容，比如使用一个注册到 Red Hat Subscription  Management 的系统。CDN 受 x.509  证书认证保护，以保证只有有效用户可访问。当在红帽订阅管理中注册系统时，附加的订阅管理该系统可访问的 CDN 子集。 			

​					从 CDN 注册并安装 RHEL 有以下优点： 			

- ​							CDN 安装方法支持 Boot ISO 和 Binary DVD ISO 镜像文件。但推荐使用较小的引导 ISO 镜像文件，因为它消耗的空间比较大的二进制 DVD ISO 镜像文件要少。 					
- ​							CDN 使用最新的软件包以便安装后有一个完全最新的系统。安装后不需要立即安装软件包更新，在使用 Binary DVD ISO 镜像文件时通常会如此。 					
- ​							集成了对连接 Red Hat Insights 和启用系统目的的支持。 					

​					GUI 和 Kickstart 支持从 CDN 注册并安装 RHEL。有关如何使用 GUI 从 CDN 注册并安装 RHEL 的详情请参考 [第 9.2 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#register-and-install-from-cdn-using-gui_register-and-install-from-cdn)。有关如何使用 Kickstart 注册和安装 RHEL 的详情，请查看 [*执行高级 RHEL 安装文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index)。 			

## 9.2. 从 CDN 注册并安装 RHEL

​					使用这个流程注册您的系统、附加 RHEL 订阅并使用 GUI 从 Red Hat Content Delivery Network(CDN)安装 RHEL。 			

重要

​						**引导 ISO** 和 **Binary DVD ISO** 镜像文件支持 CDN 的功能。但建议您使用 **引导 ISO** 镜像文件作为引导 ISO 镜像文件的默认 CDN 安装源。 				

**先决条件**

- ​							系统连接到可以访问 CDN 的网络。 					
- ​							已经从客户门户网站下载了 **Boot ISO** 镜像文件。如需更多信息,请参阅 [第 3 章 *下载 RHEL 安装 ISO 镜像*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 					
- ​							您已创建了可引导安装介质。如需更多信息 [,请参阅创建可引导 DVD 或者 CD](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-an-installation-cd-or-dvd_assembly_creating-a-bootable-installation-medium)。 					
- ​							您已引导安装程序，此时会显示引导菜单。如需更多信息,请参阅 [第 7 章 *引导安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#booting-the-installer_installing-RHEL)。系统注册后的安装源存储库依赖于系统的引导方式。如需更多信息,请参阅 [第 9.2.1 节 “系统注册后安装源存储库”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#how-the-default-installation-repo-works-in-cdn_register-and-install-from-cdn)。 					

**流程**

1. ​							在引导菜单中选择 **Install Red Hat Enterprise Linux 8**,然后按 **Enter** 键。 					

2. ​							在 **Welcome to Red Hat Enterprise Linux 8** 窗口中,选择您的语言和位置,然后点 Continue。**安装概述** 窗口将打开并显示每个设置的默认值。 					

3. ​							选择 **System > Installation Destination**,然后在 **Local Standard Disks** 窗格中选择目标磁盘,然后点 Done。为存储配置选择默认设置。有关自定义存储设置的详情请参考 [第 10.4 节 “配置软件选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-software-settings_graphical-installation)、[第 10.5 节 “配置存储设备”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#storage-devices_graphical-installation)、[第 10.6 节 “配置手动分区”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#manual-partitioning_graphical-installation)。 					

4. ​							选择 **System > Network & Host Name**。此时会打开 **Network and Hostname** 窗口。 					

5. ​							在 **Network and Hostname** 窗口中,将 **以太网** 开关切换为 **ON**,然后点 Done。安装程序连接到可用网络并配置网络中可用设备。如果需要,您可以在可用网络列表中选择所需的网络并配置那个网络中可用的设备。有关配置网络或网络设备的详情请参考 [第 10.3.3 节 “配置网络和主机名选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#network-hostname_configuring-system-settings)。 					

6. ​							选择 **Software > Connect to Red Hat**。此时会打开 **连接到红帽** 窗口。 					

7. ​							在 **连接到红帽的** 窗口中,执行以下步骤： 					

   1. ​									选择 **Authentication 方法,** 并根据您选择的方法提供详情。 							

      ​									对于 **帐户** 验证方法：输入您的红帽客户门户网站用户名和密码详情。 							

      ​									对于 **激活码** 验证方法： 输入您的机构 ID 和激活码。当把您的激活码注册到订阅中时，就可以输入多个激活码（使用逗号分开）。 							

   2. ​									选择 **Set System Purpose** 复选框,然后从对应的下拉列表中选择所需的 **Role**、**SLA** 和 **Usage**。 							

      ​									使用系统目的,您可以记录 Red Hat Enterprise Linux 8 系统的预期使用,并确定授权服务器自动为您的系统附加最合适的订阅。 							

   3. ​									默认情况下启用 **连接到 Red Hat Insights** 复选框。如果您不想连接到 Red Hat Insights，请清除复选框。 							

      ​									Red Hat Insights 是一个软件即服务(SaaS)服务(SaaS),它提供对注册的红帽系统的持续分析，以主动识别跨物理、虚拟和云环境以及容器部署的安全性、性能和稳定性。 							

   4. ​									（可选）展开 **Options** 并选择网络通信类型。 							

      - ​											如果您的网络环境只允许外部互联网访问,或者通过 **HTTP 代理服务器访问内容服务器,请选择 Use** HTTP proxy 复选框。 									

      - ​											如果您要运行 Satellite 服务器或执行内部测试，请选择 **自定义服务器 URL** 和 **自定义基本 URL** 复选框，并输入所需详情。 									

        ​											**自定义服务器 URL** 字段不需要 HTTP 协议,如 `nameofhost.com`。但是, **自定义基本 URL 字** 段需要 HTTP 协议。要在注册后更改 **Custom base URL**，您必须取消注册，提供新详情，然后重新注册。 									

   5. ​									点 Register。当成功注册系统并附加订阅后, **连接到红帽** 窗口会显示附加的订阅详情。 							

      ​									根据订阅的数量，注册和附加过程可能需要一分钟时间完成。 							

   6. ​									点击 Done。 							

      ​									在 **Connect to Red Hat** 下会显示一个 *Registered* 信息。 							

8. ​							选择 **User Settings > Root 密码**。此时会打开 **Root 密码** 窗口。 					

9. ​							在 **Root 密码** 窗口中输入您要为 root 帐户设置的密码,然后点 Done。需要 root 密码才能完成安装过程,并登录到系统管理员用户帐户。有关创建密码的要求和建议的详情请参考 [第 10.7 节 “配置一个根密码”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-a-root-password_graphical-installation)。 					

10. ​							可选： 选择 **User Settings > User Creation** 来为安装过程创建用户帐户。用这个用户帐户替换 root 帐户来执行任何系统管理任务。 					

11. ​							在 **Create User** 窗口中执行以下操作,然后点 Done。 					

    1. ​									为您要创建的帐户输入名称和用户名。 							
    2. ​									选择 **Make this user administrator** and **Require a password to use this account** 复选框。安装程序将用户添加到 wheel 组中,并创建一个带有默认设置的密码保护用户帐户。建议您创建一个密码保护的管理用户帐户。有关编辑用户帐户默认设置的详情请参考 [第 10.8 节 “创建用户帐户”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#creating-a-user-account_graphical-installation)。 							

12. ​							点击 Begin Installation 启动安装并等待安装完成。它可能需要几分钟时间。 					

13. ​							安装过程完成后,点 重启 系统。 					

14. ​							如果安装介质在重新引导时没有被自动弹出，则需要删除它。 					

    ​							Red Hat Enterprise Linux8 在系统正常的开机序列完成后启动。如果系统安装在一个使用 X Window  系统的工作站，配置系统的应用程序就会启动。这些应用程序指导您完成初始配置,您可以设置系统时间和日期,并在红帽中注册您的系统,等等。如果没有安装 X 窗口系统,则会显示 `login:` 提示符。 					

    注意

    ​								如果您已经安装了 Red Hat Enterprise Linux Beta 发行版本,在启用了 UEFI 安全引导的系统中,将 Beta 公钥添加到系统的 Machine Owner Key(MOK)列表中。 						

15. ​							在 **Initial Setup** 窗口中接受许可协议并注册您的系统。 					

**其它资源**

- ​							要了解如何自定义您的网络、连接到红帽、系统目的、安装目的地、KDUMP 和安全策略的信息,请参阅 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 					
- ​							要了解更多有关完成 Initial Setup 的信息,请参阅 [第 11.1 节 “完成初始设置”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#completing-initial-setup_post-installation-tasks)。 					
- ​							有关 Red Hat Insights 的详情,请查看 [*Red Hat Insights 产品文档*](https://access.redhat.com/documentation/en-us/red_hat_insights/)。 					
- ​							有关激活码的详情，请查看 *使用红帽订阅管理*文档中的[*了解激活码*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html/using_red_hat_subscription_management/activation_keys_con) 一章。 					
- ​							有关如何为 Subscription Manager 设置 HTTP 代理服务器的详情，请参考*使用并配置 Red Hat Subscription Manager* 文档中的[*使用 HTTP 代理*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index#repos-proxy)章节。 					

### 9.2.1. 系统注册后安装源存储库

​						系统注册后的安装源存储库依赖于系统的引导方式。 				

- 系统使用引导 ISO 或者 Binary DVD ISO 镜像文件引导

  ​									如果您使用带有默认引导参数的 `Boot ISO` 或 `Binary DVD ISO` 镜像文件引导 RHEL 安装,安装程序会在注册后自动将安装源存储库切换到 CDN。 							

- 系统使用 `inst.repo=<URL>` 引导参数引导

  ​									如果您使用 `inst.repo=<URL>` 引导参数引导 RHEL 安装,安装程序不会在注册后自动将安装源存储库切换到 CDN。如果要使用 CDN 安装 RHEL，您必须在图形安装的**安装源**窗口中选择 **红帽 CDN** 选项手动将 安装源存储库切换到 CDN。如果没有手动切换到 CDN,安装程序会从内核命令行中指定的程序库安装软件包。 							

重要

- ​									如果您没有使用内核命令行中的 `inst.repo=` 或者 Kickstart 文件中的 `url` 命令指定安装源,则只能使用 `rhsm` Kickstart 命令将安装源存储库切换到 CDN。您必须在内核命令行中使用 `inst.stage2=<URL>` 获取安装镜像,但不指定安装源。 							
- ​									使用引导选项指定或者包含在 Kickstart 文件中的安装源 URL 优先于 CDN,即使 Kickstart 文件包含带有有效凭证的 `rhsm` 命令。已注册该系统，但会通过 URL 安装源进行安装。这样可保证早期安装进程正常运行。 							

## 9.3. 从 CDN 验证您的系统注册

​					使用这个步骤来验证您的系统是否使用 GUI 在 CDN 中注册。 			

警告

​						如果您**没有**从**Installation Summary** 窗口中按 **Begin Installation** 按钮，则只能从 CDN 验证您的注册。点击 **开始安装** 按钮后,您就无法返回安装概述窗口来验证您的注册。 				

**先决条件**

- ​							您已完成了注册过程 *,* 如 [第 9.2 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#register-and-install-from-cdn-using-gui_register-and-install-from-cdn) 所述, Registered 在 **Installation Summary** 窗口中 **的 Connect to Red Hat** 下显示。 					

**流程**

1. ​							在 **安装概述** 窗口中选择 **连接到红帽**。 					

2. ​							该窗口将打开并显示注册概述： 					

   - 方法

     ​										此时会显示注册的帐户名称或者激活码。 								

   - 系统用途

     ​										如果设置，则会显示角色、SLA 和用量详情。 								

   - Insights

     ​										如果启用，则显示 Insights 详情。 								

   - 订阅数

     ​										此时会显示附加的订阅数。 								

3. ​							验证注册概述是否与输入的详细信息匹配。 					

## 9.4. 从 CDN 取消注册您的系统

​					这个过程使用 GUI 从 CDN 取消注册您的系统。 			

警告

- ​								如果您还 **没有** 在安装 **概述** 窗口中点击 开始安装按钮，则可以从 CDN 取消注册。点击开始安装按钮后，您就无法返回安装概述窗口取消注册。 						
- ​								取消注册时，安装程序会按以下顺序切换到第一个可用的存储库： 						
  1. ​										内核命令行中的 inst.repo=<url> 引导参数中使用的 URL。 								
  2. ​										安装介质（USB 或者 DVD）中自动探测到的软件仓库。 								

**先决条件**

- ​							您已完成了注册过程 *,* 如 [第 9.2 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#register-and-install-from-cdn-using-gui_register-and-install-from-cdn) 所述, Registered 在 **Installation Summary** 窗口中 **的 Connect to Red Hat** 下显示。 					

**流程**

1. ​							在 **安装概述** 窗口中选择 **连接到红帽**。 					

2. ​							**连接到红帽** 窗口会打开并显示注册概述： 					

   - 方法

     ​										此时会显示注册的帐户名称或者使用的激活码。 								

   - 系统用途

     ​										如果设置，则会显示角色、SLA 和用量详情。 								

   - Insights

     ​										如果启用，则显示 Insights 详情。 								

   - 订阅数

     ​										此时会显示附加的订阅数。 								

3. ​							点击 Unregister 从 CDN 中删除注册。原始注册详情会在窗口的下半部分显示 **Not registered** 信息。 					

4. ​							点击 完成 返回 **安装概述** 窗口。 					

5. ​							**Connect to Red Hat** 会显示一个 *Not registered* 信息，**Software Selection** 显示 *Red Hat CDN requires registration* 信息。 					

注意

​						取消注册后，就可以重新注册您的系统。点击 **连接到红帽**。之前输入的详细信息会填充。编辑原始详情，或者根据帐户、目的和连接更新相应的性。点击 Register 以完成。 				

## 第 10 章 自定义安装

​				安装 Red Hat Enterprise Linux 时，您可以使用 **安装概述** 窗口自定义位置、软件和系统设置和参数。 		

​				**安装概述** 窗口包含以下类别： 		

- ​						**LOCALIZATION**: 您可以配置键盘、语言支持以及时间和日期。 				
- ​						**SOFTWARE**: 您可以配置连接到 Red Hat、Installation Source 和软件选择。 				
- ​						**SYSTEM**: 您可以配置安装目的、KDUMP、网络和主机名称以及安全策略。 				
- ​						**USER SETTINGS**:您可以配置一个 root 密码来登录到用于系统管理任务的管理员帐户,并创建一个用户帐户来登录该系统。 				

​				类别具有不同的状态，具体要看安装程序的位置。 		

**表 10.1. 类别状态**

| 类别状态           | 状态                                   | 描述                                                         |
| ------------------ | -------------------------------------- | ------------------------------------------------------------ |
| **警告符号类型 1** | 带有叹号和红色文本的黄三角             | 安装前需要注意。例如,在从 Content Delivery Network(CDN)注册和下载前,网络和主机名需要注意。 |
| **警告符号类型 2** | 灰掉，带有警告符号（带有叹号的黄三角） | 安装程序正在配置一个类别,您必须在访问窗口前等待它完成。      |

注意

​					在 **安装概述** 窗口的底部会显示警告信息,在您配置所有需要的类别前禁用 **开始安装** 按钮。 			

​				这部分包含有关使用图形用户界面(GUI)自定义 Red Hat Enterprise Linux 安装的信息。使用 CD、DVD、USB 闪存驱动器或者使用 PXE 从网络引导系统时,GUI 是安装 Red Hat Enterprise Linux 的首选方法。 		

注意

​					在线帮助和客户门户网站中发布的内容之间可能有一些提示。有关最新更新，请查看客户门户网站中的安装内容。 			

## 10.1. 配置语言和地区设置

​					安装程序使用您在安装过程中选择的语言。 			

**先决条件**

1. ​							创建了安装介质。如需更多信息 [,请参阅创建可引导 DVD 或者 CD](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-an-installation-cd-or-dvd_assembly_creating-a-bootable-installation-medium)。 					
2. ​							如果您使用引导 ISO 镜像文件，请指定安装源。如需更多信息,请参阅 [第 5 章 *准备安装源*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#prepare-installation-source_installing-RHEL)。 					
3. ​							启动了安装。如需更多信息,请参阅 [第 7 章 *引导安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#booting-the-installer_installing-RHEL)。 					

**流程**

1. ​							在 **Welcome to Red Hat Enterprise Linux** 窗口左侧的方框中选择一个语言。或者,在 **搜索** 字段输入您首选的语言。 					

   注意

   ​								默认预选语言。如果配置了网络访问,即从网络服务器而不是本地介质引导时,预选语言由 **GeoIP** 模块的自动位置检测功能决定。如果您在引导命令行或者 PXE 服务器配置中使用 `inst.lang=` 选项,则会选择使用引导选项定义的语言。 						

2. ​							在 **Welcome to Red Hat Enterprise Linux** 右侧窗格中选择特定于您所在地区的位置。 					

3. ​							点 Continue 进入 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation) 窗口。 					

   重要

   ​								如果您要安装 Red Hat Enterprise Linux 预发布版本,则会显示安装介质预发布状态的警告信息。点 I want to proceed 继续安装，或 I want to exit 推出安装过程并重启系统。 						

**其它资源**

​						有关如何在安装程序中更改语言和位置设置的详情,请参考 [第 10.2 节 “配置本地化选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-localization-settings_graphical-installation) 				

## 10.2. 配置本地化选项

​					本节介绍如何配置键盘、语言支持以及时间和日期设置。 			

重要

​						如果您使用无法接受俄语字符的布局,如 **俄语**,请添加 **英语（美国）** 布局并配置键盘组合以在两个布局间切换。如果您选择了没有空白字符的布局,您可能无法在安装过程后输入有效的 `root` 密码和用户凭证。这可能会阻止您完成安装。 				

### 10.2.1. 配置键盘、语言以及时间和日期设置

注意

​							键盘、语言和时间设置会默认配置为 [第 10.1 节 “配置语言和地区设置”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#installing-rhel-using-anaconda_graphical-installation) 的一部分。要更改任何设置,请完成以下步骤,否则将执行 [第 10.4 节 “配置软件选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-software-settings_graphical-installation)。 					

**步骤： 配置键盘设置**

1. ​								在 **安装概述** 窗口中点击 **键盘**。默认布局取决于 [第 10.1 节 “配置语言和地区设置”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#installing-rhel-using-anaconda_graphical-installation) 中选择的选项。 						

   1. ​										点击 + 打开 **Add a Keyboard Layout 窗口,** 并切换到不同的布局。 								

   2. ​										通过浏览列表或使用 **Search** 字段来选择布局。 								

   3. ​										选择所需的布局并点 Add。新布局会出现在默认布局下。 								

   4. ​										点击 Options 配置键盘开关,您可使用该开关在可用布局间进行循环。此时会打开 **布局切换 Options** 窗口。 								

   5. ​										要配置用于切换的密钥组合,请选择一个或多个密钥组合,然后点击 确定 来确认您的选择。 								

      注意

      ​											当您选择布局时,点击 **键盘** 按钮打开一个新对话框,显示所选布局的视觉显示。 									

   6. ​										点击完成 应用设置并返回 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 								

**步骤： 配置语言设置**

1. ​								在 **安装概述** 窗口中点击 **语言支持**。**语言支持窗口** 将打开。左侧面板列出了可用语言组。如果至少配置了一个组中的语言,则会显示一个标记并突出显示支持的语言。 						
   1. ​										在左侧窗格中,点击组来选择附加语言,从右窗格中选择区域选项。对所需语言重复这个过程。 								
   2. ​										点击 完成 应用这些更改并返回 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 								

**步骤： 配置时间和日期设置**

1. ​								在 **安装概述** 窗口中点击 **Time & Date**。此时会打开 **Time & Date** 窗口。 						

   注意

   ​									**Time & Date** 设置会根据您在 [第 10.1 节 “配置语言和地区设置”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#installing-rhel-using-anaconda_graphical-installation) 中选择的设置默认配置。 							

   ​									区和区域列表来自于互联网分配号颁发机构(IANA)维护的 Time Zone 数据库(`tzdata`)的公共域。红帽不能将此数据库添加到此数据库。您可以在 [IANA 官方网站找到更多信息](http://www.iana.org/time-zones)。 							

   1. ​										从 **Region** 下拉菜单中选择一个区域。 								

      注意

      ​											选择 **Etc** 作为您的区域,在不将您的位置设置为特定地区的情况下,相对于 greenwich Mean Time(GMT)配置时区。 									

   2. ​										在 **按** 下拉菜单中选择城市,或者在同一个时区中最接近您所在位置的城市。 								

   3. ​										使用 **网络时间协议** (NTP)切换网络时间开关来启用或禁用网络时间同步。 								

      注意

      ​											启用网络时间交换机可保留您的系统时间,只要系统可以访问互联网。默认情况下,配置了一个 NTP 池 ; 您可以添加一个新的选项,或者通过点击 网络时间 交换机旁的 gear wheel 按钮来禁用或删除默认选项。 									

   4. ​										点击 完成 应用这些更改并返回 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 								

      注意

      ​											如果您禁用网络时间同步,则窗口底部的控制将处于活跃状态,您可以手动设置时间和日期。 									

## 10.3. 配置系统选项

​					本节包含有关配置安装目的、KDUMP、网络和主机名称、安全策略和系统目的的信息。 			

### 10.3.1. 配置安装目的地

​						使用 **Installation Destination** 窗口配置存储选项,例如您要用作 Red Hat Enterprise Linux 安装目标的磁盘。您必须至少选择一个磁盘。 				

警告

​							如果您计划使用已包含数据的磁盘,请备份您的数据。例如： 如果要缩小现有 Microsoft Windows 分区并将 Red  Hat Enterprise Linux 安装为第二个系统，或者要升级之前的 Red Hat Enterprise Linux  版本。控制分区总是有风险。例如，如果因为磁盘中的某种原因造成进程中断或者失败，则可能会丢失磁盘中的数据。 					

重要

**特例**

- ​									某些 BIOS 类型不支持从 RAID 卡引导。在这些实例中, `/boot` 分区必须在 RAID 阵列之外被创建,比如在一个单独的硬盘驱动器上创建。需要使用内部硬盘来创建带有有问题的 RAID 卡的分区。软件 RAID 设置还需要 `/boot` 分区。如果您选择自动为系统分区,应该手动编辑 `/boot` 分区。 							
- ​									要将 Red Hat Enterprise Linux 引导装载程序配置为来自不同引导装载程序的 *链负载*,您必须点击 **Installation Destination** 窗口中的 **Full disk summary and bootloader** 链接手动指定引导驱动器。 							
- ​									当您在带有多路径和非多路径存储设备的系统中安装 Red Hat Enterprise Linux,安装程序中的自动分区布局会创建混合使用多路径和非多路径设备的卷组。这违背了多重路径存储的目的。建议您在 **Installation Destination** 窗口中选择多路径或者非多路径设备。或者手动分区。 							

**先决条件**

​							打开 **安装概述** 窗口。 					

**流程**

1. ​								在 **安装概述** 窗口中点击 **安装目的**。此时会打开 **Installation Destination** 窗口。 						

   1. ​										在 **Local Standard Disks** 部分中选择您需要的存储设备 ; 白色检查标记显示了您的选择。没有白名单检查标记的磁盘不会在安装过程中使用 ; 如果您选择自动分区,则忽略它们,且手动分区不可用。 								

      注意

      ​											所有本地可用的存储设备（SATA、IDE 和 SCSI 硬盘、USB 闪存和外部磁盘）都会在 **本地标准磁盘下显示**。安装程序启动后连接的任何存储设备都不会被检测到。如果您使用可移动驱动器安装 Red Hat Enterprise Linux，在删除了该设备后您的系统将无法使用。 									

   2. ​										可选： 如果您想要配置附加本地存储设备来连接新的硬盘驱动器，请点击窗口右下方的 **Refresh** 链接。此时会打开 **Rescan Disks** 对话框。 								

      注意

      ​											当您点击**扫描磁盘**时，您在安装过程中进行的所有存储更改都会丢失。 									

      1. ​												点 Rescan Disks 并等到扫描过程完成。 										
      2. ​												点击 OK 返回 **安装目标** 窗口。所有探测到的磁盘（包括新磁盘）都会在 **本地标准磁盘** 部分显示。 										

2. ​								可选： 要添加专用存储设备,请点击 Add a disk…。 						

   ​								**存储设备选择** 窗口将打开，并列出安装程序可访问的所有存储设备。有关如何添加专用磁盘的详情请参考 [第 10.5.3 节 “使用高级存储选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-advanced-storage-options_storage-devices)。 						

3. ​								可选： Under **Storage Configuration**,选择 **Automatic 单选** 按钮。 						

   重要

   ​									自动分区是 **推荐** 对存储进行分区的方法。您还可以配置自定义分区,如需了解更多详细信息,请参阅 [第 10.6 节 “配置手动分区”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#manual-partitioning_graphical-installation) 							

4. ​								可选： 要从现有分区布局中重新声明空间,请选择 **我想要添加可用空间** 的复选框。例如：如果您想要使用的磁盘已经包含不同的操作系统,而您想要使这个系统的分区更小,从而为 Red Hat Enterprise Linux 提供更多空间。 						

5. ​								可选： 选择 **加密我的数据** 来加密所有分区,但使用 *Linux Unified Key Setup* (LUKS)引导系统（比如 `/boot`）所需的分区除外。建议加密您的硬盘。 						

   1. ​										点击 Done。此时会打开 **磁盘加密 Passphrase** 对话框。 								

      1. ​												在 **Passphrase** 和 **Confirm** 字段中输入您的密码短语。 										

      2. ​												点击 Save Passphrase 完成磁盘加密。 										

         警告

         ​													如果您丢失了 LUKS 密码短语，那么就完全无法访问所有加密的分区及其数据。丢失的密码短语是无法找回的。但是，如果您执行 Kickstart 安装，您可以保存加密密码短语并在安装过程中生成加密密码短语备份。详情请参阅 [*执行高级 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/) 文档。 											

6. ​								可选：点击窗口左下方的 **Full disk summary and bootloader** 链接来选择哪个存储设备包含引导装载程序。如需更多信息,请参阅 [第 10.3.1.1 节 “配置引导装载程序”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#boot-loader-installation_configuring-system-settings)。 						

   注意

   ​									在大多数情况下,将引导装载程序留在默认位置就足够了。例如，需要从另一个引导装载程序进行链载入的系统需要手工指定引导驱动器。 							

7. ​								点击 Done。 						

   1. ​										如果您选择了 **自动分区,** 并且 **希望提供额外的空间,或者您选择的硬盘没有足够的可用** 空间来安装 Red Hat Enterprise Linux,则当点 Done 时会打开 **Reclaim Disk Space** 对话框,并列出所有配置的磁盘设备以及那些设备中的所有分区。对话框显示系统最小安装所需的空间量以及您重新声明的空间量。 								

      警告

      ​											如果**删除**了一个分区，那个分区上的所有数据都会丢失。如果您想保留数据，请使用 **Shrink** 选项，而不是 **Delete** 选项。 									

   2. ​										查看显示的可用存储设备列表。可 **重新声明的空间** 列显示了每个条目可以回收的空间量。 								

   3. ​										要重新声明空间,选择磁盘或分区,并点 Delete 按钮删除 该分区,或者所选磁盘上的所有分区,或者点击 Shrink 在保留现有数据时使用空闲空间。 								

      注意

      ​											或者,您可以点击 删除所有,这将删除所有磁盘中所有现有分区,并将这个空间提供给 Red Hat Enterprise Linux。所有磁盘上的现有数据都会丢失。 									

   4. ​										点击 回收空间 以应用更改并返回 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 								

重要

​							除非点了 **Installation Summary** 窗口中的 Begin Installation，不会有磁盘变化。**重新声明空间** 对话框只标记用于重新定义大小或删除的分区,不执行任何操作。 					

#### 10.3.1.1. 配置引导装载程序

​							Red Hat Enterprise Linux 使用 GRand Unified Bootloader 版本 2(**GRUB2**)作为 AMD64 和 Intel 64、IBM Power Systems 和 ARM 的引导装载程序。对于 IBM Z,使用 **zipl** 引导装载程序。 					

​							引导装载程序是系统启动时所运行的第一个程序，它负责载入和向操作系统传输控制。**GRUB2** 可以引导任何兼容的操作系统（包括 Microsoft Windows）,并可使用链载入功能将控制传送到其他引导装载程序用于不受支持的操作系统。 					

警告

​								安装 **GRUB2** 可能会覆盖您现有的引导装载程序。 						

​							如果已经安装了操作系统，Red Hat Enterprise Linux 安装程序会尝试自动探测并配置引导装载程序，以启动另一个操作系统。如果没有检测到引导装载程序，您可以在完成安装后手动配置任意附加操作系统。 					

​							如果您要在多个磁盘上安装一个 Red Hat Enterprise Linux 系统，您可能需要手动指定要安装引导装载程序的磁盘。 					

**流程**

1. ​									在 **安装目标** 窗口中点 **Full disk summary and bootloader**此时会打开 **Selected Disks** 对话框。 							

   ​									引导装载程序安装在您选择的设备中,或者在 UEFI 系统上安装。在引导的 **分区过程中在目标设备中创建 EFI 系统** 分区。 							

2. ​									要更改引导设备，请从列表中选择设备并点击 Set as Boot Device。您只能将一个设备设定为引导设备。 							

3. ​									要禁用新引导装载程序安装,请选择当前标记为引导的设备,然后点击 Do not install boot loader。这样可保证不在任何设备中安装 **GRUB2**。 							

警告

​								如果选择不安装引导装载程序，则不能直接引导系统，而且必须使用另外一种引导方法，如独立的商业引导装载程序应用程序。只有在您有其它引导系统的方法时才使用这个选项。 						

​							引导装载程序可能还需要创建特殊分区,这要看您的系统使用 BIOS 或 UEFI 固件,或者引导驱动器有 *GUID 分区表(* GPT)或者 **主引导记录** （MBR,也称为 `msdos`）标签。如果您使用自动分区，安装程序会创建该分区。 					

### 10.3.2. 配置 Kdump

​						**Kdump** 是内核崩溃转储机制。系统崩溃时，**Kdump** 会在故障时捕获系统内存内容。可以对捕获的内存进行分析，以找出造成崩溃的原因。如果启用了 **Kdump**，则需要为其自身保留一小部分系统内存(RAM)。主内核无法访问预留内存。 				

**流程**

1. ​								在 **安装概述** 窗口中点击 **Kdump**。此时会打开 **Kdump** 窗口。 						
2. ​								选择 **启用 kdump** 复选框。 						
3. ​								选择 **Automatic** 或 **Manual** 设置内存保留。 						
   1. ​										如果选择 **Manual**,使用 **+** 和 **-** 按钮在 **Memory to reserved 字段中输入您要保留** 的内存量（以 MB 为单位）。保留输入字段下的 Usable **System Memory** readout 显示主系统在保留您选择的 RAM 量后可以访问的内存量。 								
4. ​								点击完成 应用设置并返回 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 						

注意

​							您保留的内存量由系统架构（AMD64 和 Intel 64）的要求与 IBM Power 不同,以及系统内存总量。在大多数情况下，可以使用自动保留。 					

重要

​							其他设置,比如保存内核崩溃转储的位置,只能在安装后使用 system **-config-kdump** 图形界面,或者手动在 `/etc/kdump.conf` 配置文件中配置。 					

### 10.3.3. 配置网络和主机名选项

​						使用 `Network and Host name` 窗口配置网络接口。您可以在安装过程中选择的选项用于从远程位置下载软件包,也可以在安装的系统中使用。 				

#### 10.3.3.1. 配置网络和主机名

​							按照以下步骤来配置您的网络和主机名。 					

**流程**

1. ​									在 **安装概述** 窗口中点击 网络和主机名称。 							

2. ​									在左侧窗格的列表中选择一个接口。详情显示在右侧方框中。 							

3. ​									使用 ON/OFF 开关来启用或禁用所选接口。 							

   注意

   ​										安装程序自动检测到本地可访问的界面，您无法手动添加或删除它们。 								

4. ​									点 + 添加虚拟网络接口，可以是 Team、Bond、Bridge 或 VLAN。 							

5. ​									点 - 删除虚拟接口。 							

6. ​									点 Configure 更改设置，如 IP 地址、DNS 服务器或者现有接口的路由配置（虚拟和物理）。 							

7. ​									在 **Host Name** 字段中输入您系统的主机名。 							

   注意

   - ​												用于使用持久名称识别网络设备的网络设备命名标准有几种，例如 `em1` 和 `wl3sp0`。有关这些标准的详情，请查看 [*配置和管理联网文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_networking/index/)。 										
   - ​												主机名可以是完全限定域名（FQDN），其格式为 *hostname.domainname*，也可以是没有域名的短主机名。很多网络有一个动态主机配置协议(DHCP)服务,它可自动提供带域名的连接的系统。要允许 DHCP 服务为这台机器分配域名，请只指定简短主机名。`localhost.localdomain` 表示没有为目标系统配置特定静态主机名，同时在执行网络配置的过程中会配置安装的系统的实际主机名，比如使用 DHCP 或 DNS 的 `NetworkManager`。 										

8. ​									点 Apply 在环境中应用主机名。 							

#### 10.3.3.2. 添加虚拟网络接口

​							按照以下步骤添加虚拟网络接口。 					

**流程**

1. ​									在 **Network & Host name** 窗口中点击 + 按钮添加虚拟网络接口。此时会打开 **Add a device** 对话框。 							
2. ​									选择四个可用虚拟接口类型之一： 							
   - ​											**bond**: NIC（*网络接口控制器）*绑定,这是将多个物理网络接口绑定到单个绑定频道的方法。 									
   - ​											**Bridge**:代表 NIC 桥接,这是将多个独立网络连接到一个聚合网络的方法。 									
   - ​											**team: NIC 团队** （用来聚合链接的新实现）。它旨在提供一个小内核驱动程序来实现对数据包流的快速处理,以及各种应用程序在用户空间中执行其他所有操作。 									
   - ​											**VLAN** （*虚拟 LAN）*:创建多个不同的广播域的方法,它们是相互隔离的。 									
3. ​									选择接口类型并点击 Add。此时会打开一个编辑接口对话框,允许您为所选接口类型编辑所有可用设置。如需更多信息,请参阅 [第 10.3.3.3 节 “编辑网络接口配置”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#editing-network-interface-configuration_network-hostname)。 							
4. ​									点 Save 来确认虚拟接口设置并返回到 **Network & Host name 窗口**。 							

注意

​								如果您需要更改虚拟接口的设置,请选择接口并点击 Configure。 						

#### 10.3.3.3. 编辑网络接口配置

​							本节介绍在安装过程中使用的典型有线连接的重要设置。配置其他类型的网络与其基本相同，但具体的配置参数可能有所不同。 					

注意

​								对于 IBM Z,您无法添加新连接,因为网络子频道需要预先分组和在线,当前只在引导阶段完成。 						

**流程**

1. ​									要手动配置网络连接,请从 **网络和主机名称** 窗口中选择接口并点击 Configure。 							

   ​									此时会打开特定于所选接口的编辑对话框。 							

注意

​								出现的选项取决于连接类型 - 可用选项根据连接类型是物理接口（有线或有线网络接口控制器）还是之前在 [第 10.3.3.2 节 “添加虚拟网络接口”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#adding-a-virtual-network-interface_network-hostname) 中配置的虚拟接口（Bond、Bridge、Team 或 Vlan）而稍有不同。 						

​							以下部分包含有关编辑对话框中三个最常用和最有用的选项的信息： 					

#### 10.3.3.4. 启用或者禁用接口连接

​							按照以下步骤中的步骤启用或禁用接口连接。 					

**流程**

1. ​									点击**常规**标签。 							

2. ​									选择 **与优先级自动连接** 框以默认启用连接。将默认优先级设置保留为 `0`。 							

   重要

   - ​												当在有线连接中启用时，系统会在启动或重启过程中自动连接。在无线连接中，接口会尝试连接到所有已知的无线网络。有关 NetworkManager 的详情,包括 `nm-connection-editor` 工具,请参阅 [*配置和管理网络文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_networking/index?lb_target=production)。 										
   - ​												您可以通过设置 **All users may connect to this network** 选项来允许或禁止系统上的所有用户连接到这个网络。如果您禁用这个选项,则只有 `root` 能够连接到这个网络。 										
   - ​												不可能只允许 `root` 以外的特定用户使用这个接口,因为在安装过程中没有创建其它用户。如果您需要其他用户的连接，需要在安装后配置它。 										

3. ​									点击 保存 按钮应用这些更改并返回到 **网络和主机名称** 窗口。 							

#### 10.3.3.5. 设置静态 IPv4 或者 IPv6 设置

​							默认情况下，根据当前的网络设置，IPv4 和 IPv6 都被设置为自动配置。这意味着,当接口连接到网络时,会自动检测到本地 IP 地址、DNS 地址和其他设置。在很多情况下，这已经足够了。但您也可以在 **IPv4 设置**和 **IPv6 设置** 标签页中对它们进行静态配置。完成以下步骤来配置 IPv4 或 IPv6 设置： 					

**流程**

1. ​									要设置静态网络配置，请导航到一个 IPv 设置标签页，并在 **方法** 下拉菜单中选择除 **Automatic** 以外的方法，例如**Manual**。Addresses **窗格** 被启用。 							

   注意

   ​										在 **IPv6 设置** 标签页中，您还可以将方法设置为 **Ignore** 以禁用此接口上的 IPv6。 								

2. ​									点 Add 并输入您的地址设置。 							

3. ​									在 **Additional DNS server 字段** 中输入 IP 地址,它接受一个或多个 DNS 服务器的 IP 地址,例如 `10.0.0.1,10.0.0.8`。 							

4. ​									选择 **Require IPv\*X\* 地址以完成** 复选框。 							

   注意

   ​										在 **IPv4 Settings 或 \**IPv\** 6 设置标签页中** 选择这个选项,以仅在 IPv4 或 IPv6 成功时允许这个连接。如果 IPv4 和 IPv6 都禁用这个选项,如果在任何一个 IP 协议上的配置都成功,接口就可以连接。 								

5. ​									点击 保存 按钮应用这些更改并返回到 **Network & Host name** 窗口。 							

#### 10.3.3.6. 配置路由

​							完成以下步骤以配置路由。 					

**流程**

1. ​									在 **IPv4 Settings** 和 **IPv6 Settings** 标签页中，点击 路由 来配置接口上特定 IP 协议的路由设置。一个特定于接口的编辑路由对话框。 							

2. ​									点击 Add 以添加路由。 							

3. ​									选择 **Ignore 自动获取路由** 复选框来配置至少一个静态路由,并禁用所有未特别配置的路由。 							

4. ​									如果 **只为网络复选框中的资源选择 Use this connection**,以防止连接成为默认路由。 							

   注意

   ​										即使没有配置任何静态路由，也可以选择这个选项。这个路由只用来访问某些资源，比如需要本地或者 VPN 连接的内部网页。另一个（默认）路由用于公开的资源。与配置的附加路由不同，这个设置会被传送到安装的系统上。这个选项仅在配置多个接口时可用。 								

5. ​									点击 OK 保存您的设置并返回特定于该接口的编辑路由对话框。 							

6. ​									点击 Save 以应用设置并返回到 **Network and Host Name** 窗口。 							

#### 10.3.3.7. 其它资源

- ​									如需了解在安装后配置网络的更多信息，请参阅 [*配置和管理网络*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_networking/index/)文档。 							

### 10.3.4. 配置连接到红帽

​						Red Hat Content Delivery Network(CDN)（ cdn.redhat.com）是一  个分布式的静态网页服务器,包含系统消耗的内容和勘误。可直接使用该内容，比如使用一个注册到 Red Hat Subscription  Management 的系统。CDN 受 x.509  证书认证保护，以保证只有有效用户可访问。当在红帽订阅管理中注册系统时，附加的订阅管理该系统可访问的 CDN 子集。 				

​						从 CDN 注册并安装 RHEL 有以下优点： 				

- ​								CDN 安装方法支持 Boot ISO 和 Binary DVD ISO 镜像文件。但推荐使用较小的引导 ISO 镜像文件，因为它消耗的空间比较大的二进制 DVD ISO 镜像文件要少。 						
- ​								CDN 使用最新的软件包以便安装后有一个完全最新的系统。安装后不需要立即安装软件包更新，在使用 Binary DVD ISO 镜像文件时通常会如此。 						
- ​								集成了对连接 Red Hat Insights 和启用系统目的的支持。 						

#### 10.3.4.1. 系统目的介绍

​							系统目的（System Purpose）是 Red Hat Enterprise Linux  安装的可选功能，我们推荐使用它。您可使用系统目的记录 Red Hat Enterprise Linux 8  系统的预期使用，并确定授权服务器自动为您的系统附加最合适的订阅。 					

​							优点包括： 					

- ​									为系统管理员和商业操作提供深入系统级的信息。 							
- ​									降低管理成本以决定系统为什么及其预期目的。 							
- ​									改进了 Subscription Manager 自动附加的客户体验，并自动发现并协调系统使用。 							

​							可以用以下方法之一输入系统目的： 					

- ​									创建镜像期间 							
- ​									在 GUI 安装过程中，使用 **连接到红帽** 的界面注册您的系统并附加您的红帽订阅 							
- ​									在使用 Kickstart 自动化脚本的 Kickstart 安装过程中 							
- ​									在安装后，使用 **syspurpose 命令行 (** CLI）工具进行 							

​							要记录系统的预期目的，您可以配置以下系统目的组件。注册时授权服务器会使用所选值为您的系统附加最合适的订阅。 					

- ​									**Role** 							
  - ​											Red Hat Enterprise Linux Server 									
  - ​											Red Hat Enterprise Linux Workstation 									
  - ​											Red Hat Enterprise Linux Compute 节点 									
- ​									**服务等级协议** 							
  - ​											Premium（高级） 									
  - ​											Standard（标准） 									
  - ​											Self-Support（自助） 									
- ​									**使用** 							
  - ​											生产环境 									
  - ​											开发/测试 									
  - ​											灾难恢复 									

**其它资源**

- ​									有关镜像构建器的更多信息，请参阅 [*编写自定义的 RHEL 系统镜像*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/composing_a_customized_rhel_system_image/index/)文档。 							
- ​									有关 Kickstart 的详情，请查看 [*执行高级 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/)文档。 							
- ​									有关 Subscription Manager 的详情，请参考 [*使用和配置 Red Hat Subscription Manager*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index/) 文档。 							

#### 10.3.4.2. 配置连接至红帽选项

​							使用以下步骤在 GUI 中配置连接到红帽的选项。 					

注意

​								可以使用您的红帽帐户或者激活码在 CDN 中注册。 						

**流程**

1. ​									点击 **帐户**。 							

   1. ​											输入您的红帽客户门户网站用户名和密码详情。 									

2. ​									可选： 点击 **激活码**。 							

   1. ​											输入您的机构 ID 和激活码。当把您的激活码注册到订阅中时，就可以输入多个激活码（使用逗号分开）。 									

3. ​									选择 **设置系统** 复选框。系统目的使授权服务器能够决定并自动附加最合适的订阅以满足您的 RHEL 8 系统预期的使用。 							

   1. ​											从对应的下拉列表中选择所需的 **Role**、**SLA** 和 **Usage**。 									

4. ​									默认情况下启用 **连接到 Red Hat Insights** 复选框。如果您不想连接到 Red Hat Insights，请清除复选框。 							

   注意

   ​										Red Hat Insights 是一个软件即服务(SaaS)服务(SaaS),它提供对注册的红帽系统的持续分析，以主动识别跨物理、虚拟和云环境以及容器部署的安全性、性能和稳定性。 								

5. ​									可选：扩展 **选项**。 							

   1. ​											如果您的网络环境只允许外部互联网访问，或通过 HTTP 代理服务器访问内容服务器，请选择 **Use HTTP proxy** 复选框。如果不使用 HTTP 代理，则取消选择 **Use HTTP proxy** 选项。 									

   2. ​											如果您要运行 Satellite 服务器或执行内部测试，请选择 **自定义服务器 URL** 和 **自定义基本 URL** 复选框，并输入所需详情。 									

      重要

      - ​														**自定义服务器 URL** 字段不需要 HTTP 协议,如 `nameofhost.com`。但是, **自定义基本 URL 字** 段需要 HTTP 协议。 												
      - ​														要在注册后更改 **Custom base URL**，您必须取消注册，提供新详情，然后重新注册。 												

6. ​									点 Register 注册该系统。当成功注册系统并附加订阅后, **连接到红帽** 窗口会显示附加的订阅详情。 							

   注意

   ​										根据订阅的数量，注册和附加过程可能需要一分钟时间完成。 								

7. ​									点击 完成 返回 **安装概述** 窗口。 							

   1. ​											在 **Connect to Red Hat** 下会显示一个 *Registered* 信息。 									

#### 10.3.4.3. 系统注册后安装源存储库

​							系统注册后的安装源存储库依赖于系统的引导方式。 					

- 系统使用引导 ISO 或者 Binary DVD ISO 镜像文件引导

  ​										如果您使用带有默认引导参数的 `Boot ISO` 或 `Binary DVD ISO` 镜像文件引导 RHEL 安装,安装程序会在注册后自动将安装源存储库切换到 CDN。 								

- 系统使用 `inst.repo=<URL>` 引导参数引导

  ​										如果您使用 `inst.repo=<URL>` 引导参数引导 RHEL 安装,安装程序不会在注册后自动将安装源存储库切换到 CDN。如果要使用 CDN 安装 RHEL，您必须在图形安装的**安装源**窗口中选择 **红帽 CDN** 选项手动将 安装源存储库切换到 CDN。如果没有手动切换到 CDN,安装程序会从内核命令行中指定的程序库安装软件包。 								

重要

- ​										如果您没有使用内核命令行中的 `inst.repo=` 或者 Kickstart 文件中的 `url` 命令指定安装源,则只能使用 `rhsm` Kickstart 命令将安装源存储库切换到 CDN。您必须在内核命令行中使用 `inst.stage2=<URL>` 获取安装镜像,但不指定安装源。 								
- ​										使用引导选项指定或者包含在 Kickstart 文件中的安装源 URL 优先于 CDN,即使 Kickstart 文件包含带有有效凭证的 `rhsm` 命令。已注册该系统，但会通过 URL 安装源进行安装。这样可保证早期安装进程正常运行。 								

#### 10.3.4.4. 从 CDN 验证您的系统注册

​							使用这个步骤来验证您的系统是否使用 GUI 在 CDN 中注册。 					

警告

​								如果您**没有**从**Installation Summary** 窗口中按 **Begin Installation** 按钮，则只能从 CDN 验证您的注册。点击 **开始安装** 按钮后,您就无法返回安装概述窗口来验证您的注册。 						

**先决条件**

- ​									您已完成了注册过程 *,* 如 [第 9.2 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#register-and-install-from-cdn-using-gui_register-and-install-from-cdn) 所述, Registered 在 **Installation Summary** 窗口中 **的 Connect to Red Hat** 下显示。 							

**流程**

1. ​									在 **安装概述** 窗口中选择 **连接到红帽**。 							

2. ​									该窗口将打开并显示注册概述： 							

   - 方法

     ​												此时会显示注册的帐户名称或者激活码。 										

   - 系统用途

     ​												如果设置，则会显示角色、SLA 和用量详情。 										

   - Insights

     ​												如果启用，则显示 Insights 详情。 										

   - 订阅数

     ​												此时会显示附加的订阅数。 										

3. ​									验证注册概述是否与输入的详细信息匹配。 							

#### 10.3.4.5. 从 CDN 取消注册您的系统

​							这个过程使用 GUI 从 CDN 取消注册您的系统。 					

警告

- ​										如果您还 **没有** 在安装 **概述** 窗口中点击 开始安装按钮，则可以从 CDN 取消注册。点击开始安装按钮后，您就无法返回安装概述窗口取消注册。 								
- ​										取消注册时，安装程序会按以下顺序切换到第一个可用的存储库： 								
  1. ​												内核命令行中的 inst.repo=<url> 引导参数中使用的 URL。 										
  2. ​												安装介质（USB 或者 DVD）中自动探测到的软件仓库。 										

**先决条件**

- ​									您已完成了注册过程 *,* 如 [第 9.2 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#register-and-install-from-cdn-using-gui_register-and-install-from-cdn) 所述, Registered 在 **Installation Summary** 窗口中 **的 Connect to Red Hat** 下显示。 							

**流程**

1. ​									在 **安装概述** 窗口中选择 **连接到红帽**。 							

2. ​									**连接到红帽** 窗口会打开并显示注册概述： 							

   - 方法

     ​												此时会显示注册的帐户名称或者使用的激活码。 										

   - 系统用途

     ​												如果设置，则会显示角色、SLA 和用量详情。 										

   - Insights

     ​												如果启用，则显示 Insights 详情。 										

   - 订阅数

     ​												此时会显示附加的订阅数。 										

3. ​									点击 Unregister 从 CDN 中删除注册。原始注册详情会在窗口的下半部分显示 **Not registered** 信息。 							

4. ​									点击 完成 返回 **安装概述** 窗口。 							

5. ​									**Connect to Red Hat** 会显示一个 *Not registered* 信息，**Software Selection** 显示 *Red Hat CDN requires registration* 信息。 							

注意

​								取消注册后，就可以重新注册您的系统。点击 **连接到红帽**。之前输入的详细信息会填充。编辑原始详情，或者根据帐户、目的和连接更新相应的性。点击 Register 以完成。 						

**相关信息**

- ​									有关 Red Hat Insights 的详情,请查看 [*Red Hat Insights 产品文档*](https://access.redhat.com/documentation/en-us/red_hat_insights/)。 							
- ​									有关激活码的详情，请查看 *使用红帽订阅管理*文档中的[*了解激活码*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html/using_red_hat_subscription_management/activation_keys_con) 一章。 							
- ​									有关如何为 Subscription Manager 设置 HTTP 代理服务器的详情，请参考*使用并配置 Red Hat Subscription Manager* 文档中的[*使用 HTTP 代理*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index#repos-proxy)章节。 							

### 10.3.5. 配置安全策略

​						这部分包含有关 Red Hat Enterprise Linux 8 安全策略以及如何进行配置以便用于您的系统的信息。 				

#### 10.3.5.1. 关于安全策略

​							Red Hat Enterprise Linux 安全策略遵循安全内容自动化协议(SCAP)标准中定义的限制和建议（合规政策）。软件包被自动安装。但默认情况下，不会强制实施任何策略，因此在安装过程中或安装后不会执行任何检查，除非有特殊配置。 					

​							应用安全策略不是安装程序的强制功能。如果您在系统中应用安全策略，则会使用您选择的配置集中定义的限制和建议安装该系统。在软件包选择中添加了 **openscap-scanner** 软件包，为合规及漏洞扫描提供预安装工具。安装完成后，系统会自动扫描以确认合规。扫描结果保存到安装系统的 `/root/openscap_data` 目录中。您还可以从 HTTP、HTTPS 或者 FTP 服务器载入附加配置集。 					

#### 10.3.5.2. 配置安全策略

​							完成以下步骤以配置安全策略。 					

**先决条件**

​								打开 **安装概述** 窗口。 						

**流程**

1. ​									在 **安装概述** 窗口中点击 **安全策略**。此时会打开 **Security Policy** 窗口。 							

2. ​									要在系统中启用安全策略，将**Apply security policy** 设置为 **ON**。 							

3. ​									从上面的方框中选择一个配置集。 							

4. ​									点击 Select profile。 							

   ​									安装前必须应用的配置集的更改出现在底部方框中。 							

   注意

   ​										安装前不需要更改默认配置集。但是，载入自定义配置集可能需要预安装任务。 								

5. ​									点击 更改内容 使用自定义配置集。此时会打开 一 个单独的窗口，允许您输入一个有效安全内容的 URL。 							

   1. ​											点击 Fetch 以检索 URL。 									

   2. ​											点击 使用 SCAP 安全指南 返回安全策略 **窗口**。 									

      注意

      ​												您可以从 **HTTP**、**HTTPS** 或者 **FTP** 服务器载入自定义配置集。使用包括协议内容的完整地址，比如 **http://**。在载入自定义配置集前必须激活网络连接。安装程序自动检测内容类型。 										

6. ​									点击 完成 按钮应用该设置并返回 **安装概述** 窗口。 							

#### 10.3.5.3. 相关信息

- ​									`scap-security-guide(8)` - `scap-security-guide` 项目的手册页包含有关 SCAP 安全配置集的信息,包括如何使用 OpenSCAP 工具使用所提供的基准量的示例。 							
- ​									Red Hat Enterprise Linux 安全合规性的信息包括在 [ *安全强化*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/index/)文档中。 							

## 10.4. 配置软件选项

​					本节包含有关配置安装源和软件选择设置以及激活库的信息。 			

### 10.4.1. 配置安装源

​						完成此步骤中的步骤,从自动探测的安装介质、Red Hat CDN 或网络配置安装源。 				

注意

​							当 **安装概述**窗口第一次打开时，安装程序会尝试根据用来引导系统的介质类型配置安装源。完整的 Red Hat Enterprise Linux 服务器 DVD 将源配置为本地介质。 					

**先决条件**

- ​								您下载了 Binary DVD ISO 镜像,详情请参考 [第 3 章 *下载 RHEL 安装 ISO 镜像*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 						
- ​								您已创建了可引导安装介质,详情请参阅 [创建可引导 DVD 或者 CD](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-an-installation-cd-or-dvd_assembly_creating-a-bootable-installation-medium)。 						
- ​								打开 **安装概述** 窗口。 						

**流程**

1. ​								在 **安装概述** 窗口中点击 **安装源**。此时会打开 **安装源** 窗口。 						

   1. ​										请参阅 **自动探测到的安装介质** 部分以验证详情。如果您从包含安装源（例如 DVD）的介质启动安装程，则默认选择这个选项。 								

   2. ​										点击 验证 检查介质的完整性。 								

   3. ​										查看 **Additional repositories库** 部分，**AppStream** 复选框会被默认选择。 								

      重要

      - ​													**因为作为完整安装镜像的 一 部分安装 BaseOS 和 AppStream 软件仓库，因此不需要额外的配置。** 											
      - ​													**如果您想要完整 Red Hat Enterprise Linux8 安装,请不要禁用 AppStream 存储库复选框。** 											

2. ​								可选： 选择 **Red Hat CDN** 选项来注册您的系统、附加 RHEL 订阅并从 Red Hat Content Delivery Network(CDN)安装 RHEL。如需更多信息,请参阅 *CDN 注册并安装 RHEL 部分*。 						

3. ​								可选： 选择 **On the network** 选项从网络而不是本地介质下载和安装软件包。 						

   注意

   - ​											如果您不想从网络位置下载并安装附加软件仓库,请执行 [第 10.4.2 节 “配置软件选择”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-software-selection_configuring-software-settings)。 									
   - ​											这个选项仅在网络连接活跃时可用。有关如何在 GUI 中配置网络连接的详情请参考 [第 10.3.3 节 “配置网络和主机名选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#network-hostname_configuring-system-settings)。 									

   1. ​										选择 **On the network** 下拉菜单指定下载软件包的协议。这个设置取决于您要使用的服务器。 								

   2. ​										在地址字段输入服务器地址（不包括协议）。如果您选择 NFS，则会出现第二个输入字段，您可以在其中指定自定义 **NFS 挂载选项**。这个字段接受 `nfs(5)` man page 中列出的选项。 								

      重要

      ​											选择 NFS 安装源时,您必须使用将主机名与路径分开的冒号(`:`)字符指定地址。例如： 									

      ```
      server.example.com:/path/to/directory
      ```

      注意

      ​											以下步骤是可选的，且只在您使用代理进行网络访问时才需要。 									

   3. ​										点击 Proxy setup… 为 HTTP 或 HTTPS 源配置代理。 								

   4. ​										选择**启用 HTTP 代理服务器** 复选框，然后在 **Proxy Host** 字段输入 URL。 								

   5. ​										如果代理服务器需要身份验证，选择 **Use Authentication** 选项。 								

   6. ​										输入您的用户名和密码。 								

   7. ​										点击 OK 完成配置并退出 **Proxy Setup…** 对话框。 								

      注意

      ​											如果您的 HTTP 或者 HTTPS URL 引用了存储库镜像菜单，请从 **URL 类型** 下拉列表中选择所需选项。完成源配置后，所有环境和附加软件包都可以被选择。 									

4. ​								点击 + 添加存储库。 						

5. ​								点击 - 删除库。 						

6. ​								在打开 **安装源** 窗口时,点击 箭头 图标将当前条目恢复到设置。 						

7. ​								要激活或取消激活库,请点击列表中每个条目的 **Enabled** 列中的复选框。 						

   注意

   ​									您可以通过与网络中的主存储库相同的方式命名并配置附加存储库。 							

8. ​								点击 完成 按钮应用该设置并返回 **安装概述** 窗口。 						

### 10.4.2. 配置软件选择

​						使用 **软件选择**窗口选择所需软件包。软件包被分为 Base Environment 和 Additional Software。 				

- ​								**Base Environment（基本环境）** 包含预定义的软件包。您只能选择一个基本环境，且可用性取决于用作安装源的安装 ISO 镜像。 						
- ​								**Additional Software for Selected Environment（所选环境的额外软件）**包含基本环境的额外软件包。您可以选择多个软件软件包。 						

​						使用预定义的环境和其他软件自定义您的系统。然而，在标准安装中不能选择要安装的单独软件包。要查看特定环境中的软件包,请查看安装源介质（DVD、CD、USB）中的 `*repository*/repodata/*-comps-*repository*.*architecture*.xml` 文件。XML 文件包含作为基础环境一部分安装的软件包详情。可用环境由 `<environment>` 标签标记,其他软件包由 `<group>` 标签标记。 				

​						如果您不确定要安装哪些软件包，红帽建议您选择 **最小安装（minimal Install）** 基本环境。最小安装只安装一个基本的 Red Hat Enterprise Linux 版本，以及少量的附件软件。在系统完成安装并首次登录后，您可以使用 **Yum** 安装其他软件。有关 Yum 软件包管理器的详情，请查看 [*配置基本系统设置*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_basic_system_settings/index/)文档。 				

注意

- ​									`yum group list` 命令列出来自 yum 软件仓库的所有软件包组。如需更多信息，请参阅 [*配置基本系统设置*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_basic_system_settings/index/) 文档。 							
- ​									如果您需要控制安装哪些软件包,可以使用 Kickstart 文件并在 `%packages` 部分定义软件包。有关使用 Kickstart 安装 Red Hat Enterprise Linux 的详情，请查看[*执行高级 RHEL*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/) 安装文档。 							

**先决条件**

- ​								您已配置了安装源。 						
- ​								安装程序下载软件包元数据。 						
- ​								打开 **安装概述** 窗口。 						

**流程**

1. ​								在 **安装概述** 窗口中点击 **软件选择**。此时会打开 **软件选择** 窗口。 						

2. ​								在 **Base Environment** 窗格中选择一个基础环境。您只能选择一个基本环境。 						

   注意

   ​									**Server with GUI** 基础环境的服务器是默认的基础环境，它会在安装完成后启动 **Initial Setup** 应用程序，然后重启系统。 							

3. ​								在 **Additional Software for Selected Environment** 框中选择一个或多个选项。 						

4. ​								点击完成 应用设置并返回 [第 10 章 *自定义安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#graphical-installation_graphical-installation)。 						

## 10.5. 配置存储设备

​					您可以在各种存储设备中安装 Red Hat Enterprise Linux。您可以在**安装目的**窗口配置基本的、可以通过本地访问的存储设备。直接连接到本地系统的基本存储设备,比如硬盘驱动器和固态驱动器,会在窗口的 **Local Standard Disks** 部分显示。在 IBM Z 中,本节包含激活的直接访问存储设备(DASD)。 			

警告

​						一个已知的问题导致在安装完成后自动将配置为 HyperPAV 别名的 DASD 附加到系统。这些存储设备会在安装过程中可用，但完成安装并重启后无法立即访问。要附加 HyperPAV 别名设备,请手动将其添加到系统的 `/etc/dasd.conf` 配置文件中。 				

### 10.5.1. 存储设备选择

​						存储设备选择窗口列出了安装程序可访问的所有存储设备。根据您的系统和可用的硬件, 一些标签可能无法显示。在以下标签页下对设备进行分组： 				

- 多路径设备

  ​									存储设备可以通过多个路径访问,比如通过多个 SCSI 控制器或者同一系统中的 Fiber Channel 端口。 							重要 									安装程序只检测到 16 个或者 32 个字符长的序列号的多路径存储设备。 								

- 其他 SAN 设备

  ​									Storage Area Network(SAN)中的设备可用。 							

- 固件 RAID

  ​									附加到固件 RAID 控制器中的存储设备。 							

- NVDIMM 设备

  ​									在特定情况下,Red Hat Enterprise Linux 8 可以在 Intel 64 和 AMD64 构架的扇区模式下从(NVDIMM)设备引导并运行。 							

- System z 设备

  ​									存储设备,或者逻辑单元(LUN),通过 zSeries Linux FCP(Fiber Channel Protocol)驱动程序附加。 							

### 10.5.2. 过滤存储设备

​						在存储设备选择窗口中,您可以使用其通用识别符(WWID)或者端口、目标或者逻辑单元号(LUN)过滤存储设备。 				

**先决条件**

​							打开 **安装概述** 窗口。 					

**流程**

1. ​								在 **安装概述** 窗口中点击 **Installation Destination**。此时会打开 **Installation Destination** 窗口，列出所有可用的驱动器。 						

2. ​								在 **Specialized & Network Disks** 项中，点 Add a disk…。存储设备选择窗口将打开。 						

3. ​								点 **Search by** 标签页来根据端口、目标、LUN 或 WWID 进行搜索。 						

   ​								通过 WWID 或 LUN 搜索需要在对应的输入文本字段中增加值。 						

4. ​								从**搜索**下拉菜单中选择您需要的选项。 						

5. ​								点 Find 开始搜索。每个设备都会显示在一个独立的行中，并有一个对应的复选框。 						

6. ​								选择要启用安装过程中所需设备的复选框。 						

   ​								之后在安装过程中，您可以选择在任意选择的设备中安装 Red Hat Enterprise Linux，您可以选择自动挂载其它选择的设备作为安装系统的一部分。 						

   注意

   - ​											所选设备不会被安装过程自动清除，而选择设备不会将数据存储在设备中。 									
   - ​											您可以在安装后通过修改 `/etc/fstab` 文件在系统中添加设备。 									

7. ​								点 Done 返回 **Installation Destination** 窗口。 						

重要

​							所有您没有选择的存储设备都会在安装程序中完全隐藏。要使用不同的引导装载程序链载入引导装载程序，请选择所有存在的设备。 					

### 10.5.3. 使用高级存储选项

​						要使用高级存储设备,您可以配置 iSCSI(SCSI over TCP/IP)目标或者 FCoE（光纤通道以太网）SAN(Storage Area Network)。 				

​						要将 iSCSI 存储设备用于安装,安装程序必须能够将其发现为 iSCSI 目标,并可创建一个 iSCSI  会话来访问它们。每个步骤都可能需要一个用户名和密码来进行 Challenge Handshake Authentication  Protocol(CHAP)验证。另外,您可以配置 iSCSI 目标来在附加目标的系统上验证 iSCSI 启动程序（反向  CHAP）,以发现和会话。CHAP 和反向 CHAP 一起使用,称为 mutual CHAP 或双向 CHAP。mutual CHAP 为  iSCSI 连接提供最高级别的安全性,特别是如果 CHAP 验证和反向 CHAP 验证的用户名和密码不同。 				

注意

​							重复 iSCSI 发现和 iSCSI 登录步骤以添加所有所需的 iSCSI 存储。第一次尝试发现后，您无法更改 iSCSI initiator 的名称。要更改 iSCSI initiator 名称，您必须重新开始安装。 					

#### 10.5.3.1. 发现并启动 iSCSI 会话

​							完成以下步骤以发现并启动 iSCSI 会话。 					

**先决条件**

- ​									打开 **安装概述** 窗口。 							

**流程**

1. ​									在 **安装概述** 窗口中点击 **Installation Destination**。此时会打开 **Installation Destination** 窗口，列出所有可用的驱动器。 							

2. ​									在 **Specialized & Network Disks** 项中，点 Add a disk…。存储设备选择窗口将打开。 							

3. ​									点 Add iSCSI target…。此时会打开 **Add iSCSI Storage Target** 窗口。 							

   重要

   ​										您不能将 `/boot` 分区放在您使用这个方法手动添加的 iSCSI 目标 - 必须配置包含 `/boot` 分区的 iSCSI 目标用于 iBFT。但是,当安装的系统使用由固件 iBFT 以外的方法提供的 iBFT 配置（例如使用 iPXE）引导时,您可以使用 `inst.nonibftiscsiboot` 安装程序引导选项删除 `/boot` 分区限制。 								

4. ​									在 **Target IP Address** 字段中输入 iSCSI 目标的 IP 地址。 							

5. ​									以 **iSCSI 限定名称(IQN)格式在 iSCSI Initiator Name 字段** 中输入一个名称。有效的 IQN 条目包含以下内容： 							

   - ​											字符串 `iqn.` （代表周期）。 									

   - ​											一个日期代码,指定您所在机构的互联网域或子域名注册的年和月份,以该年的四个数字、横线和月份的两个数字代表,后一个期限。例如, 2010 年 9 月作为 `2010-09.` 									

   - ​											您所在机构的互联网域或子域名,首先以相反的顺序显示。例如,代表子域 `storage.example.com` 作为 `com.example.storage`。 									

   - ​											一个冒号，后面接着一个在您的域或子域中指定这个特定 iSCSI initiator 的字符串。例如： `:diskarrays-sn-a8675309`。 									

     ​											一个完整的 IQN: `iqn.2010-09.storage.example.com:diskarrays-sn-a8675309`。安装程序使用一个这个格式的名称来预先填充 `iSCSI Initiator Name` 字段,以帮助您使用这个结构。如需更多与 IQN 相关的信息，请参阅 tools.ietf.org 中的 *RFC 3720 - Internet Small Computer Systems Interface (iSCSI)* 的 *3.2.6. iSCSI Names* 部分，以及 tools.ietf.org 中的 *RFC 3721 - Internet Small Computer Systems Interface (iSCSI) Naming and Discovery* 的*1. iSCSI Names and Addresses* 部分。 									

6. ​									选择 `Discovery Authentication Type` 下拉菜单指定用于 iSCSI 发现的验证类型。可用的选项如下： 							

   - ​											No credentials 									
   - ​											CHAP pair 									
   - ​											CHAP pair and a reverse pair 									

7. ​								

   1. ​											如果您选择了 `CHAP pair` 作为验证类型,在 `CHAP Username` 和 `CHAP Password` 字段中输入 iSCSI 目标的用户名和密码。 									
   2. ​											如果您选择 `CHAP pair and a reverse pair` 作为验证类型,在 `CHAP Username` 和 `CHAP Password` 字段中输入 iSCSI 目标的用户名和密码,在 `Reverse CHAP Username` 和 `Reverse CHAP Password` 字段中输入 iSCSI initiator 的用户名和密码。 									

8. ​									（可选）选择 `Bind targets to network interfaces` 复选框。 							

9. ​									点 Start Discovery。 							

   ​									安装程序会尝试根据提供的信息发现 iSCSI 目标。如果成功发现, `Add iSCSI Storage Target` 窗口会显示在目标上发现的所有 iSCSI 节点列表。 							

10. ​									选择您要用于安装的节点的复选框。 							

    注意

    ​										`Node login authentication type` 菜单包含与 `Discovery Authentication Type` 菜单相同的选项。但是,如果您需要凭证才能进行发现身份验证,请使用相同的凭证登录到已发现的节点。 								

11. ​									点击额外的 `Use the credentials from discovery` 下拉菜单。当您提供正确的凭证时, Log In 按钮将可用。 							

12. ​									点击 Log In 启动 iSCSI 会话。 							

#### 10.5.3.2. 配置 FCoE 参数

​							完成以下步骤以配置 FCoE 参数。 					

**先决条件**

​								打开 **安装概述** 窗口。 						

**流程**

1. ​									在 **安装概述** 窗口中点击 **Installation Destination**。此时会打开 **Installation Destination** 窗口，列出所有可用的驱动器。 							
2. ​									在 **Specialized & Network Disks** 项中，点 Add a disk…。存储设备选择窗口将打开。 							
3. ​									点 Add FCoE SAN…。此时会打开一个对话框来配置网络接口来发现 FCoE 存储设备。 							
4. ​									在 `NIC` 下拉菜单中选择连接到 FCoE 开关的网络接口。 							
5. ​									点击 Add FCoE disk(s) 在网络中扫描 SAN 设备。 							
6. ​									选择所需的复选框： 							
   - ​											**使用 DCB:** *数据中心桥接* (DCB)是一组对以太网协议的增强,旨在提高存储网络和集群中以太网连接的效率。选择要启用或禁用安装程序对 DCB 的了解的复选框。只在需要基于主机的 DCBX 客户端的网络接口中启用这个选项。对于使用硬件 DCBX 客户端的接口上的配置,禁用复选框。 									
   - ​											**使用 auto vlan:** *Auto VLAN* 被默认启用用来指示是否应该执行 VLAN 发现。如果启用了这个复选框,则当链路配置验证时,FIP(FCoE Initiation  Protocol)VLAN 发现协议会在以太网接口中运行。如果还没有配置它们,则自动为任何发现的 FCoE VLAN 创建网络接口,并在  VLAN 接口上创建 FCoE 实例。 									
7. ​									发现的 FCoE 设备会在 **Installation Destination** 窗口中的 `Other SAN Devices` 标签页下显示。 							

#### 10.5.3.3. 配置 DASD 存储设备

​							完成以下步骤来配置 DASD 存储设备。 					

**先决条件**

​								打开 **安装概述** 窗口。 						

**流程**

1. ​									在 **安装概述** 窗口中点击 **Installation Destination**。此时会打开 **Installation Destination** 窗口，列出所有可用的驱动器。 							
2. ​									在 **Specialized & Network Disks** 项中，点 Add a disk…。存储设备选择窗口将打开。 							
3. ​									点击 添加 DASD。**Add DASD Storage Target** 对话框会打开，提示您输入一个设备号，如 **0.0.0204**，并附加在安装开始时没有被发现的额外 DASD。 							
4. ​									在 **Device number** 字段输入您要附加的 DASD 设备号。 							
5. ​									点 Start Discovery。 							

注意

- ​										如果找到了带有指定设备号的 DASD,如果还没有附加它,则对话框会关闭,在驱动器列表中会显示新发现的驱动器。然后您可以选择所需设备的复选框并点击 完成。新的 DASD 可以选择,在 **Installation Destination** 窗口中的 **Local Standard Disks** 部分标记为 `DASD device 0.0.*xxxx*`。 								
- ​										如果您输入了一个无效的设备号码，或者带有指定设备号的 DASD 已被附加到系统，那么会在对话框中出现出错信息，解释错误原因并提示您使用不同的设备号码再次尝试。 								

#### 10.5.3.4. 配置 FCP 设备

​							FCP 设备可以使 IBM Z 使用 SCSI 设备而不是使用 DASD 设备，或作为 DASD 设备的补充。FCP 设备提供了一个交换光纤拓扑,它可让 IBM Z 系统使用 SCSI LUN 作为磁盘设备,除了传统的 DASD 设备外。 					

**先决条件**

- ​									打开 **安装概述** 窗口。 							
- ​									对于只使用 FCP 的安装,从 CMS 配置文件中删除 `DASD=` 选项,或者从参数文件中删除 `rd.dasd=` 选项以指示没有 DASD。 							

**流程**

1. ​									在 **安装概述** 窗口中点击 **Installation Destination**。此时会打开 **Installation Destination** 窗口，列出所有可用的驱动器。 							

2. ​									在 **Specialized & Network Disks** 项中，点 Add a disk…。存储设备选择窗口将打开。 							

3. ​									点击 添加 ZFCP LUN。**Add zFCP Storage Target** 对话框将允许您添加 FCP（光纤通道协议）存储设备。 							

   ​									IBM Z 要求您手动输入任何 FCP 设备以便安装程序可以激活 FCP LUN。您可以在图形安装中输入 FCP  设备,也可以在参数或者 CMS 配置文件中作为唯一参数条目输入 FCP 设备。您输入的值对于您配置的每个站点来说必须是唯一的。 							

4. ​									在 **Device number** 字段输入 4 位十六进制设备号码。 							

5. ​									在 **WWPN** 字段中输入 16 位的十六进制 World Wide Port Number（WWPN）。 							

6. ​									在 **LUN** 字段中输入 16 位的十六进制 FCP LUN 标识符。 							

7. ​									点 Start Discovery 连接到 FCP 设备。 							

​							新添加的设备在 **Installation Destination** 窗口中的 **System z Devices** 标签页中显示。 					

注意

- ​										交互式地创建 FCP 设备只能在图形模式中进行。不可能在文本模式安装中以互动方式配置 FCP 设备。 								
- ​										在十六进制值中只使用小写字母。如果您输入了不正确的值并点击 Start Discovery，安装程序会显示一个警告。您可以编辑配置信息并重试发现尝试。 								
- ​										有关这些值的更多信息,请参考硬件文档并检查系统管理员。 								

### 10.5.4. 安装到一个 NVDIMM 设备

​						在不提供电源时,非线性内存模块(NVDIMM)设备将 RAM 的性能与磁盘类数据持久性合并。在特定情况下,Red Hat Enterprise Linux 8 可以从 NVDIMM 设备引导并运行。 				

#### 10.5.4.1. 使用 NVDIMM 设备作为安装对象的条件

​							您可以在 Intel 64 和 AMD64 构架的扇区模式下将 Red Hat Enterprise Linux 8 安装到非线性内存模块(NVDIMM)设备,并被 **nd_pmem** 驱动支持。 					

**将 NVDIMM 设备用作存储的条件**

​								要将 NVDIMM 设备用作存储，必须满足以下条件： 						

- ​									系统的构架是 Intel 64 或者 AMD64。 							
- ​									NVDIMM 设备被配置为扇区模式。安装程序可将 NVDIMM 设备重新配置为这个模式。 							
- ​									NVDIMM 设备必须被 **nd_pmem** 驱动程序支持。 							

**从 NVDIMM 设备引导的条件**

​								在以下情况下可使用 NVDIMM 设备引导： 						

- ​									满足将 NVDIMM 设备用作存储的所有条件。 							
- ​									系统使用 UEFI。 							
- ​									NVDIMM 设备必须使用系统中可用的固件或者 UEFI 驱动程序支持。UEFI 驱动程序可以从该设备本身的选项 ROM 中载入。 							
- ​									NVDIMM 设备必须在命名空间下提供。 							

​							在引导过程中利用 NVDIMM 设备的高性能,将 `/boot` 和 `/boot/efi` 目录放在该设备中。在引导过程中不支持 NVDIMM 设备的 Execute-in-place(XIP)功能,内核被加载到传统的内存中。 					

#### 10.5.4.2. 使用图形安装模式配置 NVDIMM 设备

​							在使用图形安装时，必须正确配置非线性内存模块（NVDIMM）设备供 Red Hat Enterprise Linux 8 使用。 					

警告

​								重新配置 NVDIMM 设备进程会破坏该设备中保存的所有数据。 						

**先决条件**

- ​									系统中有 一 个 NVDIMM 设备，并满足所有其他可作为安装对象使用的条件。 							
- ​									安装已引导，并打开了 **Installation Summary** 窗口。 							

**流程**

1. ​									在 **安装概述** 窗口中点击 **Installation Destination**。此时会打开 **Installation Destination** 窗口，列出所有可用的驱动器。 							

2. ​									在 **Specialized & Network Disks** 项中，点 Add a disk…。存储设备选择窗口将打开。 							

3. ​									点击 **NVDIMM Devices** 选项卡。 							

4. ​									要重新配置某个设备，请从列表中选择它。 							

   ​									如果一个设备没有列出，则代表它不是扇区模式。 							

5. ​									点 Reconfigure NVDIMM…。此时会打开重新配置对话框。 							

6. ​									输入您需要的扇区大小并点击 Start Reconfiguration。 							

   ​									支持的扇区大小为 512 和 4096 字节。 							

7. ​									当重新配置完成时，请点击 确定。 							

8. ​									选择设备复选框。 							

9. ​									点 Done 返回 **Installation Destination** 窗口。 							

   ​									重新配置的 NVDIMM 设备会在 **Specialized & Network Disks** 部分显示。 							

10. ​									点击 完成 返回 **安装概述** 窗口。 							

​							现在您可以选择 NVDIMM 设备作为安装目标。另外，如果设备满足引导要求，您可以将设备设置为引导设备。 					

## 10.6. 配置手动分区

​					您可以使用手动分区来配置磁盘分区和挂载点，并定义安装 Red Hat Enterprise Linux 的文件系统。 			

注意

​						在安装前,您应该考虑是使用分区或者未分区的磁盘设备。如需更多信息，请参阅知识库文章 https://access.redhat.com/solutions/163853。 				

​					安装 Red Hat Enterprise Linux 需要至少一个分区,但红帽建议您至少使用以下分区或卷： `PReP`、`/`、`/home`、`/boot` 和 `swap`。您还可以根据需要创建额外的分区和卷。 			

注意

​						在 IBM Power 系统服务器中安装 Red Hat Enterprise Linux 需要 `PReP` 引导分区。 				

警告

​						要防止数据丢失，建议您在继续前备份数据。如果您要升级或创建一个双引导系统，您应该备份所有您要保留在存储设备中的数据。 				

### 10.6.1. 启动手动分区

**先决条件**

- ​								此时会显示 **安装概述** 页面。 						
- ​								所有磁盘都可用于安装程序。 						

**流程**

1. ​								选择用于安装的磁盘： 						

   1. ​										点 **Installation Destination** 打开 **Installation Destination** 窗口。 								
   2. ​										点击对应图标选择安装所需的磁盘。所选磁盘上显示了一个选择框。 								
   3. ​										在 **Storage Configuration** 下，选择 **Custom** 按钮。 								
   4. ​										可选： 要使用 LUKS 启用存储加密，选择 **Encrypt my data** 复选框。 								
   5. ​										点击 Done。 								

2. ​								如果您选择加密存储，则会打开一个输入磁盘加密密码短语的对话框。输入 LUKS 密码短语： 						

   1. ​										在两个文本字段输入密码短语。要切换键盘布局，使用键盘图标。 								

      警告

      ​											在输入密码短语的对话框中，您不能更改键盘布局。选择英文键盘布局在安装程序中输入密码短语。 									

   2. ​										点击 Save Passphrase。**Manual Partitioning** 窗口被打开。 								

3. ​								检测到的挂载点在左侧方框中列出。挂载点是由检测到的操作系统安装来组织。因此，如果在多个安装间共享分区，某些文件系统会被多次显示。 						

   1. ​										选择左侧窗格中的挂载点 ; 可自定义的选项会显示在右窗格中。 								

      注意

      - ​													如果您的系统包含现有文件系统，则请确定有足够的可用空间以供安装。要删除任何分区，请在列表中选择它们并点击 - 按钮。 											

        ​													该对话框有一个复选框,您可以使用它删除被删除分区的系统所属的所有其他分区。 											

      - ​													如果没有现有分区,并且您想要创建推荐的分区集合作为起点,请从左窗格中选择您首选的分区方案（默认为 LVM）,然后 **点击点击点击点击来自动** 链接。 											

        ​													一个 `/boot` 分区、一个 `/` （根）卷和一个与可用存储大小相关的 `swap` 卷被创建并列在左窗格中。这些是在典型安装时推荐使用的文件系统，但您可以添加附加文件系统和挂载点。 											

   2. ​										点击 完成 确认任何更改并返回 **安装概述** 窗口。 								

​						继续 [添加挂载点](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#adding-a-mount-point_manual-partitioning)，[配置独立挂载点](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-a-mount-point-file-system_manual-partitioning) 和 [配置底层分区或卷](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#customizing-a-partition-or-volume_manual-partitioning)。 				

### 10.6.2. 添加挂载点文件系统

​						完成以下步骤以添加多个挂载点文件系统。 				

**先决条件**

- ​								分区计划： 						
  - ​										为了避免空间分配出现问题,首先创建有已知固定大小的小分区,如 `/boot`,然后创建剩余的分区,允许安装程序为它们分配剩余容量。 								
  - ​										如果您要在多个磁盘中安装系统,或者您的磁盘大小不同,且必须在 BIOS 检测到的第一个磁盘中创建特定分区,请首先创建这些分区。 								

**流程**

1. ​								点击 + 可创建新挂载点文件系统。**Add a New Mount Point** 对话框被打开。 						

2. ​								从 **挂载点** 下拉菜单中选择预先设置的路径之一,或者输入自己的路径。例如,为根分区选择 `/`,或者为引导分区选择 `/boot`。 						

3. ​								在 **Desired Capacity 项中输入文件系统的大小**,例如 `2GiB`。 						

   警告

   ​									如果您没有在「Desired Capacity」项中指定值，或者指定了大于可用空间的大小，则会使用所有剩余空间。 							

4. ​								点 Add mount point 创建分区并返回到 **Manual Partitioning** 窗口。 						

### 10.6.3. 配置挂载点文件系统

​						这个过程描述了如何为手动创建的每个挂载点设置分区方案。可用选项有 `Standard Partition`、`LVM` 和 `LVM Thin Provisioning`。 				

注意

- ​									Red Hat Enterprise Linux 8 中删除了对 Btfrs 的支持。 							
- ​									无论选择了什么值, `/boot` 分区始终位于一个标准分区中。 							

**流程**

1. ​								要更改单一非 LVM 挂载点所在的设备,请从左侧窗格中选择所需的挂载点。 						

2. ​								在 **Device(s)** 下点 Modify…。此时会打开 **Configure Mount Point** 对话框。 						

3. ​								选择一个或多个设备并点击 Select 确认您的选择，并返回 **Manual Partitioning** 窗口。 						

4. ​								点 Update Settings 应用改变。 						

   注意

   ​									点击 Rescan 按钮（圆形箭头按钮）刷新所有本地磁盘和分区。这只在执行安装程序外的高级分区后才是需要的。点击 Rescan Disks 按钮重置安装程序中的所有配置更改。 							

5. ​								在 **Manual Partitioning** 窗口中左下方，点 **storage device selected** 打开 **Selected Disks** 对话框，检查磁盘信息。 						

### 10.6.4. 自定义分区或卷

​						如果需要设置特定的设置，可以自定义分区或卷。 				

重要

​							如果 `/usr` 或 `/var` 与剩余 root 卷分开分区,引导过程会变得非常复杂,因为这些目录包含关键组件。在某些情况下，比如这些目录位于 iSCSI 驱动器或 FCoE 位置，系统无法引导，或者在关机或重启时出现 **Device is busy** 错误。 					

​							这个限制只适用于 `/usr` 或 `/var`,不适用于下面的目录。例如：用于 `/var/www` 的独立分区可以正常工作。 					

**流程**

1. ​								在左侧窗格中选择挂载点。 						

   **图 10.1. 自定义分区**

   ![自定义分区。](https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-8-Performing_a_standard_RHEL_installation-zh-CN/images/65917632e8676104888550d03394cfad/anaconda-diskpartitioning-ddmain-custom.png)

2. ​								在右侧面板中您可以自定义以下选项： 						

   1. ​										在 **Mount Point** 项值嗯输入文件系统挂载点。例如： 如果文件系统是 root 文件系统,输入 `/`; 为 `/boot` 文件系统输入 `/boot` 等。对于 swap 文件系统,请不要设置挂载点,因为将文件系统类型设置为 `swap` 就足够了。 								

   2. ​										在 **Desired Capacity** 项中输入文件系统的大小。您可以使用常规大小单位，如 KiB 或者 GiB。如果没有设置任何单元，则默认为 MiB。 								

   3. ​										从下拉设备类型菜单中选择 **设备类型：** `Standard Partition`、`LVM` 或 `LVM Thin Provisioning`。 								

      警告

      ​											安装程序不支持超额提供的 LVM 精简池。 									

      注意

      ​											`RAID` 只有选择了两个或者多个磁盘进行分区时才可用。如果选择 `RAID`,也可以设置 `RAID Level`。同样,如果您选择 `LVM`,您可以指定 `Volume Group`。 									

   4. ​										选择 **Encrypt** 复选框来加密分区或卷。您必须稍后在安装程序中设置密码。此时会显示 **LUKS Version** 下拉菜单。 								

   5. ​										从下拉菜单中选择您所需的 LUKS 版本。 								

   6. ​										从文件系统下拉菜单中为这个分区或者卷选择正确的 **文件系统** 类型。 								

      注意

      ​											Linux 系统分区不支持 `VFAT` 文件系统。例如 `/`、`/var`、`/usr` 等。 									

   7. ​										选择 **重新格式化**复选框格式化现有分区，或不选择**重新格式化**复选框来保留您的数据。必须重新格式化新创建的分区和卷,且无法清除复选框。 								

   8. ​										在 **Label** 字段中输入分区的标签。使用标签轻松识别和处理单个分区。 								

   9. ​										在 **Name** 中输入名称。 								

      注意

      ​											请注意,标准分区在创建时会自动命名,您无法编辑标准分区名称。例如,您无法编辑 `/boot` 名称 `sda1`。 									

3. ​								点击 Update Settings 应用您的更改。如果需要，可以选择另外一个分区进行自定义。在点 **Installation Summary** 窗口中的 Begin Installation 前，修改不会生效。 						

   注意

   ​									点 Reset All 取消对分区的修改。 							

4. ​								当您创建并自定义所有文件系统和挂载点后，点 Done。如果您选择加密文件系统，则会提示您输入生成密码短语。 						

   ​								**Summary of Changes** 对话框会打开，它包括了安装程序进行的与所有存储相关的操作的信息。 						

5. ​								点击 Accept Changes 以应用更改并返回 **安装概述** 窗口。 						

### 10.6.5. 保留 /home 目录

​						在 RHEL 8 图形安装中,您可以保留 RHEL 7 系统中使用的 `/home` 目录。 				

警告

​							只有在 RHEL 7 系统中的独立 `/home` 分区中, `/home` 目录才有可能保留 `/home`。 					

​						保留包含各种配置设置的 `/home` 目录,从而可以在新的 RHEL 8 系统中设置 GNOME Shell 环境,其方式与 RHEL 7 系统中相同。请注意,这只适用于 RHEL 8 的用户,其用户名和 ID 与之前的 RHEL 7 系统相同。 				

​						完成这个步骤,从 RHEL 7 系统中保留 `/home` 目录。 				

**先决条件**

- ​								RHEL 7 系统已安装在您的计算机上。 						
- ​								`/home` 目录位于 RHEL 7 系统中的独立 `/home` 分区中。 						
- ​								当前会显示 RHEL 8 `Installation Summary` 窗口。 						

**流程**

1. ​								点 **Installation Destination** 打开 **Installation Destination** 窗口。 						

2. ​								在 **Storage Configuration** 下,选择 **Custom 单选** 按钮。点击 **Done**。 						

3. ​								点 Done，**Manual Partitioning** 窗口会打开。 						

4. ​								选择 `/home` 分区,在 `Mount Point:` 下填写 `/home` 并清除 **重新格式化复选框**。 						

   **图 10.2. 确定 /home 不会被格式化**

   ![保留家分区](https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-8-Performing_a_standard_RHEL_installation-zh-CN/images/18ea263ce1126360dce3e27c2fa7cbac/preserving-home-partition.png)

5. ​								可选：您还可以自定义 RHEL 8 系统所需的 `/home` 分区的各个方面,如 [第 10.6.4 节 “自定义分区或卷”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#customizing-a-partition-or-volume_manual-partitioning) 所述。但是,要从 RHEL 7 系统中保留 `/home`,需要清除 **重新格式化复选框**。 						

6. ​								根据您的要求自定义所有分区后,点 Done。**Summary of changes** 将打开。 						

7. ​								验证 **Summary of changes** 对话框不会显示 `/home` 的任何变化。这意味着 `/home` 分区被保留。 						

8. ​								点击 Accept Changes 应用更改,并返回 **安装概述** 窗口。 						

### 10.6.6. 创建软件 RAID

​						按照以下步骤创建独立磁盘(RAID)设备的冗余 Arrays。RAID 设备由多个存储设备组成的，它可以提高性能，并可以配置为增加容错功能。 				

​						创建 RAID 设备只需要一步，并可根据需要添加或者删除磁盘。您可以为系统中的每个物理磁盘配置一个 RAID  分区，因此安装程序可使用的磁盘数决定可用 RAID 设备的级别。例如： 如果系统只有两个硬盘，就无法创建 RAID 10 设备，因为它至少需要 3 个独立的磁盘。 				

注意

​							在 IBM Z 中，存储子系统会透明地使用 RAID。您不必手动配置软件 RAID。 					

**先决条件**

- ​								您已经选择了两个或者多个磁盘，然后才能看到 RAID 配置选项。创建 RAID 设备至少需要两个磁盘。 						
- ​								您创建了挂载点。通过配置挂载点，就可以配置 RAID 设备。 						
- ​								您已在 `Installation Destination` 窗口中选择了 `Custom` 单选按钮。 						

**流程**

1. ​								在 **Manual Partitioning** 窗口左面地框中，选所需的分区。 						
2. ​								在 **Device(s)** 部分点 修改。此时会打开 **Configure Mount Point** 对话框。 						
3. ​								选择您要包含在 RAID 设备中的磁盘并点击 选择。 						
4. ​								点击**设备类型**下拉菜单并选择 **RAID**。 						
5. ​								点击**文件系统**下拉菜单并选择您首选的文件系统类型。 						
6. ​								点击**RAID 级别**下拉菜单并选择您需要的 RAID 级别。 						
7. ​								点击 更新设置 保存您的更改。 						
8. ​								点击 完成 按钮应用该设置并返回 **安装概述** 窗口。 						

​						如果指定的 RAID 级别需要更多磁盘，则会在窗口底部显示一 条信息。 				

​						要了解更多有关软崩溃以及在配置 RAID LV 时如何保护数据的信息，请参阅[使用带有 RAID LV 的 DM 完整性](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_logical_volumes/index#using-dm-integrity-with-raid-lv_configure-manage-raid)。 				

### 10.6.7. 创建 LVM 逻辑卷

​						逻辑卷管理(LVM)提供了基础物理存储空间的简单逻辑视图,比如硬盘或者  LUN。物理存储分区以物理卷的形式代表，您可以将其分组到卷组中。您可以将每个卷组分成多个逻辑卷,每个逻辑卷都与标准磁盘分区类似。因此,LVM  逻辑卷作为可跨越多个物理磁盘的分区使用。 				

注意

​							LVM 配置只可用于图形安装程序。 					

重要

​							在文本模式安装过程中，LVM 配置不可用。要创建 LVM 配置,请 **按 Ctrl**+**Alt**+**F2** 使用不同的虚拟控制台,并运行 `lvm` 命令。要返回文本模式安装,请 **按 Ctrl**+**Alt**+**F1**。 					

**流程**

1. ​								在**手动分区**窗口左侧的方框中选择挂载点。 						

2. ​								点击设备 **类型** 下拉菜单并选择 `LVM`。**卷组** 下拉菜单显示新创建的卷组名称。 						

   注意

   ​									您无法在配置对话框中指定卷组物理扩展的大小。该大小始终设置为默认值 4 MiB。如果要创建具有不同物理扩展的卷组,您必须通过切换到互动 shell 并使用 `vgcreate` 命令手动创建该卷组,或使用 `volgroup --pesize=*size*` 命令使用 Kickstart 文件。有关 Kickstart 的详情，请查看[*执行高级 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/) 文档。 							

**其它资源**

- ​								有关 LVM 的详情，请参考 *[配置和管理逻辑卷](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_logical_volumes/index)*文档。 						

### 10.6.8. 配置 LVM 逻辑卷

​						按照以下步骤配置新创建的 LVM 逻辑卷。 				

警告

​							不支持将 `/boot` 分区放在 LVM 卷中。 					

**流程**

1. ​								在**手动分区**窗口左侧的方框中选择挂载点。 						

2. ​								点击设备 **类型** 下拉菜单并选择 `LVM`。**卷组** 下拉菜单显示新创建的卷组名称。 						

3. ​								点修改配置新创建的卷组。 						

   ​								此时会打开**配置卷组**对话框。 						

   注意

   ​									您无法在配置对话框中指定卷组物理扩展的大小。该大小始终设置为默认值 4 MiB。如果要创建具有不同物理扩展的卷组,您必须通过切换到互动 shell 并使用 `vgcreate` 命令手动创建该卷组,或使用 `volgroup --pesize=*size*` 命令使用 Kickstart 文件。有关 Kickstart 的详情，请查看[*执行高级 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/) 文档。 							

4. ​								在 **RAID 级别**下拉菜单中选择您需要的 RAID 级别。 						

   ​								可用的 RAID 级别与实际 RAID 设备相同。 						

5. ​								选择 **加密** 复选框来为卷组进行加密。 						

6. ​								在 **大小策略**下拉菜单中为卷组选择大小策略。 						

   ​								可用的策略选项有： 						

   - ​										**Automatic**： 自动设置卷组大小，使其足够容纳配置的逻辑卷。适合于不需要剩余空间的卷组。 								
   - ​										**尽可能大**:创建卷组时具有最大大小,而不考虑它包含的逻辑卷的大小。适合于要将大多数数据保存到 LVM，且之后需要增大一些现有逻辑卷的大小，或者需要在该卷组中生成附加逻辑卷。 								
   - ​										**修复了**:您可以设置卷组的具体大小。这个固定的大小必须能够容纳所有配置的逻辑卷。适用于知道该卷组的实际大小。 								

7. ​								点击 Save 以应用设置并返回手动 **分区** 窗口。 						

8. ​								点击 更新设置 保存您的更改。 						

9. ​								点击 完成 返回 **安装概述** 窗口。 						

## 10.7. 配置一个根密码

​					您必须配置 `root` 密码以完成安装过程,并登录到管理员（又称超级用户或 root）帐户,这些帐户用于系统管理任务。这些任务包括安装和更新软件包以及更改系统范围的配置,如网络和防火墙设置、存储选项以及添加或修改用户、组和文件权限。 			

重要

- ​								使用以下方法之一为获取安装系统的 root 权限： 						
  - ​										使用 root 帐户。 								
  - ​										创建一个具有管理权限的用户帐户（wheel 组成员）。安装过程会创建 `root` 帐户。只有在您需要执行需要管理员访问权限的任务时,切换到管理员帐户。 								

警告

​						`root` 帐户对系统有完全的控制权。如果未授权的人可以访问该帐户，他们就可以访问或删除用户个人文件。 				

**流程**

1. ​							在 **安装概述** 窗口中选择 **User Settings > Root 密码**。此时会打开 **Root 密码** 窗口。 					

2. ​							在 **Root 密码**字段输入您的密码。 					

   ​							创建一个强大根密码的要求和建议是： 					

   - ​									*至少需要* 8 个字符的长度 							
   - ​									可以包含数字、字母（大写和小写）和符号 							
   - ​									是区分大小写的 							

3. ​							在 **Confirm** 项中再次输入同一密码。 					

4. ​							点击 完成 确认您的根密码并返回 **安装概述** 窗口。 					

   注意

   ​								如果您的密码较弱,则需要点 Done 两次。 						

## 10.8. 创建用户帐户

​					建议您创建一个用户帐户来完成安装。如果您不创建用户帐户,您必须直接以 `root` 身份登录该系统,我们 **不** 建议这样做。 			

**流程**

1. ​							在 **安装概述** 窗口中,选择 **User Settings > User Creation**。此时会打开 **Create User** 窗口。 					

2. ​							在 **Full name** 字段输入用户帐户名称，例如： John Smith。 					

3. ​							在 **User name** 字段输入用户名，例如： jsmith。 					

   注意

   ​								用户名 **用于** 从命令行登录 ; 如果您安装图形环境,则您的图形登录管理器将使用 **Full 名称**。 						

4. ​							如果 **用户需要管理权限,请选择 Make this user administrator** 复选框（安装程序将用户添加到 `wheel` 组]。 					

   重要

   ​								管理员用户可以使用用户密码,使用 `sudo` 命令执行只有 `root` 可用的任务,而不必使用 `root` 密码。这可能更方便,但也可能导致安全隐患。 						

5. ​							选择 **Require a password to use this account** 复选框。 					

   警告

   ​								如果您为用户授予管理员特权,请验证帐户是否被保护。在没有为用户设置密码前，不要授予用户管理员的权限。 						

6. ​							在 **Password** 项中输入密码。 					

7. ​							在 **Confirm password** 项中再次输入同一密码。 					

8. ​							点击 完成 应用这些更改并返回 **安装概述** 窗口。 					

### 10.8.1. 编辑高级用户设置

​						按照以下步骤在 **高级用户配置**对话框中编辑该用户帐户的默认设置。 				

**流程**

1. ​								在 **Create User** 窗口中点 Advanced。 						

2. ​								如果需要，在 **Home directory** 字段中编辑详情。该字段默认填充 `/home/*username*`。 						

3. ​								在 **User and Groups IDs** 部分，您可以： 						

   1. ​										选择 **Specify a user ID manually** 并使用 + or - 来输入所需的值。 								

      注意

      ​											默认值为 1000。用户 ID(UID)0-999 被系统保留,因此无法分配给用户。 									

   2. ​										选择 **Specify a group ID manually** 并使用 + or - 来输入所需的值。 								

      注意

      ​											默认组名称与用户名相同,默认组 ID(GID)为 1000。GIDs 0-999 由系统保留,因此不会分配给用户组。 									

4. ​								在 **Group Membership** 字段中，指定用逗号分开的额外组列表。创建尚未存在的组 ; 您可以为括号中的附加组指定自定义 GID。如果您没有为新组指定自定义 GID,新组会自动收到 GID。 						

   注意

   ​									创建的用户帐户总是有一个默认组成员资格（用户的默认组,在 **指定组 ID 手动设置的 ID** 中设置）。 							

5. ​								点击 Save Changes 以应用更新并返回到 **Create User 窗口**。 						

## 第 11 章 完成安装后的任务

​				这部分论述了如何完成以下安装后任务： 		

- ​						完成初始设置 				

- ​						注册您的系统 				

  注意

  ​							根据您的要求，有几个方法来注册您的系统。大多数方法都是作为安装后任务的一部分完成的。但是，Red Hat Content Delivery Network（CDN）注册您的系统并附加 RHEL 订阅是在安装过程开始 **前**进行的。如需更多信息,请参阅 [第 9.2 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#register-and-install-from-cdn-using-gui_register-and-install-from-cdn)。 					

- ​						保护您的系统 				

## 11.1. 完成初始设置

​					这部分包含如何在 Red Hat Enterprise Linux 8 系统中完成初始设置的信息。 			

重要

- ​								如果在安装过程中选择了**Server with GUI** 基础环境，**Initial Setup** 窗口将在安装过程结束后第一次重启系统时打开。 						
- ​								如果您从 CDN 注册并安装了 RHEL, Subscription Manager 选项会显示一个备注,所有安装的产品都由有效权利涵盖。 						

​					**Initial Setup** 窗口中显示的信息可能会根据安装过程中配置的不同而有所不同。但最少会显示 **Licensing** 和 **Subscription Manager** 选项。 			

**先决条件**

- ​							您已根据 [第 8 章 *使用客户门户网站中的 ISO 镜像安装 RHEL*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#performing-a-quick-install-with-gui_installing-RHEL) 中推荐的工作流完成图形安装。 					
- ​							您有一个有效的、非试用的 Red Hat Enterprise Linux 订阅。 					

**流程**

1. ​							在 **Initial Setup** 窗口中选择 **Licensing 信息**。 					

   ​							**许可证协议** 窗口会打开并显示 Red Hat Enterprise Linux 的许可条款。 					

2. ​							检查许可证协议并选择 **我接受许可证协议** 复选框。 					

   注意

   ​								您必须接受许可证协议。在不完成这一步的情况下退出 **Initial Setup** 会导致系统重启。重启过程完成后会提示您再次接受该许可证。 						

3. ​							点击 完成 应用设置并返回到 **Initial Setup** 窗口。 					

   注意

   ​								如果没有配置网络设置，就无法立即注册您的系统。在这种情况下，点 完成配置。Red Hat Enterprise Linux 8 启动，您可以进行登录，激活对网络的访问，并注册您的系统。如需更多信息,请参阅 [第 11.3 节 “使用 Subscription Manager 用户界面注册您的系统”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#subscription-manager-post-install-ui_post-installation-tasks)。如果您如 [第 10.3.3 节 “配置网络和主机名选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#network-hostname_configuring-system-settings) 所述配置了网络设置,您可以立即注册您的系统,如下所示： 						

4. ​							在 **Initial Setup** 窗口中选择 **Subscription Manager**。 					

   重要

   ​								如果您从 CDN 注册并安装了 RHEL, Subscription Manager 选项会显示一个备注,所有安装的产品都由有效权利涵盖。 						

5. ​							**Subscription Manager** 图形界面会打开并显示要注册的选项 ***,即 subscription.rhsm.redhat.com\***。 					

6. ​							点击 Next。 					

7. ​							输入您的 **登录名** 和 **密码** 信息，并点击 Register。 					

8. ​							确认订阅详情并点击 Attach。您必须收到以下确认信息： **注册红帽订阅管理已完成！** 					

9. ​							点击 Done。此时会打开 **Initial Setup** 窗口。 					

10. ​							点击 完成配置。登录窗口将打开。 					

11. ​							配置您的系统。如需更多信息，请参阅 [*配置基本系统设置*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_basic_system_settings/index/) 文档。 					

**其它资源**

​						根据您的需要，有五种方法来注册您的系统： 				

- ​							使用 Red Hat Content Delivery Network(CDN)注册您的系统、附加 RHEL 订阅并安装 Red Hat Enterprise Linux。如需更多信息,请参阅 [第 9.2 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#register-and-install-from-cdn-using-gui_register-and-install-from-cdn)。 					
- ​							在安装过程中使用 **Initial Setup**。 					
- ​							在安装后使用命令行。如需更多信息,请参阅 [第 11.2 节 “使用命令行注册您的系统”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#subman-rhel8-setup_post-installation-tasks)。 					
- ​							在安装后使用 Subscription Manager 用户界面。如需更多信息,请参阅 [第 11.3 节 “使用 Subscription Manager 用户界面注册您的系统”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#subscription-manager-post-install-ui_post-installation-tasks)。 					
- ​							在安装后使用 Registration Assistant。Registration Assistant 可帮助为您的 Red Hat Enterprise Linux 环境选择最合适的注册选项。如需更多信息，请参阅 https://access.redhat.com/labs/registrationassistant/。 					

## 11.2. 使用命令行注册您的系统

​					这部分包含如何使用命令行注册 Red Hat Enterprise Linux 8 系统的信息。 			

注意

​						当自动附加某个系统时，订阅服务会检查系统是物理还是虚拟的，以及系统中有多少个插槽物理系统通常会使用两个权利，一个虚拟系统通常使用一个权利。一个系统中的每两个插槽会使用一个权利。 				

**先决条件**

- ​							您有一个有效的、非试用的 Red Hat Enterprise Linux 订阅。 					
- ​							验证您的红帽订阅状态。 					
- ​							您之前还没有收到 Red Hat Enterprise Linux 8 订阅。 					
- ​							在从客户门户网站下载权利前已激活了订阅。您计划使用的每个实例都需要一个权利。如果您需要帮助，请联系红帽客户服务。 					
- ​							您已成功安装 Red Hat Enterprise Linux 8 并登录该系统。 					

**流程**

1. ​							打开终端窗口并使用您的红帽客户门户网站用户名和密码注册订阅： 					

   ```
   # subscription-manager register --username [username] --password [password]
   ```

2. ​							当成功注册订阅后，会显示类似如下的输出： 					

   ```
   # The system has been registered with ID: 123456abcdef
   # The registered system name is: localhost.localdomain
   ```

3. ​							为系统设置角色，例如： 					

   ```
   # subscription-manager role --set="Red Hat Enterprise Linux Server"
   ```

   注意

   ​								可用的角色取决于用户购买的订阅，以及 RHEL 8 系统的架构。您可以设置以下角色之一： `Red Hat Enterprise Linux Server`、`Red Hat Enterprise Linux Workstation` 或 `Red Hat Enterprise Linux Compute Node`。 						

4. ​							为该系统设置服务级别，例如： 					

   ```
   # subscription-manager service-level --set="Premium"
   ```

5. ​							为系统设置使用量,例如： 					

   ```
   # subscription-manager usage --set="Production"
   ```

6. ​							将系统附加到与主机系统架构匹配的授权中： 					

   ```
   # subscription-manager attach
   ```

7. ​							成功附加订阅后会显示类似如下的输出： 					

   ```
   Installed Product Current Status:Product Name: Red Hat Enterprise Linux for x86_64Status: Subscribed
   ```

   注意

   ​								您还可以以 `root` 用户身份登录到系统,并使用 Subscription Manager 图形用户界面注册 Red Hat Enterprise Linux 8。 						

## 11.3. 使用 Subscription Manager 用户界面注册您的系统

​					这部分包含有关如何使用 Subscription Manager 用户界面注册 Red Hat Enterprise Linux 8 系统以接收更新和访问软件包库的信息。 			

**先决条件**

- ​							您已根据 [第 8 章 *使用客户门户网站中的 ISO 镜像安装 RHEL*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#performing-a-quick-install-with-gui_installing-RHEL) 中推荐的工作流完成图形安装。 					
- ​							您有一个有效的、非试用的 Red Hat Enterprise Linux 订阅。 					
- ​							验证您的红帽订阅状态。 					

**流程**

1. ​							登录到您的系统。 					

2. ​							从窗口的左上方点击 **Activities**。 					

3. ​							在菜单选项中点**显示应用程序**图标。 					

4. ​							点 **Red Hat Subscription Manager** 图标，或使用 **Red Hat Subscription Manager** 进行搜索。 					

5. ​							在 **Authentication Required** 对话框中输入管理员密码。 					

   注意

   ​								在系统上执行特权任务需要身份验证。 						

6. ​							**Subscriptions** 窗口将打开,显示 Subscription 的当前状态、系统目的和已安装的产品。未注册的产品会显示红色 X。 					

7. ​							点 Register 按钮。 					

8. ​							此时会打开 **注册系统** 对话框。输入您的 **客户门户网站** 凭证并点注册按钮。 					

​					**Subscriptions** 窗口中的 **Register** 按钮会变为 **Unregister**,已安装的产品会显示绿色 X。您可以使用 `subscription-manager status` 命令排除失败注册的问题。 			

**其它资源**

- ​							有关使用和配置 Subscription Manager 的详情，请参考 [*使用和配置 Red Hat Subscription Manager*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index/) 文档。 					
- ​							有关在订阅管理中准备订阅、配置 virt-who 和注册虚拟机以便其从虚拟机管理程序中继承订阅的详情，请参考 [*红帽订阅管理中的配置虚拟机订阅*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/configuring_virtual_machine_subscriptions_in_red_hat_subscription_management/index)文档。 					

## 11.4. Registration Assistant

​					Registration Assistant 可帮助为您的 Red Hat Enterprise Linux 环境选择最合适的注册选项。如需更多信息，请参阅 https://access.redhat.com/labs/registrationassistant/。 			

## 11.5. 使用 syspurpose 命令行工具配置系统目的

​					系统目的（System Purpose）是 Red Hat Enterprise Linux  安装的可选功能，我们推荐使用它。您可使用系统目的记录 Red Hat Enterprise Linux 8  系统的预期使用，并确定授权服务器自动为您的系统附加最合适的订阅。`syspurpose` 命令行工具是 `python3_syspurpose.rpm` 软件包的一部分。如果在安装过程中没有配置系统目的,您可以在安装后使用 `syspurpose` 命令行工具设置所需的属性。 			

**先决条件**

- ​							安装并注册了 Red Hat Enterprise Linux 8 系统，但不会配置系统目的。 					

- ​							以 `root` 用户身份登录。 					

- ​							`python3_syspurpose.rpm` 软件包可在您的系统中可用。 					

  注意

  ​								如果您的系统已注册,但订阅无法满足所需目的,您可以运行 `subscription-manager remove --all` 命令删除附加的订阅。然后,您可以使用 `syspurpose` 命令行工具设置所需的目的属性,并运行 `subscription-manager attach --auto` 使用更新属性授权系统。 						

  **流程**

  ​								完成此步骤中的步骤,以便在安装后使用 `syspurpose` 命令行工具配置系统目的。权利服务器使用选择的值为您的系统附加最合适的订阅。 						

  1. ​									在终端窗口中运行以下命令设定系统预期的角色： 							

     ```
     # syspurpose set-role "VALUE"
     ```

     ​									使用您要分配的角色替换 `VALUE`: 							

     - ​											`Red Hat Enterprise Linux Server` 									
     - ​											`Red Hat Enterprise Linux Workstation` 									
     - ​											`Red Hat Enterprise Linux Compute Node` 									

     ​									例如： 							

     ```
     # syspurpose set-role "Red Hat Enterprise Linux Server"
     ```

     1. ​											可选： 运行以下命令以取消设置角色： 									

        ```
        # syspurpose unset-role
        ```

  2. ​									运行以下命令设定系统的预期服务等级协议(SLA): 							

     ```
     # syspurpose set-sla "VALUE"
     ```

     ​									使用您要分配的 SLA 替换 `VALUE`: 							

     - ​											`Premium` 									
     - ​											`Standard` 									
     - ​											`Self-Support` 									

     ​									例如： 							

     ```
     # syspurpose set-sla "Standard"
     ```

     1. ​											可选： 运行以下命令以取消设置 SLA: 									

        ```
        # syspurpose unset-sla
        ```

  3. ​									运行以下命令设定系统预定用法： 							

     ```
     # syspurpose set-usage "VALUE"
     ```

     ​									使用您要分配的用法替换 `VALUE`: 							

     - ​											`Production` 									
     - ​											`Disaster Recovery` 									
     - ​											`Development/Test` 									

     ​									例如： 							

     ```
     # syspurpose set-usage "Production"
     ```

     1. ​											可选： 运行以下命令以取消设置用法： 									

        ```
        # syspurpose unset-usage
        ```

  4. ​									运行以下命令来显示当前系统目的属性： 							

     ```
     # syspurpose show
     ```

     1. ​											可选： 运行以下命令访问 `syspurpose` man page: 									

        ```
        # man syspurpose
        ```

## 11.6. 保护您的系统

​					在安装 Red Hat Enterprise Linux 后立即完成以下与安全性相关的步骤。 			

**先决条件**

- ​							您已根据 [第 8 章 *使用客户门户网站中的 ISO 镜像安装 RHEL*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#performing-a-quick-install-with-gui_installing-RHEL) 中推荐的工作流完成图形安装。 					

**流程**

1. ​							要更新您的系统，请作为 root 运行以下命令： 					

   ```
   # yum update
   ```

2. ​							虽然防火墙服务 `firewalld` 会在安装 Red Hat Enterprise Linux 时自动启用,但在有些情况下可能会明确禁用它,例如在 Kickstart 配置中。在那种情况下，建议您重新启用防火墙。 					

   ​							要启动 `firewalld`,以 root 运行以下命令： 					

   ```
   # systemctl start firewalld# systemctl enable firewalld
   ```

3. ​							要提高安全性，禁用您不需要的服务。例如，如果您的系统没有安装打印机，使用以下命令禁用 cups 服务： 					

   ```
   # systemctl mask cups
   ```

   ​							要查看活跃的服务，运行以下命令： 					

   ```
   $ systemctl list-units | grep service
   ```

## 11.7. 安装后立即部署符合安全配置集的系统

​					在安装完成后,可以使用 OpenSCAP 套件来部署符合安全配置集的 RHEL 系统,如 OSPP、PCI-DSS 和 HIPAA 配置集。使用这个部署方法,您可以应用在以后无法使用补救脚本应用的特定规则,例如密码强度和分区规则。 			

### 11.7.1. 使用图形安装部署基本兼容 RHEL 系统

​						使用此流程部署与特定基准兼容的 RHEL 系统。这个示例为常规目的操作系统(OSPP)使用保护配置集。 				

**先决条件**

- ​								您已引导到 `graphical` 安装程序。请注意： **OSCAP Anaconda 插件**不只支持文本安装。 						
- ​								您已访问 `Installation Summary` 窗口。 						

**流程**

1. ​								在 `Installation Summary` 窗口中点击 `Software Selection`。`Software Selection` 窗口将打开。 						

2. ​								在 `Base Environment` 窗格中选择 `Server` 环境。您只能选择一个基本环境。 						

   警告

   ​									如果要部署兼容的系统,请不要使用 `Server with GUI` 基础环境。作为 **SCAP Security Guide 的一部分提供的安全** 配置集可能与 `Server with GUI` 的扩展软件包不兼容。如需更多信息,请参阅 [BZ#1648162](https://bugzilla.redhat.com/show_bug.cgi?id=1648162)、 [BZ#1787156](https://bugzilla.redhat.com/show_bug.cgi?id=1787156) 或 [BZ#1816199](https://bugzilla.redhat.com/show_bug.cgi?id=1816199)。 							

3. ​								点击 `Done` 应用设置并返回 `Installation Summary` 窗口。 						

4. ​								点击 `Security Policy`。`Security Policy` 窗口将打开。 						

5. ​								要在系统中启用安全策略,将 `Apply security policy` 开关切换到 `ON`。 						

6. ​								从配置集窗格中选择 `Protection Profile for General Purpose Operating Systems`。 						

7. ​								点击 `Select Profile` 以确认选择。 						

8. ​								确认在窗口底部显示的 `Changes that were done or need to be done` 窗格的更改。完成所有剩余的手动更改。 						

9. ​								因为 OSPP 有必须满足的严格的分区要求,所以为 `/boot`、`/home`、`/var`、`/var/log`、`/var/tmp` 和 `/var/log/audit` 创建单独的分区。 						

10. ​								完成图形安装过程。 						

    注意

    ​									图形安装程序在安装成功后自动创建对应的 Kickstart 文件。您可以使用 `/root/anaconda-ks.cfg` 文件自动安装兼容 OSPP 的系统。 							

**验证**

1. ​								要在安装完成后检查系统当前的状态,请重启系统并启动新的扫描： 						

   ```
   # oscap xccdf eval --profile ospp --report eval_postinstall_report.html /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml
   ```

**其它资源**

- ​								有关分区的详情，请参阅 [配置手动分区](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/graphical-installation_graphical-installation#manual-partitioning_graphical-installation)。 						

### 11.7.2. 使用 Kickstart 部署基本兼容 RHEL 系统

​						使用这个流程部署与特定基准兼容的 RHEL 系统。这个示例为常规目的操作系统(OSPP)使用保护配置集。 				

**先决条件**

- ​								`scap-security-guide` 软件包安装在 RHEL 8 系统中。 						

**流程**

1. ​								在您选择的编辑器中打开 `/usr/share/scap-security-guide/kickstarts/ssg-rhel8-ospp-ks.cfg` Kickstart 文件。 						

2. ​								更新分区方案以符合您的配置要求。要满足 OSPP 合规性,必须保留 `/boot`、`/home`、`/var`、`/var/log`、`/var/tmp` 和 `/var/log/audit` 的独立分区,您只能更改分区的大小。 						

   警告

   ​									因为 `OSCAP Anaconda Addon` 插件不支持只使用文本安装,请不要在 Kickstart 文件中使用 `text` 选项。如需更多信息，请参阅 [RHBZ#1674001](https://bugzilla.redhat.com/show_bug.cgi?id=1674001)。 							

3. ​								启动 Kickstart 安装,如 [使用 Kickstart 执行自动安装](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_an_advanced_rhel_installation/starting-kickstart-installations_installing-rhel-as-an-experienced-user) 中所述。 						

重要

​							使用哈希格式的密码无法检测 OSPP 要求。 					

**验证**

1. ​								要在安装完成后检查系统当前的状态,请重启系统并启动新的扫描： 						

   ```
   # oscap xccdf eval --profile ospp --report eval_postinstall_report.html /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml
   ```

**其它资源**

- ​								详情请查看 [OSCAP Anaconda Addon](https://www.open-scap.org/tools/oscap-anaconda-addon/) 项目页。 						

## 11.8. 后续步骤

​					当完成要求的安装后步骤后，可以配置基本的系统设置。有关完成一些任务（如使用 yum 安装软件、使用 systemd 进行服务管理、管理用户、组群和文件权限、使用 chrony 配置 NTP 以及使用 Python 3）的详情,请参考 [*配置基本系统设置文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/index)。 			







​	



​			

## 基于网络安装的端口

​					下表列出了必须在服务器中打开的端口，可提供各种基于网络的安装的文件。 			

**表 5.1. 基于网络安装的端口**

| 使用的协议 | 打开端口         |
| ---------- | ---------------- |
| HTTP       | 80               |
| HTTPS      | 443              |
| FTP        | 21               |
| NFS        | 2049, 111, 20048 |
| TFTP       | 69               |

**其它资源**

- ​							[安全网络](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/securing_networks/index/) 					

## 5.4. 在 NFS 服务器中创建安装源

​					按照以下步骤将安装源放在 NFS 服务器中。使用这个安装方法从单一源安装多个系统，而无需连接到物理介质。 			

**先决条件**

- ​							您对带有 Red Hat Enterprise Linux8 的服务器具有管理员级别的访问权限,且该服务器与要安装的系统位于同一个网络中。 					
- ​							下载了 Binary DVD ISO 镜像。如需更多信息 [,请参阅下载安装 ISO 镜像](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 					
- ​							您已使用镜像文件创建了可引导 CD、DVD 或者 USB 设备。如需更多信息 [,请参阅创建可引导 DVD 或者 CD](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-an-installation-cd-or-dvd_assembly_creating-a-bootable-installation-medium)。 					
- ​							确认您的防火墙允许安装的系统访问远程安装源。如需 [更多信息,请参阅基于网络的安装](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ports-for-network-based-installation_prepare-installation-source) 端口。 					

**流程**

1. ​							安装 `nfs-utils` 软件包： 					

   ```
   # yum install nfs-utils
   ```

2. ​							将 Binary DVD ISO 镜像复制到 NFS 服务器的目录中。 					

3. ​							使用文本编辑器打开 `/etc/exports` 文件，并使用以下语法添加一行： 					

   ```
   /exported_directory/ clients
   ```

4. ​							使用到包括 ISO 镜像的目录的完全路径替换 */exported_directory/*。使用目标系统的主机名或 IP 地址替换 *clients*，所有目标系统可以用来访问 ISO 镜像的子网络 ; 如果要允许任何可通过网络访问 NFS 服务器的系统使用 ISO 镜像，则使用星号(`*`)。有关此格式的详情，请查看 `exports(5)` man page。 					

   ​							使 `/rhel8-install/` 目录为所有客户端以只读形式提供的基本配置是： 					

   ```
   /rhel8-install *
   ```

5. ​							保存 `/etc/exports` 文件并退出文本编辑器。 					

6. ​							启动 nfs 服务： 					

   ```
   # systemctl start nfs-server.service
   ```

   ​							如果在您更改 `/etc/exports` 文件前运行该服务，为运行的 NFS 服务器运行以下命令重新载入其配置： 					

   ```
   # systemctl reload nfs-server.service
   ```

   ​							现在可通过 NFS 访问该 ISO 镜像并可作为安装源使用。 					

注意

​						在配置安装源时，使用 `nfs:` 作为协议，指定服务器主机名或 IP 地址、冒号 `(:)` 以及该 ISO 镜像所在目录。例如：如果服务器主机名是 `myserver.example.com` 且您保存了 ISO 镜像 `/rhel8-install/`，指定 `nfs:myserver.example.com:/rhel8-install/` 为安装源。 				

## 5.5. 使用 HTTP 或 HTTPS 创建安装源

​					按照以下步骤使用安装树为基于网络的安装创建安装源，该树是包含提取 Binary DVD ISO 镜像内容和有效 `.treeinfo` 文件的目录。可通过 HTTP 或 HTTPS 访问该安装源。 			

**先决条件**

- ​							您需要对带有 Red Hat Enterprise Linux8 的服务器具有管理员级别的访问权限,且这个服务器与要安装的系统位于同一个网络中。 					
- ​							下载了 Binary DVD ISO 镜像。如需更多信息 [,请参阅下载安装 ISO 镜像](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 					
- ​							您已使用镜像文件创建了可引导 CD、DVD 或者 USB 设备。如需更多信息 [,请参阅创建可引导 DVD 或者 CD](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-an-installation-cd-or-dvd_assembly_creating-a-bootable-installation-medium)。 					
- ​							确认您的防火墙允许安装的系统访问远程安装源。如需 [更多信息,请参阅基于网络的安装](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ports-for-network-based-installation_prepare-installation-source) 端口。 					

**流程**

1. ​							安装 `httpd` 软件包： 					

   ```
   # yum install httpd
   ```

   警告

   ​								如果您的 Apache 网页服务器配置启用了 SSL 安全性，请确定您只启用 TLSv1 协议，并禁用 SSLv2 和 SSLv3。这是因为 POODLE SSL 漏洞(CVE-2014-3566)。详情请查看 https://access.redhat.com/solutions/1232413。 						

   重要

   ​								如果您使用带有自签名证书的 HTTPS 服务器，则必须使用 `noverifyssl` 选项引导安装程序。 						

2. ​							将 Binary DVD ISO 镜像复制到 HTTP(S)服务器。 					

3. ​							使用 `mount` 命令将二进制 DVD ISO 镜像挂载到适当的目录： 					

   ```
   # mkdir /mnt/rhel8-install/
   # mount -o loop,ro -t iso9660 /image_directory/image.iso /mnt/rhel8-install/
   ```

   ​							使用到 Binary DVD ISO 镜像的路径替换  */image_directory/image.iso*。 					

4. ​							将挂载镜像中的文件复制到 HTTP(S)服务器 root 中。此命令会创建包含镜像内容的 `/var/www/html/rhel8-install/` 目录。 					

   ```
   # cp -r /mnt/rhel8-install/ /var/www/html/
   ```

   ​							该命令创建包含镜像内容的 `/var/www/html/rhel8-install/` 目录。请注意，有些复制方法可以跳过有效安装源所需的 `.treeinfo` 文件。为整个目录运行 `cp` 命令，如本流程所示将正确复制 `.treeinfo`。 					

5. ​							启动 `httpd` 服务： 					

   ```
   # systemctl start httpd.service
   ```

   ​							安装树现在可以访问并可作为安装源使用。 					

   注意

   ​								在配置安装源时，使用 `http://` 或者 `https://` 作为协议、指定服务器主机名或 IP 地址以及 ISO 镜像中包含文件的目录（相对于 HTTP 服务器 root）。例如：如果您使用 HTTP，则服务器主机名为 `myserver.example.com`，且您已将镜像中的文件复制到 `/var/www/html/rhel8-install/`，指定 `http://myserver.example.com/rhel8-install/` 作为安装源。 						

**其它资源**

- ​							[部署不同类型的服务器](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/index/) 					

## 5.6. 使用 FTP 创建安装源

​					按照以下步骤使用安装树为基于网络的安装创建安装源，该树是包含提取 Binary DVD ISO 镜像内容和有效 `.treeinfo` 文件的目录。通过 FTP 访问该安装源。 			

**先决条件**

- ​							您对带有 Red Hat Enterprise Linux8 的服务器具有管理员级别的访问权限,且该服务器与要安装的系统位于同一个网络中。 					
- ​							下载了 Binary DVD ISO 镜像。如需更多信息 [,请参阅下载安装 ISO 镜像](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 					
- ​							您已使用镜像文件创建了可引导 CD、DVD 或者 USB 设备。如需更多信息 [,请参阅创建可引导 DVD 或者 CD](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-an-installation-cd-or-dvd_assembly_creating-a-bootable-installation-medium)。 					
- ​							确认您的防火墙允许安装的系统访问远程安装源。如需 [更多信息,请参阅基于网络的安装](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ports-for-network-based-installation_prepare-installation-source) 端口。 					

**流程**

1. ​							安装 `vsftpd` 软件包。请作为 root 运行以下命令完成此步骤： 					

   ```
   # yum install vsftpd
   ```

2. ​							在文本编辑器中打开并编辑 `/etc/vsftpd/vsftpd.conf` 配置文件。 					

   1. ​									将行 `anonymous_enable=NO` 改为 `anonymous_enable=YES` 							

   2. ​									将行 `write_enable=YES` 改为 `write_enable=NO`。 							

   3. ​									添加行 `pasv_min_port=*min_port*` 和 `pasv_max_port=*max_port*`。用被动模式的 FTP 服务器使用的端口范围替换 *min_port* 和 *max_port*`10021` 和 `10031`。 							

      ​									在带有各种防火墙/NAT 设置的网络环境中，这个步骤可能是必要的。 							

   4. ​									另外，还可在您的配置中添加自定义更改。可用选项请查看 **vsftpd.conf(5)** 手册页。这个步骤假设使用了默认选项。 							

      警告

      ​										如果在 `vsftpd.conf` 文件中配置了 SSL/TLS 安全性，请确保只启用 TLSv1 协议，并禁用 SSLv2 和 SSLv3。这是因为 POODLE SSL 漏洞(CVE-2014-3566)。详情请参考 https://access.redhat.com/solutions/1234773。 								

3. ​							配置服务器防火墙。 					

   1. ​									启用防火墙： 							

      ```
      # systemctl enable firewalld
      # systemctl start firewalld
      ```

   2. ​									在您的防火墙中启用前一步中的 FTP 端口和端口范围： 							

      ```
      # firewall-cmd --add-port min_port-max_port/tcp --permanent
      # firewall-cmd --add-service ftp --permanent
      # firewall-cmd --reload
      ```

      ​									将 *min_port*-*max_port* 替换为您输入到 `/etc/vsftpd/vsftpd.conf` 配置文件的端口号。 							

4. ​							将 Binary DVD ISO 镜像复制到 FTP 服务器。 					

5. ​							使用 mount 命令将二进制 DVD ISO 镜像挂载到适当的目录： 					

   ```
   # mkdir /mnt/rhel8-install
   # mount -o loop,ro -t iso9660 /image-directory/image.iso /mnt/rhel8-install
   ```

   ​							使用 Binary DVD ISO 镜像的路径替换 */image-directory/image.iso*。 					

6. ​							将挂载镜像中的文件复制到 FTP 服务器 root 目录中： 					

   ```
   # mkdir /var/ftp/rhel8-install# cp -r /mnt/rhel8-install/ /var/ftp/
   ```

   ​							该命令创建包含镜像内容的 `/var/ftp/rhel8-install/` 目录。请注意，有些复制方法可以跳过有效安装源所需的 `.treeinfo` 文件。为整个目录运行 `cp` 命令，如本流程所示将正确复制 `.treeinfo`。 					

7. ​							请确定在复制的内容中设置了正确的 SELinux 上下文和访问模式： 					

   ```
   # restorecon -r /var/ftp/rhel8-install
   # find /var/ftp/rhel8-install -type f -exec chmod 444 {} \;
   # find /var/ftp/rhel8-install -type d -exec chmod 755 {} \;
   ```

8. ​							启动 `vsftpd` 服务： 					

   ```
   # systemctl start vsftpd.service
   ```

   ​							如果在更改 `/etc/vsftpd/vsftpd.conf` 文件前运行该服务，重启该服务以载入经过编辑的文件： 					

   ```
   # systemctl restart vsftpd.service
   ```

   ​							在引导过程中启用 `vsftpd` 服务： 					

   ```
   # systemctl enable vsftpd
   ```

   ​							安装树现在可以访问并可作为安装源使用。 					

   注意

   ​								在配置安装源时，使用 `ftp://` 协议、指定服务器主机名或 IP 地址以及保存 ISO 镜像中文件的目录（相对于 FTP 服务器 root）。例如：如果服务器主机名是 `myserver.example.com` 且已将镜像中的文件复制到 `/var/ftp/rhel8-install/`，指定 `ftp://myserver.example.com/rhel8-install/` 作为安装源。 						









## 系统要求参考信息

​				这部分提供了在安装 Red Hat Enterprise Linux 时的硬件、安装目标、系统、内存和 RAID 的信息和指南。 		

### 硬件兼容性

​					红帽与硬件支持的硬件厂商紧密合作。 			

- ​							要验证您的硬件是否被支持,请查看红帽硬件兼容性列表,网址为 https://access.redhat.com/ecosystem/search/#/category/Server。 					
- ​							要查看支持的内存大小或者 CPU 的数量，请参阅 https://access.redhat.com/articles/rhel-limits。 					

## A.2. 支持的安装目标

​					安装目标是保存 Red Hat Enterprise Linux 并引导系统的存储设备。Red Hat Enterprise Linux 支持 AMD64、Intel 64 和 64 位 ARM 系统的以下安装目标： 			

- ​							通过标准内部接口（如 SCSI、SATA 或 SAS）连接的存储 					
- ​							BIOS/firmware RAID 设备 					
- ​							Intel64 和 AMD64 构架中的扇区模式的 NVDIMM 设备,由 nd_pmem 驱动程序支持。 					
- ​							光纤通道主机总线适配器和多路径设备。有些操作需要厂商提供的驱动程序。 					
- ​							Xen 虚拟机的 Intel 处理器上的 Xen 块设备。 					
- ​							KVM 虚拟机的 Intel 处理器上的 virtio 块设备。 					

​					红帽不支持安装 USB 驱动器或者 SD 内存卡。有关支持第三方虚拟化技术的详情，请查看 [红帽硬件兼容性列表](https://hardware.redhat.com/)。 			

## A.3. 系统规格

​					Red Hat Enterprise Linux 安装程序自动侦测并安装您的系统硬件，因此您不必提供具体系统信息。然而,在某些 Red Hat Enterprise Linux 安装场景中,建议您记录系统规格以备以后参考。这些情况包括： 			

**使用自定义分区布局安装 RHEL**

​						**Record:** 模型号、大小、类型和附加到系统的硬盘接口。例如： SATA0 中的 Seagate ST3320613AS 320 GB、SATA1 中的 Western Digital WD7500AAKS 750 GB。 				

**在现有系统中将 RHEL 作为附加操作系统安装**

​						**Record:**  系统中使用的分区。这个信息可以包括文件系统类型、设备节点名称、文件系统标签和大小,并允许您在分区过程中识别特定的分区。如果某个操作系统是  Unix 操作系统，Red Hat Enterprise Linux 可能会报告不同的设备名称。要找到额外的信息,可以执行等同 **mount** 命令和 blkid 命令 **,** 并在 **/etc/fstab** 文件中执行。 				

​					如果安装了多个操作系统，Red Hat Enterprise Linux 安装程序会尝试自动探测它们，并配置引导装载程序来引导它们。如果没有自动探测到它们，您可以手动配置附加操作系统。如需更多信息 *,请参阅在 [第 10.4 节 “配置软件选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#configuring-software-settings_graphical-installation) 中配置引导装载程序*。 			

**从本地硬盘中的镜像安装 RHEL**

​						**Record:** 包含该镜像的硬盘和目录。 				

**从网络位置安装 RHEL**

​						如果需要手动配置网络，即不使用 DHCP。 				

​					**Record:** 			

- ​							IP 地址 					
- ​							子网掩码 					
- ​							网关的 IP 地址 					
- ​							服务器 IP 地址（如果需要） 					

​					如果您需要网络支持，请联系您的网络管理员。 			

**在 iSCSI 目标上安装 RHEL**

​						**Record:** iSCSI 目标的位置。根据您的网络，可能需要 CHAP 用户名和密码，以及反向 CHAP 用户名和密码。 				

**如果系统是某个域的一部分，请安装 RHEL**

​						验证域名是否由 DHCP 服务器提供。如果没有，在安装过程中输入域名。 				

## A.4. 磁盘和内存要求

​					如果安装了一些操作系统，必须确定分配的磁盘空间与 Red Hat Enterprise Linux 要求的磁盘空间分离。 			

注意

- ​								对于 AMD64、Intel 64 和 64 位 ARM,Red Hat Enterprise Linux 至少需要两个专用分区（`/` 和 `swap`）。 						
- ​								对于 IBM Power 系统服务器,Red Hat Enterprise Linux 至少需要三个专用的分区（`/`、`swap` 和 `PReP` 引导分区）。 						

​					您必须至少有 10GiB 可用磁盘空间。如需更多信息,请参阅 [附录 B, *分区参考*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#partitioning-reference_installing-RHEL)。 			

​					要安装 Red Hat Enterprise Linux，必须至少有 10GiB 未分区磁盘空间或可删除分区。如需更多信息,请参阅 [附录 B, *分区参考*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#partitioning-reference_installing-RHEL)。 			

**表 A.1. 最低 RAM 要求**

| 安装类型                      | 推荐的最小内存                                               |
| ----------------------------- | ------------------------------------------------------------ |
| 本地介质安装（USB、DVD）      | 1.5 GiB 用于一个 arch64、s390x 和 x86_64 架构 									 										3 GiB 用于 ppc64le 架构 |
| NFS 网络安装                  | 1.5 GiB 用于一个 arch64、s390x 和 x86_64 架构 									 										3 GiB 用于 ppc64le 架构 |
| HTTP、HTTPS 或者 FTP 网络安装 | 3 GiB 用于 s390x 和 x86_64 架构 									 										4 GiB 用于 arch64 和 ppc64le 构架 |

注意

​						使用比推荐的最低要求小的内存可完成安装。具体的要求取决于您的环境和安装路径。建议您测试各种配置，以确定环境所需的最小内存。使用  Kickstart 文件安装 Red Hat Enterprise Linux 与标准安装有相同的推荐最小 RAM 要求。然而，如果您的  Kickstart 文件包含需要额外内存的命令，或者将数据写入 RAM 磁盘，则可能需要额外的 RAM。如需更多信息，请参阅[*执行高级 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/)文档。 				

## A.5. RAID 要求

​					非常重要的一点是，了解如何配置存储技术以及如何在 Red Hat Enterprise Linux 主要版本间的更改对存储技术的支持。 			

**硬件 RAID**

​						您的计算机主板或者附加控制器卡提供的所有 RAID 功能都需要在开始安装进程前进行配置。在 Red Hat Enterprise Linux 中，每个活跃的 RAID 阵列都以一个驱动器的形式出现。 				

**软件 RAID**

​						在超过一个硬盘的系统中，您可以使用 Red Hat Enterprise Linux 安装程序作为 一 个 Linux 软件 RAID 阵列操作多个驱动器。使用软件 RAID 阵列时,RAID 功能由操作系统控制,而不是由专用硬件控制。 				

注意

​						当预先存在的 RAID 阵列的成员设备都是未分区的磁盘/驱动器时,安装程序会将阵列视为磁盘,且没有删除该阵列的方法。 				

**USB 磁盘**

​						您可在安装后连接和配置外部 USB 存储。大多数设备可被内核识别，但有些设备可能无法识别。如果在安装过程中配置这些磁盘并不是必须的,请断开连接它们以避免潜在的问题。 				

**NVDIMM 设备**

​						要将非线性内存模块(NVDIMM)设备用作存储,必须满足以下条件： 				

- ​							Red Hat Enterprise Linux 的版本为 7.6 或更高版本。 					
- ​							系统的构架是 Intel 64 或者 AMD64。 					
- ​							该设备被配置为扇区模式。Anaconda 可将 NVDIMM 设备重新配置为这个模式。 					
- ​							该设备必须被 nd_pmem 驱动程序支持。 					

​					在以下附加条件下可使用 NVDIMM 设备引导： 			

- ​							系统使用 UEFI。 					
- ​							该设备必须使用系统中可用的固件或者 UEFI 驱动程序支持。UEFI 驱动程序可以从该设备本身的选项 ROM 中载入。 					
- ​							该设备必须在命名空间下提供。 					

​					要在引导过程中利用 NVDIMM 设备的高性能,将 `/boot` 和 `/boot/efi` 目录放在该设备中。 			

注意

​						在引导过程中不支持 NVDIMM 设备的 Execute-in-place(XIP)功能,内核被加载到传统的内存中。 				

**Intel BIOS RAID 设定的注意事项**

​						Red Hat Enterprise Linux 使用 `mdraid` 在 Intel BIOS RAID 组件中安装。这些组件会在引导过程中自动探测到，设备节点路径可在多个引导过程中更改。因此,在 Red Hat Enterprise Linux 中,对 `/etc/fstab`、`/etc/crypttab` 或者其它参考设备节点路径的配置文件进行的本地修改可能无法在 Red Hat Enterprise Linux 中正常工作。建议您使用文件系统标签或者设备 UUID 替换设备节点路径（比如 `/dev/sda`）。您可以使用 `blkid` 命令查找文件系统标签和设备 UUID。 				

## A.6. UEFI 安全引导和 Beta 发行要求

​					如果您计划安装 Red Hat Enterprise Linux 的 Beta 版本,在启用了 UEFI 安全引导的系统上,首先禁用 UEFI 安全引导选项,然后开始安装。 			

​					UEFI 安全引导要求操作系统内核使用一个可识别的私钥签名,系统 firware 使用对应的公钥验证它。对于 Red Hat  Enterprise Linux Beta 版本,内核使用特定于 Red Hat Beta  的公钥签名,系统默认无法识别该公钥。因此,系统甚至无法引导安装介质。 			

## 附录 B. 分区参考

## B.1. 支持的设备类型

- 标准分区

  ​								标准分区可以包含文件系统或者 swap 空间。标准分区最常用于 `/boot` `BIOS Boot` 以及 `EFI System partitions`。多数其他用途，推荐使用 LVM 逻辑卷。 						

- LVM

  ​								选择 `LVM` （或者逻辑卷管理）作为设备类型会创建一个 LVM  逻辑卷。如果目前没有 LVM 卷组，则会自动生成包含新卷的卷组 ; 如果 LVM 卷组已存在，则会分配该卷。LVM  可在使用物理磁盘时提高性能，并允许高级设置，比如在一个挂载点使用多个物理磁盘，并设置软件 RAID 来提高性能、可靠性或两者。 						

- LVM 精简配置

  ​								使用精简配置，您可以管理一个空闲空间的存储池，称为精简池，可在应用程序需要时将其分配给任意数量的设备。您可以根据需要动态地扩展池，以便有效分配存储空间。 						

警告

​						安装程序不支持超额提供的 LVM 精简池。 				

## B.2. 支持的文件系统

​					这部分论述了 Red Hat Enterprise Linux 中可用的文件系统。 			

- xfs

  ​								`XFS` 它是一个高度可扩展的高性能文件系统，它最多支持 16 EB（大约一千六百万 TB）的文件系统、8 EB 文件（大约八百万 TB）以及包含千百万条目的目录结构。`XFS` 也支持元数据日志，它可提高崩溃恢复速度。单个 XFS 文件系统最多支持 500 TB。`XFS` 是 Red Hat Enterprise Linux 中默认和推荐的文件系统。 						

- ext4

  ​								`ext4` 文件系统基于 `ext3` 文件系统，并做了很多改进。这包括对更大文件系统和更大文件的支持、更快更有效的磁盘空间分配、一个目录中无限的子目录数、更快速的文件系统检查及更强大的日志能力。单个 `ext4` 文件系统最多支持 50 TB。 						

- ext3

  ​								`ext3` 文件系统基于 `ext2` 文件系统，它有一个主要优点 - 日志（journaling）。使用日志记录文件系统可减少在文件系统终止后恢复文件系统所花费的时间，因为不需要每次运行 fsck 程序检查文件系统元数据一致性。 						

- ext2

  ​								`ext2` 文件系统支持标准 Unix 文件类型，包括常规文件、目录或符号链接。它允许分配长文件名，最多 255 个字符。 						

- swap

  ​								交换分区是用来支持虚拟内存的。换句话说，当内存不足以贮存系统正在处理的数据时，数据就会被写入 swap 分区。 						

- vfat

  ​								`VFAT` 文件系统是一个 Linux 文件系统，它与 Microsoft Windows 的 FAT 文件系统中的长文件名兼容。 						注意 								Linux 系统分区不支持 `VFAT` 文件系统。例如 `/`、`/var`、`/usr` 以此类推。 							

- BIOS 引导

  ​								从在 BIOS 系统和 BIOS 兼容模式的 UEFI 系统上使用 GUID 分区表(GPT)引导的设备所需小分区。 						

- EFI 系统分区

  ​								UEFI 系统上引导使用 GUID 分区表(GPT)设备所需小分区。 						

- PReP

  ​								这个小的引导分区位于硬盘的第一个分区中。`PReP` boot 分区包含 GRUB2 引导装载程序,它可允许 IBM Power Systems 服务器引导 Red Hat Enterprise Linux。 						

## B.3. 支持的 RAID 类型

​					RAID 代表独立磁盘冗余阵列，可让您将多个物理磁盘合并为逻辑单元。有些设置的设计思想是以可靠性来换取性能的提高，另一些设备会通过需要更多的磁盘空间来获得高可靠性。 			

​					这部分论述了您可以在 LVM 和 LVM Thin Provisioning 中使用的软件 RAID 类型在安装的系统中设置存储。 			

- 无

  ​								没有设置 RAID 阵列。 						

- RAID 0

  ​								性能： 在多个磁盘间分配数据。RAID 0 提供比标准分区优越的性能，并可用来将多个磁盘的存储池化到一个大的虚拟设备中。请注意，RAID 0 不提供冗余,且阵列中的一个设备失败会破坏整个阵列中的数据。RAID 0 要求至少有两个磁盘。 						

- RAID 1

  ​								冗余： 镜像将所有数据从一个分区复制到一个或多个其他磁盘。阵列中的附加设备提供增大的冗余级别。RAID 1 要求至少有两个磁盘。 						

- RAID 4

  ​								错误检查：  在多个磁盘间分配数据,并使用阵列中的一个磁盘存储奇偶校验信息,这样可在阵列中的任意磁盘失败时保护阵列。因为所有奇偶校验信息都存储在一个磁盘上,访问这个磁盘会为阵列的性能创建一个"bottleneck"。RAID 4 要求至少有三个磁盘。 						

- RAID 5

  ​								分布式错误检查： 在多个磁盘间分配数据和奇偶校验信息。RAID 5 提供在多个磁盘间分布数据的性能优势,但没有 RAID 4 的性能瓶颈,因为也在阵列间发布奇偶校验信息。RAID 5 要求至少有三个磁盘。 						

- RAID 6

  ​								冗余错误检查： RAID 6 与 RAID 5 类似。不同之处是会保存两组奇偶校验数据，而不是一组。RAID 6 要求至少有四个磁盘。 						

- RAID 10

  ​								性能和冗余： RAID 10 是嵌套的或混合的 RAID。它由在磁盘镜像组件中分布的数据组成。例如：一个由四个 RAID 分区组成的 RAID 10 阵列由两对条状分区组成。RAID 10 要求至少有 四 个磁盘。 						

## B.4. 推荐的分区方案

​					红帽建议您在以下挂载点创建单独的文件系统。但是，如果需要您还可以在其中生成文件系统 `/usr` `/var`以及 `/tmp` 挂载点。 			

- ​							`/boot` 					

- ​							`/` (root) 					

- ​							`/home` 					

- ​							`swap` 					

- ​							`/boot/efi` 					

- ​							`PReP` 					

  - `/boot` partition - 建议大小至少为 1 GiB

    ​										挂载的分区 `/boot` 包含操作系统内核，它可允许您的系统引导  Red Hat Enterprise Linux 8,以及在 bootstrap  过程中使用的文件。鉴于多数固件的限制，推荐创建一个较小的分区来容纳这些文件。在大多数情况下，1 GiB 引导分区足够了。和其它挂载点不同，`/boot` 不能使用 LVM 卷进行 - `/boot` 必须位于独立的磁盘分区中。 								警告 										通常情况下，`/boot` 分区由安装程序自动创建。但是，如果 `/` （根）分区大于 2 TiB，且(U)EFI 用于引导，您需要创建一个小于 2 TiB 的独立 `/boot` 分区才能成功引导机器。 									注意 										如果有一张 RAID 卡，请注意某些 BIOS 类型不支持从 RAID 卡中引导。在这种情况下，`/boot` 分区必须在 RAID 阵列之外被创建，比如在一个单独的硬盘驱动器上创建。 									

  - `root` - 建议大小为 10 GiB

    ​										这是"`/`"或根目录的位置。root 目录是目录结构的最顶层。默认情况下，所有文件都会被写入这个文件系统，除非在要写入的路径中挂载了不同的文件系统，例如： `/boot` 或 `/home`。 								 									虽然 5 GiB 根文件系统允许您最小安装，但建议至少分配 10 GiB，以便可以尽可能安装您想要的软件包组。 								重要 										不要将 `/` 目录与 `/root` 目录混淆。`/root` 目录是 root 用户的主目录。`/root` 目录有时被称为 *斜杠 root*，将其与 root 目录区分开。 									

  - `/home` - 建议大小至少为 1 GiB

    ​										要将用户数据与系统数据分开存储，请为该 `/home`  目录创建一个专用的文件系统。文件系统大小基于本地存储的数据大小、用户数量等。您可以在不删除用户数据文件的情况下，升级或重新安装 Red Hat  Enterprise Linux 8。如果您选择自动分区，则建议至少有 55 GiB 磁盘空间可用于安装，以确保创建了 `/home` 文件系统。 								

  - `swap` 分区 - 建议大小至少为 1 GB

    ​										swap 文件系统支持虚拟内存 ; 当内存不足以贮存系统正在处理的数据时，数据就会被写入 swap 文件系统。swap  大小是系统内存负载的一个功能，而不是系统内存总量，因此不等于系统内存总量。务必要分析系统将要运行的应用程序以及那些应用程序将服务的负载，以确定系统内存工作负载。应用程序供应商和开发人员可提供支持。 								 									当系统没有 swap 空间时，内核会终止进程，因为系统 RAM 内存已耗尽。配置太多 swap  空间会导致存储设备被分配但处于闲置状态，因此资源使用不足。太多 swap 空间也会隐藏内存泄漏的问题。swap 分区的最大值以及其它附加信息可在 `mkswap(8)` 手册页中找到。 								 									下表根据系统中的 RAM 量以及需要足够的内存以便系统休眠提供推荐的 swap  分区大小。如果您让安装程序自动为系统分区，则使用这个指南建立 swap 分区大小。自动分区设置假设不使用休眠功能。swap  分区的最大大小为硬盘总容量的 10%,且安装程序无法创建大于 1TiB 的交换分区。要设置足够的 swap 空间来允许休眠功能,或者想将  swap 分区大小设定为超过系统的存储空间 10%,或者大于 1TiB,您必须手动编辑分区布局。 								

  - `/boot/efi` 分区 - 建议大小为 200 MiB

    ​										基于 UEFI 的 AMD64、Intel 64 和 64 位 ARM 需要 200 MiB EFI 系统分区。推荐的最小值是 200 MiB，默认大小为 600 MiB，最大为 600 MiB。BIOS 系统不需要 EFI 系统分区。 								

**表 B.1. 推荐的系统 swap 空间**

| 系统中的 RAM 量 | 推荐的 swap 空间        | 如果允许休眠则推荐使用 swap 空间 |
| --------------- | ----------------------- | -------------------------------- |
| 低于 2 GB       | RAM 量的 2 倍           | RAM 量的 3 倍                    |
| 2 GB - 8 GB     | 与 RAM 量相等           | RAM 量的 2 倍                    |
| 8 GB - 64 GB    | 4 GB 到 RAM 量的 0.5 倍 | RAM 量的 1.5 倍                  |
| 64 GB 以上      | 独立负载（至少 4GB）    | 不推荐休眠                       |

​					例如，一个有 2GB、8 GB 或 64 GB 系统 RAM 的系统。可根据所选 swap 空间和休眠支持自由裁量。如果您的系统资源允许此操作，增加 swap 空间可提高性能。 			

​					将 swap 空间分布到多个存储设备中 - 特别是对于那些使用高速驱动器、控制程序和接口的系统，还可提高 swap 空间性能。 			

​					很多系统的分区和卷超过了最低要求。根据具体系统需要选择分区。 			

注意

- ​								只为那些您需要的分区立即分配存储容量。您可以在任何时间分配空闲空间来满足需要。 						
- ​								如果您不确定如何配置分区，使用安装程序提供的自动默认分区布局。 						

- `PReP` 引导分区 - 建议大小为 4 到 8 MiB

  ​								当在 IBM Power System 服务器中安装 Red Hat Enterprise Linux 时，硬盘的第一个分区应该包括一个 `PReP` 引导分区。它包含 GRUB2 引导装载程序，可允许 IBM Power Systems 服务器引导 Red Hat Enterprise Linux。 						

## B.5. 分区建议

​					无法为每个系统分区最佳方法; 最理想的设置取决于您计划如何使用要安装的系统。然而,下面的提示可能帮助您找到最合适的布局以满足您的需要： 			

- ​							首先创建具有特定要求的分区，例如，某个分区必须位于特定磁盘中。 					

- ​							考虑加密任何可能包含敏感数据的分区和卷。加密可防止未授权的人访问分区中的数据，即使他们可以访问物理存储设备。在大多数情况下，您应该至少为包含用户数据的 `/home` 分区进行加密。 					

- ​							在某些情况下,为 `/`、`/boot` 和 `/home` 以外的目录创建独立挂载点可能很有用。例如,在运行 `MySQL` 数据库的服务器中,拥有一个单独的 `/var/lib/mysql` 挂载点允许您在重新安装的过程中保留数据库,而无需之后从备份中恢复它。但是，使用不必要的挂载点使存储管理更为困难。 					

- ​							一些特殊的限制适用于某些可以放置分区布局的目录。值得注意的是，`/boot` 目录必须总是位于物理分区（不能在 LVM 卷中）。 					

- ​							如果您对 Linux 不熟悉,请考虑查看 [Linux Filesystem Hierarchy Standard](http://refspecs.linuxfoundation.org/FHS_2.3/fhs-2.3.html) 以了解有关各种系统目录及其内容的信息。 					

- ​							每个安装在您系统的内核都需要大约 56 MB `/boot` 分区： 					

  - ​									32 MB initramfs 							

  - ​									14 MB kdump initramfs 							

  - ​									3.5 MB 系统映射 							

  - ​									6.6 MB vmlinuz 							

    注意

    ​										对于救援模式 `initramfs` 和 `vmlinuz` 需要 80 MB。 								

    ​									`/boot` 的默认大小为 1 GB，这可以满足大多数常用用例的需要。但如果您计划保留多个内核发行本或者勘误内核，则建议您增大这个分区的大小。 							

- ​							`/var` 目录保存了大量应用程序的内容,包括 Apache web 服务器, YUM 软件包管理器使用它暂时存储下载的软件包更新。确定包含 `/var` 的分区或卷至少有 3 GB。 					

- ​							`/var` 目录中的内容通常会经常改变。这可能会导致较旧的固态驱动器(SSD)出现问题,因为它们在变得不可用前可处理较少的读/写循环。如果系统 root 位于 SSD 上，请考虑在一般的 HDD 中为 `/var` 创建一个单独的挂载点。 					

- ​							该 `/usr` 目录包含典型 Red Hat Enterprise Linux 安装中的主要软件。因此，包含这个目录的分区或卷应该至少 5 GB 用于最小安装，使用图形环境的安装需要至少 10 GB。 					

- ​							如果 `/usr` 或 `/var` 是独立于剩余 root 卷的分区，引导过程会变得非常复杂，因为这些目录包含了对引导极为重要的组件。在某些情况下，比如这些目录位于 iSCSI 驱动器或 FCoE 位置，系统可能无法引导，或者在关机或重启时挂起并出现 `Device is busy` 出错信息。 					

  ​							这个限制只适用于 `/usr` 或 `/var`,不适用于它们下的目录。例如：为 `/var/www` 使用一个独立的分区可以正常工作。 					

  重要

  ​								有些安全策略需要分离 `/usr` 和 `/var`,即使它使管理更为复杂。 						

- ​							考虑在 LVM 卷组中保留一部分空间不分配。如果您的空间要求改变，但您不希望从其他卷中删除数据，这个未分配空间为您提供了灵活性。您还可以为分区选择 `LVM Thin Provisioning` 设备类型，以便让卷自动处理未使用的空间。 					

- ​							不能缩小 XFS 文件系统的大小 - 如果您需要使这个文件系统的分区或卷更小,您必须备份数据,销毁文件系统,然后创建一个新的、较小的文件系统。因此,如果您计划在以后更改分区布局,则需要使用 ext4 文件系统。 					

- ​							如果您希望在安装完成后通过添加更多硬盘或增加虚拟机硬盘来扩展存储，请使用逻辑卷管理（LVM）。通过使用 LVM，您可以在新驱动器中创建物理卷，然后将其分配给任何您认为适合的卷组和逻辑卷 - 例如，您可以轻松地扩展您的系统 `/home` （或者其它位于逻辑卷的目录）。 					

- ​							取决于系统的固件、引导驱动器大小以及引导驱动器磁盘标签，可能需要创建 BIOS 引导分区或者 EFI 系统分区。有关这些 [分区的详情,请参阅推荐](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#recommended-partitioning-scheme_partitioning-reference) 的分区方案。请注意,如果您的系统不 **需要**,则无法在图形安装中创建 BIOS 引导或者 EFI 系统分区 - 在这种情况下,在菜单中隐藏它们。 					

- ​							如果您需要在安装后更改存储配置，Red Hat Enterprise Linux 程序库会提供几个不同的工具来帮助您完成此操作。如果您希望使用命令行工具,请尝试 `system-storage-manager`。 					

## 附录 C. 引导选项参考

​				本节介绍可以用来修改安装程序默认行为的一些引导选项。有关 Kickstart 和高级引导选项，请查看 [*执行高级 RHEL 安装文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/)。 		

## C.1. 安装源引导选项

​					这部分包含有关各种安装源引导选项的信息。 			

- inst.repo=

  ​								`inst.repo=` 引导选项指定安装源，即提供软件包程序库的位置以及一个有效的描述它们的 `.treeinfo` 文件。例如： `inst.repo=cdrom`。该 `inst.repo=` 选项的目标必须是以下安装介质之一： 						 									一个可安装树，它是一个目录结构，其中包含安装程序镜像、软件包和存储库数据的目录结构，以及有效 `.treeinfo` 文件。 								 									一个 DVD（系统 DVD 驱动器中有物理磁盘） 								 									一个 Red Hat Enterprise Linux 安装 DVD 的 ISO 镜像，它可以位于一个硬盘中，或在一个可以被访问到的网络位置。 								 									使用 `inst.repo=` 引导选项使用不同的格式配置不同的安装方法。下表包含 `inst.repo=` 引导选项语法的详情： 								**表 C.1. inst.repo= installation source boot options**源类型引导选项格式源格式  													CD/DVD 驱动器 												 												   													`inst.repo=cdrom:*<device>*` 												 												   													将 DVD 作为物理磁盘安装。[[a\]](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ftn.idm140510195169552) 												 												   													可安装的树 												 												   													`inst.repo=hd:*<device>*:/*<path>*` 												 												   													DVD 或安装树的镜像文件，这是安装 DVD 中的目录和文件的完整副本。 												 												   													NFS 服务器 												 												   													`inst.repo=nfs:[*options*:]*<server>*:/*<path>*` 												 												   													DVD 或安装树的镜像文件，这是安装 DVD 中的目录和文件的完整副本。[[b\]](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ftn.idm140510198887680) 												 												   													HTTP 服务器 												 												   													`inst.repo=http://*<host>*/*<path>*` 												 												   													安装树，这是安装 DVD 中的目录和文件的完整副本。 												 												   													HTTPS 服务器 												 												   													`inst.repo=https://*<host>*/*<path>*` 												 												   													FTP 服务器 												 												   													`inst.repo=ftp://*<username>*:*<password>*@*<host>*/*<path>*` 												 												   													HMC 												 												   													`inst.repo=hmc` 												 												  [[a\] ](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#idm140510195169552) 														如果*禁用*了设备，安装程序会自动搜索包含安装 DVD 的驱动器。 													[[b\] ](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#idm140510198887680) 														NFS 服务器选项默认使用 NFS 协议版本 3。要使用不同的版本，把 `nfsvers=*X*` 添加到 *选项*，用您要使用的版本号替换 *X*。 													 									使用以下格式设定磁盘设备名称： 								 									内核设备名称，例如 `/dev/sda1` : `sdb2` 								 									文件系统标签，例如 `LABEL=Flash` 或 `LABEL=RHEL8` 								 									文件系统 UUID，例如 `UUID=8176c7bf-04ff-403a-a832-9557f94e61db` 								 									非字母数字的字符必须使用 `\xNN`，其中 *NN* 是代表字符的十六进制值。例如, `\x20` 是一个空格 `(" ")`。 								

- inst.addrepo=

  ​								使用 `inst.addrepo=` 引导选项添加可用作另一个安装源的附加程序库以及主仓库（`inst.repo=`）。在一次引导中，您可以多次使用 `inst.addrepo=` 引导选项。下表包含 `inst.addrepo=` 引导选项语法的详情。 						注意 								`REPO_NAME` 是仓库的名称，它是安装过程所需要的。这些软件仓库仅在安装过程中使用，它们不会在安装的系统中安装。 							**表 C.2. inst.addrepo 安装源引导选项**安装源引导选项格式附加信息  											在 URL 中可安装的树 										 										   											`inst.addrepo=REPO_NAME,[http,https,ftp]://*<host>*/*<path>*` 										 										   											在给定 URL 中查找可安装的树。 										 										   											NFS 路径中的可安装树 										 										   											`inst.addrepo=REPO_NAME,nfs://*<server>*:/*<path>*` 										 										   											在给定的 NFS 路径中查找可安装的树。主机后需要一个冒号。安装程序将 `nfs://` 后的所有内容直接传递给 mount 命令，而不是根据 RFC 2224 解析 URL。 										 										   											安装环境中的可安装树 										 										   											`inst.addrepo=REPO_NAME,file://*<path>*` 										 										   											在安装环境中的给定位置查找可安装的树。要使用这个选项，必须在安装程序尝试载入可用软件组前挂载该程序库。这个选项的好处是，您可以在一个可引导 ISO 上有多个库，您还可以从 ISO 安装主存储库和其他软件仓库。到额外软件仓库的路径为 `/run/install/source/REPO_ISO_PATH`。另外，您可以在 Kickstart 文件的 `%pre` 小节中挂载仓库目录。该路径必须是绝对路径，且以 `/` 开始，例如： `inst.addrepo=REPO_NAME,file:///*<path>*` 										 										   											硬盘驱动器 										 										   											`inst.addrepo=REPO_NAME,hd:*<device>*:*<path>*` 										 										   											挂载给定的 *<device>* 分区并从由 *<path>* 指定的 ISO 中安装。如果没有指定 *<path>*，安装程序会在 *<device>* 中查找有效安装 ISO。这个安装方法需要一个含有有效可安装树的 ISO。 										 										 

- inst.stage2=

  ​								使用 `inst.stage2=` 引导选项指定安装程序运行时镜像的位置。这个选项需要包含有效 `.treeinfo` 文件的目录的路径。运行时镜像的位置从文件 `.treeinfo` 中读取。如果这个 `.treeinfo` 文件不可用，安装程序会尝试从 `images/install.img` 载入镜像。 						 							如果没有指定该 `inst.stage2` 选项，安装程序会尝试使用 `inst.repo` 选项指定的位置。 						 							仅在使用 PXE 引导方法时使用这个选项。安装 DVD 和引导 ISO 已经包含正确的 `inst.stage2` 选项来引导安装程序。 						注意 								默认情况下，安装介质中使用 `inst.stage2=` 引导选项，并被设置为具体标签，例如： `inst.stage2=hd:LABEL=RHEL-8-0-0-BaseOS-x86_64`如果您修改包含该运行时镜像的文件系统默认标签，或者使用自定义流程引导安装系统，则必须验证 `inst.stage2=` 引导选项是否已被设置为正确的值。 							

- inst.noverifyssl

  ​								使用 `inst.noverifyssl` 引导选项可防止安装程序为所有 HTTPS 连接验证 SSL 证书，但附加 Kickstart 程序库除外，其中 `--noverifyssl` 可为每个程序库设置。 						 							例如：如果您的远程安装源使用自签名 SSL 证书，则该 `inst.noverifyssl` 引导选项可让安装程序在不验证 SSL 证书的情况下完成安装。 						**指定源时使用 `inst.stage2=` 示例** 								 `inst.stage2=https://hostname/path_to_install_image/ inst.noverifyssl` 								**指定源时使用 `inst.repo=` 示例** 								 `inst.repo=https://hostname/path_to_install_repository/ inst.noverifyssl` 								

- inst.stage2.all

  ​								`inst.stage2.all` 引导选项是用来指定 HTTP、HTTPS 或者 FTP 源。您可以多次使用 `inst.stage2=` 引导选项，同时使用 `inst.stage2.all` 选项从源顺序获取镜像，直到成功为止。例如： 						`inst.stage2.all inst.stage2=http://hostname1/path_to_install_tree/ inst.stage2=http://hostname2/path_to_install_tree/ inst.stage2=http://hostname3/path_to_install_tree/`

- inst.dd=

  ​								`inst.dd=` 引导选项在安装过程中执行驱动程序更新。有关如何在安装过程中更新驱动程序的更多信息，请参阅 [*执行高级 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/) 文档。 						

- inst.repo=hmc

  ​								当使用二进制 DVD 引导时，安装程序会提示您输入附加内核参数。要将 DVD 设为安装源，请在内核参数中附加 `inst.repo=hmc` 选项。然后安装程序将启用 `SE` 和 `HMC` 文件访问，从 DVD 中获取 stage2 镜像，并提供对 DVD 中软件包的访问以供软件选择。这个选项消除了外部网络设置的要求并扩展安装选项。 						

- inst.proxy=

  ​								使用 HTTP、HTTPS 和 FTP 协议执行安装时使用 `inst.proxy=` 引导选项。例如： 						`[PROTOCOL://][USERNAME[:PASSWORD]@]HOST[:PORT]`

- inst.nosave=

  ​								使用 `inst.nosave=` 引导选项控制安装日志以及没有保存到安装的系统中的相关文件，例如 `input_ks`、`output_ks`、`logs` 和 `all_ks` `all`。可将多个值合并为一个用逗号分开的列表，例如： `input_ks,logs` 						注意 								该 `inst.nosave` 引导选项是用来排除安装系统中无法被 Kickstart %post 脚本删除的文件，如日志和输入/输出 Kickstart 结果。 							**表 C.3. inst.nosave boot options**选项描述  											input_ks 										 										   											禁用保存输入 Kickstart 结果的功能。 										 										   											output_ks 										 										   											禁用保存安装程序生成的 Kickstart 结果的功能。 										 										   											all_ks 										 										   											禁用保存输入和输出 Kickstart 结果的功能。 										 										   											日志 										 										   											禁用保存所有安装日志的功能。 										 										   											all 										 										   											禁用保存所有 Kickstart 结果以及所有日志的功能。 										 										 

- inst.multilib

  ​								使用 `inst.multilib` 引导选项将 DNF 的 `multilib_policy` 设置为 **all**，而不是 **best**。 						

- inst.memcheck

  ​								`inst.memcheck` 引导选项执行检查来确定系统有足够 RAM 来完成安装。如果没有足够 RAM，则会停止安装过程。系统检查不是完全准确的，在安装过程中的内存用量要根据软件包的选择、用户界面（如图形或文本）和其它参数而定。 						

- inst.nomemcheck

  ​								`inst.nomemcheck` 引导选项不会执行检查来验证系统是否有足够 RAM 来完成安装。在低于推荐最小内存量的系统中进行安装不被支持，并可能导致安装过程失败。 						

## C.2. 网络引导选项

​					这部分包含关于常用网络引导选项的信息。 			

注意

​						初始网络初始化是由 `dracut` 处理的。有关完整列表，请查看 `dracut.cmdline(7)` man page。 				

- ip=

  ​								使用 `ip=` 引导选项配置一个或多个网络接口。要配置多个接口，您可以多次使用 `ip` 选项，每个接口都必须使用 `rd.neednet=1` 选项，且您必须使用 `bootdev` 选项指定主引导接口。另外，您可以使用一次 `ip` 选项，然后使用 Kickstart 设置其他接口。这个选项接受几种不同的格式。下表包含大多数常用选项的信息。 						注意 								在以下表格中： 							 										`ip` 参数指定客户端 IP 地址，需要方括号，例如 [ 2001:db8::99]。 									 										`gateway` 参数是默认网关。IPv6 地址也被接受。 									 										`netmask` 参数是要使用的子网掩码。这可以是完整子网掩码（例如： 255.255.255.0），或是一个前缀（例如 64）。 									 										`hostname` 参数是客户端系统的主机名。这个参数是可选的。 									**表 C.4. 网络接口配置引导选项格式**配置方法引导选项格式  											自动配置任意接口 										 										   											`ip=*method*` 										 										   											自动配置特定的接口 										 										   											`ip=*interface:method*` 										 										   											静态配置 										 										   											`ip=*ip::gateway:netmask:hostname:interface*:none` 										 										   											自动配置特定接口并进行覆盖 										 										   											`ip=*ip::gateway:netmask:hostname:interface:method:mtu*` 										 										 注意 								`automatic configuration of a specific interface with an override` 方法使用指定的自动配置方法启动接口，比如 `dhcp`，但会覆盖自动获得的 IP 地址 、网关、子网掩码、主机名或其他指定参数。所有参数都是可选的，因此仅指定您要覆盖的参数。 							 							`method` 参数可以是以下任意一种： 						**表 C.5. 自动接口配置方法**自动配置方法Value  											DHCP 										 										   											`dhcp` 										 										   											IPv6 DHCP 										 										   											`dhcp6` 										 										   											IPv6 自动配置 										 										   											`auto6` 										 										   											iSCSI Boot Firmware Table (iBFT) 										 										   											`ibft` 										 										 注意 										如果您使用需要网络访问的引导选项 `inst.ks=http://host/path`，比如在没有指定 ip 选项的情况下，安装程序将使用 `ip=dhcp`。 									 										要自动连接到 iSCSI 目标，您必须激活网络设备以便访问该目标。激活网络的建议方法是使用 `ip=ibft` 引导选项。 									

- nameserver=

  ​								`nameserver=` 选项指定名称服务器的地址。您可以多次使用这个选项。 						注意 								`ip=` 参数需要方括号。但是 IPv6 地址不能使用方括号。IPv6 地址使用的正确语法示例如下 `nameserver=2001:db8::1`。 							

- bootdev=

  ​								`bootdev=` 选项指定引导接口。如果您使用多个选项，这个 `ip` 选项是必须的。 						

- ifname=

  ​								这些 `ifname=` 选项会为带有给定 MAC 地址的网络设备分配接口名称。您可以多次使用这个选项。语法是 `ifname=interface:MAC`。例如： 						`ifname=eth0:01:23:45:67:89:ab`注意 								该 `ifname=` 选项是在安装过程中设置自定义网络接口的唯一方法。 							

- inst.dhcpclass=

  ​								该 `inst.dhcpclass=` 选项指定 DHCP 厂商类别识别符。`dhcpd` 服务将此值视为 `vendor-class-identifier`。默认值为 `anaconda-$(uname -srm)`。 						

- inst.waitfornet=

  ​								使用 `inst.waitfornet=SECONDS` 引导选项可让安装系统在安装前等待网络连接。参数中给出的 `SECONDS` 值指定了在超时和继续安装过程（即使没有网络连接）前等待网络连接的最长时间。 						

**其它资源**

- ​							有关联网的更多信息，请参阅[*配置和管理联网文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_networking/index/)。 					

## C.3. 控制台引导选项

​					本节介绍如何为您的控制台配置引导选项、显示器显示和键盘。 			

- console=

  ​								使用 `console=` 选项指定您要用作主控制台的设备。例如，要使用第一个串口上的控制台，请使用 `console=ttyS0`。这个选项和这个 `inst.text` 选项一起使用。您可以多次使用该 `console=` 选项。如果您这样做，则会在所有指定的控制台中显示引导信息,但安装程序将只使用最后一个控制台。例如，如果指定 `console=ttyS0 console=ttyS1`，安装程序将使用 `ttyS1`。 						

- inst.lang=

  ​								使用 `inst.lang=` 选项设定您要在安装过程中使用的语言。`locale -a | grep _` 或者 `localectl list-locales | grep _` 命令返回区域列表。 						

- inst.singlelang

  ​								使用 `inst.singlelang` 这个选项以单一语言模式安装，这将导致安装语言和语言支持配置没有可用的互动选项。如果使用 `inst.lang` 引导选项或者 `lang` Kickstart 命令指定语言，则会使用它。如果没有指定语言，安装程序会默认使用 `en_US.UTF-8`。 						

- inst.geoloc=

  ​								使用 `inst.geoloc=` 这个选项在安装程序中配置地理位置的使用。地理位置用于预设语言和时区，并使用以下语法： `inst.geoloc=value``value` 可以是以下参数： 						**表 C.6. inst.geoloc 引导选项的值**Value引导选项格式  											禁用地理位置 										 										   											`inst.geoloc=0` 										 										   											使用 Fedora geoip API 										 										   											`inst.geoloc=provider_fedora_geoip` 										 										   											使用 Hostip.info GeoIP API 										 										   											`inst.geoloc=provider_hostip` 										 										  							如果您没有指定 `inst.geoloc=` 选项，安装程序将使用 `provider_fedora_geoip`。 						

- inst.keymap=

  ​								使用 `inst.keymap=` 选项指定您要用来安装的键盘布局。 						

- inst.cmdline

  ​								使用 `inst.cmdline` 选项强制安装程序在命令行模式下运行。这个模式不允许任何互动，且您必须在 Kickstart 文件或者命令行中指定所有选项。 						

- inst.graphical

  ​								使用 `inst.graphical` 选项强制安装程序在图形模式下运行。这个模式是默认的模式。 						

- inst.text

  ​								使用 `inst.text` 选项强制安装程序在文本模式而不是图形模式下运行。 						

- inst.noninteractive

  ​								使用 `inst.noninteractive` 引导选项以非互动模式运行安装程序。在非互动模式中不允许用户互动，`inst.noninteractive` 可用于图形或文本安装。当在文本模式中使用这个 `inst.noninteractive` 选项时，它的行为与 `inst.cmdline` 选项相同。 						

- inst.resolution=

  ​								使用 `inst.resolution=` 选项指定图形模式中的页面分辨率。格式为 `NxM`，其中 *N* 是屏幕宽度， *M* 是页面高度（单位为像素）。最低分辨率为 1024x768。 						

- inst.vnc

  ​								使用 `inst.vnc` 选项使用 VNC 运行图形安装。您必须使用 VNC 客户端应用程序与安装程序交互。启用 VNC 共享时，可以连接多个客户端。在文本模式中安装使用 VNC 启动的系统。 						

- inst.vncpassword=

  ​								使用 `inst.vncpassword=` 选项设定安装程序使用的 VNC 服务器中的密码。 						

- inst.vncconnect=

  ​								使用 `inst.vncconnect=` 选项连接到给定主机位置侦听的 VNC 客户端。例如, `inst.vncconnect=<host>[:<port>]` 默认端口为 5900。这个选项可以与 `vncviewer -listen` 一起使用。 						

- inst.xdriver=

  ​								使用 `inst.xdriver=` 选项指定您要在安装过程中和安装的系统中使用的 X 驱动程序名称。 						

- inst.usefbx

  ​								使用 `inst.usefbx` 选项提示安装程序使用帧缓冲 X 驱动程序，而不是具体硬件驱动程序。这个选项等同于 `inst.xdriver=fbdev`。 						

- modprobe.blacklist=

  ​								使用 `modprobe.blacklist=` 选项阻止或完全禁用一个或多个驱动程序。在安装开始后，使用这个选项禁用的驱动（模式）不会被加载，在安装完成后，安装的系统还会保留这些设置。您可以在 `/etc/modprobe.d/` 目录中找到列出块驱动程序列表。使用以逗号分隔的列表禁用多个驱动程序。例如： 						`modprobe.blacklist=ahci,firewire_ohci`

- inst.xtimeout=

  ​								使用 `inst.xtimeout=` 选项指定启动 X 服务器的超时时间（以秒为单位）。 						

- inst.sshd

  ​								在安装过程中使用 `inst.sshd` 选项启动 `sshd` 服务，以便您可以在安装过程中使用 SSH 连接到该系统，并监控安装进程。有关 SSH 的详情请参考 `ssh(1)` man page。默认情况下，该 `sshd` 选项只在 IBM Z 构架中自动启动。在其它构架中，除非您使用 `inst.sshd` 选项，否则`sshd` 不会启动。 						注意 								在安装过程中，root 帐户默认没有密码。您可在安装过程中使用 `sshpw` Kickstart 命令设定 root 密码。 							

- inst.kdump_addon=

  ​								使用 `inst.kdump_addon=` 选项启用或禁用安装程序中的 Kdump 配置页面（附加组件）。这个页面会默认启用；可以使用 `inst.kdump_addon=off` 来禁用它。禁用该附加组件可在图形和文本界面以及 `%addon com_redhat_kdump` Kickstart 命令中禁用 Kdump 页面。 						

## C.4. 调试引导选项

​					本节介绍在调试问题时可以使用的选项。 			

- inst.rescue

  ​								使用这个 `inst.rescue` 选项来运行救援环境。该选项对诊断和修复系统很有用。例如：您可以 [在救援模式中修复文件系统](https://access.redhat.com/solutions/9541)。 						

- inst.updates=

  ​								使用 `inst.updates=` 选项指定您要在安装过程中应用的 `updates.img` 文件的位置。这些更新有很多源。 						**表 C.7. inst.updates= source updates**源描述示例  											从网络更新 										 										   											使用 `inst.updates=` 的最简单方法是指定 `updates.img` 的网络位置。这不需要对安装树进行任何修改。要使用这个方法，请编辑内核命令行使其包含 `inst.updates`。 										 										   											`inst.updates=http://some.website.com/path/to/updates.img`. 										 										   											从磁盘镜像更新 										 										   											您可在软盘或者 USB 密钥中保存 `updates.img`。这只能使用 `ext2` 文件系统类型完成 `updates.img`。要在软盘驱动器中保存镜像内容,请插入软盘并运行命令。 										 										   											`dd if=updates.img of=/dev/fd0 bs=72k count=20`.要使用 USB 密钥或者闪存介质，请使用您的 USB 密钥的设备名称替换 `/dev/fd0`。 										 										   											安装树中的更新 										 										   											如果您使用 CD、硬盘、HTTP 或者 FTP 安装，您可以在安装树中保存 `updates.img`，以便所有安装都可检测到 .img 文件。将文件保存到 `images/` 目录中。文件名必须是 `updates.img`。 										 										   											对于 NFS 安装，有两个选项： 您可以将镜像保存到 `images/` 目录中，也可以保存在安装树的 `RHupdates/` 目录中。 										 										 

- inst.loglevel=

  ​								使用 `inst.loglevel=` 选项指定终端日志信息的最小级别。这只考虑终端日志 ; 日志文件总是包含所有级别的信息。这个选项的可能值包括（从最低到最高级别）： `debug`、`info` `warning`、`error` 和 `critical`。默认值为 `info`。这代表，默认情况下日志记录终端会显示的范围是从 `info` 到 `critical`。 						

- inst.syslog=

  ​								当安装启动时，`inst.syslog=` 选项会将日志信息发送到指定主机的 `syslog` 进程。必须将远程 `syslog` 进程配置为接受进入的连接。 						

- inst.virtiolog=

  ​								使用 `inst.virtiolog=` 选项指定您要用于转发日志的 virtio 端口（字符设备 `/dev/virtio-ports/name`）。默认值为 `org.fedoraproject.anaconda.log.0`; 如果存在这个端口，则会使用它。 						

- inst.zram=

  ​								该 `inst.zram=` 选项控制在安装过程中 zRAM swap  的使用。该选项会在系统 RAM 中创建压缩块设备，并使用 swap  空间而不是硬盘。这可让安装程序在不压缩的情况下以小的可用内存运行，而且可能会加快安装速度。默认情况下，在内存超过 2 GiB 的系统中在  zRAM 上启用 swap，并在内存超过 2 GiB 的系统中禁用 swap。您可以使用这个选项来更改此行为 ; 在超过 2 GiB RAM  的系统中，使用 `inst.zram=1` 启用这个功能 ; 在内存为 2 GiB 或更少内存的系统中，使用 `inst.zram=0` 用来禁用这个功能。 						

- rd.live.ram

  ​								如果指定该 `rd.live.ram` 选项，`stage 2` 镜像将复制到 RAM 中。当 `stage 2` 镜像位于 NFS 服务器中时，使用这个选项会将该镜像大小大约增加 500 MiB。 						

- inst.nokill

  ​								该 `inst.nokill` 选项是一个调试选项，可防止安装程序在出现致命错误或安装过程结束时重启。使用 `inst.nokill` 选项捕获重启后会丢失的安装日志。 						

- inst.noshell

  ​								如果您在安装过程中不希望在终端会话 2(tty2)中有一个 shell，使用 `inst.noshell` 选项。 						

- inst.notmux

  ​								如果您不想在安装过程中使用 tmux，使用 `inst.notmux` 选项。输出在没有终端控制字符的情况下生成，用于非互动性。 						

- inst.remotelog=

  ​								您可以使用 `inst.remotelog=` 选项通过 TCP 连接将所有日志发送到远程 `host:port`。如果没有监听程序而安装正常进行，则该连接将会停用。 						

## C.5. 存储启动选项

- inst.nodmraid

  ​								使用 `inst.nodmraid` 选项禁用 `dmraid` 支持。 						

警告

​						请小心使用这个选项。如果您的磁盘被错误地识别为固件 RAID 阵列的一部分，那么您可能有一些过时的 RAID 元数据必须使用适当的工具删除，例如 `dmraid` 或 `wipefs`。 				

- inst.nompath

  ​								使用 `inst.nompath` 此选项禁用对多路径设备的支持。这个选项可用于遇到假正（false-positive）的系统中，这样会错误地将普通块设备识别为多路径设备。其他情况都不需要使用这个选项。 						

警告

​						请小心使用这个选项。您不应该在多路径硬件中使用这个选项。使用这个选项试图安装到多路径的单一路径不被支持。 				

- inst.gpt

  ​								`inst.gpt` 引导选项强制安装程序在 GUID  分区表（GPT）而不是主引导记录（MBR）中安装分区信息。这个选项在基于 UEFI 的系统上无效，除非采用与 BIOS 兼容的模式。通常，基于  BIOS 的系统和基于 UEFI 的系统在兼容模式下尝试使用 MBR 模式来存储分区信息，除非磁盘大小为 2^32 个扇区或大于 2  个扇区。磁盘扇区大小通常是 512 字节，通常相当于 2 TiB。使用 `inst.gpt` 引导选项可更改此行为，允许将 GPT 写入较小的磁盘。 						

## C.6. 弃用的引导选项

​					本节包含已弃用的引导选项的信息。安装程序仍然可以接受这些选项，但它们已被弃用，并计划在以后的 Red Hat Enterprise Linux 版本中删除。 			

- method

  ​								该 `method` 选项是一个 `inst.repo` 的别名。 						

- dns

  ​								使用 `nameserver` 而不是使用 `dns`。请注意，名称服务器不接受用逗号分开的列表 ; 使用多个名称服务器选项。 						

- netmask, gateway, hostname

  ​								`netmask`、`gateway` 和 `hostname` 选择作为 `ip` 选项的一部分提供。 						

- ip=bootif

  ​								自动使用由 PXE 提供的 `BOOTIF` 选项，因此无需使用 `ip=bootif`。 						

- ksdevice

  **表 C.8. ksdevice 引导选项的值**Value信息  											不存在 										 										   											不适用 										 										   											`ksdevice=link` 										 										   											忽略，这个选项与默认行为相同 										 										   											`ksdevice=bootif` 										 										   											如果 `BOOTIF=` 存在会忽略，这个选项是默认的 										 										   											`ksdevice=ibft` 										 										   											使用 `ip=ibft` 替换。查看 `ip` 										 										   											`ksdevice=<MAC>` 										 										   											替换为 `BOOTIF=${MAC/:/-}` 										 										   											`ksdevice=<DEV>` 										 										   											替换为 `bootdev` 										 										 

## C.7. 删除引导选项

​					这部分包含从 Red Hat Enterprise Linux 中删除的引导选项。 			

注意

​						`dracut` 提供高级引导选项。有关 `dracut` 详情请参考 `dracut.cmdline(7)` man page。 				

- askmethod, asknetwork

  ​								`initramfs` 完全非交互式，因此删除了 `asknetwork` 选项 `askmethod` 和选项。反之，请使用 `inst.repo` 或者指定适当的网络选项。 						

- blacklist, nofirewire

  ​								该 `modprobe` 选项处理阻止将内核模块列入清单的操作,使用 `modprobe.blacklist=<mod1>,<mod2>`。您可以使用 `modprobe.blacklist=firewire_ohci` 来阻止 firewire 模块。 						

- inst.headless=

  ​								`headless=` 指定要安装的系统没有任何显示硬件，且安装程序不需要查找任何显示硬件。 						

- inst.decorated

  ​								该 `inst.decorated` 选项用于在解码窗口中指定图形安装。默认情况下，这个窗口是不分离的，所以它没有标题栏，改变控制大小等等。这个选项已不再需要。 						

- repo=nfsiso

  ​								使用 `inst.repo=nfs:` 选项。 						

- serial

  ​								使用 `console=ttyS0` 选项。 						

- updates

  ​								使用 `inst.updates` 选项。 						

- essid, wepkey, wpakey

  ​								Dracut 不支持无线网络。 						

- ethtool

  ​								这个选项已不再需要。 						

- gdb

  ​								这个选项已被删除，因为有很多可用来调试基于 dracut 的选项 `initramfs`。 						

- inst.mediacheck

  ​								使用 `dracut option rd.live.check` 选项。 						

- ks=floppy

  ​								使用 `inst.ks=hd:<device>` 选项。 						

- 显示

  ​								对于 UI 的远程显示，使用 `inst.vnc` 选项。 						

- utf8

  ​								因为默认的 TERM 设置的行为如预期，所以不再需要这个选项。 						

- noipv6

  ​								IPv6 是内置在内核中，不能被安装程序删除。您可以使用 `ipv6.disable=1` 禁用 ipv6。安装的系统将使用这个设置。 						

- upgradeany

  ​								因为安装程序不再处理升级，所以不再需要这个选项。 						

## 附录 D. 更改订阅服务

​				要管理订阅，您可以在 Red Hat Subscription Management Server 或者 Red Hat  Satellite Server 中注册 RHEL  系统。如果需要，可以稍后更改订阅服务。要更改注册您的订阅服务,请从当前服务中取消注册系统,然后使用新服务注册它。 		

​				本节介绍了如何从 Red Hat Subscription Management Server 和 Red Hat Satellite Server 中取消注册 RHEL 系统。 		

**先决条件**

​					使用以下方法注册了您的系统：它包括以下之 一 : 			

- ​						Red Hat Subscription Management Server 				
- ​						Red Hat Satellite Server 				

注意

​					要接收系统更新,请使用其中任何一个管理服务器注册您的系统。 			

## D.1. 从 Subscription Management Server 中取消注册。

​					本节介绍如何使用命令行和 Subscription Manager 用户界面从 Red Hat Subscription Management Server 取消注册 RHEL 系统。 			

### D.1.1. 使用命令行取消注册

​						使用 `unregister` 命令从 Red Hat Subscription Management Server 取消注册 RHEL 系统。 				

**流程**

1. ​								作为 root 用户运行 unregister 命令，无需任何附加参数。 						

   ```
   # subscription-manager unregister
   ```

2. ​								提示时请提供 root 密码。 						

​						在 Subscription Management Server 中取消注册该系统，状态会显示"系统当前没有注册"信息，且Register 按钮可用。 				

注意

​							要继续不受中断的服务,请使用其中任何一个管理服务重新注册系统。如果您没有将系统注册到管理服务,您可能无法接收系统更新。有关注册系统的更多信息,请参阅 [使用命令行注册您的系统](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/post-installation-tasks_installing-rhel#subman-rhel8-setup_post-installation-tasks) 					

​						有关红帽订阅管理服务器的详情，请查看[*使用和配置 Red Hat Subscription Manager*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index/) 文档。 				

### D.1.2. 使用 Subscription Manager 用户界面取消注册

​						本节介绍如何使用 Subscription Manager 用户界面从 Red Hat Subscription Management Server 中取消注册 RHEL 系统。 				

**流程**

1. ​								登录到您的系统。 						

2. ​								从窗口的左上方点击 **Activities**。 						

3. ​								在菜单选项中点**显示应用程序**图标。 						

4. ​								点 **Red Hat Subscription Manager** 图标，或使用 **Red Hat Subscription Manager** 进行搜索。 						

5. ​								在 **Authentication Required** 对话框中输入管理员密码。**Subscriptions** 窗口会出现并显示 Subscription、系统目的和已安装产品的当前状态。未注册的产品会显示红色 X。 						

   注意

   ​									在系统上执行特权任务需要身份验证。 							

6. ​								点 Unregister 按钮。 						

​						在 Subscription Management Server 中取消注册该系统，状态会显示"系统当前没有注册"信息，且Register 按钮可用。 				

注意

​							要继续不受中断的服务,请使用其中任何一个管理服务重新注册系统。如果您没有将系统注册到管理服务,您可能无法接收系统更新。如需有关注册系统的更多信息，请参阅[使用 Subscription Manager 用户界面注册您的系统](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/post-installation-tasks_installing-rhel#subscription-manager-post-install-ui_post-installation-tasks) 					

​						有关红帽订阅管理服务器的详情，请查看[*使用和配置 Red Hat Subscription Manager*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index/) 文档。 				

## D.2. 在 Satellite 服务器中取消注册

​					要从 Satellite 服务器中取消 Red Hat Enterprise Linux 系统注册，从 Satellite 服务器中删除该系统。 			

​					如需更多信息，请参阅 Satellite Server 文档中的 *管理主机* 指南中的 [从 Red Hat Satellite 中删除主机](https://access.redhat.com/documentation/en-us/red_hat_satellite/6.6/html/managing_hosts/index)部分。 			

## 附录 E. 安装程序中的 iSCSI 磁盘

​				Red Hat Enterprise Linux 安装程序可以通过两种方式发现并登录 iSCSI 磁盘： 		

- ​						当安装程序启动时,它会检查系统的 BIOS 或附加引导 ROM 是否支持 iSCSI 引导固件表(iBFT)。这是可以从 iSCSI 引导系统的 BIOS 扩展。如果 BIOS 支持 iBFT,安装程序会从 BIOS 读取配置的引导磁盘的 iSCSI  目标信息,并登录到这个目标,并使其可作为安装目标使用。 				

  重要

  ​							要自动连接到 iSCSI 目标,请激活网络设备访问该目标。要做到这一点,使用 `ip=ibft` 引导选项。如需更多信息，请参阅 [网络引导选项](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index?lb_target=production#network-boot-options_kickstart-and-advanced-boot-options)。 					

- ​						您可以在安装程序的图形用户界面中手动发现并添加 iSCSI 目标。如需更多信息，请参阅 [配置存储设备](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/graphical-installation_graphical-installation#storage-devices_graphical-installation)。 				

  重要

  ​							您不能将 `/boot` 分区放在您使用这个方法手动添加的 iSCSI 目标 - 必须配置包含 `/boot` 分区的 iSCSI 目标用于 iBFT。但是,当安装的系统使用由固件 iBFT 以外的方法提供的 iBFT 配置（例如使用 iPXE）引导时,您可以使用 `inst.nonibftiscsiboot` 安装程序引导选项删除 `/boot` 分区限制。 					

​				虽然安装程序使用 `iscsiadm` 查找并登录 iSCSI 目标,但 `iscsiadm` 会自动将有关目标的任何信息保存在 `iscsiadm` iSCSI 数据库中。然后安装程序将这个数据库复制到安装的系统,并标记所有不是用于 root 分区的 iSCSI  目标,以便系统在启动时自动登录到它们。如果 root 分区放在 iSCSI 目标上,则进入这个目标的 initrd  日志不会在启动脚本中包含这个目标,以避免多次尝试登录同一目标。 		

## 第 42 章 使用 UEFI 安全引导 beta 系统

​				本章介绍了在启用了 UEFI 安全引导的系统中引导 Red Hat Enterprise Linux Beta 发行版本的步骤。 		

## 42.1. UEFI 安全引导和 RHEL Beta 发行版本

​					UEFI 安全引导要求操作系统内核使用一个可识别的私钥签名。然后,UEFI 安全引导使用对应的公钥验证签名。 			

​					对于 Red Hat Enterprise Linux Beta 发行版本,内核使用特定于 Red Hat Beta  的私钥签名。UEFI 安全引导尝试使用对应的公钥验证签名,但因为硬件不识别 Beta 私钥,Red Hat Enterprise Linux  Beta 发行系统无法引导。因此,要在 Beta 发行版本中使用 UEFI 安全引导,请使用 Machine Owner Key(MOK)功能将 Red Hat Beta 公钥添加到系统中。 			

## 42.2. 为 UEFI 安全引导添加 Beta 公钥

​					这部分包含如何为 UEFI 安全引导添加 Red Hat Enterprise Linux Beta 公钥的信息。 			

**先决条件**

- ​							在系统上禁用 UEFI 安全引导。 					
- ​							安装 Red Hat Enterprise Linux Beta 发行版本,即使系统重启后仍禁用安全引导机制。 					
- ​							您已登录到该系统, **Initial Setup** 窗口中的任务已完成。 					

**流程**

1. ​							在系统的 Machine Owner Key(MOK)列表中开始注册 Red Hat Beta 公钥： 					

   ```
   # kr=$(uname -r)
   # mokutil --import /usr/share/doc/kernel-keys/${kr%}/kernel-signing-ca.cer
   ```

   ​							${KR%} 替换为字符串 - 例如 **4.18.0-80.el8.x86_64**。 					

2. ​							提示时输入密码。 					

3. ​							重启系统并按任意密钥继续启动。在系统启动过程中启动 Shim UEFI 密钥管理工具。 					

4. ​							选择 **Enroll MOK**。 					

5. ​							选择 **Continue**。 					

6. ​							选择 **Yes** 并输入密码。密钥导入到系统的固件中。 					

7. ​							**选择 Reboot**。 					

8. ​							在系统中启用安全引导。 					

## 42.3. 删除 Beta 公钥

​					如果您计划删除 Red Hat Enterprise Linux Beta 发行版本,并安装 Red Hat Enterprise Linux General Availability(GA)发行版本,或者不同的操作系统,请删除 Beta 公钥。 			

​					这个步骤描述了如何删除 Beta 公钥。 			

**流程**

1. ​							开始从系统的 Machine Owner Key(MOK)列表中删除 Red Hat Beta 公钥： 					

   ```
   # mokutil --reset
   ```

2. ​							提示时输入密码。 					

3. ​							重启系统并按任意密钥继续启动。在系统启动过程中启动 Shim UEFI 密钥管理工具。 					

4. ​							选择 **Reset MOK**。 					

5. ​							选择 **Continue**。 					

6. ​							选择 **Yes** 并输入您在第 2 步中指定的密码。密钥已从系统的固件中删除。 					

7. ​							**选择 Reboot**。 					

## 附录 F. 故障排除和错误报告工具和提示

​				以下部分中的故障排除信息在诊断安装过程开始时可能会有帮助。以下部分适用于所有支持的构架。但是，如果某个问题与某个具体构架有关，它会在本节的开头指定。 		

## F.1. Dracut

​					`Dracut` 这是一个在 Linux 操作系统引导过程中管理 `initramfs` 镜像的工具。`dracut` 紧急 shell 是一个互动模式,可在载入 `initramfs` 镜像时启动。您可以从 `dracut` 紧急 shell 运行基本的故障排除命令。如需更多信息,请参阅 `dracut` man page 中的 **故障排除** 部分。 			

## F.2. 使用安装日志文件

​					为了进行调试,安装程序会在位于 `/tmp` 目录中的文件中记录安装操作。这些日志文件在下表中列出。 			

**表 F.1. 安装过程中生成的日志文件**

| 日志文件                  | 内容                                                 |
| ------------------------- | ---------------------------------------------------- |
| `/tmp/anaconda.log`       | 常规消息。                                           |
| `/tmp/program.log`        | 在安装过程中运行的所有外部程序。                     |
| `/tmp/storage.log`        | 广泛的存储模块信息。                                 |
| `/tmp/packaging.log`      | yum 和 rpm 软件包安装信息。                          |
| `/tmp/dbus.log`           | 有关用于安装程序模块的 `dbus` 会话的信息。           |
| `/tmp/ifcfg.log`          | 有关网络脚本的信息。                                 |
| `/tmp/sensitive-info.log` | 不是其他日志的一部分但没有复制到安装系统的配置信息。 |
| `/tmp/syslog`             | 与硬件相关的系统信息。                               |

​					如果安装失败,则消息会被合并到 `/tmp/anaconda-tb-identifier` 中,其中标识符是一个随机字符串。安装成功后,这些文件将复制到 `/var/log/anaconda/` 目录中安装的系统。但是,如果安装失败,或者在引导安装系统时使用 `inst.nosave=all` 或 `inst.nosave=logs` 选项,这些日志只存在于安装程序的 RAM 磁盘中。这意味着日志不会被永久保存，并在系统关闭时丢失。要永久保存这些文件,将文件复制到网络中的另一个系统中,或者将其复制到挂载的存储设备中,比如 USB 闪存驱动器。 			

### F.2.1. 创建预安装日志文件

​						使用这个步骤设置 `inst.debug` 选项在安装过程开始前创建日志文件。例如，这些日志文件包含当前的存储配置。 				

**先决条件**

- ​								显示 Red Hat Enterprise Linux 引导菜单。 						

**流程**

1. ​								从引导菜单中选择 **Install Red Hat Enterprise Linux** 选项。 						

2. ​								在基于 BIOS 的系统中按 **Tab** 键，或使用 UEFI 的系统中的 **e** 键编辑所选引导选项。 						

3. ​								在选项中附加 `inst.debug`。例如： 						

   ```
   vmlinuz ... inst.debug
   ```

4. ​								按 **Enter** 键。在安装程序启动前,系统将预安装日志文件保存在 `/tmp/pre-anaconda-logs/` 目录中。 						

5. ​								要访问日志文件，请切换到控制台。 						

6. ​								进入 `/tmp/pre-anaconda-logs/` 目录： 						

   ```
   # cd /tmp/pre-anaconda-logs/
   ```

   **其它资源**

   - ​										有关引导选项的详情请参考 [附录 C, *引导选项参考*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#custom-boot-options_installing-RHEL)。 								
   - ​										有关如何切换控制台的详情,请参考。 [第 F.5 节 “安装过程中的控制台和日志记录”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#consoles-logging-during-install_troubleshooting-at-the-start-of-the-installation) 								

### F.2.2. 将安装日志文件传送到 USB 驱动器中

​						使用这个步骤将安装日志文件传送到 USB 驱动器中。 				

**先决条件**

- ​								在使用此步骤前备份 USB 驱动器中的所有数据。 						
- ​								已登录到 root 帐户，并可访问安装程序的临时文件系统。 						

**流程**

1. ​								按 **Ctrl** + **Alt** + **F2** 访问您要安装的系统的 shell 提示。 						

2. ​								将 USB 闪存驱动器连接到该系统并运行 `dmesg` 命令： 						

   ```
   # dmesg
   ```

   ​								此时会显示列出所有最新事件的日志。在这个日志的末尾会显示一组信息。例如： 						

   ```
   [ 170.171135] sd 5:0:0:0: [sdb] Attached SCSI removable disk
   ```

3. ​								注意连接设备的名称。在上例中,是 `sdb`。 						

4. ​								进入 `/mnt` 目录并创建一个作为 USB 驱动器挂载对象的新目录。本例使用 `usb` 名称： 						

   ```
   # mkdir usb
   ```

5. ​								将 USB 闪存驱动器挂载到新创建的目录中。在大多数情况下，您不想要挂载整个驱动器，而只需要挂载一个分区。不要使用 `sdb` 名称,使用您要将日志文件写入的分区名称。本例中使用了 `sdb1` 名称： 						

   ```
   # mount /dev/sdb1 /mnt/usb
   ```

6. ​								通过访问它并列出其内容验证您挂载了正确的设备和分区： 						

   ```
   # cd /mnt/usb
   ```

   ```
   # ls
   ```

7. ​								将日志文件复制到挂载的设备中。 						

   ```
   # cp /tmp/*log /mnt/usb
   ```

8. ​								卸载 USB 闪存驱动器。如果您收到一个目标忙碌的错误信息,请将工作目录改为在挂载之外（例如： /）。 						

   ```
   # umount /mnt/usb
   ```

### F.2.3. 通过网络传输安装日志文件

​						使用以下步骤通过网络传输安装日志文件。 				

**先决条件**

- ​								已登录到 root 帐户，并可访问安装程序的临时文件系统。 						

**流程**

1. ​								按 **Ctrl** + **Alt** + **F2** 访问您要安装的系统的 shell 提示。 						

2. ​								切换到日志文件所在的 `/tmp` 目录： 						

   ```
   # cd /tmp
   ```

3. ​								使用 `scp` 命令将日志文件复制到网络中的另一个系统中： 						

   ```
   # scp *log user@address:path
   ```

   1. ​										使用目标系统中的有效用户名替换 **user**,使用 **目标** 系统的地址或主机名 **替换** 为您要保存日志文件的目录的路径。例如： 如果您要在 IP 地址 192.168.0.122 系统中以 `john` 身份登录,并将日志文件放在该系统的 `/home/john/logs/` 目录中,使用以下命令： 								

      ```
      # scp *log john@192.168.0.122:/home/john/logs/
      ```

      ​										当首次连接到目标系统时,SSH 客户端要求您确认远程系统的指纹正确,并且您要继续： 								

      ```
      The authenticity of host '192.168.0.122 (192.168.0.122)' can't be established.
      ECDSA key fingerprint is a4:60:76:eb:b2:d0:aa:23:af:3d:59:5c:de:bb:c4:42.
      Are you sure you want to continue connecting (yes/no)?
      ```

   2. ​										输入 **yes** 并按 **Enter** 继续。提示时提供一个有效的密码。将文件传送到目标系统的指定目录。 								

## F.3. 使用 Memtest86 应用程序检测内存故障

​					内存(RAM)模块中的错误可能会导致您的系统无法预计失败。在某些情况下,内存错误只可能导致带有特定软件组合的错误。因此，应该在安装 Red Hat Enterprise Linux 前测试您的系统内存。 			

注意

​						Red Hat Enterprise Linux 只包含用于 BIOS 系统的 `Memtest86+` 内存测试程序。目前不支持 UEFI 系统。 				

### F.3.1. 运行 Memtest86

​						在安装 Red Hat Enterprise Linux 前,运行 `Memtest86` 应用程序测试您的系统是否有内存问题。 				

**先决条件**

- ​								您已进入 Red Hat Enterprise Linux 引导菜单。 						

**流程**

1. ​								在 Red Hat Enterprise Linux 引导菜单中选择 **Troubleshooting > Run a memory test**。显示 `Memtest86` 应用程序窗口并立即开始测试。默认情况下, `Memtest86` 会在每次通过中执行十次测试。第一次通过完成后，会在窗口的下部显示一条信息，告知您当前状态。另一个通过会自动启动。 						

   ​								如果 `Memtest86+`  检测到错误,则错误会在窗口的中央窗格中显示,并用红色突出显示。消息包含详细信息,比如测试检测到问题、失败的内存位置等。在大多数情况下,所有 10 个测试的单个成功传递足以验证您的 RAM  是否良好。然而,在个别情况下,第一次通过时无法检测到的错误可能会出现在后续的通过中。要在重要系统中执行彻底测试,请在一夜内运行测试,或片段内完成多个通过。 						

   注意

   ​									完成单一完全传递 `Memtest86+` 所需的时间因您的系统配置而异,特别是 RAM 大小和速度。例如，在 2 GiB DDR2 内存 667 MHz 的系统中，单一通过需要 20 分钟完成。 							

2. ​								可选： 按照屏幕上的说明访问 **Configuration** 窗口并指定不同的配置。 						

3. ​								要停止测试并重新引导计算机， 按 **Esc** 键。 						

**其它资源**

- ​								有关使用 `Memtest86` 的更多信息,请参阅官方网站 http://www.memtest.org/。 						

## F.4. 校验引导介质

​					验证 ISO 镜像有助于避免在安装过程中遇到的问题。这些源包括保存在硬盘或者 NFS 服务器中的 DVD 和 ISO 镜像。在使用这个步骤安装 Red Hat Enterprise Linux 前，请先测试基于 ISO 安装源的完整性。 			

**先决条件**

- ​							您已进入 Red Hat Enterprise Linux 引导菜单。 					

**流程**

1. ​							在引导菜单中选择 **Test this media & install Red Hat Enterprise Linux 8.1** 来测试引导介质。 					
2. ​							引导过程会测试该介质，并高亮显示任何存在的问题。 					
3. ​							可选： 您可以通过在引导命令行中添加 `rd.live.check` 来启动验证过程。 					

## F.5. 安装过程中的控制台和日志记录

​					在主界面外，Red Hat Enterprise Linux 安装程序使用 **tmux** 终端显示和控制几个窗口。每个窗口都有不同的目的，它们会显示几个不同的日志，可用于在安装过程中排除问题。其中一个窗口提供带有 `root` 权限的互动 shell 提示符，除非使用引导选项或者 Kickstart 命令特别禁用了这个提示符。 			

注意

​						一般来说，除非需要诊断安装问题，不需要离开默认的图形安装环境。 				

​					终端多路器在虚拟控制台 1 中运行。要从实际安装环境切换到 **tmux**，按**Ctrl**+**Alt**+**F1**。要回到在虚拟控制台 6 中运行的主安装界面，按 **Ctrl**+**Alt**+**F6**。 			

注意

​						如果选择文本模式安装，会在虚拟控制台 1（**tmux**）中启动，切换到控制台 6 将打开 shell 提示符而不是图形界面。 				

​					运行 **tmux** 的控制台有五个可用的窗口; 下表中描述了它们的内容以及键盘快捷键。请注意，键盘快捷键有两个部分：首先按 **Ctrl**+**b** 键，然后释放这两个键，再按您想要使用的窗口的数字键。 			

​					您还可以使用 **Ctrl**+**b** **n**、**Alt+** **Tab** 和 **Ctrl**+**b** **p** 切换到下一个或前一个 **tmux** 窗口。 			

**表 F.2. 可用的 tmux 窗口**

| 快捷键               | 内容                                                         |
| -------------------- | ------------------------------------------------------------ |
| **Ctrl**+**b** **1** | 安装程序主窗口。包含基于文本的提示（在文本模式安装或者使用 VNC 直接模式时），以及一些调试信息。 |
| **Ctrl**+**b** **2** | 有 `root` 权限的互动 shell 提示符。                          |
| **Ctrl**+**b** **3** | 安装日志; 显示信息保存在 `/tmp/anaconda.log`。               |
| **Ctrl**+**b** **4** | 存储日志; 显示与存储设备和配置相关的消息，保存在 `/tmp/storage.log`。 |
| **Ctrl**+**b** **5** | 程序日志; 显示安装过程中执行的实用程序的信息并保存在 `/tmp/program.log`。 |

## F.6. 保存屏幕截屏

​					您可以在图形安装的任意时刻按 **Shift**+**Print Screen** 键对当前屏幕进行截屏。截屏保存到 `/tmp/anaconda-screenshots`。 			

## F.7. 显示设置和设备驱动程序

​					有些显示卡会在引导到 Red Hat Enterprise Linux  图形化安装程序时遇到问题。如果安装程序没有使用默认设置运行，它会尝试在较低分辨率模式中运行。如果失败,安装程序会尝试在文本模式中运行。有几个可能的解决方案可以解决显示问题,其中大多数涉及指定自定义引导选项。如需更多信息,请参阅 [第 C.3 节 “控制台引导选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#console-environment-and-display-boot-options_custom-boot-options)。 			

**表 F.3. 解决方案**

| 解决方案               | 描述                                                         |
| ---------------------- | ------------------------------------------------------------ |
| 使用基本的图形模式     | 您可以尝试使用基本图形驱动程序执行安装。要做到这一点，在引导菜单中选 **Troubleshooting > Install Red Hat Enterprise Linux 8.1 in basic graphics mode**，或者编辑安装程序的引导选项，并在命令行的最后附加 **inst.xdriver=vesa**。 |
| 手动指定显示分辨率     | 如果安装程序无法检测到屏幕分辨率,您可以覆盖自动检测并手动指定它。要做到这一点,请在引导菜单中附加 **inst.resolution=x** 选项,其中 x 是您的显示分辨率,例如： 1024x768。 |
| 使用另一个视频驱动程序 | 您可以尝试指定自定义视频驱动程序,覆盖安装程序的自动检测。要指定驱动程序，使用 **inst.xdriver=x** 选项，其中 x 是您要使用的设备驱动程序（例如： nouveau）*。 |
| 使用 VNC 执行安装      | 如果以上选项失败,您可以使用单独的系统通过网络访问图形安装,使用虚拟网络计算(VNC)协议。有关使用 VNC 安装的详情，请查看*执行高级 RHEL 安装*中的[*使用 VNC 执行远程 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#performing-a-remote-installation-using-vnc_installing-rhel-as-an-experienced-user) 部分。 |

​					* 如果指定自定义视频驱动程序解决了您的问题,您应该在 `anaconda` 组件的 https://bugzilla.redhat.com [中](https://bugzilla.redhat.com) 作为程序错误报告。安装程序应该能够自动检测您的硬件,并在不受干预的情况下使用适当的驱动程序。 			

## F.8. 向红帽客户支持报告错误信息

​					如果图形安装遇到错误,它会显示 **未知错误对话框**。您可以向红帽客户支持发送有关错误的信息。要发送报告,您必须输入您的客户门户网站凭证。如果您没有客户门户网站帐户，请通过 https://www.redhat.com/wapps/ugc/register.html 注册。自动错误报告需要一个网络连接。 			

**先决条件**

​						图形安装程序遇到错误并显示 **未知错误对话框**。 				

**流程**

1. ​							在 **未知错误** 对话框中点击 Report Bug 报告问题,或点击 Quit 退出安装。 					
   1. ​									（可选）点击 More Info… 显示可能有助于确定错误原因的详细输出。如果您熟悉调试,点 Debug。这会显示虚拟终端 `tty1`,您可以在其中请求更多信息。要从 `tty1` 返回图形界面,使用 `continue` 命令。 							
2. ​							点 Report a bug to Red Hat Customer Support。 					
3. ​							**Red Hat Customer Support - Reporting Configuration** 对话框被显示。在 **Basic** 标签页中输入您的客户门户网站用户名和密码。如果您的网络设置需要您使用 HTTP 或 HTTPS 代理，可以选择 **高级**标签页并输入代理服务器的地址来配置该代理服务器。 					
4. ​							完成所有字段并点击 OK。 					
5. ​							此时会显示一个文本框。解释在显示 **未知错误** 对话框前采取的每个步骤。 					
6. ​							从 **How reproducible is this problem** 下拉菜单中选择一个选项，并在文本框中提供额外的信息。 					
7. ​							点 Forward。 					
8. ​							验证您提供的所有信息是否位于↑ 标签页 **中**。其他标签页包括的信息,如系统的主机名以及安装环境的其他详情。您可以删除您不想向红帽发送的任何信息,但请注意,提供的详细信息可能会影响对问题的调查。 					
9. ​							当完成查看所有标签页后,点 **Forward**。 					
10. ​							对话框显示发送到红帽的所有文件。清除您不想发送到红帽的文件旁的复选框。要添加一个文件，请点击**附加一个文件**。 					
11. ​							选择 **我已经过检查数据的复选框并同意提交数据。** 					
12. ​							点击 Forward 将报告及附件发送到红帽。 					
13. ​							点击 Show log 查看报告过程的详情,或者点击 Close 返回到 **未知错误对话框**。 					
14. ​							点击 Quit 退出安装。 					

## 附录 G. 故障排除

​				以下部分中的故障排除信息在安装后诊断可能会有帮助。以下部分适用于所有支持的构架。但是，如果某个问题与某个具体构架有关，它会在本节的开头指定。 		

## G.1. 恢复被中断的下载

​					您可以使用 `curl` 命令恢复中断的下载。 			

**先决条件**

- ​							您已进入红帽客户门户网站的 **产品下载** 部分 https://access.redhat.com/downloads, [并](https://access.redhat.com/downloads) 选择了所需的变体、版本和架构。 					
- ​							您右键点击所需 ISO 文件，并选择 **Copy Link Location** 将 ISO 镜像文件的 URL 复制到您的剪贴板。 					

**流程**

1. ​							从新链接下载该 ISO 镜像。添加 `--continue-at -` 选项以自动恢复下载： 					

   ```
   $ curl --output directory-path/filename.iso 'new_copied_link_location' --continue-at -
   ```

2. ​							使用 **sha256sum** 等 checksum 程序在下载完成后验证镜像文件的完整性： 					

   ```
   $ sha256sum rhel-8.1-x86_64-dvd.iso
   			`85a...46c rhel-8.1-x86_64-dvd.iso`
   ```

   ​							将输出与 Red Hat Enterprise Linux **产品下载**网页中提供的 checksum 进行比较。 					

**例 G.1. 恢复被中断的下载**

​						以下是部分下载的 ISO 镜像的 `curl` 命令示例： 				

```
$ curl --output _rhel-8.1-x86_64-dvd.iso 'https://access.cdn.redhat.com//content/origin/files/sha256/85/85a...46c/rhel-8.1-x86_64-dvd.iso?_auth=141...963' --continue-at -
```

## G.2. 未检测到磁盘

​					如果安装程序无法找到可写入的存储设备安装到,它会在 **Installation Destination** 窗口中返回以下出错信息： **No disks detected to。请关闭计算机,至少连接一个磁盘并重启以便完成安装。** 			

​					检查以下项： 			

- ​							您的系统至少附加了一个存储设备。 					
- ​							如果您的系统使用硬件 RAID 控制器 ; 验证控制器是否已正确配置并按预期工作。具体步骤请查看控制器的文档。 					
- ​							如果您要安装到一个或多个 iSCSI 设备中,且系统中没有本地存储,请确定在适当的主机总线适配器(HBA)中显示所有必需的 LUN。 					

​					如果在重启系统并启动安装过程后仍然显示错误信息,安装程序将无法检测到存储。在很多情况下,错误消息是试图在安装程序无法识别的 iSCSI 设备中安装的结果。 			

​					在这种情况下，您必须在开始安装前执行驱动程序更新。查看您的硬件厂商的网站来确定是否有可用的驱动程序更新。有关驱动程序更新的常规信息，请查看 *执行高级 RHEL 安装*文档中的 [*在安装期间更新驱动*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#updating-drivers-during-installation_installing-rhel-as-an-experienced-user) 部分。 			

​					您还可以参考红帽硬件兼容性列表,地址为 https://access.redhat.com/ecosystem/search/#/category/Server。 			

## G.3. 无法使用 RAID 卡引导

​					如果在安装后无法引导系统,可能需要重新安装并重新分区系统存储。某些 BIOS 类型不支持从 RAID 卡引导。在完成安装并第一次重启系统后,基于文本的屏幕会显示引导装载程序提示（例如 `grub>`）并显示闪动的光标。如果情况如此,您必须重新对系统进行分区,并将 `/boot` 分区和引导装载程序移到 RAID 阵列之外。`/boot` 分区和引导装载程序必须位于同一个驱动器中。完成这些更改后，应该可以完成安装并正确引导系统。 			

## G.4. 图形引导序列没有响应

​					 安装后第一次重启您的系统时,该系统在图形引导序列中可能是无响应的。如果出现这种情况，则需要对系统进行重置。在这种情况下,引导装载程序菜单会被成功显示,但选择任何条目并尝试引导系统会导致停止。这通常表示图形化引导序列有问题。要解决这个问题,您必须在引导时临时更改设置来禁用图形引导,然后再永久更改它。 			

**步骤： 禁用图形化引导**

1. ​							启动您的系统并等到引导装载程序菜单被显示为止。如果您将引导超时周期设置为 `0`, **按 Esc 键** 访问它。 					
2. ​							在引导装载程序菜单中，选择想要引导的条目。在基于 BIOS 的系统中按 **Tab** 键，或者使用 UEFI 的系统中的 **e** 键编辑所选输入选项。 					
3. ​							在选项列表中找到内核行 - 也就是说,以关键字 **linux** 开头的行。在这个行中,找到并删除 `rhgb`。 					
4. ​							按 **F10** 或者 **Ctrl**+**X** 使用编辑选项引导您的系统。 					

​					如果系统成功启动，您可以正常登录。然而，如果没有永久禁用图形引导，则必须在每次系统引导时都执行这个步骤。 			

**过程： 永久禁用图形引导**

1. ​							登录到您系统中的 root 帐户。 					

2. ​							使用 grubby 工具来查找默认的 GRUB2 内核： 					

   ```
   # grubby --default-kernel
   /boot/vmlinuz-4.18.0-94.el8.x86_64
   ```

3. ​							使用 grubby 工具从 GRUB2 配置的默认内核中删除 `rhgb` 引导选项。例如： 					

   ```
   # grubby --remove-args="rhgb" --update-kernel /boot/vmlinuz-4.18.0-94.el8.x86_64
   ```

4. ​							重启系统。不再使用图形化引导序列。如果要启用图形引导序列,请按照相同的步骤使用 `--args="rhgb"` 参数替换 `--remove-args="rhgb"` 参数。这可将 `rhgb` 引导选项恢复到您的 GRUB2 配置中的默认内核。 					

## G.5. X 服务器在登录后失败

​					X 服务器是在 X 窗口系统中运行的程序,它在本地机器上运行,即用户直接使用的计算机。X  服务器处理所有对图形卡的访问、显示屏幕和输入设备,通常是这些计算机上的键盘和鼠标。X 窗口系统通常被称为  X,它是一个完整、跨平台和免费的客户端服务器系统,用于在单一计算机和计算机网络中管理  GUI。客户端服务器模型是一个架构,它将工作分成两个独立但连接的应用程序（称为客户端和服务器）。* 			

​					如果 X 服务器在登录后崩溃,一个或多个文件系统可能已满。要排除这个问题,请执行以下命令： 			

```
$ df -h
```

​					检查哪个分区已满的输出 - 在大多数情况下,问题位于 `/home` 分区中。以下是 `df` 命令的输出示例： 			

```
Filesystem                                  Size  Used Avail Use% Mounted on
devtmpfs                                    396M     0  396M   0%  /dev
tmpfs                                       411M     0  411M   0%  /dev/shm
tmpfs                                       411M  6.7M  405M   2%  /run
tmpfs                                       411M     0  411M   0%  /sys/fs/cgroup
/dev/mapper/rhel-root                       17G    4.1G  13G   25% /
/dev/sda1                                   1014M  173M 842M  17% /boot
tmpfs                                       83M    20K   83M   1%  /run/user/42
tmpfs                                       83M    84K  83M    1%  /run/user/1000
/dev/dm-4                                   90G    90G    0  100% /home
```

​					在这个示例中,您可以看到 `/home` 分区已满,从而导致失败。删除所有不需要的文件。释放了一些磁盘空间后,使用 `startx` 命令启动 X。有关 `df` 的详情,以及可用选项的说明,如本例中使用的 `-h` 选项,请查看 `df(1)` man page。 			

​					*source: http://www.linfo.org/x_server.html 			

## G.6. RAM 未识别

​					在某些情况下,内核无法识别所有内存(RAM),这会导致系统使用的内存少于安装的内存。您可以使用免费 `-m` 命令找出所使用的 RAM 量。如果内存总量与您的预期不匹配,则至少有一个内存模块有问题。在基于 BIOS 的系统中,您可以使用 `Memtest86+` 工具测试您的系统内存。 			

​					有些硬件配置保留了系统 RAM 的一部分,因此系统无法使用它。一些集成图形卡的笔记本电脑为 GPU 保留一部分内存。例如,带有 4  GiB RAM 的笔记本电脑和集成的 Intel 图形卡显示大约 3.7 GiB 可用内存。另外,在大多数 Red Hat Enterprise Linux 系统上默认启用 kdump 崩溃内核转储机制,在主内核失败时为二级内核保留一些内存。使用空闲命令时,这个保留内存不会显示。 			

**步骤： 手动配置内存**

​						使用 `mem=` 内核选项手动设置内存量。 				

1. ​							启动您的系统并等到引导装载程序菜单被显示为止。如果将引导超时时间设定为 **0**，按 **Esc** 键访问它。 					

2. ​							在引导装载程序菜单中,使用您的光标键突出显示您要引导的条目,然后在基于 BIOS 的系统 **中按 Tab 键**,或使用 UEFI 的系统中的 **e** 键编辑所选输入选项。 					

3. ​							在选项列表中找到内核行 - 也就是说,以关键字 **linux** 开头的行。在该行末尾附加以下选项： 					

   ```
   mem=xxM
   ```

4. ​							将 **xx** 替换成您使用 MiB 的 RAM 数量。 					

5. ​							按 **F10** 或者 **Ctrl**+**X** 使用编辑选项引导您的系统。 					

6. ​							等待系统引导，然后登录。 					

7. ​							打开命令行并再次执行免费 `-m` 命令。如果命令显示的 RAM 总量符合您的预期,请将以下内容附加到 `/etc/default/grub` 文件中以 `GRUB_CMDLINE_LINUX` 开始的行中,使更改持久化： 					

   ```
   # grub2-mkconfig --output=/boot/grub2/grub.cfg
   ```

## G.7. 系统显示信号 11 错误

​					信号 11 错误通常被称为 segmentation 错误,意味着程序可以访问没有被分配的内存位置。信号 11  错误可能是因为安装的软件程序错误或者硬件出现故障造成的。如果您在安装过程中收到信号 11  错误,请确定您使用最新的安装镜像并提示安装程序验证它们是否被破坏。如需更多信息,请参阅 [第 F.4 节 “校验引导介质”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#verifying-boot-media_troubleshooting-at-the-start-of-the-installation)。 			

​					导致信号 11 错误的常见原因是安装介质有问题（比如光盘有损害）。建议在每次安装前校验安装介质的完整性。有关获取最新安装介质的详情请参考 [第 3 章 *下载 RHEL 安装 ISO 镜像*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 			

​					要在安装开始前执行介质检查,请在引导菜单中附加 `rd.live.check` 引导选项。如果您在没有错误的情况下进行了介质检查,并且仍存在 segmentation 错误,这通常表示您的系统遇到硬件错误。在这种情况下,这个问题最有可能在系统的内存(RAM)中。即使您之前在同一计算机上使用了不同的操作系统,也可能会有问题。 			

注意

​						对于 AMD 和 Intel 64 位和 64 位 ARM 架构： 在基于 BIOS 的系统上,您可以使用安装介质中的 `Memtest86+` 内存测试模块对系统内存进行彻底测试。如需更多信息,请参阅 [第 F.3 节 “使用 Memtest86 应用程序检测内存故障”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#memtest86_troubleshooting-at-the-start-of-the-installation)。 				

​					其他可能的原因不在本文档讨论范围内。查看硬件厂商的文档，并参阅红帽硬件兼容性列表，地址为 https://access.redhat.com/ecosystem/search/#/category/Server。 			

## G.8. 无法从网络存储空间 IPL

注意

​						这个问题只针对于 IBM Power 系统。 				

​					如果您在从网络存储空间(*NWSSTG)中尝试 IPL 时遇到问题,这很可能是因为缺少 PReP 分区。在这种情况下,您必须重新安装系统并在分区阶段或在 Kickstart 文件中创建这个分区。 			

## G.9. 使用 XDMCP

​					有些情况下，您安装了 X 窗口系统并希望使用图形登录管理器登录到 Red Hat Enterprise Linux。使用此流程启用 X Display Manager Control Protocol(XDMCP),并从任何 X 兼容客户端（如网络连接的工作站或 X11  终端）远程登录到桌面环境中。 			

注意

​						Wayland 协议不支持 XDMCP。如需更多信息，请参阅[*在 RHEL 8 中使用桌面环境*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_the_desktop_environment_in_rhel_8/index)。 				

注意

​						这个问题适用于 IBM Z。 				

**流程**

1. ​							在文本编辑器（如 **vi** 或 **nano** ）中打开 `/etc/gdm/custom.conf` 配置文件。 					

2. ​							在 `custom.conf` 文件中,找到以 `[xdmcp]` 开始的部分。在这个部分，添加以下行： 					

   ```
   Enable=true
   ```

3. ​							保存文件并退出文本编辑器。 					

4. ​							重启 X 窗口系统。要做到这一点，您可以重启系统，也可以以根用户身份使用以下命令来重启 GNOME 显示管理器： 					

   ```
   # systemctl restart gdm.service
   ```

5. ​							等待登录提示并使用您的用户名和密码登录。X 窗口系统现在为 XDMCP 配置。您可以通过在客户工作站上的 X 命令启动远程 X 会话，从另一个工作站（客户端）连接它。例如： 					

   ```
   $ X :1 -query address
   ```

6. ​							使用远程 X11 服务器的主机名替换 `address`。该命令使用 XDMCP 连接到远程 X11 服务器,并显示 X11 服务器系统的远程图形登录屏幕（通常按 `Ctrl-Alt-F8`访问）。您还可以使用一个嵌套的 X11 服务器来访问远程桌面会话。它还在您当前的 X11 会话的一个窗口中打开远程桌面。您可以使用 Xnest 在本地 X11 会话中打开远程桌面。例如，使用以下命令运行 Xnest，用远程 X11 服务器的主机名替换地址： 					

   ```
   $ Xnest :1 -query address
   ```

   ​							有关 XDMCP 的详情，请参考 X 窗口系统文档，地址为 http://www.x.org/releases/X11R7.6/doc/libXdmcp/xdmcp.html。 					

## G.10. 使用救援（rescue）模式

​					安装程序救援模式是可从 Red Hat Enterprise Linux DVD 或者其它引导介质引导的最小 Linux 环境。它包含可用来解决各种问题的命令行工具。救援模式可以从引导菜单的 **Troubleshooting** 菜单进入。在这个模式中,您可以将文件系统挂载为只读,列入黑名单或者添加在驱动程序磁盘中提供的驱动、安装或升级系统软件包或者管理分区。 			

注意

​						安装程序的救援模式与救援模式（等同于单用户模式）和紧急模式不同,后者是 `systemd` 系统和服务管理器的一部分。 				

​					要引导至救援模式,您必须可以使用一个 Red Hat Enterprise Linux 引导介质引导系统，比如最小引导磁盘或者 USB 驱动器，或者完整安装 DVD。 			

重要

​						高级存储（如 iSCSI 或 zFCP 设备）必须使用 `dracut` 引导选项（如 `rd.zfcp=` 或 `root=iscsi:` *选项* ）,或者在 IBM Z 上的 CMS 配置文件中进行配置。在引导至救援模式后,无法以互动方式配置这些存储设备。有关 `dracut` 引导选项的详情请参考 `dracut.cmdline(7)` man page。 				

### G.10.1. 引导至救援模式

​						使用这个步骤引导至救援模式。 				

**流程**

1. ​								从最小引导介质或者完整安装 DVD 或者 USB 驱动器引导系统,并等待引导菜单被显示。 						

2. ​								在引导菜单中选择 **Troubleshooting** > **Rescue a Red Hat Enterprise Linux system** 选项,或者在引导命令行中添加 `inst.rescue` 选项。要进入引导命令行，在基于 BIOS 的系统中按 **Tab** 键；或在使用 UEFI 的系统中按 **e** 键。 						

3. ​								可选： 如果您的系统需要驱动程序磁盘中提供的第三方驱动程序才能引导,请将 `inst.dd=driver_name` 附加到引导命令行中： 						

   ```
   inst.rescue inst.dd=driver_name
   ```

4. ​								可选： 如果作为 Red Hat Enterprise Linux 发行本一部分的某个驱动程序阻止系统引导,请将 `modprobe.blacklist=` 选项附加到引导命令行中： 						

   ```
   inst.rescue modprobe.blacklist=driver_name
   ```

5. ​								按 **Enter** （基于 BIOS 的系统）或者 **Ctrl**+**X** （基于 UEFI 的系统）引导修改的选项。等待以下信息出现： 						

   ```
   The rescue environment will now attempt to find your Linux installation and mount it under the directory: /mnt/sysroot/. You can then make any changes required to your system. Choose 1 to proceed with this step. You can choose to mount your file systems read-only instead of read-write by choosing 2. If for some reason this process does not work choose 3 to skip directly to a shell.
   
   1) Continue
   2) Read-only mount
   3) Skip to shell
   4) Quit (Reboot)
   ```

   ​								如果您选择 **1**,安装程序会尝试将文件系统挂载到 `/mnt/sysroot/` 目录中。如果挂载分区失败，则会收到通知。如果您选择 **2**,它会尝试将文件系统挂载到 `/mnt/sysroot/` 目录中,但使用只读模式。如果选择 **3**，文件系统将不会被挂载。 						

   ​								对于系统 root,安装程序支持两个挂载点 `/mnt/sysimage` 和 `/mnt/sysroot`。`/mnt/sysroot` 路径用于挂载目标系统的 `/`。通常物理根和系统根是相同的,因此 `/mnt/sysroot` 会附加到与 `/mnt/sysimage` 相同的文件系统中。唯一例外是 rpm-ostree 系统,其中的系统根更改基于部署。然后, `/mnt/sysroot` 被附加到 `/mnt/sysimage` 的子目录中。建议您将 `/mnt/sysroot` 用于 chroot。 						

6. ​								选择 **1** 来继续。系统进入救援模式后，会在 VC（虚拟控制台）1 和 VC 2 中出现提示。使用 `Ctrl+Alt+F1` 密钥组合来访问 VC 1 和 `Ctrl+Alt+F2` 访问 VC 2: 						

   ```
   sh-4.2#
   ```

7. ​								即使挂载了文件系统,在救援模式下的默认 root 分区是一个临时 root 分区,而不是正常用户模式中使用的文件系统的 root 分区（`multi-user.target` 或者 `graphical.target`）。如果选择挂载文件系统并成功挂载它,您可以执行以下命令将救援模式环境的根分区改为文件系统的根分区： 						

   ```
   sh-4.2# chroot /mnt/sysroot
   ```

   ​								如果您需要运行需要将您的 root 分区挂载为 `/` 的命令,比如 `rpm`,这非常有用。要退出 chroot 环境，输入 **exit** 来返回提示符。 						

8. ​								如果您选择了 **3**,您仍然可以通过创建目录（如 `/directory/` ）并输入以下命令来手动在救援模式中挂载分区或者 LVM2 逻辑卷： 						

   ```
   sh-4.2# mount -t xfs /dev/mapper/VolGroup00-LogVol02 /directory
   ```

   ​								在以上命令中, `/directory/` 是您创建的目录, `/dev/mapper/VolGroup00-LogVol02` 是您要挂载的 LVM2 逻辑卷。如果分区类型不是 XFS，使用正确的类型（比如 ext4）替换 xfs 字符串。 						

9. ​								如果不知道所有物理分区的名称，使用以下命令列出它们： 						

   ```
   sh-4.2# fdisk -l
   ```

   ​								如果您不知道所有 LVM2 物理卷、卷组或者逻辑卷的名称,使用 `pvdisplay`、`vgdisplay` 或 `lvdisplay` 命令。 						

### G.10.2. 在救援模式中使用 SOS 报告

​						`sosreport` 命令行工具会收集配置和诊断信息,如运行的内核版本、载入的模块以及系统和服务配置文件。程序输出保存在 `/var/tmp/` 目录中的 tar 归档中。`sosreport` 工具可用于分析系统错误和故障排除。使用这个步骤捕获救援模式中的 `sosreport` 输出。 				

**先决条件**

- ​								引导至救援模式。 						
- ​								您已经以读写模式挂载安装的系统 `/ (root)` 分区。 						
- ​								已就您的问题单联系了红帽支持团队，并已获得了一个问题单号。 						

**流程**

1. ​								将根目录改为 `/mnt/sysroot/` 目录： 						

   ```
   sh-4.2# chroot /mnt/sysroot/
   ```

2. ​								执行 `sosreport` 使用系统配置和诊断信息生成存档： 						

   ```
   sh-4.2# sosreport
   ```

   重要

   ​									`sosreport` 提示您输入您的名称以及您从红帽支持收到的问题单号。只使用字母和数字，添加以下字符或空格可能会导致报告不可用： 							

   ​									`# % & { } \ < > > * ? / $ ~ ' " : @ + ` | =` 							

3. ​								可选： 如果想用网络把所生成的归档传输到一个新的位置，需要配置一个网络接口。在这种情况下，使用动态 IP  地址作为不需要其他步骤。但是，在使用静态寻址时，输入以下命令将 IP 地址（如 10.13.153.64/23）分配给网络接口，如 dev  eth0: 						

   ```
   bash-4.2# ip addr add 10.13.153.64/23 dev eth0
   ```

4. ​								退出 chroot 环境： 						

   ```
   sh-4.2# exit
   ```

5. ​								将所生成的存档保存在一个新位置以便进行访问： 						

   ```
   sh-4.2# cp /mnt/sysroot/var/tmp/sosreport new_location
   ```

6. ​								要通过网络传输归档,使用 `scp` 实用程序： 						

   ```
   sh-4.2# scp /mnt/sysroot/var/tmp/sosreport username@hostname:sosreport
   ```

   **其它资源**

   - ​										有关 sosreport 的常规信，请查看 [sosreport 是什么以及如何在 Red Hat Enterprise Linux 中创建？](https://access.redhat.com/solutions/3592) 								
   - ​										有关在救援模式中使用 sosreport 的详情，请参考 [如何在救援环境中生成 sosreport](https://access.redhat.com/solutions/2872)。 								
   - ​										有关将 sosreport 生成到 /tmp 以外的不同位置的信息，请参阅[如何把 sosreport 写入另一个位置？](https://access.redhat.com/solutions/1847)。 								
   - ​										有关手动收集 sosreport 的详情，请参考 [sosreport 失败。我应该提供什么数据？](https://access.redhat.com/solutions/68996) 								

### G.10.3. 重新安装 GRUB2 引导装载程序

​						在某些情况下，GRUB2 引导装载程序被错误地删除、损坏或者被其他操作系统替代。使用这个流程在使用 BIOS 的 AMD64 和  Intel 64 系统的主引导记录(MBR),或者在使用 Open Firmware 的 IBM Power Systems 的  little-endian 变体中重新安装 GRUB2。 				

**先决条件**

- ​								引导至救援模式。 						
- ​								您已经以读写模式挂载安装的系统 `/ (root)` 分区。 						
- ​								您已经以读写模式挂载 `/boot` 挂载点。 						

**流程**

1. ​								更改根分区： 						

   ```
   sh-4.2# chroot /mnt/sysroot/
   ```

2. ​								重新安装安装 `install_device` 块设备的 GRUB2 引导装载程序： 						

   ```
   sh-4.2# /sbin/grub2-install install_device
   ```

   重要

   ​									如果满足以下条件,运行 `grub2-install` 命令可能会导致机器不可引导： 							

   - ​											系统是一个 AMD64 或者 Intel 64,它带有可扩展固件界面(EFI)。 									
   - ​											启用了安全引导。 									

   ​									运行 `grub2-install` 命令后,您无法引导启用了可扩展固件接口(EFI)和安全引导的 AMD64 或者 Intel 64 系统。这是因为 `grub2-install` 命令安装了一个直接引导的未签名的 GRUB2 镜像,而不是使用 shim 应用程序。系统引导时, shim 应用程序会验证镜像签名,当未找到引导系统时该签名。 							

3. ​								重启系统。 						

### G.10.4. 使用 RPM 添加或删除驱动

​						缺少或者无法正常工作的驱动会在引导系统时出现问题。救援模式提供了一个环境,您可以在系统引导失败时添加或删除驱动程序。建议您尽可能使用 RPM 软件包管理器来删除发生故障的驱动，或添加已更新或丢失的驱动。使用以下步骤添加或删除驱动程序。 				

重要

​							当您从驱动程序磁盘安装驱动程序时,该驱动程序磁盘会更新系统中的所有 `initramfs` 镜像以使用这个驱动程序。如果驱动出现问题导致系统无法引导,您就无法依赖另一个 `initramfs` 镜像引导系统。 					

**步骤： 使用 RPM 添加驱动程序**

​							使用此流程添加驱动程序。 					

**先决条件**

- ​								引导至救援模式。 						

- ​								您已经以读写模式挂载安装系统。 						

  1. ​										可以使用包含驱动的软件包。例如：挂载 CD 或者 USB 闪存驱动器,并将 RPM 软件包复制到您选择的位置 `/mnt/sysroot/` 下,例如： `/mnt/sysroot/root/drivers/`。 								

  2. ​										将根目录改为 `/mnt/sysroot/`: 								

     ```
     sh-4.2# chroot /mnt/sysroot/
     ```

  3. ​										使用 `rpm -ivh` 命令安装驱动程序软件包。例如,运行以下命令从 `/root/drivers/` 安装 `xorg-x11-drv-wacom` 驱动程序软件包： 								

     ```
     sh-4.2# rpm -­ivh /root/drivers/xorg-x11-drv-wacom-0.23.0-6.el7.x86_64.rpm
     ```

     注意

     ​											这个 chroot 环境中的 `/root/drivers/` 目录是原始救援环境中的 `/mnt/sysroot/root/drivers/` 目录。 									

  4. ​										退出 chroot 环境： 								

     ```
     sh-4.2# exit
     ```

**步骤： 使用 RPM 移除驱动程序**

​							使用此流程删除驱动程序。 					

**先决条件**

- ​								引导至救援模式。 						

- ​								您已经以读写模式挂载安装系统。 						

  1. ​										将根目录改为 `/mnt/sysroot/` 目录： 								

     ```
     sh-4.2# chroot /mnt/sysroot/
     ```

  2. ​										使用 `rpm -e` 命令删除驱动程序软件包。例如,要删除 `xorg-x11-drv-wacom` 驱动程序软件包,请运行： 								

     ```
     sh-4.2# rpm -e xorg-x11-drv-wacom
     ```

  3. ​										退出 chroot 环境： 								

     ```
     sh-4.2# exit
     ```

     ​										如果由于某种原因无法删除有问题的驱动,可以将该驱动列入列表,使其不会在引导时加载。 								

  4. ​										当您完成添加和删除驱动程序后，重启该系统。 								

## G.11. ip= boot 选项返回一个错误

​					使用 `ip=` 引导选项格式 `ip=[ip address]` 例如： `ip=192.168.1.1` 返回错误消息 `Fatal for argument 'ip=[insert ip here]'\n sorry, unknown value [ip address] refusing to continue`。 			

​					在之前的 Red Hat Enterprise Linux 版本，引导选项的格式为： 			

```
--ip=192.168.1.15 --netmask=255.255.255.0 --gateway=192.168.1.254 --nameserver=192.168.1.250 --hostname=myhost1
```

​					然而，在 Red Hat Enterprise Linux 8 中，引导选项的格式是： 			

```
ip=192.168.1.15::192.168.1.254:255.255.255.0:myhost1::none: nameserver=192.168.1.250
```

​					要解决这个问题,使用格式： `ip=ip::gateway:netmask:hostname:interface:none`,其中： 			

- ​							`ip` 指定客户端的 ip 地址。您可以在方括号中指定 IPv6 地址,例如 `[2001:DB8::1]`。 					
- ​							`gateway` 是默认网关。IPv6 地址也被接受。 					
- ​							`netmask` 是要使用的子网掩码。这可以是完整子网掩码,如 255.255.255.0 或一个前缀,例如 `64`。 					
- ​							`hostname` 是客户端系统的主机名。这个参数是可选的。 					

​					如需更多信息,请参阅 [第 C.2 节 “网络引导选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#network-boot-options_custom-boot-options)。 			

## G.12. 在 iLO 或 iDRAC 设备中无法引导至图形安装

​					由于互联网连接缓慢,在 iLO 或 iDRAC 设备中远程 ISO 安装的图形安装程序可能无法使用。要在这种情况下进行安装,您可以选择以下方法之一： 			

1. ​							避免超时。要做到这一点： 					

   1. ​									如果使用 BIOS ,按 Tab 键, 或者在从安装介质引导时使用 UEFI 时使用 e 键。这将允许您修改内核命令行参数。 							

   2. ​									要继续安装,请附加 `rd.live.ram=1`,并在使用 BIOS 时按 Enter 键,如果使用 UEFI,则 按 Ctrl+x。 							

      ​									这可能需要较长时间载入安装程序。 							

2. ​							为图形安装程序延长加载时间的另一个选项是设置 `inst.xtimeout` 内核参数以秒为单位。 					

   ```
   inst.xtimeout=N
   ```

3. ​							您可以在文本模式中安装该系统。如需了解更多详细信息,请参阅 [在文本模式中安装 RHEL8](https://access.redhat.com/articles/4323781)。 					

4. ​							在远程管理控制台（如 iLO 或 iDRAC）而不是本地介质源中,使用来自红帽客户门户网站的 [下载中心](https://access.redhat.com/downloads) 的安装 ISO 文件的直接 URL。您必须登录才能访问此部分。 					

[         Red Hat Customer Portal     ](https://access.redhat





=============================================

## 安装



# 执行高级 RHEL 安装

Red Hat Enterprise Linux 8

## 使用 Kickstart 安装 Red Hat Enterprise Linux 8

Red Hat Customer Content Services

[法律通告](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#idm140200002959856)

**摘要**

​				本文档适用于想要使用 Kickstart 和配置高级安装选项执行高级 Red Hat Enterprise Linux 安装的用户。 		

------

# 使开源包含更多

​			红帽承诺替换我们的代码、文档和网页属性中存在问题的语言。我们从这四个术语开始： master、slave、blacklist 和 whitelist。这些更改将在即将发行的几个发行本中逐渐实施。如需了解更多详细信息，请参阅 [CTO Chris Wright 信息](https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language)。 	

# 对红帽文档提供反馈

​			我们感谢您对文档提供反馈信息。请让我们了解如何改进文档。要做到这一点： 	

- ​					关于特定内容的简单评论： 			
  1. ​							请确定您使用 *Multi-page HTML* 格式查看文档。另外，确定 **Feedback** 按钮出现在文档页的右上方。 					
  2. ​							用鼠标指针高亮显示您想评论的文本部分。 					
  3. ​							点在高亮文本上弹出的 **Add Feedback**。 					
  4. ​							按照显示的步骤操作。 					
- ​					要提交更复杂的反馈，请创建一个 Bugzilla ticket： 			
  1. ​							进入 [Bugzilla](https://bugzilla.redhat.com/enter_bug.cgi?product=Red Hat Enterprise Linux 8) 网站。 					
  2. ​							在 Component 中选择 **Documentation**。 					
  3. ​							在 **Description** 中输入您要提供的信息。包括文档相关部分的链接。 					
  4. ​							点 **Submit Bug**。 					

# 第 1 章 简介

​			Red Hat Enterprise Linux 8 在混合云部署环境中提供稳定、安全、持续的基础，并提供更迅速地提供工作负载所需的工具。它可部署为虚拟机监控程序及云供应商环境，也可以部署到物理构架中，以便您的应用程序可在主要硬件构架平台中利用创新。 	

## 1.1. 支持的构架

​				Red Hat Enterprise Linux 支持以下构架： 		

- ​						AMD、Intel 和 ARM 64 位架构 				
- ​						IBM Power Systems, Little Endian 				
  - ​								IBM Power System LC 服务器 						
  - ​								IBM Power System AC 服务器 						
  - ​								IBM Power System L 服务器 						
- ​						IBM Z 				

## 1.2. 安装术语

​				这部分论述了 Red Hat Enterprise Linux 安装术语。同一概念可以会使用不同的术语，具体要看上游或下游来源。 		

​				**Anaconda**:  Fedora、Red Hat Enterprise Linux 以及其变体使用的操作系统安装程序。Anaconda 是一组 Python  模块和脚本，它带有其他文件，比如 Gtk widgets（使用 C）、systemd 单元以及 dracut  程序库。它们一起形成允许用户设置结果（target）系统参数的工具。在这个文档中, **安装程序** 指的是 **Anaconda** 的安装方面。 		

# 第 2 章 安装方法

​			根据具体要求，您可以使用几种方法安装 Red Hat Enterprise Linux。查看以下部分以确定符合您的要求的最佳安装方法。 	

## 2.1. 可用安装方法

​				您可以使用以下任一方法安装 Red Hat Enterprise Linux： 		

- ​						基于 GUI 的安装 				
- ​						系统或云镜像安装 				
- ​						高级安装 				

注意

​					本文档提供有关使用高级安装方法安装 Red Hat Enterprise Linux 的详情。 			

**高级安装**

​					可用的高级安装方法如下： 			

- ​						**使用 Kickstart 执行自动 RHEL 安装：** 使用 Kickstart 安装 Red Hat Enterprise Linux。Kickstart 是一个自动安装，可让您执行无人值守操作系统安装任务。 				
- ​						**从 Content Delivery Network 注册并安装并注册 RHEL：**通过 Content Delivery Network（CDN）在不同架构中安装 Red Hat Enterprise Linux。注册是在从 CDN 下载并安装软件包前执行的。图形用户界面和 Kickstart 支持这个安装方法。 				
- ​						**使用 VNC 执行远程 RHEL 安装：** RHEL 安装程序提供两种 VNC 安装模式： Direct 和 Connect。建立连接后，这两种模式不会有所不同。您选择的模式取决于您的环境。 				
- ​						**使用 PXE 从网络安装 RHEL:**  网络安装可让您将 Red Hat Enterprise Linux 安装到可访问安装服务器的系统。网络安装至少需要两个系统。 				

**系统或云镜像安装**

​					您只能在虚拟和云环境中使用系统或云镜像安装方法。要执行系统或基于云镜像的安装，请使用 Red Hat Image  Builder（红帽镜像构建器）。镜像构建器创建 Red Hat Enterprise Linux 的自定义系统镜像，包括用于云部署的系统镜像。 			

​				有关镜像构建器的更多信息，请参阅[*编写自定义的 RHEL 系统镜像*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/composing_a_customized_rhel_system_image/index/)文档。 		

**基于 GUI 的安装**

​					有以下基于 GUI 的安装方法可用： 			

- ​						**使用客户门户网站中的 ISO 镜像安装 RHEL：**通过从客户门户网站下载 **Binary DVD ISO** 镜像文件安装 Red Hat Enterprise Linux。系统注册在 GUI 安装完成后进行。GUI 和 Kickstart 支持这个安装方法。 				
- ​						**从 Content Delivery Network 注册并安装 RHEL：**注册您的系统、附加订阅并从 Content Delivery Network（CDN）安装 Red Hat Enterprise Linux。**Boot ISO** 和 **Binary DVD ISO** 镜像文件支持这个安装方法，但推荐使用 **Boot ISO** 镜像文件，因为 CDN 默认的安装源是 Boot ISO 镜像文件。注册是在从 CDN 下载并安装软件包前执行的。GUI 和 Kickstart 支持这个安装方法。 				

​				有关高级安装方法的详情，请查看[*执行高级 RHEL 安装文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index/)。 		

# 部分 I. 使用 Kickstart 执行自动安装

## 第 3 章 Kickstart 安装基础

​				以下提供了有关 Kickstart 的基本信息，以及如何使用它自动安装 Red Hat Enterprise Linux。 		

## 3.1. Kickstart 安装是什么

​					Kickstart 提供了一种部分自动化 RHEL 安装过程的方法。 			

​					Kickstart 文件包含一些或所有 RHEL 安装选项。例如，设置时区，如何对驱动器进行分区，或者应该安装哪些软件包。提供准备好的 Kickstart 文件可进行安装而无需用户干预。这在同时大量部署 Red Hat Enterprise Linux 时特别有用。 			

​					Kickstart 文件还提供有关软件选择的更多选项。当使用图形安装界面手动安装 Red Hat Enterprise Linux 时，软件选择仅限于预定义环境和附加组件。Kickstart 文件也允许您安装或删除独立软件包。 			

​					Kickstart 文件可保存在单一服务器系统中，并在安装过程中由独立计算机读取。这个安装方法支持使用单一 Kickstart 文件在多台机器中安装 Red Hat Enterprise Linux，使其成为网络和系统管理员的理想选择。 			

​					所有执行它们的 Kickstart 脚本和日志文件都保存在新安装系统的 `/tmp` 目录中，以帮助调试安装问题。 			

注意

​						在以前的 Red Hat Enterprise Linux 版本里，可以使用 Kickstart 来升级系统。从 Red Hat  Enterprise Linux 7 开始，删除了这个功能，系统升级是由特殊工具处理的。有关升级到 Red Hat Enterprise  Linux 8 的详情，请参阅 [从 RHEL 7 升级到 RHEL 8](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/upgrading_from_rhel_7_to_rhel_8/index) 以及使用 [RHEL 8 的注意事项](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/considerations_in_adopting_rhel_8/index)。 				

## 3.2. 自动化安装工作流

​					Kickstart 安装可以使用本地 DVD、本地硬盘驱动器、NFS、FTP、HTTP 服务器来执行。这部分提供了 Kickstart 使用的高级概述。 			

1. ​							创建一个 Kickstart 文件。您可以手动写入该文件，复制手动安装后保存的 Kickstart 文件，或者使用在线生成器工具创建该文件，之后再编辑该文件。请查看 [第 4 章 *创建 Kickstart 文件*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#creating-kickstart-files_installing-rhel-as-an-experienced-user)。 					
2. ​							在可移动介质、硬盘或者使用 HTTP(S)、FTP 或者 NFS 服务器的网络位置中让安装程序使用 Kickstart 文件。请查看 [第 5 章 *为安装程序提供 Kickstart 文件*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#making-kickstart-files-available-to-the-installation-program_installing-rhel-as-an-experienced-user)。 					
3. ​							创建用来开始安装的引导介质。请参阅 [创建可引导安装介质](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#assembly_creating-a-bootable-installation-medium_installing-RHEL) 和 [第 14 章 *准备使用 PXE 从网络安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#preparing-for-a-network-install_installing-rhel-as-an-experienced-user)。 					
4. ​							使安装源可供安装程序使用。请查看 [第 6 章 *为 Kickstart 安装创建安装源*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#creating-installation-sources-for-kickstart-installations_installing-rhel-as-an-experienced-user)。 					
5. ​							使用引导介质和 Kickstart 文件开始安装。请查看 [第 7 章 *启动 Kickstart 安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#starting-kickstart-installations_installing-rhel-as-an-experienced-user)。 					

​					如果 Kickstart 文件包含所有强制命令和部分，则会自动完成安装。如果缺少一个或多个这些强制部分，或者出现错误，则安装需要手动干预才能完成。 			

注意

​						如果您计划安装 Red Hat Enterprise Linux 的 Beta 版本,在启用了 UEFI 安全引导的系统上,首先禁用 UEFI 安全引导选项,然后开始安装。 				

​						UEFI 安全引导要求操作系统内核使用一个可识别的私钥签名,系统 firware 使用对应的公钥验证它。对于 Red Hat  Enterprise Linux Beta 发行版本,内核使用特定于 Red Hat Beta  的私钥签名,系统默认无法识别该私钥。因此,系统无法引导安装介质。 				

## 第 4 章 创建 Kickstart 文件

​				您可以使用以下方法创建 Kickstart 文件： 		

- ​						使用在线 Kickstart 配置工具。 				
- ​						复制手动安装后创建的 Kickstart 文件。 				
- ​						手动编写整个 Kickstart 文件。请注意，编辑通过其它方法已存在的文件速度会更快，因此不建议使用这个方法。 				
- ​						为 Red Hat Enterprise Linux 8 安装转换 Red Hat Enterprise Linux 7 Kickstart 文件。 				
- ​						如果是虚拟和云环境，请使用 Image Builder 创建自定义系统镜像。 				

​				请注意，某些高度特定的安装选项只能通过手动编辑 Kickstart 文件来配置。 		

## 4.1. 使用 Kickstart 配置工具创建 Kickstart 文件

​					有红帽客户门户网站帐户的用户可以使用客户门户网站 Labs 中的 Kickstart Generator 工具在线生成 Kickstart 文件。这个工具可帮助您完成基本配置，并下载得到的 Kickstart 文件。 			

注意

​						该工具目前不支持任何高级分区。 				

**先决条件**

- ​							您必须有一个红帽客户门户网站帐户和一个活跃的红帽订阅。 					

**流程**

1. ​							在 https://access.redhat.com/labsinfo/kickstartconfig 打开 Kickstart 生成器实验室信息页面 					

2. ​							点击标题左侧的 **Go to Application** 按钮并等待下一个页面加载。 					

3. ​							在下拉菜单中选择 **Red Hat Enterprise Linux 8** 并等待页面更新。 					

4. ​							使用表单中的字段描述要安装的系统。 					

   ​							您可以使用表单左侧的链接来快速导航表表单的部分内容。 					

5. ​							要下载生成的 Kickstart 文件，请点击本页顶部的红色 **下载** 按钮。 					

   ​							浏览器会保存该文件。 					

## 4.2. 执行手动安装来创建 Kickstart 文件

​					推荐的生成 Kickstart 文件的方法是使用手动安装 Red Hat Enterprise Linux 生成的文件。安装完成后，安装中的所有选择都会保存到名为 `anaconda-ks.cfg` 的 Kickstart 文件中，它位于安装的系统中的 `/root/` 目录中。您可以使用这个文件来重现安装。另外，复制此文件，根据需要进行修改，并使用得到的配置文件进行进一步安装。 			

**流程**

1. ​							安装 RHEL。详情请参阅 [执行标准 RHEL 安装文档](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/index)。 					

   ​							在安装过程中，创建一个具有管理员权限的用户。 					

2. ​							完成安装并重启系统。 					

3. ​							使用管理员帐户登录该系统。 					

4. ​							将文件 `/root/anaconda-ks.cfg` 复制到您选择的位置。 					

   - ​									在终端显示文件内容： 							

     ```
     # cat /root/anaconda-ks.cfg
     ```

     ​									您可以复制输出并保存到您选择的其他文件中。 							

   - ​									要将文件复制到另一个位置，请使用文件管理器。请记住需要修改副本的权限，以便非 root 用户可读取该文件。 							

   小心

   ​							该文件包含用户和密码的信息。 					

**其它资源**

- ​							[执行标准 RHEL 安装](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/index) 					

## 4.3. 为 RHEL 8 安装转换 RHEL 7 Kickstart 文件

​					您可以使用 Kickstart Converter 工具转换 RHEL 7 Kickstart 文件，用于新的 RHEL 8 安装。有关该工具以及如何使用该工具转换 RHEL 7 Kickstart 文件的详情，请查看 https://access.redhat.com/labs/kickstartconvert/ 			

## 4.4. 使用 Image Builder 创建自定义镜像

​					您可以使用 Red Hat Image Builder 为虚拟和云部署创建自定义系统镜像。 			

​					有关使用镜像构建器创建自定义镜像的更多信息，请参阅 [*生成自定义的 RHEL 系统镜像文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/composing_a_customized_rhel_system_image/index)。 			

## 第 5 章 为安装程序提供 Kickstart 文件

​				以下提供了有关在目标系统中让安装程序使用 Kickstart 文件的信息。 		

## 5.1. 基于网络安装的端口

​					下表列出了必须在服务器中打开的端口，可提供各种基于网络的安装的文件。 			

**表 5.1. 基于网络安装的端口**

| 使用的协议 | 打开端口         |
| ---------- | ---------------- |
| HTTP       | 80               |
| HTTPS      | 443              |
| FTP        | 21               |
| NFS        | 2049, 111, 20048 |
| TFTP       | 69               |

**其它资源**

- ​							[安全网络](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/securing_networks/index/) 					

## 5.2. 在 NFS 服务器中提供 Kickstart 文件

​					这个步骤描述了如何在 NFS 服务器中保存 Kickstart 脚本。这个方法可让您使用单一源安装多个系统而无需为 Kickstart 文件使用物理介质。 			

**先决条件**

- ​							您必须具有管理员对本地网络中使用 Red Hat Enterprise Linux 8 的服务器的访问权限。 					
- ​							要安装的系统必须能够连接到服务器。 					
- ​							服务器上的防火墙必须允许您要安装到的系统的连接。如需更多信息,请参阅 [第 5.1 节 “基于网络安装的端口”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#ports-for-network-based-installation_making-kickstart-files-available-to-the-installation-program)。 					

**流程**

1. ​							安装 `nfs-utils` 软件包。请作为 root 运行以下命令完成此步骤： 					

   ```
   # yum install nfs-utils
   ```

2. ​							将 Kickstart 文件复制到 NFS 服务器的目录中。 					

3. ​							使用文本编辑器打开 `/etc/exports` 文件，并使用以下语法添加一行： 					

   ```
   /exported_directory/ clients
   ```

4. ​							使用到包含 Kickstart 文件的目录的完整路径替换 */exported_directory/*。要从这个 NFS 服务器安装计算机的主机名或 IP 地址替换 *clients*，如果您想允许任何可访问该 NFS 服务器的计算机都能使用该 ISO 镜像，则使用该系统所在的子网络访问该 ISO 镜像，或者使用星号（`*`）。有关此格式的详情，请查看 *exports(5)* 手册页。 					

   ​							以下是一个基本配置，它使 `/rhel8-install/` 目录以只读方式对所有客户端可用： 					

   ```
   /rhel8-install *
   ```

5. ​							保存 `/etc/exports` 文件并退出文本编辑器。 					

6. ​							启动 nfs 服务： 					

   ```
   # systemctl start nfs-server.service
   ```

   ​							如果在更改 `/etc/exports` 文件前运行该服务，请为运行的 NFS 服务器运行以下命令来重新载入其配置： 					

   ```
   # systemctl reload nfs-server.service
   ```

   ​							Kickstart 文件现在可以通过 NFS 访问并可用于安装。 					

注意

​						当指定 Kickstart 源时，使用 `nfs:` 作为协议、服务器主机名或 IP 地址、冒号（`:`）以及包含该文件的目录内的路径。例如：如果服务器主机名是 `myserver.example.com` 且已在 `/rhel8-install/my-ks.cfg` 中保存了该文件，请将 `inst.ks=nfs:myserver.example.com:/rhel8-install/my-ks.cfg` 指定为安装源引导选项。 				

**其它资源**

- ​							有关为从网络进行 PXE 引导设置 TFTP 服务器的详情,请参考 [第 14 章 *准备使用 PXE 从网络安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#preparing-for-a-network-install_installing-rhel-as-an-experienced-user)。 					

## 5.3. 在 HTTP 或 HTTPS 服务器中提供 Kickstart 文件

​					这个步骤描述了如何在 HTTP 或 HTTPS 服务器中存储 Kickstart 脚本文件。这个方法可让您使用单一源安装多个系统而无需为 Kickstart 文件使用物理介质。 			

**先决条件**

- ​							您必须具有管理员对本地网络中使用 Red Hat Enterprise Linux 8 的服务器的访问权限。 					
- ​							要安装的系统必须能够连接到服务器。 					
- ​							服务器上的防火墙必须允许您要安装到的系统的连接。如需更多信息,请参阅 [第 5.1 节 “基于网络安装的端口”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#ports-for-network-based-installation_making-kickstart-files-available-to-the-installation-program)。 					

**流程**

1. ​							安装 `httpd` 软件包。请作为 root 运行以下命令完成此步骤： 					

   ```
   # yum install httpd
   ```

   警告

   ​								如果您的 Apache 网页服务器配置启用了 SSL 安全性，请确定您只启用 TLSv1 协议，并禁用 SSLv2 和 SSLv3。这是因为 POODLE SSL 漏洞(CVE-2014-3566)。详情请查看 https://access.redhat.com/solutions/1232413。 						

   重要

   ​								如果您使用带有自签名证书的 HTTPS 服务器，则必须使用 `inst.noverifyssl` 选项引导安装程序。 						

2. ​							将 Kickstart 文件复制到 HTTP(S)服务器到该 `/var/www/html/` 目录的子目录中。 					

3. ​							启动 httpd 服务： 					

   ```
   # systemctl start httpd.service
   ```

   ​							Kickstart 文件现在可以访问并可用于安装。 					

   注意

   ​								当指定 Kickstart 文件的位置、使用 `http://` 或者 `https://` 作为协议，该服务器的主机名或 IP 地址以及 Kickstart 文件的路径（相对于 HTTP 服务器 root）。例如：如果您使用 HTTP，则服务器的主机名为 `myserver.example.com`，且已将 Kickstart 文件复制为 `/var/www/html/rhel8-install/my-ks.cfg`，指定 `http://myserver.example.com/rhel8-install/my-ks.cfg` 组为文件位置。 						

**其它资源**

- ​							有关 HTTP 服务器的详情，请参考 [部署不同类型的服务器文档](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/)。 					

## 5.4. 在 FTP 服务器中提供 Kickstart 文件

​					这个步骤描述了如何在 FTP 服务器中保存 Kickstart 脚本。这个方法可让您使用单一源安装多个系统而无需为 Kickstart 文件使用物理介质。 			

**先决条件**

- ​							您必须具有管理员对本地网络中使用 Red Hat Enterprise Linux 8 的服务器的访问权限。 					
- ​							要安装的系统必须能够连接到服务器。 					
- ​							服务器上的防火墙必须允许您要安装到的系统的连接。如需更多信息,请参阅 [第 5.1 节 “基于网络安装的端口”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#ports-for-network-based-installation_making-kickstart-files-available-to-the-installation-program)。 					

**流程**

1. ​							安装 `vsftpd` 软件包。请作为 root 运行以下命令完成此步骤： 					

   ```
   # yum install vsftpd
   ```

2. ​							在文本编辑器中打开并编辑 `/etc/vsftpd/vsftpd.conf` 配置文件。 					

   1. ​									将行 `anonymous_enable=NO` 改为 `anonymous_enable=YES` 							

   2. ​									将行 `write_enable=YES` 改为 `write_enable=NO`。 							

   3. ​									添加行 `pasv_min_port=*min_port*` 和 `pasv_max_port=*max_port*`。用被动模式的 FTP 服务器使用的端口范围替换 *min_port* 和 *max_port*`10021` 和 `10031`。 							

      ​									在带有各种防火墙/NAT 设置的网络环境中，这个步骤可能是必要的。 							

   4. ​									另外，还可在您的配置中添加自定义更改。可用选项请查看 **vsftpd.conf(5)** 手册页。这个步骤假设使用了默认选项。 							

      警告

      ​										如果在 `vsftpd.conf` 文件中配置了 SSL/TLS 安全性，请确保只启用 TLSv1 协议，并禁用 SSLv2 和 SSLv3。这是因为 POODLE SSL 漏洞(CVE-2014-3566)。详情请参考 https://access.redhat.com/solutions/1234773。 								

3. ​							配置服务器防火墙。 					

   1. ​									启用防火墙： 							

      ```
      # systemctl enable firewalld
      # systemctl start firewalld
      ```

   2. ​									在您的防火墙中启用前一步中的 FTP 端口和端口范围： 							

      ```
      # firewall-cmd --add-port min_port-max_port/tcp --permanent
      # firewall-cmd --add-service ftp --permanent
      # firewall-cmd --reload
      ```

      ​									将 *min_port*-*max_port* 替换为您输入到 `/etc/vsftpd/vsftpd.conf` 配置文件的端口号。 							

4. ​							将 Kickstart 文件复制到 FTP 服务器的 `/var/ftp/` 目录中或者子目录中。 					

5. ​							请确定在文件中正确设置了正确的 SELinux 上下文和访问模式： 					

   ```
   # restorecon -r /var/ftp/your-kickstart-file.ks
   # chmod 444 /var/ftp/your-kickstart-file.ks
   ```

6. ​							启动 `vsftpd` 服务： 					

   ```
   # systemctl start vsftpd.service
   ```

   ​							如果在更改 `/etc/vsftpd/vsftpd.conf` 文件前运行该服务，重启该服务以载入经过编辑的文件： 					

   ```
   # systemctl restart vsftpd.service
   ```

   ​							在引导过程中启用 `vsftpd` 服务： 					

   ```
   # systemctl enable vsftpd
   ```

   ​							Kickstart 文件现在可以访问，并可用于同一网络中的系统安装。 					

   注意

   ​								在指定安装源时，使用 `ftp://` 作为协议，指定服务器的主机名或 IP 地址，以及 Kickstart 文件的路径（相对于 HTTP 服务器 root）。例如：如果服务器的主机名是 `myserver.example.com` 且您已经将文件复制到 `/var/ftp/my-ks.cfg`，请指定 `ftp://myserver.example.com/my-ks.cfg` 为安装源。 						

## 5.5. 在本地卷中提供 Kickstart 文件

​					这个步骤描述了如何在要安装的系统中的卷中保存 Kickstart 脚本文件。这个方法可让您绕过其他系统的要求。 			

**先决条件**

- ​							您必须有可移动到要安装的机器的驱动器，比如 USB 盘。 					
- ​							该驱动器必须包含安装程序可读取的分区。支持的类型有 `ext2`、`ext3` `ext4` `xfs`、和 `fat`。 					
- ​							该驱动器必须已连接到系统，并挂载了它的卷。 					

**流程**

1. ​							列出卷信息并记录您想要复制 Kickstart 文件的卷 UUID。 					

   ```
   # lsblk -l -p -o name,rm,ro,hotplug,size,type,mountpoint,uuid
   ```

2. ​							导航到卷中的文件系统。 					

3. ​							将 Kickstart 文件复制到这个文件系统中。 					

4. ​							请记录以后要与 `inst.ks=` 选项搭配使用的字符串。这个字符串的格式是 `hd:UUID=*volume-UUID*:*path/to/kickstart-file.cfg*`。请注意：该路径相对于文件系统根目录，而不是文件系统分级的 `/` 根目录。使用之前记录的 UUID 替换 *volume-UUID*。 					

5. ​							卸载所有驱动器卷： 					

   ```
   # umount /dev/xyz ...
   ```

   ​							在命令中添加所有卷，用空格分开。 					

## 5.6. 在本地卷中生成 Kickstart 文件以便自动载入

​					在要安装的系统中特殊命名的卷的根目录中会出现一个名为 Kickstart 文件。这可让您避开另一个系统的需要，让安装程序自动载入该文件。 			

**先决条件**

- ​							您必须有可移动到要安装的机器的驱动器，比如 USB 盘。 					
- ​							该驱动器必须包含安装程序可读取的分区。支持的类型有 `ext2`、`ext3` `ext4` `xfs`、和 `fat`。 					
- ​							该驱动器必须已连接到系统，并挂载了它的卷。 					

**流程**

1. ​							列出卷信息并记录您想要复制 Kickstart 文件的卷 UUID。 					

   ```
   # lsblk -l -p
   ```

2. ​							导航到卷中的文件系统。 					

3. ​							将 Kickstart 文件复制到文件系统的根目录下。 					

4. ​							将 Kickstart 文件重命名为 `ks.cfg`。 					

5. ​							将卷重命名为 `OEMDRV`: 					

   - ​									对于 `ext2`、`ext3` 和 `ext4` 文件系统： 							

     ```
     # e2label /dev/xyz OEMDRV
     ```

   - ​									对于 XFS 文件系统： 							

     ```
     # xfs_admin -L OEMDRV /dev/xyz
     ```

   ​							使用卷块设备的路径替换 */dev/xyz*。 					

6. ​							卸载所有驱动器卷： 					

   ```
   # umount /dev/xyz ...
   ```

   ​							在命令中添加所有卷，用空格分开。 					

## 第 6 章 为 Kickstart 安装创建安装源

​				这部分介绍了，如何使用包含所需软件仓库和软件包的 Binary DVD ISO 镜像为引导 ISO 镜像创建安装源的信息。 		

## 6.1. 安装源的类型

​					您可选择以下安装源之一用于最小引导镜像： 			

- ​							**DVD:** 将 Binary DVD ISO 镜像刻录到 DVD。安装程序将使用 DVD 自动安装软件软件包。 					

- ​							**硬盘或者 USB 驱动器：** 将二进制 DVD ISO 镜像复制到驱动器中，并将安装程序配置为从驱动器安装软件软件包。如果您使用 USB 驱动器，请在安装开始前确定连接到该系统。安装过程开始后，安装程序无法检测到介质。 					

  - ​									**硬盘限制**: 硬盘中的 Binary DVD ISO 镜像必须在含有安装程序可挂载的文件系统的分区中。支持的文件系统包括 `xfs`、`ext2`、`ext3` `ext4`、以及 `vfat (FAT32)`。 							

  警告

  ​								在 Microsoft Windows 系统中，格式化硬盘时使用的默认文件系统是 NTFS。exFAT  文件系统也可用。但是，这些文件系统无法在安装过程中被挂载。如果您在 Microsoft Windows 中创建硬盘或者 USB  驱动器作为安装源，请确定您将驱动器格式化为 FAT32。请注意： FAT32 文件系统无法存储大于 4GiB 的文件。 						

  ​								在 Red Hat Enterprise Linux 8 中，您可以使用本地硬盘中的目录启用安装。要做到这一点，您需要将 DVD ISO 镜像的内容复制到硬盘的目录中，然后指定该目录作为安装源而不是 ISO 镜像。例如： `inst.repo=hd:<device>:<path to the directory>` 						

- ​							**网络位置：** 将 Binary DVD ISO 镜像或者安装树（Binary DVD ISO 镜像的展开内容）复制到网络位置，并使用以下协议通过网络执行安装： 					

  - ​									**NFS:** 二进制 DVD ISO 镜像位于网络文件系统(NFS)共享中。 							
  - ​									**HTTPS、HTTP 或者 FTP:** 安装树位于可通过 HTTP、HTTPS 或者 FTP 访问的网络位置。 							

## 6.2. 基于网络安装的端口

​					下表列出了必须在服务器中打开的端口，可提供各种基于网络的安装的文件。 			

**表 6.1. 基于网络安装的端口**

| 使用的协议 | 打开端口         |
| ---------- | ---------------- |
| HTTP       | 80               |
| HTTPS      | 443              |
| FTP        | 21               |
| NFS        | 2049, 111, 20048 |
| TFTP       | 69               |

**其它资源**

- ​							[安全网络](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/securing_networks/index/) 					

## 6.3. 在 NFS 服务器中创建安装源

​					按照以下步骤将安装源放在 NFS 服务器中。使用这个安装方法从单一源安装多个系统，而无需连接到物理介质。 			

**先决条件**

- ​							您对带有 Red Hat Enterprise Linux8 的服务器具有管理员级别的访问权限,且该服务器与要安装的系统位于同一个网络中。 					
- ​							您已下载了 Binary DVD 镜像。如需更 *多信息,请参阅执行标准 RHEL 安装* 文档中的 [下载安装 ISO 镜像](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 					
- ​							您已使用镜像文件创建了可引导 CD、DVD 或者 USB 设备。如需更 *多信息,请参阅执行标准 RHEL 安装* 文档中的 [创建安装介质](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-media_installing-RHEL)。 					
- ​							确认您的防火墙允许安装的系统访问远程安装源。如需更多信息，请参阅*执行标准 RHEL 安装*文档中的[基于网络的安装端口](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ports-for-network-based-installation_prepare-installation-source)。 					

**流程**

1. ​							安装 `nfs-utils` 软件包： 					

   ```
   # yum install nfs-utils
   ```

2. ​							将 Binary DVD ISO 镜像复制到 NFS 服务器的目录中。 					

3. ​							使用文本编辑器打开 `/etc/exports` 文件，并使用以下语法添加一行： 					

   ```
   /exported_directory/ clients
   ```

4. ​							使用到包括 ISO 镜像的目录的完全路径替换 */exported_directory/*。使用目标系统的主机名或 IP 地址替换 *clients*，所有目标系统可以用来访问 ISO 镜像的子网络 ; 如果要允许任何可通过网络访问 NFS 服务器的系统使用 ISO 镜像，则使用星号(`*`)。有关此格式的详情，请查看 `exports(5)` man page。 					

   ​							使 `/rhel8-install/` 目录为所有客户端以只读形式提供的基本配置是： 					

   ```
   /rhel8-install *
   ```

5. ​							保存 `/etc/exports` 文件并退出文本编辑器。 					

6. ​							启动 nfs 服务： 					

   ```
   # systemctl start nfs-server.service
   ```

   ​							如果在您更改 `/etc/exports` 文件前运行该服务，为运行的 NFS 服务器运行以下命令重新载入其配置： 					

   ```
   # systemctl reload nfs-server.service
   ```

   ​							现在可通过 NFS 访问该 ISO 镜像并可作为安装源使用。 					

注意

​						在配置安装源时，使用 `nfs:` 作为协议，指定服务器主机名或 IP 地址、冒号 `(:)` 以及该 ISO 镜像所在目录。例如：如果服务器主机名是 `myserver.example.com` 且您保存了 ISO 镜像 `/rhel8-install/`，指定 `nfs:myserver.example.com:/rhel8-install/` 为安装源。 				

## 6.4. 使用 HTTP 或 HTTPS 创建安装源

​					按照以下步骤使用安装树为基于网络的安装创建安装源，该树是包含提取 Binary DVD ISO 镜像内容和有效 `.treeinfo` 文件的目录。可通过 HTTP 或 HTTPS 访问该安装源。 			

**先决条件**

- ​							您需要对带有 Red Hat Enterprise Linux8 的服务器具有管理员级别的访问权限,且这个服务器与要安装的系统位于同一个网络中。 					
- ​							您已下载了 Binary DVD 镜像。如需更 *多信息,请参阅执行标准 RHEL 安装* 文档中的 [下载安装 ISO 镜像](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 					
- ​							您已使用镜像文件创建了可引导 CD、DVD 或者 USB 设备。如需更 *多信息,请参阅执行标准 RHEL 安装* 文档中的 [创建安装介质](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-media_installing-RHEL)。 					
- ​							确认您的防火墙允许安装的系统访问远程安装源。如需更多信息，请参阅*执行标准 RHEL 安装*文档中的[基于网络的安装端口](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ports-for-network-based-installation_prepare-installation-source)。 					

**流程**

1. ​							安装 `httpd` 软件包： 					

   ```
   # yum install httpd
   ```

   警告

   ​								如果您的 Apache 网页服务器配置启用了 SSL 安全性，请确定您只启用 TLSv1 协议，并禁用 SSLv2 和 SSLv3。这是因为 POODLE SSL 漏洞(CVE-2014-3566)。详情请查看 https://access.redhat.com/solutions/1232413。 						

   重要

   ​								如果您使用带有自签名证书的 HTTPS 服务器，则必须使用 `noverifyssl` 选项引导安装程序。 						

2. ​							将 Binary DVD ISO 镜像复制到 HTTP(S)服务器。 					

3. ​							使用 `mount` 命令将二进制 DVD ISO 镜像挂载到适当的目录： 					

   ```
   # mkdir /mnt/rhel8-install/
   # mount -o loop,ro -t iso9660 /image_directory/image.iso /mnt/rhel8-install/
   ```

   ​							使用到 Binary DVD ISO 镜像的路径替换  */image_directory/image.iso*。 					

4. ​							将挂载镜像中的文件复制到 HTTP(S)服务器 root 中。此命令会创建包含镜像内容的 `/var/www/html/rhel8-install/` 目录。 					

   ```
   # cp -r /mnt/rhel8-install/ /var/www/html/
   ```

   ​							该命令创建包含镜像内容的 `/var/www/html/rhel8-install/` 目录。请注意，有些复制方法可以跳过有效安装源所需的 `.treeinfo` 文件。为整个目录运行 `cp` 命令，如本流程所示将正确复制 `.treeinfo`。 					

5. ​							启动 `httpd` 服务： 					

   ```
   # systemctl start httpd.service
   ```

   ​							安装树现在可以访问并可作为安装源使用。 					

   注意

   ​								在配置安装源时，使用 `http://` 或者 `https://` 作为协议、指定服务器主机名或 IP 地址以及 ISO 镜像中包含文件的目录（相对于 HTTP 服务器 root）。例如：如果您使用 HTTP，则服务器主机名为 `myserver.example.com`，且您已将镜像中的文件复制到 `/var/www/html/rhel8-install/`，指定 `http://myserver.example.com/rhel8-install/` 作为安装源。 						

**其它资源**

- ​							[部署不同类型的服务器](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/index/) 					

## 6.5. 使用 FTP 创建安装源

​					按照以下步骤使用安装树为基于网络的安装创建安装源，该树是包含提取 Binary DVD ISO 镜像内容和有效 `.treeinfo` 文件的目录。通过 FTP 访问该安装源。 			

**先决条件**

- ​							您对带有 Red Hat Enterprise Linux8 的服务器具有管理员级别的访问权限,且该服务器与要安装的系统位于同一个网络中。 					
- ​							您已下载了 Binary DVD 镜像。如需更 *多信息,请参阅执行标准 RHEL 安装* 文档中的 [下载安装 ISO 镜像](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#downloading-beta-installation-images_installing-RHEL)。 					
- ​							您已使用镜像文件创建了可引导 CD、DVD 或者 USB 设备。如需更 *多信息,请参阅执行标准 RHEL 安装* 文档中的 [创建安装介质](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#making-media_installing-RHEL)。 					
- ​							确认您的防火墙允许安装的系统访问远程安装源。如需更多信息，请参阅*执行标准 RHEL 安装*文档中的[基于网络的安装端口](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#ports-for-network-based-installation_prepare-installation-source)。 					

**流程**

1. ​							安装 `vsftpd` 软件包。请作为 root 运行以下命令完成此步骤： 					

   ```
   # yum install vsftpd
   ```

2. ​							在文本编辑器中打开并编辑 `/etc/vsftpd/vsftpd.conf` 配置文件。 					

   1. ​									将行 `anonymous_enable=NO` 改为 `anonymous_enable=YES` 							

   2. ​									将行 `write_enable=YES` 改为 `write_enable=NO`。 							

   3. ​									添加行 `pasv_min_port=*min_port*` 和 `pasv_max_port=*max_port*`。用被动模式的 FTP 服务器使用的端口范围替换 *min_port* 和 *max_port*`10021` 和 `10031`。 							

      ​									在带有各种防火墙/NAT 设置的网络环境中，这个步骤可能是必要的。 							

   4. ​									另外，还可在您的配置中添加自定义更改。可用选项请查看 **vsftpd.conf(5)** 手册页。这个步骤假设使用了默认选项。 							

      警告

      ​										如果在 `vsftpd.conf` 文件中配置了 SSL/TLS 安全性，请确保只启用 TLSv1 协议，并禁用 SSLv2 和 SSLv3。这是因为 POODLE SSL 漏洞(CVE-2014-3566)。详情请参考 https://access.redhat.com/solutions/1234773。 								

3. ​							配置服务器防火墙。 					

   1. ​									启用防火墙： 							

      ```
      # systemctl enable firewalld
      # systemctl start firewalld
      ```

   2. ​									在您的防火墙中启用前一步中的 FTP 端口和端口范围： 							

      ```
      # firewall-cmd --add-port min_port-max_port/tcp --permanent
      # firewall-cmd --add-service ftp --permanent
      # firewall-cmd --reload
      ```

      ​									将 *min_port*-*max_port* 替换为您输入到 `/etc/vsftpd/vsftpd.conf` 配置文件的端口号。 							

4. ​							将 Binary DVD ISO 镜像复制到 FTP 服务器。 					

5. ​							使用 mount 命令将二进制 DVD ISO 镜像挂载到适当的目录： 					

   ```
   # mkdir /mnt/rhel8-install
   # mount -o loop,ro -t iso9660 /image-directory/image.iso /mnt/rhel8-install
   ```

   ​							使用 Binary DVD ISO 镜像的路径替换 */image-directory/image.iso*。 					

6. ​							将挂载镜像中的文件复制到 FTP 服务器 root 目录中： 					

   ```
   # mkdir /var/ftp/rhel8-install
   # cp -r /mnt/rhel8-install/ /var/ftp/
   ```

   ​							该命令创建包含镜像内容的 `/var/ftp/rhel8-install/` 目录。请注意，有些复制方法可以跳过有效安装源所需的 `.treeinfo` 文件。为整个目录运行 `cp` 命令，如本流程所示将正确复制 `.treeinfo`。 					

7. ​							请确定在复制的内容中设置了正确的 SELinux 上下文和访问模式： 					

   ```
   # restorecon -r /var/ftp/rhel8-install
   # find /var/ftp/rhel8-install -type f -exec chmod 444 {} \;
   # find /var/ftp/rhel8-install -type d -exec chmod 755 {} \;
   ```

8. ​							启动 `vsftpd` 服务： 					

   ```
   # systemctl start vsftpd.service
   ```

   ​							如果在更改 `/etc/vsftpd/vsftpd.conf` 文件前运行该服务，重启该服务以载入经过编辑的文件： 					

   ```
   # systemctl restart vsftpd.service
   ```

   ​							在引导过程中启用 `vsftpd` 服务： 					

   ```
   # systemctl enable vsftpd
   ```

   ​							安装树现在可以访问并可作为安装源使用。 					

   注意

   ​								在配置安装源时，使用 `ftp://` 协议、指定服务器主机名或 IP 地址以及保存 ISO 镜像中文件的目录（相对于 FTP 服务器 root）。例如：如果服务器主机名是 `myserver.example.com` 且已将镜像中的文件复制到 `/var/ftp/rhel8-install/`，指定 `ftp://myserver.example.com/rhel8-install/` 作为安装源。 						

## 第 7 章 启动 Kickstart 安装

​				您可以以多种方式启动 Kickstart 安装： 		

- ​						输入安装程序引导菜单并指定选项，包括 Kickstart 文件。 				
- ​						通过在 PXE 引导中自动编辑引导选项。 				
- ​						通过使用特定名称在卷中自动提供文件。 				

​				如何在以下部分中了解如何执行这些方法。 		

## 7.1. 手动启动 Kickstart 安装

​					这部分论述了如何手动启动 Kickstart 安装。这意味着需要一些用户互动（在 `boot:` 提示符后添加引导选项）。引导安装系统 `inst.ks=*location*` 时使用引导选项，使用 Kickstart 文件的位置替换 location。指定引导选项的具体方法取决于系统的架构。 			

**先决条件**

- ​							您有一个可用的 Kickstart 文件，位于系统可访问的位置 					

**流程**

1. ​							使用本地介质（CD、DVD 或者 USB 闪存驱动器）引导系统。 					

2. ​							在 boot 提示符后指定所需的引导选项。 					

   1. ​									如果 Kickstart 文件或者所需库位于网络中，可能需要使用 `ip=` 选项配置网络。在没有这个选项时，安装程序会默认尝试使用 DHCP 协议配置所有网络设备。 							
   2. ​									添加 `inst.ks=` 引导选项以及 Kickstart 文件的位置。 							
   3. ​									要访问安装所需软件包的软件源，可能需要添加 `inst.repo=` 选项。如果您没有指定这个选项，则必须在 Kickstart 文件中指定安装源。 							

   ​							有关编辑引导选项的详情请参考 [第 16.2 节 “编辑引导选项”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#editing-boot-options_kickstart-and-advanced-boot-options)。 					

3. ​							通过确认您添加的引导选项启动安装。 					

   ​							现在开始使用在 Kickstart 文件中指定的选项安装。如果 Kickstart 文件有效并包含全部所需命令，则从现在开始安装将是全自动的。 					

注意

​						如果您已经安装了 Red Hat Enterprise Linux Beta 发行版本,在启用了 UEFI 安全引导的系统中,将  Beta 公钥添加到系统的 Machine Owner Key(MOK)列表中。有关 UEFI 安全引导和 Red Hat Enterprise Linux Beta 发行版本的详情请参考 [附录 D, *UEFI 安全引导和 RHEL Beta 发行版本*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#uefi-secure-boot-and-beta-releases_installing-rhel-as-an-experienced-user)。 				

## 7.2. 使用 PXE 自动启动 Kickstart 安装

​					AMD64、Intel 64 和 64 位 ARM 系统以及 IBM Power Systems 服务器能够使用 PXE  服务器引导。当您配置 PXE  服务器时，可以在引导装载程序配置文件中添加引导选项，以便您可以自动启动安装。使用这个方法，可以完全自动化安装，包括引导过程。 			

​					这个步骤只是一般参考，具体步骤根据您的系统架构有所不同，且不是所有选项都可用于所有架构（例如：您无法在 IBM Z 上使用 PXE 引导）。 			

**先决条件**

- ​							您必须有一个可用的 Kickstart 文件位于系统可访问的位置。 					
- ​							您必须有可用来引导系统并开始安装的 PXE 服务器。 					

**流程**

1. ​							打开 PXE 服务器中的引导装载程序配置文件，并在相应的行中添加 `inst.ks=` 引导选项。该文件的名称及其句法取决于您系统的架构和硬件： 					

   - ​									在使用 BIOS 的 AMD64 和 Intel 64 系统中，该文件名称可以是 default，或取决于您的系统 IP 地址。在这种情况下，在安装条目的附加行中添加 `inst.ks=` 选项。在配置文件中添加的行示例类似如下： 							

     ```
     append initrd=initrd.img inst.ks=http://10.32.5.1/mnt/archive/RHEL-8/8.x/x86_64/kickstarts/ks.cfg
     ```

   - ​									在使用 GRUB2 引导装载程序（带有 UEFI 固件和 IBM Power Systems 服务器的 AMD64、Intel 64 和 64 位 ARM 系统系统）中，该文件的名称将是 `grub.cfg`。在这个文件中，在安装条目的 kernel 行中添加 `inst.ks=` 选项。该配置文件 kernel 行示例类似如下： 							

     ```
     kernel vmlinuz inst.ks=http://10.32.5.1/mnt/archive/RHEL-8/8.x/x86_64/kickstarts/ks.cfg
     ```

2. ​							从网络服务器引导安装。 					

   ​							现在开始使用在 Kickstart 文件中指定的安装选项安装。如果 Kickstart 文件有效并包含全部所需命令，则安装将是全自动的。 					

注意

​						如果您已经安装了 Red Hat Enterprise Linux Beta 发行版本,在启用了 UEFI 安全引导的系统中,将  Beta 公钥添加到系统的 Machine Owner Key(MOK)列表中。有关 UEFI 安全引导和 Red Hat Enterprise Linux Beta 发行版本的详情请参考 [附录 D, *UEFI 安全引导和 RHEL Beta 发行版本*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#uefi-secure-boot-and-beta-releases_installing-rhel-as-an-experienced-user)。 				

**其它资源**

- ​							有关设置 PXE 服务器的详情请参考 [第 14 章 *准备使用 PXE 从网络安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#preparing-for-a-network-install_installing-rhel-as-an-experienced-user)。 					

## 7.3. 使用本地卷自动启动 Kickstart 安装

​					您可以通过在指定标记的存储卷上加上特定名称的 Kickstart 文件启动 Kickstart 安装。 			

**先决条件**

- ​							您必须有带有 [标签的卷，`OEMDRV` 和 Kickstart 文件位于它的 root 作为 `ks.cfg`](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#making-a-kickstart-file-available-on-a-local-volume-for-automatic-loading_making-kickstart-files-available-to-the-installation-program)。 					
- ​							包含此卷的驱动器必须在安装程序引导时在系统中可用。 					

**流程**

1. ​							使用本地介质（CD、DVD 或者 USB 闪存驱动器）引导系统。 					

2. ​							在 boot 提示符后指定所需的引导选项。 					

   1. ​									如果所需的仓库位于网络位置，可能需要使用 `ip=` 选项配置网络。在没有这个选项时，安装程序会默认尝试使用 DHCP 协议配置所有网络设备。 							
   2. ​									要访问安装所需软件包的软件源，可能需要添加 `inst.repo=` 选项。如果您没有指定这个选项，则必须在 Kickstart 文件中指定安装源。 							

3. ​							通过确认您添加的引导选项启动安装。 					

   ​							现在开始安装，Kickstart 文件会被自动探测，并用来自动启动 Kickstart 安装。 					

注意

​						如果您已经安装了 Red Hat Enterprise Linux Beta 发行版本,在启用了 UEFI 安全引导的系统中,将  Beta 公钥添加到系统的 Machine Owner Key(MOK)列表中。有关 UEFI 安全引导和 Red Hat Enterprise Linux Beta 发行版本的详情请参考 [附录 D, *UEFI 安全引导和 RHEL Beta 发行版本*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#uefi-secure-boot-and-beta-releases_installing-rhel-as-an-experienced-user)。 				

## 第 8 章 安装过程中的控制台和日志记录

​				在主界面外，Red Hat Enterprise Linux 安装程序使用 **tmux** 终端显示和控制几个窗口。每个窗口都有不同的目的，它们会显示几个不同的日志，可用于在安装过程中排除问题。其中一个窗口提供带有 `root` 权限的互动 shell 提示符，除非使用引导选项或者 Kickstart 命令特别禁用了这个提示符。 		

注意

​					一般来说，除非需要诊断安装问题，不需要离开默认的图形安装环境。 			

​				终端多路器在虚拟控制台 1 中运行。要从实际安装环境切换到 **tmux**，按**Ctrl**+**Alt**+**F1**。要回到在虚拟控制台 6 中运行的主安装界面，按 **Ctrl**+**Alt**+**F6**。 		

注意

​					如果选择文本模式安装，会在虚拟控制台 1（**tmux**）中启动，切换到控制台 6 将打开 shell 提示符而不是图形界面。 			

​				运行 **tmux** 的控制台有五个可用的窗口; 下表中描述了它们的内容以及键盘快捷键。请注意，键盘快捷键有两个部分：首先按 **Ctrl**+**b** 键，然后释放这两个键，再按您想要使用的窗口的数字键。 		

​				您还可以使用 **Ctrl**+**b** **n**、**Alt+** **Tab** 和 **Ctrl**+**b** **p** 切换到下一个或前一个 **tmux** 窗口。 		

**表 8.1. 可用的 tmux 窗口**

| 快捷键               | 内容                                                         |
| -------------------- | ------------------------------------------------------------ |
| **Ctrl**+**b** **1** | 安装程序主窗口。包含基于文本的提示（在文本模式安装或者使用 VNC 直接模式时），以及一些调试信息。 |
| **Ctrl**+**b** **2** | 有 `root` 权限的互动 shell 提示符。                          |
| **Ctrl**+**b** **3** | 安装日志; 显示信息保存在 `/tmp/anaconda.log`。               |
| **Ctrl**+**b** **4** | 存储日志; 显示与存储设备和配置相关的消息，保存在 `/tmp/storage.log`。 |
| **Ctrl**+**b** **5** | 程序日志; 显示安装过程中执行的实用程序的信息并保存在 `/tmp/program.log`。 |

## 第 9 章 维护 Kickstart 文件

​				您可以在 Kickstart 文件中自动运行检查。通常，您要验证一个新的或已存在的 Kickstart 文件是否有效。 		

## 9.1. 安装 Kickstart 维护工具

​					要使用 Kickstart 维护工具，您必须安装包含它们的软件包。 			

**流程**

- ​							安装 **pykickstart** 软件包： 					

  ```
  # yum install pykickstart
  ```

## 9.2. 验证 Kickstart 文件

​					使用 `ksvalidator` 命令行工具验证您的 Kickstart 文件是否有效。当您对 Kickstart 文件进行广泛更改时，这非常有用。 			

**流程**

- ​							`ksvalidator` 在您的 Kickstart 文件中运行： 					

  ```
  $ ksvalidator /path/to/kickstart.ks
  ```

  ​							使用要验证的 Kickstart 文件的路径替换 */path/to/kickstart.ks*。 					

重要

​						验证工具并不能保证安装过程可以成功。它只检查语法是否正确，且该文件不包含已弃用的选项。它不会试图验证 Kickstart 文件中的 `%pre`、`%post` 和 `%packages` 部分。 				

**其它资源**

- ​							*ksvalidator(1)* 手册页。 					

# 部分 II. 从 Content Delivery Network 注册并安装 RHEL

## 第 10 章 使用 Kickstart 从 CDN 注册并安装 RHEL

​				本节介绍如何使用 Kickstart 注册您的系统、附加 RHEL 订阅并从 Red Hat Content Delivery Network(CDN)安装。 		

## 10.1. 从 CDN 注册并安装 RHEL

​					使用`rhsm` Kickstart 命令（这个命令支持 `syspurpose` 命令和 Red Hat Insights）注册您的系统、附加 RHEL 订阅并从 Red Hat Content Delivery Network(CDN)安装。在注册系统时，`rhsm` Kickstart 命令删除了使用自定义 `%post` 脚本的要求。 			

重要

​						**引导 ISO** 和 **Binary DVD ISO** 镜像文件支持 CDN 的功能。但建议您使用 **引导 ISO** 镜像文件作为引导 ISO 镜像文件的默认 CDN 安装源。 				

**先决条件**

- ​							系统连接到可以访问 CDN 的网络。 					
- ​							您创建了 Kickstart 文件，并使其可用于可移动介质、硬盘或者使用 HTTP(S)、FTP 或者 NFS 服务器的网络位置。 					
- ​							Kickstart 文件位于要安装的系统可访问的位置。 					
- ​							您创建了用来开始安装并让安装程序可以使用安装源的引导介质。 					

重要

- ​								系统注册后的安装源存储库依赖于系统的引导方式。如需更多信息，请参阅 [*执行标准 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index)文档中的*系统注册后安装源仓库*的部分。 						
- ​								Kickstart 文件中不需要仓库配置，因为您的订阅管理系统可访问的 CDN 子集和库。 						

**流程**

1. ​							打开 Kickstart 文件。 					

2. ​							编辑该文件，在该文件中添加 `rhsm` Kickstart 命令及其选项： 					

   - 机构（必需）

     ​										输入机构 id。例如： 								`--organization=1234567`注意 										出于安全考虑，在从 CDN 注册和安装时 Kickstart 不支持使用红帽用户名和密码帐户详情。 									

   - 激活码（必需）

     ​										输入激活码。只要在您的订阅中进行了注册，您可以输入多个激活码。例如： 								`--activation-key="Test_key_1" --activation-key="Test_key_2"`

   - Red Hat Insights（可选）

     ​										将目标系统连接到 Red Hat Insights。 								注意 										Red Hat Insights  是一个软件即服务(SaaS)服务(SaaS),它提供对注册的红帽系统的持续分析，以主动识别跨物理、虚拟和云环境以及容器部署的安全性、性能和稳定性。与 GUI 设置不同，使用 Kickstart 时默认不启用连接到 Red Hat Insights。 									 									例如： 								`--connect-to-insights`

   - HTTP 代理（可选）

     ​										设置 HTTP 代理。例如： 								`--proxy="user:password@hostname:9000"`注意 										只有主机名是必须的。如果需要代理在没有验证的默认端口中运行，则使用： `--proxy="hostname"` 									

   - 服务器主机名（可选）

     注意 										服务器主机名不需要 HTTP 协议，例如 `nameofhost.com`。 									 									如果您正在运行 Satellite 服务器或者执行内部测试，则设定服务器主机名。例如： 								`--server-hostname="nameofhost.com"`

   - rhsm baseurl（可选）

     注意 										rhsm baseurl 需要 HTTP 协议。 									 									如果您正在运行 Satellite 服务器或者执行内部测试，则设置 rhsm baseurl 选项。例如： 								`--rhsm-baseurl="http://nameofhost.com"`

   - 系统目的（可选）

     ​										使用以下命令设置系统目的角色、SLA 和用法： 								`syspurpose --role="Red Hat Enterprise Linux Server" --sla="Premium" --usage="Production"`

   - 示例

     ​										以下示例显示了含有所有 Kickstart 命令选项的最小 `rhsm` Kickstart 文件。 								`graphical lang en_US.UTF-8 keyboard us rootpw 12345 timezone America/New_York zerombr clearpart --all --initlabel autopart syspurpose --role="Red Hat Enterprise Linux Server" --sla="Premium" --usage="Production" rhsm --organization="12345" --activation-key="test_key" --connect-to-insights --server-hostname="nameofhost.com" --rhsm-baseurl="http://nameofhost.com" --proxy="user:password@hostname:9000" %packages vim %end`

3. ​							保存 Kickstart 文件并启动安装过程。 					

**其它资源**

- ​							有关系统目的的详情，请参考本文档中的*配置系统目的*部分。 					
- ​							有关如何启动 Kickstart 安装的详情，请参阅[*启动 Kickstart 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#starting-kickstart-installations_installing-rhel-as-an-experienced-user)。 					
- ​							有关 Red Hat Insights 的详情，请查看 [*Red Hat Insights 产品文档*](https://access.redhat.com/documentation/or-in/red_hat_insights/)。 					
- ​							有关激活码的详情，请查看 *使用红帽订阅管理*文档中的[*了解激活码*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html/using_red_hat_subscription_management/activation_keys_con) 一章。 					
- ​							有关如何为 Subscription Manager 设置 HTTP 代理服务器的详情，请参考*使用并配置 Red Hat Subscription Manager* 文档中的[*使用 HTTP 代理*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index#repos-proxy)章节。 					

## 10.2. 从 CDN 验证您的系统注册

​					使用这个步骤验证您的系统是否在 CDN 中注册。 			

**先决条件**

- ​							您已完成了注册和安装过程,如 [第 10.1 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#register-and-install-from-cdn-using-kickstart_register-and-install-from-cdn) 					
- ​							您已启动 Kickstart 安装，如 [*启动 Kickstart 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#starting-kickstart-installations_installing-rhel-as-an-experienced-user)所述。 					
- ​							安装的系统已重启，并打开终端窗口。 					

**流程**

1. ​							在终端窗口中以 `root` 用户身份登录并验证注册： 					

   ```
   # subscription-manager list
   ```

   ​							输出会显示附加的订阅详情，例如： 					

   ```
   Installed Product Status
   
   Product Name: Red Hat Enterprise Linux for x86_64
   Product ID: 486
   Version: 8.2
   Arch: x86_64
   Status: Subscribed
   Status Details
   Starts: 11/4/2019
   Ends: 11/4/2020
   ```

2. ​							要查看详细报告，请运行以下命令： 					

   ```
   # subscription-manager list --consumed
   ```

## 10.3. 从 CDN 取消注册您的系统

​					使用这个流程从 Red Hat CDN 取消注册您的系统。 			

**先决条件**

- ​							您已完成了注册和安装过程,如 [第 10.1 节 “从 CDN 注册并安装 RHEL”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#register-and-install-from-cdn-using-kickstart_register-and-install-from-cdn) 所述。 					
- ​							您已启动 Kickstart 安装，如 [*启动 Kickstart 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#starting-kickstart-installations_installing-rhel-as-an-experienced-user)所述。 					
- ​							安装的系统已重启，并打开终端窗口。 					

**流程**

1. ​							在终端窗口中以 `root` 用户身份登录并取消注册： 					

   ```
   # subscription-manager unregister
   ```

   ​							从系统中取消注册附加的订阅，并删除到 CDN 的连接。 					

# 部分 III. 使用 VNC 执行远程 RHEL 安装

## 第 11 章 使用 VNC 执行远程 RHEL 安装

​				这部分论述了如何使用虚拟网络计算(VNC)执行远程 RHEL 安装。 		

## 11.1. 概述

​					在您使用 CD、DVD、USB 闪存驱动器或者使用 PXE 从网络引导系统时，推荐使用图形用户界面安装  RHEL。然而，很多企业级系统（如 IBM Power Systems 和 IBM  Z）都位于远程数据中心环境中，这些环境可自主运行，但没有连接显示设备、键盘和鼠标。这些系统通常被称为 *无头系统*，它们通常通过网络连接来控制。RHEL 安装程序包含在目标机器上运行图形安装的虚拟网络计算（VNC），但控制图形安装是由网络中的另一个系统处理的。RHEL 安装程序提供两种 VNC 安装模式： **Direct** 和 **Connect**。建立连接后，这两种模式不会有所不同。您选择的模式取决于您的环境。 			

- 直接（Direct）模式

  ​								在 Direct 模式中,RHEL 安装程序被配置为在目标系统中启动，并等待安装在另一个系统中的 VNC viewer  前再运行。作为直接模式安装的一部分，目标系统中会显示 IP 地址和端口。您可以使用 VNC viewer 使用 IP  地址和端口远程连接到目标系统，并完成图形安装。 						

- 连接（Connect）模式

  ​								在连接模式下, VNC viewer 是在 *侦听*  模式的远程系统中启动的。VNC viewer 在指定端口等待来自目标系统的进入连接。当 RHEL 安装程序在目标系统上启动时，使用引导选项或  Kickstart 命令提供系统主机名和端口号。然后安装程序使用指定的系统主机名和端口与侦听的 VNC viewer  建立连接。要使用连接模式，带侦听的 VNC viewer 的系统必须能够接受进入的网络连接。 						

## 11.2. 注意事项

​					使用 VNC 执行远程 RHEL 安装时请考虑以下项目： 			

- ​							**VNC 客户端应用程序：** VNC 客户端应用程序要执行 VNC 直接安装和连接安装。在大多数 Linux 发行本程序库中都有 VNC 客户端程序，如 Windows 等其它操作系统可使用免费 VNC 客户端程序。RHEL 中提供以下 VNC 客户端应用程序： 					
  - ​									`tigervnc` 独立于您的桌面环境，并作为 `tigervnc` 软件包的一部分安装。 							
  - ​									`vinagre` 是 GNOME 桌面环境的一部分，并作为 `vinagre` 软件包的一部分安装。 							

注意

​						VNC 服务器包含在安装程序中，不需要安装。 				

- ​							**网络和防火墙：** 					
  - ​									如果防火墙不允许入站连接，则必须使用连接模式或禁用防火墙。禁用防火墙可能会造成安全隐患。 							
  - ​									如果某个防火墙不允许运行 VNC viewer 的系统进入连接，则必须使用直接模式或者禁用防火墙。禁用防火墙可能会造成安全隐患。有关配置防火墙的详情请参考[安全强化](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/index/)文档。 							
- ​							**自定义引导选项：** 您必须指定启动 VNC 安装的自定义引导选项，且安装说明可能因系统架构的不同而有所不同。 					

- ​							**Kickstart 安装中的 VNC:** 您可以在 Kickstart 安装中使用 VNC 具体命令。仅使用 `vnc` 命令以 Direct 模式运行 RHEL 安装。可使用选项设置使用连接模式的安装。有关 Kickstart 安装的详情请参考 [第 3.1 节 “Kickstart 安装是什么”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#what-are-kickstart-installations_kickstart-installation-basics)。 					

## 11.3. 使用 VNC 直接模式执行远程 RHEL 安装

​					使用这个流程在 VNC 直接模式下执行远程 RHEL 安装。VNC viewer 需要 VNC viewer 启动到使用 RHEL 安装的目标系统的连接。在此过程中，使用 VNC viewer 的系统被称为**远程**系统。RHEL 安装程序提示您从远程系统中的 VNC viewer 与目标系统启动连接。 			

注意

​						这个过程使用 **TigerVNC** 作为 VNC viewer。其他浏览器的具体步骤可能有所不同，但适用一般原则。 				

**先决条件**

- ​							作为 root 用户，您已在远程系统中安装了 VNC viewer，例如： 					

  ```
  # yum install tigervnc
  ```

- ​							您已设置网络引导服务器并在目标系统中引导安装。如需更多信息,请参阅 [第 14.1 节 “网络安装概述”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#network-install-overview_preparing-for-a-network-install)。 					

**流程**

1. ​							在目标系统的 RHEL 引导菜单中，按键盘中的 `Tab` 键编辑引导选项。 					

2. ​							在命令行末尾附加 `inst.vnc` 选项。 					

   1. ​									如果您想限制正在安装的系统的 VNC 访问，请在命令行末尾添加 `inst.vncpassword=PASSWORD` 引导选项。用您要用于安装的密码替换 **PASSWORD**。VNC 密码长度必须在 6 到 8 个字符之间。 							

      重要

      ​										为 `inst.vncpassword=` 选项使用临时密码。它不应该是现有的密码或 root 密码。 								

3. ​							按 **Enter** 键开始安装。目标系统初始化安装程序并启动所需服务。当系统就绪后，会显示一条信息，提供系统的 IP 地址和端口号。 					

4. ​							在远程系统中打开 VNC viewer。 					

5. ​							在 **VNC 服务器** 字段输入 IP 地址和端口号。 					

6. ​							点 **连接**。 					

7. ​							输入 VNC 密码并点击 **确定**。此时会打开建立 VNC 连接的新窗口。显示 RHEL 安装菜单。在这个窗口中，您可以使用图形用户界面在目标系统中安装 RHEL。 					

**其它资源**

- ​							有关如何使用图形用户界面执行 RHEL 安装的详情，请参考[*执行标准 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index/)文档中的*使用图形用户界面安装 RHEL* 部分。 					

## 11.4. 在 VNC Connect 模式下执行远程 RHEL 安装

​					使用这个流程在 VNC Connect 模式下执行远程 RHEL 安装。在连接模式中，正在安装 RHEL 的目标系统会启动连接到另一个系统中安装的 VNC viewer。在此过程中，使用 VNC viewer 的系统被称为**远程**系统。 			

注意

​						这个过程使用 **TigerVNC** 作为 VNC viewer。其他浏览器的具体步骤可能有所不同，但适用一般原则。 				

**先决条件**

- ​							作为 root 用户，您已在远程系统中安装了 VNC viewer，例如： 					

  ```
  # yum install tigervnc
  ```

- ​							您已设置了一个网络引导服务器来在目标系统中启动安装。如需更多信息,请参阅 [第 14.1 节 “网络安装概述”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#network-install-overview_preparing-for-a-network-install)。 					

- ​							您已将目标系统配置为使用 VNC Connect 安装的引导选项。 					

- ​							您已确认将使用 VNC viewer 的远程系统配置为接受所需端口上的进入连接。验证取决于您的网络和系统配置。如需更多信息，请参阅[安全强化](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/index/)和[安全网络](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/securing_networks/index/)文档。 					

**流程**

1. ​							运行以下命令在远程系统中以 *侦听模式* 启动 VNC viewer: 					

   ```
   $ vncviewer -listen PORT
   ```

2. ​							使用用于连接的端口号替换 PORT。 					

3. ​							该终端会显示一条信息表示它正在等待目标系统的进入连接。 					

   ```
   TigerVNC Viewer 64-bit v1.8.0
   Built on: 2017-10-12 09:20
   Copyright (C) 1999-2017 TigerVNC Team and many others (see README.txt)
   See http://www.tigervnc.org for information on TigerVNC.
   
   Thu Jun 27 11:30:57 2019
    main:        Listening on port 5500
   ```

4. ​							从网络引导目标系统。 					

5. ​							在目标系统的 RHEL 引导菜单中，按键盘中的 `Tab` 键编辑引导选项。 					

6. ​							在命令行末尾附加 `inst.vnc inst.vncconnect=HOST:PORT` 选项。 					

7. ​							使用正在侦听的 VNC viewer 的远程系统的 IP 地址替换 *HOST*，使用 VNC viewer 侦听的端口号 *PORT*。 					

8. ​							按 **Enter** 键开始安装。系统会初始化安装程序并启动所需服务。初始化过程完成后，安装程序会尝试连接到提供的 IP 地址和端口。 					

9. ​							连接成功后，会打开建立 VNC 连接的新窗口，显示 RHEL 安装菜单。在这个窗口中，您可以使用图形用户界面在目标系统中安装 RHEL。 					

**其它资源**

- ​							有关如何使用图形用户界面执行 RHEL 安装的详情，请参考[*执行标准 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index/)文档中的*使用图形用户界面安装 RHEL* 部分。 					

# 部分 IV. 高级配置选项

## 第 12 章 配置系统目的

​				您可以使用系统目的记录 Red Hat Enterprise Linux 8 系统的预期使用。设置系统目的可让授权服务器自动附加最合适的订阅。这部分论述了如何使用 Kickstart 配置系统目的。 		

​				优点包括： 		

- ​						为系统管理员和商业操作提供深入系统级的信息。 				
- ​						降低管理成本以决定系统为什么及其预期目的。 				
- ​						改进了 Subscription Manager 自动附加的客户体验，并自动发现并协调系统使用。 				

## 12.1. 概述

​					可以用以下方法之一输入系统目的： 			

- ​							创建镜像期间 					
- ​							在 GUI 安装过程中，使用 **连接到红帽** 的界面注册您的系统并附加您的红帽订阅 					
- ​							在使用 Kickstart 自动化脚本的 Kickstart 安装过程中 					
- ​							在安装后，使用 **syspurpose 命令行 (** CLI）工具进行 					

​					要记录系统的预期目的，您可以配置以下系统目的组件。注册时授权服务器会使用所选值为您的系统附加最合适的订阅。 			

- ​							**Role** 					
  - ​									Red Hat Enterprise Linux Server 							
  - ​									Red Hat Enterprise Linux Workstation 							
  - ​									Red Hat Enterprise Linux Compute 节点 							
- ​							**服务等级协议** 					
  - ​									Premium（高级） 							
  - ​									Standard（标准） 							
  - ​									Self-Support（自助） 							
- ​							**使用** 					
  - ​									生产环境 							
  - ​									开发/测试 							
  - ​									灾难恢复 							

**其它资源**

- ​							有关镜像构建器的更多信息，请参阅 [*编写自定义的 RHEL 系统镜像*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/composing_a_customized_rhel_system_image/index/)文档。 					
- ​							有关 Kickstart 的详情，请查看 [*执行高级 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/)文档。 					
- ​							有关 Subscription Manager 的详情，请参考 [*使用和配置 Red Hat Subscription Manager*](https://access.redhat.com/documentation/en-us/red_hat_subscription_management/1/html-single/rhsm/index/) 文档。 					

## 12.2. 在 Kickstart 文件中配置系统目的

​					按照以下步骤在安装过程中配置系统目的。要做到这一点,在 Kickstart 配置文件中使用 `syspurpose` Kickstart 命令。 			

​					虽然系统目的是 Red Hat Enterprise Linux 安装程序的可选功能,我们强烈建议您配置系统目的,以自动附加最合适的订阅。 			

注意

​						您还可以在安装完成后启用系统目的。要做到这一点,使用 `syspurpose` 命令行工具。`syspurpose` 工具命令与 `syspurpose` Kickstart 命令不同。 				

​					`syspurpose` Kickstart 命令有以下操作： 			

- role

  ​								设置系统预期的角色。这个操作使用以下格式： 						`syspurpose --role=` 							分配的角色可以是： 						 									`Red Hat Enterprise Linux Server` 								 									`Red Hat Enterprise Linux Workstation` 								 									`Red Hat Enterprise Linux Compute Node` 								

- SLA

  ​								设置系统的预期 SLA。这个操作使用以下格式： 						`syspurpose --sla=` 							分配的 sla 可以是： 						 									`Premium` 								 									`Standard` 								 									`Self-Support` 								

- usage

  ​								设置系统的预期用法。这个操作使用以下格式： 						`syspurpose --usage=` 							分配的使用量可以是： 						 									`Production` 								 									`Development/Test` 								 									`Disaster Recovery` 								

## 12.3. 相关信息

- ​							如需了解更多与使用图形用户界面或 `syspurpose` 命令行工具程序配置系统目的，请参阅[*执行标准的 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index/)文档。 					

## 第 13 章 在安装过程中更新驱动程序

​				这部分论述了如何在 Red Hat Enterprise Linux 安装过程中完成驱动程序更新。 		

注意

​					这是安装过程的一个可选步骤。红帽建议不要执行驱动程序更新，除非有此需要。 			

## 13.1. 先决条件

​					红帽、您的硬件零售商或者可信的第三方零售商会通知您在 Red Hat Enterprise Linux 安装过程中需要进行驱动程序更新。 			

## 13.2. 概述

​					Red Hat Enterprise Linux  支持很多硬件设备的驱动程序，但可能不支持一些新发布驱动程序。只有在不支持的驱动程序无法完成安装时才应执行驱动程序更新。通常在安装过程中需要更新驱动程序来支持特定的配置。例如：为存储适配器卡安装驱动程序，提供对您的系统存储设备的访问。 			

警告

​						驱动程序更新磁盘可能会禁用冲突内核驱动程序。在个别情况下，卸载内核模块可能会导致安装错误。 				

## 13.3. 驱动程序更新的类型

​					红帽、您的硬件零售商或可信第三方以 ISO 镜像文件的形式提供驱动程序更新。您收到 ISO 镜像文件后，请选择驱动程序更新的类型。 			

**驱动程序更新的类型**

- 自动

  ​								推荐的驱动程序更新方法; 标记为`OEMDRV`的存储设备（包括 CD、DVD 或者 USB 闪存驱动器）是物理上连接到该系统的设备。如果在安装启动时 `OEMDRV` 存储设备存在，它将被视为驱动程序更新磁盘，安装程序会自动载入其驱动程序。 						

- Assisted

  ​								安装程序会提示您定位驱动程序更新。您可以使用 `OEMDRV` 以外的任意标签标记本地存储设备 。在开始安装时会指定 `inst.dd` 引导选项。如果您在没有参数的情况下使用这个选项，安装程序会显示所有连接到该系统的存储设备，并提示您选择包含驱动程序更新的设备。 						

- Manual（手动）

  ​								手动指定到驱动程序更新镜像或 RPM 软件包的路径。您可以使用 `OEMDRV` 以外的任意标签指定本地存储设备，,或者可从安装系统访问的网络位置。在开始安装时指定 `inst.dd=location` 引导选项，其中 *location* 是驱动程序更新磁盘或者 ISO 镜像的路径。当您指定这个选项时，安装程序会尝试载入在指定位置找到的所有驱动程序更新。使用手动驱动程序更新，您可以指定本地存储设备或者网络位置（HTTP、HTTPS 或者 FTP 服务器）。 						

注意

- ​								您可以同时使用 `inst.dd=location` 和`inst.dd`，其中 *location* 是驱动程序更新磁盘或者 ISO 镜像的路径。在这种情况下，安装程序会尝试从位置载入所有可用的驱动程序更新，并提示您选择包含驱动程序更新的设备。 						
- ​								在从网络位置载入驱动程序更新 `ip= option` 时初始化网络。 						

**限制**

​						在启用了安全引导技术的 UEFI 系统中，必须使用有效证书为所有驱动程序签名。红帽驱动程序使用红帽的私钥签署，并由内核中对应的公钥验证。如果您载入了额外的独立驱动程序，请确认它们已进行了签名。 				

## 13.4. 准备驱动程序更新

​					这个步骤描述了如何在 CD 和 DVD 中准备驱动程序更新。 			

**先决条件**

- ​							您收到来自红帽、您的硬件零售商或者可信第三方零售商的驱动程序更新 ISO 镜像。 					
- ​							您将驱动程序更新 ISO 镜像刻录到 CD 或者 DVD 中。 					

警告

​						如果 CD 或者 DVD 中只有一个以 `.iso` 结尾的 ISO 镜像文件，则刻录过程将无法成功。有关如何将 ISO 镜像刻录到 CD 或者 DVD 的说明，请查看您的系统刻录软件文档。 				

**流程**

1. ​							将驱动程序更新 CD 或者 DVD 插入系统的 CD/DVD 驱动器中，并使用系统的文件管理器工具浏览。 					
2. ​							验证单个文件是否可用 `rhdd3`。`rhdd3` 是一个签名文件，它包含驱动程序描述和一个名为 `rpms` 的目录，它包含带有不同构架的实际驱动程序的 RPM 软件包。 					

## 13.5. 执行自动驱动程序更新

​					这个步骤描述了如何在安装过程中执行自动驱动程序更新。 			

**先决条件**

- ​							您已将驱动程序更新映像放在标准磁盘分区中（带有 `OEMDRV` 标签），或将 `OEMDRV` 驱动程序更新镜像刻录到 CD 或者 DVD 中。在驱动程序更新过程中可能无法访问高级存储，比如 RAID 或者 LVM 卷。 					
- ​							您已将块设备与 `OEMDRV` 卷标签连接到您的系统，或者在开始安装进程前将准备的 CD 或者 DVD 插入系统的 CD/DVD 驱动器中。 					

**流程**

1. ​							完成先决条件步骤后，安装程序启动时会自动载入这些驱动程序，并在安装过程中安装该系统。 					

## 13.6. 执行驱动程序更新

​					这个步骤描述了如何在安装过程中执行驱动程序更新。 			

**先决条件**

​						您已将没有 `OEMDRV` 卷标签的块设备连接到您的系统，并将驱动程序磁盘镜像复制到这个设备中，或者您已准备好驱动程序更新 CD 或者 DVD，并在开始安装进程前将其插入到系统的 CD/DVD 驱动器中。 				

注意

​						如果您将 ISO 镜像文件刻录到 CD 或者 DVD，但没有 `OEMDRV` 卷标签，则可以使用没有参数的 `inst.dd` 选项。安装程序提供从 CD 或者 DVD 中扫描和选择驱动程序的选项。在这种情况下，安装程序不会提示您选择驱动程序更新 ISO 镜像。另一个情况是使用带 `inst.dd=location` 引导选项的 CD 或者 DVD，这样安装程序就可以自动扫描 CD 或者 DVD 进行驱动程序更新。如需更多信息,请参阅 [第 13.7 节 “执行手动驱动程序更新”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#performing-a-manual-driver-update_updating-drivers-during-installation)。 				

**流程**

1. ​							在引导菜单窗口中按键盘中的 **Tab** 键显示引导命令行。 					

2. ​							在命令行中附加 `inst.dd` 引导选项并 按 **Enter** 执行引导过程。 					

3. ​							在菜单中选择本地磁盘分区或者 CD 或者 DVD 设备。安装程序扫描 ISO 文件或驱动程序更新 RPM 软件包。 					

4. ​							可选： 选择驱动程序更新 ISO 文件。 					

   注意

   ​								如果选择的设备或者分区包含驱动程序更新 RPM 软件包而不是 ISO 镜像文件（例如：包含驱动程序更新 CD 或者 DVD 的光驱），则不需要这一步。 						

5. ​							选择所需驱动程序。 					

   1. ​									使用键盘上的数字键切换驱动器选择。 							
   2. ​									按 **c** 键安装所选驱动程序。载入所选驱动程序并开始安装过程。 							

## 13.7. 执行手动驱动程序更新

​					这个步骤描述了如何在安装过程中手动驱动程序更新。 			

**先决条件**

- ​							将驱动程序更新 ISO 镜像文件放在 USB 闪存驱动器或者网页服务器中，并将其连接到您的计算机。 					

**流程**

1. ​							在引导菜单窗口中按键盘中的 **Tab** 键显示引导命令行。 					
2. ​							在命令行中附加 `inst.dd=location` 引导选项，其中 location 是驱动程序更新的路径。镜像文件通常位于网页服务器中，例如 [ http://server.example.com/dd.iso](http://server.example.com/dd.iso) 或在 USB 闪存驱动器中，如 `/dev/sdb1`。您还可以指定包含驱动程序更新的 RPM 软件包，例如 http://server.example.com/dd.rpm。 					
3. ​							按 **Enter** 执行引导过程。指定位置中的可用驱动程序会自动载入并启动安装过程。 					

**其它资源**

- ​							有关`inst.dd`引导选项的更多信息，请参阅上游 [inst.dd 引导选项](https://github.com/rhinstaller/anaconda/blob/rhel-8.0/docs/boot-options.rst/#instdd) 内容。 					
- ​							有关所有引导选项的更多信息，请参阅上游[引导选项](https://github.com/rhinstaller/anaconda/blob/rhel-8.0/docs/boot-options.rst/) 内容。 					

## 13.8. 禁用驱动程序

​					这个步骤描述了如何禁用发生故障的驱动程序。 			

**先决条件**

- ​							您已引导安装程序引导菜单。 					

**流程**

1. ​							在引导菜单中，按键盘中的 **Tab** 键显示引导命令行。 					

2. ​							在命令行中附加 `modprobe.blacklist=driver_name` 引导选项。 					

3. ​							使用您要禁用的驱动程序或驱动程序名称替换 *driver_name*，例如： 					

   ```
   modprobe.blacklist=ahci
   ```

   ​							使用 `modprobe.blacklist=` 引导选项禁用的驱动程序在安装的系统中会保持禁用状态，并出现在 `/etc/modprobe.d/anaconda-blacklist.conf` 文件中。 					

4. ​							按 **Enter** 执行引导过程。 					

## 第 14 章 准备使用 PXE 从网络安装

​				这部分论述了如何在 PXE 服务器中配置 TFTP 和 DHCP 来启用 PXE 引导和网络安装。 		

## 14.1. 网络安装概述

​					网络安装允许您将 Red Hat Enterprise Linux 安装到可访问安装服务器的系统。网络安装至少需要两个系统： 			

​					**PXE 服务器：** 运行 DHCP 服务器、TFTP 服务器和 HTTP、HTTPS、FTP 或者 NFS 服务器的系统。虽然每个服务器都可以在不同物理系统中运行，但本节中的步骤假设所有服务器都在一个系统中运行。 			

​					**Client:** 您要安装  Red Hat Enterprise Linux 的系统。安装开始后，客户端会查询 DHCP 服务器，从 TFTP 服务器接收引导文件，并从  HTTP、HTTPS、FTP 或 NFS 服务器下载安装镜像。与其它安装方法不同，客户端不需要任何物理引导介质来启动安装。 			

注意

​						要使用网络引导客户端，请在 BIOS/UEFI 或者快速引导菜单中进行配置。在某些硬件中，从网络引导的选项可能会被禁用，或者不可用。 				

​					以下是准备使用 PXE 从网络安装 Red Hat Enterprise Linux 的工作流步骤： 			

**步骤**

1. ​							将安装 ISO 镜像或者安装树导出到 NFS、HTTPS、HTTP 或者 FTP 服务器中。 					
2. ​							配置 TFTP 服务器和 DHCP 服务器，并在 PXE 服务器中启动 TFTP 服务。 					
3. ​							引导客户端并开始安装。 					

重要

​						GRUB2 引导装载程序除支持 TFTP 服务器外还支持从 HTTP 进行网络引导。发送引导文件，即内核和初始 RAM 磁盘 `vmlinuz` 和 `initrd`，使用这个协议可能很慢，并导致超时失败。HTTP 服务器不会有这个风险，但建议您在发送引导文件时使用 TFTP 服务器。 				

**其它资源**

- ​							要将安装 ISO 镜像导出到网络位置,请参阅 [第 6 章 *为 Kickstart 安装创建安装源*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#creating-installation-sources-for-kickstart-installations_installing-rhel-as-an-experienced-user)。 					
- ​							要配置 TFTP 服务器和 DHCP 服务器并启动 TFTP 服务,请参阅 [第 14.2 节 “为基于 BIOS 的客户端配置 TFTP 服务器”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#configuring-a-tftp-server-for-bios-based-clients_preparing-for-a-network-install)、[第 14.3 节 “为基于 UEFI 的客户端配置 TFTP 服务器”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#configuring-a-tftp-server-for-uefi-based-clients_preparing-for-a-network-install) 和 [第 14.4 节 “为 IBM Power 系统配置网络服务器”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#configuring-a-network-server-for-ibm-power_preparing-for-a-network-install)。 					
- ​							Red Hat Satellite 可以自动设置 PXE 服务器。如需更多信息，请参阅 Red Hat Satellite 产品文档。 	



=================================================

## 14.2. 为基于 BIOS 的客户端配置 TFTP 服务器

​					使用这个步骤配置 TFTP 服务器和 DHCP 服务器，并为基于 BIOS 的 AMD 和 Intel 64 位系统在 PXE 服务器中启动 TFTP 服务。 			

重要

​						本节中的所有配置文件都是示例。配置详情会根据架构和具体要求的不同而有所不同。 				

**流程**

1. ​							作为 root 用户安装以下软件包。如果您已在网络中配置了 DHCP 服务器，排除 `dhcp-server` 软件包： 					

   ```
   # yum install tftp-server dhcp-server
   ```

2. ​							允许到防火墙 `tftp service` 中的进入连接： 					

   ```
   # firewall-cmd --add-service=tftp
   ```

   注意

   - ​										这个命令启用了临时访问，直到下次服务器重启为止。要启用持久性访问，在该命令中添加 `--permanent` 选项。 								
   - ​										根据安装 ISO 文件的位置，您可能需要允许 HTTP 或者其他服务的进入连接。 								

3. ​							将您的 DHCP 服务器配置为使用 **SYSLINUX** 打包的引导镜像，如下例所示 `/etc/dhcp/dhcpd.conf`。请注意，如果您已经配置了 DHCP 服务器，在 DHCP 服务器中执行这个步骤。 					

   ```
   option space pxelinux;
   option pxelinux.magic code 208 = string;
   option pxelinux.configfile code 209 = text;
   option pxelinux.pathprefix code 210 = text;
   option pxelinux.reboottime code 211 = unsigned integer 32;
   option architecture-type code 93 = unsigned integer 16;
   
   subnet 10.0.0.0 netmask 255.255.255.0 {
   	option routers 10.0.0.254;
   	range 10.0.0.2 10.0.0.253;
   
   	class "pxeclients" {
   	  match if substring (option vendor-class-identifier, 0, 9) = "PXEClient";
   	  next-server 10.0.0.1;
   
   	  if option architecture-type = 00:07 {
   	    filename "uefi/shim.efi";
   	    } else {
   	    filename "pxelinux/pxelinux.0";
   	  }
   	}
   }
   ```

4. ​							访问位于 Binary DVD ISO 镜像文件中的 `SYSLINUX` 软件包中的 `pxelinux.0` 文件，其中 *my_local_directory* 是您创建的目录的名称： 					

   ```
   # mount -t iso9660 /path_to_image/name_of_image.iso /mount_point -o loop,ro
   ```

   ```
   # cp -pr /mount_point/BaseOS/Packages/syslinux-tftpboot-version-architecture.rpm /my_local_directory
   ```

   ```
   # umount /mount_point
   ```

5. ​							解压软件包： 					

   ```
   # rpm2cpio syslinux-tftpboot-version-architecture.rpm | cpio -dimv
   ```

6. ​							在 `tftpboot/` 目录中创建一个 `pxelinux/` 目录, 并将目录中的所有文件复制到 `pxelinux/` 目录中： 					

   ```
   # mkdir /var/lib/tftpboot/pxelinux
   ```

   ```
   # cp my_local_directory/tftpboot/* /var/lib/tftpboot/pxelinux
   ```

7. ​							在 `pxelinux/` 目录中创建 `pxelinux.cfg/` 目录： 					

   ```
   # mkdir /var/lib/tftpboot/pxelinux/pxelinux.cfg
   ```

8. ​							在 `pxelinux.cfg/` 目录中添加默认配置文件，如下例所示： 					

   ```
   default vesamenu.c32
   prompt 1
   timeout 600
   
   display boot.msg
   
   label linux
     menu label ^Install system
     menu default
     kernel images/RHEL-8.1/vmlinuz
     append initrd=images/RHEL-8.1/initrd.img ip=dhcp inst.repo=http://10.32.5.1/RHEL-8.1/x86_64/iso-contents-root/
   label vesa
     menu label Install system with ^basic video driver
     kernel images/RHEL-8.1/vmlinuz
     append initrd=images/RHEL-8.1/initrd.img ip=dhcp inst.xdriver=vesa nomodeset inst.repo=http://10.32.5.1/RHEL-8.1/x86_64/iso-contents-root/
   label rescue
     menu label ^Rescue installed system
     kernel images/RHEL-8.1/vmlinuz
     append initrd=images/RHEL-8.1/initrd.img rescue
   label local
     menu label Boot from ^local drive
     localboot 0xffff
   ```

   注意

   - ​										安装程序在没有运行时镜像的情况下无法引导。使用 `inst.stage2` 引导选项指定镜像的位置。另外，您可以使用 `inst.repo=` 选项指定镜像和安装源。 								
   - ​										与 `inst.repo` 一起使用的安装源位置必须包含一个有效的 `.treeinfo` 文件所。 								
   - ​										当您选择 RHEL8 安装 DVD 作为安装源时，该 `.treeinfo` 文件会指向 BaseOS 和 AppStream 软件仓库。您可以使用单个 `inst.repo` 选项来加载这两个软件仓库。 								

9. ​							创建一个子目录来将引导镜像文件保存在 `/var/lib/tftpboot/` 目录中，并将引导镜像文件复制到该目录中。在这个示例中，目录为 `/var/lib/tftpboot/pxelinux/images/RHEL-8.1/`: 					

   ```
   # mkdir -p /var/lib/tftpboot/pxelinux/images/RHEL-8.1/
   # cp /path_to_x86_64_images/pxeboot/{vmlinuz,initrd.img} /var/lib/tftpboot/pxelinux/images/RHEL-8.1/
   ```

10. ​							在 DHCP 服务器中启动并启用该 `dhcpd` 服务。如果您在 localhost 中配置了 DHCP 服务器，在本地主机中启动并启用 `dhcpd` 服务。 					

    ```
    # systemctl start dhcpd
    # systemctl enable dhcpd
    ```

11. ​							启动并启用 `tftp.socket` 服务： 					

    ```
    # systemctl start tftp.socket
    # systemctl enable tftp.socket
    ```

    ​							PXE 引导服务器现在可以提供 PXE 客户端。您可以启动客户端，即您要安装 Red Hat Enterprise Linux 的系统，在提示指定引导源时选择 **PXE 引导**，并启动网络安装。 					

## 14.3. 为基于 UEFI 的客户端配置 TFTP 服务器

​					使用这个流程配置 TFTP 服务器和 DHCP 服务器，并为基于 UEFI 的 AMD64、Intel 64 和 64 位 ARM 系统的 PXE 服务器启动 TFTP 服务。 			

重要

- ​								本节中的所有配置文件都是示例。配置详情会根据架构和具体要求的不同而有所不同。 						
- ​								Red Hat Enterprise Linux 8 UEFI PXE 引导支持基于 MAC 的 grub 菜单文件的小写文件格式。例如： grub2 的 MAC 地址文件格式是 `grub.cfg-01-aa-bb-cc-dd-ee-ff` 						

**流程**

1. ​							作为 root 用户安装以下软件包。如果您已在网络中配置了 DHCP 服务器，请排除 dhcp-server 软件包。 					

   ```
   # yum install tftp-server dhcp-server
   ```

2. ​							允许到防火墙 `tftp service` 中的进入连接： 					

   ```
   # firewall-cmd --add-service=tftp
   ```

   注意

   - ​										这个命令启用了临时访问，直到下次服务器重启为止。要启用持久性访问，在该命令中添加 `--permanent` 选项。 								
   - ​										根据安装 ISO 文件的位置，您可能需要允许 HTTP 或者其他服务的进入连接。 								

3. ​							将您的 DHCP 服务器配置为使用带有 **shim** 打包的引导镜像，如下例所示 `/etc/dhcp/dhcpd.conf`。请注意，如果您已经配置了 DHCP 服务器，在 DHCP 服务器中执行这个步骤。 					

   ```
   option space pxelinux;
   option pxelinux.magic code 208 = string;
   option pxelinux.configfile code 209 = text;
   option pxelinux.pathprefix code 210 = text;
   option pxelinux.reboottime code 211 = unsigned integer 32;
   option architecture-type code 93 = unsigned integer 16;
   
   subnet 10.0.0.0 netmask 255.255.255.0 {
   	option routers 10.0.0.254;
   	range 10.0.0.2 10.0.0.253;
   
   	class "pxeclients" {
   	  match if substring (option vendor-class-identifier, 0, 9) = "PXEClient";
   	  next-server 10.0.0.1;
   
   	  if option architecture-type = 00:07 {
   	    filename "BOOTX64.efi";
   	  } else {
   	    filename "pxelinux/pxelinux.0";
   		}
     }
   }
   ```

4. ​							从 `shim` 软件包 `BOOTX64.efi` 中访问该 `grubx64.efi` 文件，从 Binary DVD ISO 镜像文件中的 `grub2-efi` 软件包访问该文件，其中 *my_local_directory* 是您创建的目录的名称： 					

   ```
   # mount -t iso9660 /path_to_image/name_of_image.iso /mount_point -o loop,ro
   ```

   ```
   # cp -pr /mount_point/BaseOS/Packages/shim-version-architecture.rpm /my_local_directory
   ```

   ```
   # cp -pr /mount_point/BaseOS/Packages/grub2-efi-version-architecture.rpm /my_local_directory
   ```

   ```
   # umount /mount_point
   ```

5. ​							解压软件包： 					

   ```
   # rpm2cpio shim-version-architecture.rpm | cpio -dimv
   ```

   ```
   # rpm2cpio grub2-efi-version-architecture.rpm | cpio -dimv
   ```

6. ​							从您的引导目录中复制 EFI 引导镜像。用 shim 或 grub 替换 *ARCH*，后接构架，例如 `grubx64`: 					

   ```
   # cp my_local_directory/boot/efi/EFI/redhat/ARCH.efi /var/lib/tftpboot/uefi/
   ```

   ```
   # cp my_local_directory/boot/efi/EFI/redhat/ARCH.efi /var/lib/tftpboot/uefi
   ```

7. ​							在 `tftpboot/` 目录中添加名为 `grub.cfg` 的配置文件，如下例所示： 					

   ```
   set timeout=60
   menuentry 'RHEL 8' {
     linuxefi images/RHEL-8.1/vmlinuz ip=dhcp inst.repo=http://10.32.5.1/RHEL-8.1/x86_64/iso-contents-root/
     initrdefi images/RHEL-8.1/initrd.img
   }
   ```

   注意

   - ​										安装程序在没有运行时镜像的情况下无法引导。使用 `inst.stage2` 引导选项指定镜像的位置。另外，您可以使用 `inst.repo=` 选项指定镜像和安装源。 								
   - ​										与 `inst.repo` 一起使用的安装源位置必须包含一个有效的 `.treeinfo` 文件所。 								
   - ​										当您选择 RHEL8 安装 DVD 作为安装源时，该 `.treeinfo` 文件会指向 BaseOS 和 AppStream 软件仓库。您可以使用单个 `inst.repo` 选项来加载这两个软件仓库。 								

8. ​							创建一个子目录来将引导镜像文件保存在 `/var/lib/tftpboot/` 目录中，并将引导镜像文件复制到该目录中。在这个示例中，目录为 `/var/lib/tftpboot/images/RHEL-8.1/`: 					

   ```
   # mkdir -p /var/lib/tftpboot/images/RHEL-8.1/
   # cp /path_to_x86_64_images/pxeboot/{vmlinuz,initrd.img} /var/lib/tftpboot/images/RHEL-8.1/
   ```

9. ​							在 DHCP 服务器中启动并启用该 `dhcpd` 服务。如果您在 localhost 中配置了 DHCP 服务器，在本地主机中启动并启用 `dhcpd` 服务。 					

   ```
   # systemctl start dhcpd
   # systemctl enable dhcpd
   ```

10. ​							启动并启用 `tftp.socket` 服务： 					

    ```
    # systemctl start tftp.socket
    # systemctl enable tftp.socket
    ```

    ​							PXE 引导服务器现在可以提供 PXE 客户端。您可以启动客户端，即您要安装 Red Hat Enterprise Linux 的系统，在提示指定引导源时选择 **PXE 引导**，并启动网络安装。 					

**其它资源**

- ​							有关 `shim` 的更多信息，请参阅上游文档： [使用 Shim Program](https://www.rodsbooks.com/efi-bootloaders/secureboot.html#shim)。 					

## 14.4. 为 IBM Power 系统配置网络服务器

​					使用 GRUB2 为 IBM Power 系统配置网络引导服务器。 			

重要

​						本节中的所有配置文件都是示例。配置详情会根据架构和具体要求的不同而有所不同。 				

**流程**

1. ​							作为 root 用户安装以下软件包。如果您已在网络中配置了 DHCP 服务器，请排除 dhcp-server 软件包。 					

   ```
   # yum install tftp-server dhcp-server
   ```

2. ​							允许到防火墙 `tftp service` 中的进入连接： 					

   ```
   # firewall-cmd --add-service=tftp
   ```

   注意

   - ​										这个命令启用了临时访问，直到下次服务器重启为止。要启用持久性访问，在该命令中添加 `--permanent` 选项。 								
   - ​										根据安装 ISO 文件的位置，您可能需要允许 HTTP 或者其他服务的进入连接。 								

3. ​							在 tftp root 中创建 `GRUB2` 网络引导目录： 					

   ```
   # grub2-mknetdir --net-directory=/var/lib/tftpboot
   Netboot directory for powerpc-ieee1275 created. Configure your DHCP server to point to /boot/grub2/powerpc-ieee1275/core.elf
   ```

   注意

   ​								命令输出会告诉您 DHCP 配置中需要配置的文件名，如下所述。 						

   1. ​									如果 PXE 服务器在 x86 机器中运行，则 `grub2-ppc64-modules` 必须在 tftp root 中创建 `GRUB2` 网络引导目录前安装它： 							

      ```
      # yum install grub2-ppc64-modules
      ```

4. ​							创建一个 `GRUB2` 配置文件 `/var/lib/tftpboot/boot/grub2/grub.cfg` ,如下例所示： 					

   ```
   set default=0
   set timeout=5
   
   echo -e "\nWelcome to the Red Hat Enterprise Linux 8 installer!\n\n"
   
   menuentry 'Red Hat Enterprise Linux 8' {
     linux grub2-ppc64/vmlinuz ro ip=dhcp inst.repo=http://10.32.5.1/RHEL-8.1/x86_64/iso-contents-root/
     initrd grub2-ppc64/initrd.img
   }
   ```

   注意

   - ​										安装程序在没有运行时镜像的情况下无法引导。使用 `inst.stage2` 引导选项指定镜像的位置。另外，您可以使用 `inst.repo=` 选项指定镜像和安装源。 								
   - ​										与 `inst.repo` 一起使用的安装源位置必须包含一个有效的 `.treeinfo` 文件所。 								
   - ​										当您选择 RHEL8 安装 DVD 作为安装源时，该 `.treeinfo` 文件会指向 BaseOS 和 AppStream 软件仓库。您可以使用单个 `inst.repo` 选项来加载这两个软件仓库。 								

5. ​							使用以下命令挂载二进制 DVD ISO 镜像： 					

   ```
   # mount -t iso9660 /path_to_image/name_of_iso/ /mount_point -o loop,ro
   ```

6. ​							创建目录并将 `initrd.img` `vmlinuz` Binary DVD ISO 镜像复制到其中，例如： 					

   ```
   # cp /mount_point/ppc/ppc64/{initrd.img,vmlinuz} /var/lib/tftpboot/grub2-ppc64/
   ```

7. ​							将您的 DHCP 服务器配置为使用打包的引导镜像 `GRUB2`，如下例所示。请注意，如果您已经配置了 DHCP 服务器，在 DHCP 服务器中执行这个步骤。 					

   ```
   subnet 192.168.0.1 netmask 255.255.255.0 {
     allow bootp;
     option routers 192.168.0.5;
     group { #BOOTP POWER clients
       filename "boot/grub2/powerpc-ieee1275/core.elf";
       host client1 {
       hardware ethernet 01:23:45:67:89:ab;
       fixed-address 192.168.0.112;
       }
     }
   }
   ```

8. ​							调整样本参数 `subnet`, `netmask`、`routers`、`fixed-address` 和 `hardware ethernet` 来适合于您的网络配置。记录 `file name` 参数 ; 这是 `grub2-mknetdir` 命令在此流程前面输出的文件名。 					

9. ​							在 DHCP 服务器中启动并启用该 `dhcpd` 服务。如果您在 localhost 中配置了 DHCP 服务器，在本地主机中启动并启用 `dhcpd` 服务。 					

   ```
   # systemctl start dhcpd
   # systemctl enable dhcpd
   ```

10. ​							启动并启用 `tftp.socket` 服务： 					

    ```
    # systemctl start tftp.socket
    # systemctl enable tftp.socket
    ```

    ​							PXE 引导服务器现在可以提供 PXE 客户端。您可以启动客户端，即您要安装 Red Hat Enterprise Linux 的系统，在提示指定引导源时选择 **PXE 引导**，并启动网络安装。 					

## 第 15 章 创建远程仓库

​				按照以下步骤，使用包含 Binary DVD ISO 镜像内容的远程仓库为基于网络的安装创建安装源。可通过 HTTP 或 HTTPS 访问该安装源。 		

**先决条件**

- ​						Red Hat Enterprise Linux 8 安装 DVD/ISO 镜像 				
- ​						多个运行 Red Hat Enterprise Linux 的服务器 				

## 15.1. 在 RHEL 上安装 Apache

​					这个过程将帮助您在 Red Hat Enterprise Linux 8 中安装 Apache。 			

**先决条件**

- ​							访问带有 Apache webserver 的仓库 					

**流程**

1. ​							安装 httpd 软件包 					

   ```
   # yum install httpd
   ```

2. ​							运行，然后启用 Apache webserver。这些命令也会在重启后启动 webserver。 					

   ```
   # systemctl enable httpd
   # systemctl start httpd
   ```

3. ​							插入任何您可能拥有的网页文件。 					

   ```
   # echo Apache on RHEL 8 > /var/www/html/index.html
   ```

4. ​							更新防火墙。 					

   ```
   # firewall-cmd --add-service=http --permanent
   # firewall-cmd --add-service=http
   ```

5. ​							访问网站。 					

   ```
   http://<the-apache-ip-address>
   
   http://<the-apache-hostname>
   ```

## 15.2. 创建远程仓库

​					多个 Red Hat Enterprise Linux 服务器可访问该网络中的单一 Red Hat Enterprise Linux 程序库。这需要一个正在运行的网页服务器，最有可能是 Apache。 			

**先决条件**

- ​							Red Hat Enterprise Linux 8 安装 DVD 					
- ​							多个运行 Red Hat Enterprise Linux 的服务器 					

**流程**

1. ​							挂载并复制下载的 DVD 的内容。 					

   ```
   mkdir /mnt/rhel8
   mount -o loop,ro rhel-8.1-x86_64-dvd.iso /mnt/rhel8/
   cp -r /mnt/rhel8/ /var/www/html/
   umount  /mnt/rhel8
   ```

   ​							下一步是在客户端执行，而不是在安装了 Apache 的服务器中执行。 					

2. ​							为 BaseOS 和 AppStream 软件仓库创建一个 repo 文件。 					

   ```
   vi /etc/yum.repos.d/rhel_http_repo.repo
   
   [BaseOS_repo_http]
   name=RHEL_8.0_x86_64_HTTP BaseOS
   baseurl="http://myhost/rhel8/BaseOS"
   gpgcheck=1
   gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
   
   [AppStream_repo_http]
   name=RHEL_8.0_x86_64_HTTP AppStream
   baseurl="http://myhost/rhel8/AppStream"
   gpgcheck=1
   gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
   
   [root@localhost ~]# yum repolist
   Updating Subscription Management repositories.
   Unable to read consumer identity
   This system is not registered to Red Hat Subscription Management. You can use subscription-manager to register.
   Last metadata expiration check: 0:08:33 ago on Út 23. července 2019, 16:48:09 CEST.
   repo id                                                              repo name                                                                        status
   AppStream_repo_http                                                  RHEL_8.0_x86_64_HTTP AppStream                                                   4,672
   BaseOS_repo_http                                                     RHEL_8.0_x86_64_HTTP BaseOS                                                      1,658
   [root@localhost ~]#
   ```

## 第 16 章 引导选项

​				本节介绍可以用来修改安装程序默认行为的一些引导选项。有关引导选项的完整列表，请查看 [上游引导选项](https://github.com/rhinstaller/anaconda/blob/rhel-8.0/docs/boot-options.rst) 内容。 		

## 16.1. 引导选项类型

​					有两种引导选项： 带有 "=" 和没有带有 "=" 。引导选项会附加到引导命令行中，而且多个选项必须以单一空格分开。安装程序专用的引导选项总是以 `inst` 开始 。 			

- 带有 "=" 的选项

  ​								您必须为使用该 `=` 符号的引导选项指定一个值。例如，该 `inst.vncpassword=` 选项必须包含一个值，在本例中是一个密码。这个示例的正确语法是 `inst.vncpassword=password`。 						

- 没有 "=" 的选项

  ​								该引导选项不接受任何值或参数。例如：该 `rd.live.check` 选项强制安装程序在开始安装前验证安装介质。如果使用了这个选项，则执行验证; 如果没有使用这个选项，则会跳过验证。 						

## 16.2. 编辑引导选项

​					本节介绍您从引导菜单中编辑引导选项的不同方法。引导菜单在您引导安装介质后打开。 			

#### 编辑 BIOS 中的 boot: 提示符

​					使用 `boot:` 提示符时，第一个选项必须总是指定您要载入的安装程序镜像文件。在大多数情况下，您可以使用关键字来指定镜像。您可以根据要求指定附加选项。 			

**先决条件**

- ​							已创建了可引导安装介质（USB、CD 或者 DVD）。 					
- ​							已使用该介质引导安装，并打开了安装引导菜单。 					

**流程**

1. ​							打开引导菜单后，按键盘上的 **Esc** 键。 					
2. ​							`boot:` 提示现在可以访问。 					
3. ​							按 **Tab** 键显示帮助命令。 					
4. ​							按 **Enter** 键启动安装。要从提示符 `boot:` 返回到引导菜单，请重启系统并再次从安装介质引导。 					

注意

​						`boot:` 提示也接受 `dracut` 内核选项。`dracut.cmdline(7)` man page 中包括了选项列表。 				

#### 编辑 > 提示符

​					您可以使用 `>` 提示编辑预定义的引导选项。例如： 在引导菜单中选择 **Test this media and install Red Hat Enterprise Linux 8.1** 来显示完整的选项。 			

注意

​						这个过程用于使用 BIOS 的 AMD64 和 Intel 64 系统。 				

**先决条件**

- ​							已创建了可引导安装介质（USB、CD 或者 DVD）。 					
- ​							已使用该介质引导安装，并打开了安装引导菜单。 					

**流程**

1. ​							在引导菜单中选择一个选项，然后按键盘上的 **Tab** 键。可访问该 `>` 提示符并显示可用选项。 					
2. ​							在提示符后附加您需要的选项 `>`。 					
3. ​							按 **Enter** 键开始安装。 					
4. ​							按 **Esc** 键取消编辑并返回引导菜单。 					

#### 编辑 GRUB2 菜单

​					基于 UEFI 的 AMD64、Intel 64 和 64 位 ARM 系统上有 GRUB2 菜单。 			

**先决条件**

- ​							已创建了可引导安装介质（USB、CD 或者 DVD）。 					
- ​							已使用该介质引导安装，并打开了安装引导菜单。 					

**流程**

1. ​							在引导菜单窗口中选择所需选项，然后在键盘中按 **e** 键。 					
2. ​							移动光标到内核命令行。在 UEFI 系统中，内核命令行以 `linuxefi` 开始。 					
3. ​							将光标移动到 `linuxefi` 内核命令行的末尾。 					
4. ​							根据需要编辑参数。例如：要配置一个或多个网络接口，在 `linuxefi` 内核命令行末尾添加 `ip=` 参数，后接所需的值。 					
5. ​							完成编辑后，按组合键 **Ctrl**+**X** 启动安装。 					

## 16.3. 安装源引导选项

​					这部分包含有关各种安装源引导选项的信息。 			

- inst.repo=

  ​								`inst.repo=` 引导选项指定安装源，即提供软件包程序库的位置以及一个有效的描述它们的 `.treeinfo` 文件。例如： `inst.repo=cdrom`。该 `inst.repo=` 选项的目标必须是以下安装介质之一： 						 									一个可安装树，它是一个目录结构，其中包含安装程序镜像、软件包和存储库数据的目录结构，以及有效 `.treeinfo` 文件。 								 									一个 DVD（系统 DVD 驱动器中有物理磁盘） 								 									一个 Red Hat Enterprise Linux 安装 DVD 的 ISO 镜像，它可以位于一个硬盘中，或在一个可以被访问到的网络位置。 								 									使用 `inst.repo=` 引导选项使用不同的格式配置不同的安装方法。下表包含 `inst.repo=` 引导选项语法的详情： 								**表 16.1. inst.repo= installation source boot options**源类型引导选项格式源格式  													CD/DVD 驱动器 												 												   													`inst.repo=cdrom:*<device>*` 												 												   													将 DVD 作为物理磁盘安装。[[a\]](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#ftn.idm140200005630816) 												 												   													可安装的树 												 												   													`inst.repo=hd:*<device>*:/*<path>*` 												 												   													DVD 或安装树的镜像文件，这是安装 DVD 中的目录和文件的完整副本。 												 												   													NFS 服务器 												 												   													`inst.repo=nfs:[*options*:]*<server>*:/*<path>*` 												 												   													DVD 或安装树的镜像文件，这是安装 DVD 中的目录和文件的完整副本。[[b\]](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#ftn.idm140200004732624) 												 												   													HTTP 服务器 												 												   													`inst.repo=http://*<host>*/*<path>*` 												 												   													安装树，这是安装 DVD 中的目录和文件的完整副本。 												 												   													HTTPS 服务器 												 												   													`inst.repo=https://*<host>*/*<path>*` 												 												   													FTP 服务器 												 												   													`inst.repo=ftp://*<username>*:*<password>*@*<host>*/*<path>*` 												 												   													HMC 												 												   													`inst.repo=hmc` 												 												  [[a\] ](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#idm140200005630816) 														如果*禁用*了设备，安装程序会自动搜索包含安装 DVD 的驱动器。 													[[b\] ](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#idm140200004732624) 														NFS 服务器选项默认使用 NFS 协议版本 3。要使用不同的版本，把 `nfsvers=*X*` 添加到 *选项*，用您要使用的版本号替换 *X*。 													 									使用以下格式设定磁盘设备名称： 								 									内核设备名称，例如 `/dev/sda1` : `sdb2` 								 									文件系统标签，例如 `LABEL=Flash` 或 `LABEL=RHEL8` 								 									文件系统 UUID，例如 `UUID=8176c7bf-04ff-403a-a832-9557f94e61db` 								 									非字母数字的字符必须使用 `\xNN`，其中 *NN* 是代表字符的十六进制值。例如, `\x20` 是一个空格 `(" ")`。 								

- inst.addrepo=

  ​								使用 `inst.addrepo=` 引导选项添加可用作另一个安装源的附加程序库以及主仓库（`inst.repo=`）。在一次引导中，您可以多次使用 `inst.addrepo=` 引导选项。下表包含 `inst.addrepo=` 引导选项语法的详情。 						注意 								`REPO_NAME` 是仓库的名称，它是安装过程所需要的。这些软件仓库仅在安装过程中使用，它们不会在安装的系统中安装。 							**表 16.2. inst.addrepo 安装源引导选项**安装源引导选项格式附加信息  											在 URL 中可安装的树 										 										   											`inst.addrepo=REPO_NAME,[http,https,ftp]://*<host>*/*<path>*` 										 										   											在给定 URL 中查找可安装的树。 										 										   											NFS 路径中的可安装树 										 										   											`inst.addrepo=REPO_NAME,nfs://*<server>*:/*<path>*` 										 										   											在给定的 NFS 路径中查找可安装的树。主机后需要一个冒号。安装程序将 `nfs://` 后的所有内容直接传递给 mount 命令，而不是根据 RFC 2224 解析 URL。 										 										   											安装环境中的可安装树 										 										   											`inst.addrepo=REPO_NAME,file://*<path>*` 										 										   											在安装环境中的给定位置查找可安装的树。要使用这个选项，必须在安装程序尝试载入可用软件组前挂载该程序库。这个选项的好处是，您可以在一个可引导 ISO 上有多个库，您还可以从 ISO 安装主存储库和其他软件仓库。到额外软件仓库的路径为 `/run/install/source/REPO_ISO_PATH`。另外，您可以在 Kickstart 文件的 `%pre` 小节中挂载仓库目录。该路径必须是绝对路径，且以 `/` 开始，例如： `inst.addrepo=REPO_NAME,file:///*<path>*` 										 										   											硬盘驱动器 										 										   											`inst.addrepo=REPO_NAME,hd:*<device>*:*<path>*` 										 										   											挂载给定的 *<device>* 分区并从由 *<path>* 指定的 ISO 中安装。如果没有指定 *<path>*，安装程序会在 *<device>* 中查找有效安装 ISO。这个安装方法需要一个含有有效可安装树的 ISO。 										 										 

- inst.stage2=

  ​								使用 `inst.stage2=` 引导选项指定安装程序运行时镜像的位置。这个选项需要包含有效 `.treeinfo` 文件的目录的路径。运行时镜像的位置从文件 `.treeinfo` 中读取。如果这个 `.treeinfo` 文件不可用，安装程序会尝试从 `images/install.img` 载入镜像。 						 							如果没有指定该 `inst.stage2` 选项，安装程序会尝试使用 `inst.repo` 选项指定的位置。 						 							仅在使用 PXE 引导方法时使用这个选项。安装 DVD 和引导 ISO 已经包含正确的 `inst.stage2` 选项来引导安装程序。 						注意 								默认情况下，安装介质中使用 `inst.stage2=` 引导选项，并被设置为具体标签，例如： `inst.stage2=hd:LABEL=RHEL-8-0-0-BaseOS-x86_64`如果您修改包含该运行时镜像的文件系统默认标签，或者使用自定义流程引导安装系统，则必须验证 `inst.stage2=` 引导选项是否已被设置为正确的值。 							

- inst.noverifyssl

  ​								使用 `inst.noverifyssl` 引导选项可防止安装程序为所有 HTTPS 连接验证 SSL 证书，但附加 Kickstart 程序库除外，其中 `--noverifyssl` 可为每个程序库设置。 						 							例如：如果您的远程安装源使用自签名 SSL 证书，则该 `inst.noverifyssl` 引导选项可让安装程序在不验证 SSL 证书的情况下完成安装。 						**指定源时使用 `inst.stage2=` 示例** 								 `inst.stage2=https://hostname/path_to_install_image/ inst.noverifyssl` 								**指定源时使用 `inst.repo=` 示例** 								 `inst.repo=https://hostname/path_to_install_repository/ inst.noverifyssl` 								

- inst.stage2.all

  ​								`inst.stage2.all` 引导选项是用来指定 HTTP、HTTPS 或者 FTP 源。您可以多次使用 `inst.stage2=` 引导选项，同时使用 `inst.stage2.all` 选项从源顺序获取镜像，直到成功为止。例如： 						`inst.stage2.all inst.stage2=http://hostname1/path_to_install_tree/ inst.stage2=http://hostname2/path_to_install_tree/ inst.stage2=http://hostname3/path_to_install_tree/`

- inst.dd=

  ​								`inst.dd=` 引导选项在安装过程中执行驱动程序更新。有关如何在安装过程中更新驱动程序的更多信息，请参阅 [*执行高级 RHEL 安装*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index/) 文档。 						

- inst.repo=hmc

  ​								当使用二进制 DVD 引导时，安装程序会提示您输入附加内核参数。要将 DVD 设为安装源，请在内核参数中附加 `inst.repo=hmc` 选项。然后安装程序将启用 `SE` 和 `HMC` 文件访问，从 DVD 中获取 stage2 镜像，并提供对 DVD 中软件包的访问以供软件选择。这个选项消除了外部网络设置的要求并扩展安装选项。 						

- inst.proxy=

  ​								使用 HTTP、HTTPS 和 FTP 协议执行安装时使用 `inst.proxy=` 引导选项。例如： 						`[PROTOCOL://][USERNAME[:PASSWORD]@]HOST[:PORT]`

- inst.nosave=

  ​								使用 `inst.nosave=` 引导选项控制安装日志以及没有保存到安装的系统中的相关文件，例如 `input_ks`、`output_ks`、`logs` 和 `all_ks` `all`。可将多个值合并为一个用逗号分开的列表，例如： `input_ks,logs` 						注意 								该 `inst.nosave` 引导选项是用来排除安装系统中无法被 Kickstart %post 脚本删除的文件，如日志和输入/输出 Kickstart 结果。 							**表 16.3. inst.nosave boot options**选项描述  											input_ks 										 										   											禁用保存输入 Kickstart 结果的功能。 										 										   											output_ks 										 										   											禁用保存安装程序生成的 Kickstart 结果的功能。 										 										   											all_ks 										 										   											禁用保存输入和输出 Kickstart 结果的功能。 										 										   											日志 										 										   											禁用保存所有安装日志的功能。 										 										   											all 										 										   											禁用保存所有 Kickstart 结果以及所有日志的功能。 										 										 

- inst.multilib

  ​								使用 `inst.multilib` 引导选项将 DNF 的 `multilib_policy` 设置为 **all**，而不是 **best**。 						

- inst.memcheck

  ​								`inst.memcheck` 引导选项执行检查来确定系统有足够 RAM 来完成安装。如果没有足够 RAM，则会停止安装过程。系统检查不是完全准确的，在安装过程中的内存用量要根据软件包的选择、用户界面（如图形或文本）和其它参数而定。 						

- inst.nomemcheck

  ​								`inst.nomemcheck` 引导选项不会执行检查来验证系统是否有足够 RAM 来完成安装。在低于推荐最小内存量的系统中进行安装不被支持，并可能导致安装过程失败。 						

## 16.4. 网络引导选项

​					这部分包含关于常用网络引导选项的信息。 			

注意

​						初始网络初始化是由 `dracut` 处理的。有关完整列表，请查看 `dracut.cmdline(7)` man page。 				

- ip=

  ​								使用 `ip=` 引导选项配置一个或多个网络接口。要配置多个接口，您可以多次使用 `ip` 选项，每个接口都必须使用 `rd.neednet=1` 选项，且您必须使用 `bootdev` 选项指定主引导接口。另外，您可以使用一次 `ip` 选项，然后使用 Kickstart 设置其他接口。这个选项接受几种不同的格式。下表包含大多数常用选项的信息。 						注意 								在以下表格中： 							 										`ip` 参数指定客户端 IP 地址，需要方括号，例如 [ 2001:db8::99]。 									 										`gateway` 参数是默认网关。IPv6 地址也被接受。 									 										`netmask` 参数是要使用的子网掩码。这可以是完整子网掩码（例如： 255.255.255.0），或是一个前缀（例如 64）。 									 										`hostname` 参数是客户端系统的主机名。这个参数是可选的。 									**表 16.4. 网络接口配置引导选项格式**配置方法引导选项格式  											自动配置任意接口 										 										   											`ip=*method*` 										 										   											自动配置特定的接口 										 										   											`ip=*interface:method*` 										 										   											静态配置 										 										   											`ip=*ip::gateway:netmask:hostname:interface*:none` 										 										   											自动配置特定接口并进行覆盖 										 										   											`ip=*ip::gateway:netmask:hostname:interface:method:mtu*` 										 										 注意 								`automatic configuration of a specific interface with an override` 方法使用指定的自动配置方法启动接口，比如 `dhcp`，但会覆盖自动获得的 IP 地址 、网关、子网掩码、主机名或其他指定参数。所有参数都是可选的，因此仅指定您要覆盖的参数。 							 							`method` 参数可以是以下任意一种： 						**表 16.5. 自动接口配置方法**自动配置方法Value  											DHCP 										 										   											`dhcp` 										 										   											IPv6 DHCP 										 										   											`dhcp6` 										 										   											IPv6 自动配置 										 										   											`auto6` 										 										   											iSCSI Boot Firmware Table (iBFT) 										 										   											`ibft` 										 										 注意 										如果您使用需要网络访问的引导选项 `inst.ks=http://host/path`，比如在没有指定 ip 选项的情况下，安装程序将使用 `ip=dhcp`。 									 										要自动连接到 iSCSI 目标，您必须激活网络设备以便访问该目标。激活网络的建议方法是使用 `ip=ibft` 引导选项。 									

- nameserver=

  ​								`nameserver=` 选项指定名称服务器的地址。您可以多次使用这个选项。 						注意 								`ip=` 参数需要方括号。但是 IPv6 地址不能使用方括号。IPv6 地址使用的正确语法示例如下 `nameserver=2001:db8::1`。 							

- bootdev=

  ​								`bootdev=` 选项指定引导接口。如果您使用多个选项，这个 `ip` 选项是必须的。 						

- ifname=

  ​								这些 `ifname=` 选项会为带有给定 MAC 地址的网络设备分配接口名称。您可以多次使用这个选项。语法是 `ifname=interface:MAC`。例如： 						`ifname=eth0:01:23:45:67:89:ab`注意 								该 `ifname=` 选项是在安装过程中设置自定义网络接口的唯一方法。 							

- inst.dhcpclass=

  ​								该 `inst.dhcpclass=` 选项指定 DHCP 厂商类别识别符。`dhcpd` 服务将此值视为 `vendor-class-identifier`。默认值为 `anaconda-$(uname -srm)`。 						

- inst.waitfornet=

  ​								使用 `inst.waitfornet=SECONDS` 引导选项可让安装系统在安装前等待网络连接。参数中给出的 `SECONDS` 值指定了在超时和继续安装过程（即使没有网络连接）前等待网络连接的最长时间。 						

**其它资源**

- ​							有关联网的更多信息，请参阅[*配置和管理联网文档*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_networking/index/)。 					

## 16.5. 控制台引导选项

​					本节介绍如何为您的控制台配置引导选项、显示器显示和键盘。 			

- console=

  ​								使用 `console=` 选项指定您要用作主控制台的设备。例如，要使用第一个串口上的控制台，请使用 `console=ttyS0`。这个选项和这个 `inst.text` 选项一起使用。您可以多次使用该 `console=` 选项。如果您这样做，则会在所有指定的控制台中显示引导信息,但安装程序将只使用最后一个控制台。例如，如果指定 `console=ttyS0 console=ttyS1`，安装程序将使用 `ttyS1`。 						

- inst.lang=

  ​								使用 `inst.lang=` 选项设定您要在安装过程中使用的语言。`locale -a | grep _` 或者 `localectl list-locales | grep _` 命令返回区域列表。 						

- inst.singlelang

  ​								使用 `inst.singlelang` 这个选项以单一语言模式安装，这将导致安装语言和语言支持配置没有可用的互动选项。如果使用 `inst.lang` 引导选项或者 `lang` Kickstart 命令指定语言，则会使用它。如果没有指定语言，安装程序会默认使用 `en_US.UTF-8`。 						

- inst.geoloc=

  ​								使用 `inst.geoloc=` 这个选项在安装程序中配置地理位置的使用。地理位置用于预设语言和时区，并使用以下语法： `inst.geoloc=value``value` 可以是以下参数： 						**表 16.6. inst.geoloc 引导选项的值**Value引导选项格式  											禁用地理位置 										 										   											`inst.geoloc=0` 										 										   											使用 Fedora geoip API 										 										   											`inst.geoloc=provider_fedora_geoip` 										 										   											使用 Hostip.info GeoIP API 										 										   											`inst.geoloc=provider_hostip` 										 										  							如果您没有指定 `inst.geoloc=` 选项，安装程序将使用 `provider_fedora_geoip`。 						

- inst.keymap=

  ​								使用 `inst.keymap=` 选项指定您要用来安装的键盘布局。 						

- inst.cmdline

  ​								使用 `inst.cmdline` 选项强制安装程序在命令行模式下运行。这个模式不允许任何互动，且您必须在 Kickstart 文件或者命令行中指定所有选项。 						

- inst.graphical

  ​								使用 `inst.graphical` 选项强制安装程序在图形模式下运行。这个模式是默认的模式。 						

- inst.text

  ​								使用 `inst.text` 选项强制安装程序在文本模式而不是图形模式下运行。 						

- inst.noninteractive

  ​								使用 `inst.noninteractive` 引导选项以非互动模式运行安装程序。在非互动模式中不允许用户互动，`inst.noninteractive` 可用于图形或文本安装。当在文本模式中使用这个 `inst.noninteractive` 选项时，它的行为与 `inst.cmdline` 选项相同。 						

- inst.resolution=

  ​								使用 `inst.resolution=` 选项指定图形模式中的页面分辨率。格式为 `NxM`，其中 *N* 是屏幕宽度， *M* 是页面高度（单位为像素）。最低分辨率为 1024x768。 						

- inst.vnc

  ​								使用 `inst.vnc` 选项使用 VNC 运行图形安装。您必须使用 VNC 客户端应用程序与安装程序交互。启用 VNC 共享时，可以连接多个客户端。在文本模式中安装使用 VNC 启动的系统。 						

- inst.vncpassword=

  ​								使用 `inst.vncpassword=` 选项设定安装程序使用的 VNC 服务器中的密码。 						

- inst.vncconnect=

  ​								使用 `inst.vncconnect=` 选项连接到给定主机位置侦听的 VNC 客户端。例如, `inst.vncconnect=<host>[:<port>]` 默认端口为 5900。这个选项可以与 `vncviewer -listen` 一起使用。 						

- inst.xdriver=

  ​								使用 `inst.xdriver=` 选项指定您要在安装过程中和安装的系统中使用的 X 驱动程序名称。 						

- inst.usefbx

  ​								使用 `inst.usefbx` 选项提示安装程序使用帧缓冲 X 驱动程序，而不是具体硬件驱动程序。这个选项等同于 `inst.xdriver=fbdev`。 						

- modprobe.blacklist=

  ​								使用 `modprobe.blacklist=` 选项阻止或完全禁用一个或多个驱动程序。在安装开始后，使用这个选项禁用的驱动（模式）不会被加载，在安装完成后，安装的系统还会保留这些设置。您可以在 `/etc/modprobe.d/` 目录中找到列出块驱动程序列表。使用以逗号分隔的列表禁用多个驱动程序。例如： 						`modprobe.blacklist=ahci,firewire_ohci`

- inst.xtimeout=

  ​								使用 `inst.xtimeout=` 选项指定启动 X 服务器的超时时间（以秒为单位）。 						

- inst.sshd

  ​								在安装过程中使用 `inst.sshd` 选项启动 `sshd` 服务，以便您可以在安装过程中使用 SSH 连接到该系统，并监控安装进程。有关 SSH 的详情请参考 `ssh(1)` man page。默认情况下，该 `sshd` 选项只在 IBM Z 构架中自动启动。在其它构架中，除非您使用 `inst.sshd` 选项，否则`sshd` 不会启动。 						注意 								在安装过程中，root 帐户默认没有密码。您可在安装过程中使用 `sshpw` Kickstart 命令设定 root 密码。 							

- inst.kdump_addon=

  ​								使用 `inst.kdump_addon=` 选项启用或禁用安装程序中的 Kdump 配置页面（附加组件）。这个页面会默认启用；可以使用 `inst.kdump_addon=off` 来禁用它。禁用该附加组件可在图形和文本界面以及 `%addon com_redhat_kdump` Kickstart 命令中禁用 Kdump 页面。 						

## 16.6. 调试引导选项

​					本节介绍在调试问题时可以使用的选项。 			

- inst.rescue

  ​								使用这个 `inst.rescue` 选项来运行救援环境。该选项对诊断和修复系统很有用。例如：您可以 [在救援模式中修复文件系统](https://access.redhat.com/solutions/9541)。 						

- inst.updates=

  ​								使用 `inst.updates=` 选项指定您要在安装过程中应用的 `updates.img` 文件的位置。这些更新有很多源。 						**表 16.7. inst.updates= source updates**源描述示例  											从网络更新 										 										   											使用 `inst.updates=` 的最简单方法是指定 `updates.img` 的网络位置。这不需要对安装树进行任何修改。要使用这个方法，请编辑内核命令行使其包含 `inst.updates`。 										 										   											`inst.updates=http://some.website.com/path/to/updates.img`. 										 										   											从磁盘镜像更新 										 										   											您可在软盘或者 USB 密钥中保存 `updates.img`。这只能使用 `ext2` 文件系统类型完成 `updates.img`。要在软盘驱动器中保存镜像内容,请插入软盘并运行命令。 										 										   											`dd if=updates.img of=/dev/fd0 bs=72k count=20`.要使用 USB 密钥或者闪存介质，请使用您的 USB 密钥的设备名称替换 `/dev/fd0`。 										 										   											安装树中的更新 										 										   											如果您使用 CD、硬盘、HTTP 或者 FTP 安装，您可以在安装树中保存 `updates.img`，以便所有安装都可检测到 .img 文件。将文件保存到 `images/` 目录中。文件名必须是 `updates.img`。 										 										   											对于 NFS 安装，有两个选项： 您可以将镜像保存到 `images/` 目录中，也可以保存在安装树的 `RHupdates/` 目录中。 										 										 

- inst.loglevel=

  ​								使用 `inst.loglevel=` 选项指定终端日志信息的最小级别。这只考虑终端日志 ; 日志文件总是包含所有级别的信息。这个选项的可能值包括（从最低到最高级别）： `debug`、`info` `warning`、`error` 和 `critical`。默认值为 `info`。这代表，默认情况下日志记录终端会显示的范围是从 `info` 到 `critical`。 						

- inst.syslog=

  ​								当安装启动时，`inst.syslog=` 选项会将日志信息发送到指定主机的 `syslog` 进程。必须将远程 `syslog` 进程配置为接受进入的连接。 						

- inst.virtiolog=

  ​								使用 `inst.virtiolog=` 选项指定您要用于转发日志的 virtio 端口（字符设备 `/dev/virtio-ports/name`）。默认值为 `org.fedoraproject.anaconda.log.0`; 如果存在这个端口，则会使用它。 						

- inst.zram=

  ​								该 `inst.zram=` 选项控制在安装过程中 zRAM swap  的使用。该选项会在系统 RAM 中创建压缩块设备，并使用 swap  空间而不是硬盘。这可让安装程序在不压缩的情况下以小的可用内存运行，而且可能会加快安装速度。默认情况下，在内存超过 2 GiB 的系统中在  zRAM 上启用 swap，并在内存超过 2 GiB 的系统中禁用 swap。您可以使用这个选项来更改此行为 ; 在超过 2 GiB RAM  的系统中，使用 `inst.zram=1` 启用这个功能 ; 在内存为 2 GiB 或更少内存的系统中，使用 `inst.zram=0` 用来禁用这个功能。 						

- rd.live.ram

  ​								如果指定该 `rd.live.ram` 选项，`stage 2` 镜像将复制到 RAM 中。当 `stage 2` 镜像位于 NFS 服务器中时，使用这个选项会将该镜像大小大约增加 500 MiB。 						

- inst.nokill

  ​								该 `inst.nokill` 选项是一个调试选项，可防止安装程序在出现致命错误或安装过程结束时重启。使用 `inst.nokill` 选项捕获重启后会丢失的安装日志。 						

- inst.noshell

  ​								如果您在安装过程中不希望在终端会话 2(tty2)中有一个 shell，使用 `inst.noshell` 选项。 						

- inst.notmux

  ​								如果您不想在安装过程中使用 tmux，使用 `inst.notmux` 选项。输出在没有终端控制字符的情况下生成，用于非互动性。 						

- inst.remotelog=

  ​								您可以使用 `inst.remotelog=` 选项通过 TCP 连接将所有日志发送到远程 `host:port`。如果没有监听程序而安装正常进行，则该连接将会停用。 						

## 16.7. 存储启动选项

- inst.nodmraid

  ​								使用 `inst.nodmraid` 选项禁用 `dmraid` 支持。 						

警告

​						请小心使用这个选项。如果您的磁盘被错误地识别为固件 RAID 阵列的一部分，那么您可能有一些过时的 RAID 元数据必须使用适当的工具删除，例如 `dmraid` 或 `wipefs`。 				

- inst.nompath

  ​								使用 `inst.nompath` 此选项禁用对多路径设备的支持。这个选项可用于遇到假正（false-positive）的系统中，这样会错误地将普通块设备识别为多路径设备。其他情况都不需要使用这个选项。 						

警告

​						请小心使用这个选项。您不应该在多路径硬件中使用这个选项。使用这个选项试图安装到多路径的单一路径不被支持。 				

- inst.gpt

  ​								`inst.gpt` 引导选项强制安装程序在 GUID  分区表（GPT）而不是主引导记录（MBR）中安装分区信息。这个选项在基于 UEFI 的系统上无效，除非采用与 BIOS 兼容的模式。通常，基于  BIOS 的系统和基于 UEFI 的系统在兼容模式下尝试使用 MBR 模式来存储分区信息，除非磁盘大小为 2^32 个扇区或大于 2  个扇区。磁盘扇区大小通常是 512 字节，通常相当于 2 TiB。使用 `inst.gpt` 引导选项可更改此行为，允许将 GPT 写入较小的磁盘。 						

## 16.8. Kickstart 引导选项

​					这部分包含有关 Kickstart 引导选项的信息。 			

- inst.ks=

  ​								使用 `inst.ks=` 引导选项定义您要用于自动化安装的 Kickstart 文件的位置。然后，可以使用任何 `inst.repo` 格式指定位置。如果您指定设备而不是路径，安装程序会在您指定设备的 `/ks.cfg` 中查找 Kickstart 文件。如果您使用这个选项但没有指定设备，安装程序将使用以下选项： 						`inst.ks=nfs:next-server:/filename` 							在前面的例子中，*next-server* 是 DHCP 服务器的 next-server 选项或者 DHCP 服务器本身的 IP 地址，*filename* 是 DHCP 文件名选项，或 */kickstart/*。如果给定文件名以这个 `/` 字符结尾， `ip-kickstart` 则会附加。下表包含示例。 						**表 16.8. 默认 Kickstart 文件位置**DHCP 服务器地址客户端地址kickstart 文件位置  											192.168.122.1 										 										   											192.168.122.100 										 										   											192.168.122.1:/kickstart/192.168.122.100-kickstart 										 										  							如果存在带有标签 `OEMDRV` 的卷，安装程序会尝试载入名为 `ks.cfg` 的 Kickstart 文件。如果您的 Kickstart 文件在这个位置，则不需要使用 `inst.ks=` 引导选项。 						

- inst.ks.all

  ​								指定这个选项来连续尝试多个由多个 `inst.ks` 选项提供的 Kickstart 文件位置。使用第一个成功位置。这只适用于类型位置 `http` `ftp`, `https` 或者忽略其他位置。 						

- inst.ks.sendmac

  ​								使用 `inst.ks.sendmac` 选项将标头添加到包含所有网络接口 MAC 地址的传出 HTTP 请求中。例如： 						`X-RHN-Provisioning-MAC-0: eth0 01:23:45:67:89:ab` 							这在使用 `inst.ks=http` 置备系统时非常有用。 						

- inst.ks.sendsn

  ​								使用 `inst.ks.sendsn` 选项为传出的 HTTP 请求添加标头。这个标头包含从中读取的系统序列号 `/sys/class/dmi/id/product_serial`。标头具有以下语法： 						`X-System-Serial-Number: R8VA23D`

**其它资源**

- ​							有关引导选项的完整列表，请查看 [上游引导选项](https://github.com/rhinstaller/anaconda/blob/rhel-8.0/docs/boot-options.rst) 内容。 					

## 16.9. 高级安装引导选项

​					这部分包含有关高级安装引导选项的信息。 			

- inst.kexec

  ​								该 `inst.kexec` 选项允许安装程序在安装结束时使用 `kexec` 系统调用,而不是重新启动。该 `inst.kexec` 选项会立即载入新系统，绕过通常由 BIOS 或固件执行的硬件初始化。 						重要 								这个选项已弃用，仅作为技术预览使用。如需有关红帽对技术预览功能支持范围的信息，请参阅[技术预览功能支持范围文档](https://access.redhat.com/support/offerings/techpreview)。 							 								当 `kexec` 使用后，通常会在系统完全重启后清除的设备注册，可能会仍然使用数据，这可能会给一些设备驱动程序造成问题。 							

- inst.multilib

  ​								使用 `inst.multilib` 引导选项为多 lib  软件包配置系统，即允许在 64 位 AMD64 或者 Intel 64 系统中安装 32 位软件包。通常在 AMD64 或者 Intel 64  系统中，只安装用于这个构架（标记为 x86_64）的软件包以及用于所有架构（标记为 noarch）的软件包。当您使用 `inst.multilib` 引导选项时，32 位 AMD 或者 Intel 系统（标记为 i686）的软件包会被自动安装。 						 							这只适用于在 `%packages` 本节中直接指定的软件包。如果软件包作为相依性安装，则只会安装指定的相依性。例如：如果您要安装依赖 `glibc` 软件包的 `bash` 软件包，安装的软件包会安装多个变体，被依赖的软件包会在 bash 软件包需要的变体中安装。 						

- selinux=0

  ​								默认情况下, `selinux=0` 引导选项在安装程序的 permissive 模式下运行，并在安装的系统中以 enforcing 模式运行。`selinux=0` 引导选项禁止在安装程序和安装的系统中使用 SELinux。 						注意 								`inst.selinux=0` 选项 `selinux=0` 和选项不同。该 `selinux=0` 选项禁止在安装程序和安装的系统中使用 SELinux。该 `inst.selinux=0` 选项只禁用安装程序中的 SELinux。默认情况下，SELinux 在安装程序中以 permissive 模式运行，因此禁用 SELinux 不会起作用。 							

- inst.nonibftiscsiboot

  ​								使用 `inst.nonibftiscsiboot` 引导选项将引导加载程序放在没有在 iSCSI 引导固件表（iBFT）中配置的 iSCSI 设备中。 						

## 16.10. 弃用的引导选项

​					本节包含已弃用的引导选项的信息。安装程序仍然可以接受这些选项，但它们已被弃用，并计划在以后的 Red Hat Enterprise Linux 版本中删除。 			

- method

  ​								该 `method` 选项是一个 `inst.repo` 的别名。 						

- dns

  ​								使用 `nameserver` 而不是使用 `dns`。请注意，名称服务器不接受用逗号分开的列表 ; 使用多个名称服务器选项。 						

- netmask, gateway, hostname

  ​								`netmask`、`gateway` 和 `hostname` 选择作为 `ip` 选项的一部分提供。 						

- ip=bootif

  ​								自动使用由 PXE 提供的 `BOOTIF` 选项，因此无需使用 `ip=bootif`。 						

- ksdevice

  **表 16.9. ksdevice 引导选项的值**Value信息  											不存在 										 										   											不适用 										 										   											`ksdevice=link` 										 										   											忽略，这个选项与默认行为相同 										 										   											`ksdevice=bootif` 										 										   											如果 `BOOTIF=` 存在会忽略，这个选项是默认的 										 										   											`ksdevice=ibft` 										 										   											使用 `ip=ibft` 替换。查看 `ip` 										 										   											`ksdevice=<MAC>` 										 										   											替换为 `BOOTIF=${MAC/:/-}` 										 										   											`ksdevice=<DEV>` 										 										   											替换为 `bootdev` 										 										 

## 16.11. 删除引导选项

​					这部分包含从 Red Hat Enterprise Linux 中删除的引导选项。 			

注意

​						`dracut` 提供高级引导选项。有关 `dracut` 详情请参考 `dracut.cmdline(7)` man page。 				

- askmethod, asknetwork

  ​								`initramfs` 完全非交互式，因此删除了 `asknetwork` 选项 `askmethod` 和选项。反之，请使用 `inst.repo` 或者指定适当的网络选项。 						

- blacklist, nofirewire

  ​								该 `modprobe` 选项处理阻止将内核模块列入清单的操作,使用 `modprobe.blacklist=<mod1>,<mod2>`。您可以使用 `modprobe.blacklist=firewire_ohci` 来阻止 firewire 模块。 						

- inst.headless=

  ​								`headless=` 指定要安装的系统没有任何显示硬件，且安装程序不需要查找任何显示硬件。 						

- inst.decorated

  ​								该 `inst.decorated` 选项用于在解码窗口中指定图形安装。默认情况下，这个窗口是不分离的，所以它没有标题栏，改变控制大小等等。这个选项已不再需要。 						

- repo=nfsiso

  ​								使用 `inst.repo=nfs:` 选项。 						

- serial

  ​								使用 `console=ttyS0` 选项。 						

- updates

  ​								使用 `inst.updates` 选项。 						

- essid, wepkey, wpakey

  ​								Dracut 不支持无线网络。 						

- ethtool

  ​								这个选项已不再需要。 						

- gdb

  ​								这个选项已被删除，因为有很多可用来调试基于 dracut 的选项 `initramfs`。 						

- inst.mediacheck

  ​								使用 `dracut option rd.live.check` 选项。 						

- ks=floppy

  ​								使用 `inst.ks=hd:<device>` 选项。 						

- 显示

  ​								对于 UI 的远程显示，使用 `inst.vnc` 选项。 						

- utf8

  ​								因为默认的 TERM 设置的行为如预期，所以不再需要这个选项。 						

- noipv6

  ​								IPv6 是内置在内核中，不能被安装程序删除。您可以使用 `ipv6.disable=1` 禁用 ipv6。安装的系统将使用这个设置。 						

- upgradeany

  ​								因为安装程序不再处理升级，所以不再需要这个选项。 						

# 部分 V. Kickstart 参考

## 附录 A. kickstart 脚本文件格式参考

​				这个参考详细描述了 kickstart 文件格式。 		

## A.1. kickstart 文件格式

​					Kickstart 脚本是包含安装程序识别的关键字的纯文本文件，它们是安装指令。任何可将文件保存为 ASCII 文本的文本编辑，,比如 `Gedit` 或 `vim` （Linux 系统），或 `Notepad`（Windows 系统），都可以用来创建和编辑 Kickstart 文件。Kickstart 配置的文件名无关紧要，但建议使用简单名称，因为您需要在其他配置文件或对话框中指定这个名称。 			

- 命令

  ​								命令是作为安装指令的关键字。每个命令都必须位于一行。命令可以选择。指定命令和选项和在 shell 中使用 Linux 命令类似。 						

- 部分

  ​								某些以百分比开头的特殊命令 `%` 启动一个部分。部分中的命令解释与其它部分的命令不同。每个部分都必须使用 `%end` 命令完成。 						

- 部分类型

  ​								可用的部分有： 						 									**Add-on 部分**。这些部分使用 `%addon *addon_name*` 命令。 								 									**软件包选择部分**。以 `%packages` 开始。使用它列出安装的软件包，包括间接方法，比如软件包组或者模块。 								 									**Script 部分**。它们以 `%pre`、`%pre-install`、`%post` 和 `%onerror` 开始这些部分不是必需的。 								

- command 部分

  ​								command 部分是那些不属于任何 script 部分或 `%packages` 部分的 Kickstart 文件中的命令的术语。 						

- 脚本部分计数和排序

  ​								除 command 部分外的所有部分都是可选的，并可以多次出现。当对某个特定类型的脚本进行评估时，Kickstart 中所有该类型的所有部分都会按外观顺序评估：两个 `%post` 部分会根据出现的顺序进行评估。然而，您不必按任何顺序指定各种脚本部分类型：在 `%pre` 部分前是否有 `%post` 部分是无关紧要的。 						

- 注释

  ​								Kickstart 注释是以 hash `#` 字符开头的行。安装程序会忽略这些行。 						

​					不必需的项目可以被省略。省略安装程序中所有需要的项目,以便用户可以象常规互动安装一样,提供对相关项目的回答。您还可以将 kickstart 脚本声明为非互动 `cmdline` 命令。在非互动模式中，任何缺少的回答都会中止安装过程。 			

## A.2. Kickstart 中的软件包选择

​					Kickstart 使用 `%packages` 命令启动的部分来选择要安装的软件包。您可以以这种方式安装软件包、组、环境、模块流和模块配置集。 			

### A.2.1. 软件包选择部分

​						使用该 `%packages` 命令来开始 Kickstart 部分，它描述了要安装的软件包。这个 `%packages` 部分必须以 `%end` 命令结尾。 				

​						您可以根据环境、组、模块流、模块配置集或者它们的软件包名称指定软件包。定义了包含相关软件包的几个环境和组。有关环境和组列表请查看 Red Hat Enterprise Linux 8 安装 DVD 中的该 `*repository*/repodata/*-comps-*repository*.*architecture*.xml` 文件。 				

​						该 `*-comps-*repository*.*architecture*.xml` 文件包含描述可用环境（由标签标记）和组（ `<environment>` 标签）的结构 `<group>`。每个条目都有一个 ID、用户可见值、名称、描述和软件包列表。如果为安装选择了组，则在软件包列表中标记了 `mandatory` 的软件包总会被安装；如果其它位置没有特别排除，标记了`default` 的软件包也会被安装，标记为 `optional` 的软件包需要在其他地方被指定包括时才会安装，即使已经选择该组也是如此。 				

​						您可以使用其 ID（标签）或名称（ `<id>` 标签）指定软件包组或环境 `<name>`。 				

​						如果您不确定应该安装什么软件包，红帽建议您选择 **Minimal Install** 环境。**最小安装** 只提供运行 Red Hat Enterprise Linux 8 所需的软件包。这将显著降低系统受某个漏洞影响的机会。如果需要，可以在安装后再添加附加软件包。有关 **Minimal Install** 的详情，请参阅 *安全强化* [文档中的安装最小软件包挂载部分](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/index#Minimal_install_configuring-and-managing-security)。请注意 **: Initial Setup** 无法在使用 Kickstart 文件安装系统后运行，除非安装中包含桌面环境和 X Window 系统，并启用了图形登录。 				

重要

​							要在 64 位系统中安装 32 位软件包： 					

- ​									在 `%packages` 部分指定 `--multilib` 选项 							
- ​									使用构建该软件包的 32 位构架附加软件包名称，例如： `glibc.i686` 							

### A.2.2. 软件包选择命令

​						这些命令可在 Kickstart 文件 `%packages` 部分使用。 				

- 指定一个环境

  ​									以 `@^` 符号开头的行形式指定要安装的整个环境： 							`%packages @^Infrastructure Server %end` 								这会安装作为 `Infrastructure Server` 环境一部分的所有软件包。Red Hat Enterprise Linux 8 安装 `*repository*/repodata/*-comps-*repository*.*architecture*.xml` DVD 中描述的所有可用环境。 							 								在 Kickstart 文件中只能指定一个环境。如果指定了多个环境，则只使用最后指定的环境。 							

- 指定组

  ​									指定组，每个条目一行，以 `@` 符号开头，然后是 `*-comps-*repository*.*architecture*.xml` 文件中给出的完整组群名称或者组群 ID。例如： 							`%packages @X Window System @Desktop @Sound and Video %end` 								`Core` 组总是被选择 - 并不需要在 `%packages` 部分中指定它。 							

- 指定单独的软件包

  ​									根据名称指定单个软件包，每个条目对应一行。您可以在软件包名称中使用星号(`*`)作为通配符。例如： 							`%packages sqlite curl aspell docbook* %end` 								该 `docbook*` 条目包含软件包 `docbook-style` , `docbook-dtds` 与通配符代表的模式匹配。 							

- 指定模块流的配置集

  ​									使用配置集语法为模块流指定配置集（一个条目为一行）: 							`%packages @module:stream/profile %end` 								这会安装模块流指定配置集中列出的所有软件包。 							 										当模块指定了默认流时，您可以将其退出。如果没有指定默认流，您必须指定它。 									 										当模块流指定默认配置集时，您可以将其退出。如果没有指定默认配置集，您必须指定它。 									 										无法多次使用不同流安装模块。 									 										有可能安装同一模块和流的多个配置集。 									 								模块和组使用以 `@` 符号开头的同一语法。当某个模块和软件包组具有相同名称时，该模块会优先使用。 							 								在 Red Hat Enterprise Linux 8 中，只有 AppStream 软件仓库提供模块。要列出可用的模块，使用安装的 Red Hat Enterprise Linux 8 系统中的 `yum module list` 命令。 							 								您还可以使用 `module` Kickstart 命令启用模块流，然后通过直接命名模块流中的软件包来安装它们。 							

- 排除环境、组群或者软件包

  ​									使用前横线(`-`)指定安装中排除的软件包或组。例如： 							`%packages -@Graphical Administration Tools -autofs -ipa*compat %end`

重要

​							不支持只使用 `*` Kickstart 文件安装所有可用软件包。 					

​						您可以使用几个选项来改变 `%packages` 本节的默认行为。有些选项可以用于整个软件包选择，其它选项只与特定的组一起使用。 				

**其它资源**

- ​								有关处理软件包的更多信息，请参阅*配置基本系统设置文档中*的[安装软件](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_basic_system_settings/index?lb_target=production#basics-installing-software_getting-started-with-system-administration)一章。 						
- ​								有关模块和流的详情，请参阅[安装、管理和删除用户空间组件文档](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_managing_and_removing_user-space_components/index)。 						

### A.2.3. 通用软件包选择选项

​						以下选项可用于 `%packages` 部分。要使用某个选项，请将其附加到软件包选择部分的开头。例如： 				

```
%packages --multilib --ignoremissing
```

- `--default`

  ​									安装默认软件包组。这与在互动安装过程中的**软件包选择**页面中没有其他选择时要安装的软件包组对应。 							

- `--excludedocs`

  ​									不要安装软件包中的任何文档。在大多数情况下，这不包括通常安装在 `/usr/share/doc` 目录中的任何文件，但要排除的具体文件取决于各个软件包。 							

- `--ignoremissing`

  ​									忽略安装源中缺少的软件包、组、模块流、模块配置集和环境,而不是停止安装来询问安装是中止还是继续。 							

- `--instLangs=`

  ​									指定要安装的语言列表。请注意，这与软件包组级别选择不同。这个选项没有描述应该安装哪些软件包组，而是设定 RPM 宏控制应该安装单个软件包的转换文件。 							

- `--multilib`

  ​									为多 lib 软件包配置安装的系统，允许在 64 位系统中安装 32 位软件包，并安装在这部分中指定的软件包。 							 								通常在 AMD64 和 Intel 64 系统中，您只能安装 x86_64 和 noarch 软件包。但是，使用 --multilib 选项，您可以自动安装 32 位 AMD 和 i686 Intel 系统软件包（若有）可用。 							 								这只适用于在 `%packages` 部分中明确指定的软件包。那些只作为相依性安装而没有在 Kickstart 文件中指定的软件包只能安装到需要它们的架构版本中，即使它们可用于更多构架。 							 								用户可以在系统安装过程中将 Anaconda 配置为在 `multilib` 模式中安装软件包。使用以下选项之一启用 `multilib` 模式： 							 										使用以下行配置 Kickstart 文件： 									`%packages --multilib --default %end` 										在引导安装镜像的过程中添加 inst.multilib 引导选项。 									

- `--nocore`

  ​									禁用默认会被安装的 `@Core` 软件包组。禁用 `@Core` 软件包组 `--nocore` 应该只用于创建轻量级容器 ; 安装桌面或服务器系统 `--nocore` 将导致系统不可用。 							备注 											使用 `-@Core` 软件包组中的 `@Core` 软件包无法正常工作。排除 `@Core` 软件包组的唯一方法是 使用 `--nocore` 选项。 										 											`@Core` 软件包组被定义为用来安装工作系统的最小软件包集合。它与[软件包清单](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/package_manifest/index?lb_target=production)和[覆盖范围](https://access.redhat.com/support/offerings/production/scope_moredetail)中定义的核心软件包无关。 										

- `--excludeWeakdeps`

  ​									禁用从弱依赖项安装软件包。这些软件包都链接到由 Recommends 和 supplements 标记组成的所选软件包。默认情况下会安装弱依赖项。 							

- `--retries=`

  ​									设置 Yum 试图下载软件包的次数（尝试）。默认值为 10。这个选项只适用于安装程序，它不会影响安装的系统上的 Yum 配置。 							

- `--timeout=`

  ​									以秒为单位设定 Yum 超时。默认值为 30。这个选项只适用于安装程序，它不会影响安装的系统上的 Yum 配置。 							

### A.2.4. 特定软件包组的选项

​						这个列表中的选项仅适用于单个软件包组。不是在 Kickstart 文件中的 `%packages` 命令中使用它们，而是将其附加到组群名称中。例如： 				

```
%packages
@Graphical Administration Tools --optional
%end
```

- `--nodefaults`

  ​									只安装组的强制软件包，而不是默认选择。 							

- `--optional`

  ​									除安装默认选择外，还要安装在 `*-comps-*repository*.*architecture*.xml` 文件中组定义中标记为可选的软件包。 							 								请注意，有些软件包组，比如 `Scientific Support`，没有指定任何强制或默认软件包 - 只有可选软件包。在这种情况下必须总是使用 `--optional` 选项，否则不会安装该组中的软件包。 							

## A.3. Kickstart 文件中的脚本

​					kickstart 文件可以包括以下脚本： 			

- ​							%pre 					
- ​							%pre-install 					
- ​							%post 					

​					本节提供有关脚本的以下详情： 			

- ​							执行时间 					
- ​							可以包含在脚本中的命令类型 					
- ​							脚本的目的 					
- ​							脚本选项 					

### A.3.1. %pre 脚本

​						`%pre` 脚本会在载入 Kickstart 文件后立即在系统中运行，但在完全解析及开始安装前。每个部分必须以 `%pre` 开头并以 `%end` 结尾。 				

​						这个 `%pre` 脚本可用于激活和配置联网和存储设备。还可以使用安装环境中可用的脚本来运行脚本。如果您在安装前有需要特殊配置的联网和存储，或者有设置其他日志参数或环境变量的脚本，则可以添加, `%pre` 脚本。 				

​						使用 `%pre` 脚本调试问题会比较困难，因此建议仅在需要时使用 `%pre` 脚本。 				

​						除了安装环境 `/sbin` 和 `/bin` 目录中的大多数工具外，您还可以在 `%pre` 脚本中使用与网络、存储 文件系统相关的命令。 				

​						您可以在该 `%pre` 部分中访问网络。然而，命名服务还没有被配置，所以只能使用 IP 地址，而不能使用 URL。 				

注意

​							pre 脚本不会在 chroot 环境中运行。 					

#### A.3.1.1. %pre 脚本部分选项

​							以下选项可以用来改变预安装脚本的行为。要使用某个选项，请将其附加到脚本开头的 `%pre` 行中。例如： 					

```
%pre --interpreter=/usr/libexec/platform-python
-- Python script omitted --
%end
```

- `--interpreter=`

  ​										允许指定不同的脚本语言，如 Python。可使用系统中可用的任意脚本语言 ; 在大多数情况下，它们是 `/usr/bin/sh`、`/usr/bin/bash` 和 `/usr/libexec/platform-python`。 								 									请注意，`platform-python` 解释器使用 Python 版本 3.6。对于新路径和版本，您必须将您的针对以前的 RHEL 版本的 Python 脚本进行更改，以适用于新的路径和版本。另外，`platform-python` 用于系统工具： 使用安装环境之外的 `python36` 软件包。有关 Red Hat Enterprise Linux 8 中 Python 的详情，请查看*配置基本系统设置*中的 [Python 简介](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/using-python3_configuring-basic-system-settings#introduction-to-python_using-python3)。 								

- `--erroronfail`

  ​										显示错误并在脚本失败时暂停安装。错误消息会指示您记录故障原因的位置。 								

- `--log=`

  ​										将脚本的输出记录到指定的日志文件中。例如： 								`%pre --log=/tmp/ks-pre.log`

### A.3.2. %pre-install 脚本

​						`pre-install` 脚本中的命令是在以下任务完成后运行： 				

- ​								系统已被分区 						
- ​								文件系统创建并挂载到 /mnt/sysimage 中 						
- ​								网络已根据任何引导选项和 kickstart 命令进行配置 						

​						每个 `%pre-install` 部分必须以 `%pre-install` 开头并以 `%end` 结尾。 				

​						这些 `%pre-install` 脚本可以用来修改安装，并在软件包安装前添加有保证 ID 的用户和组群。 				

​						建议您在安装所需的任何修改中使用 `%post` 脚本。只有在 `%pre-install` 脚本在需要修改的 `%post` 脚本短时才使用该脚本。 				

​						注意： `The pre-install` 脚本不会在 chroot 环境中运行。 				

#### A.3.2.1. %pre-install script 部分选项

​							以下选项可以用来改变 `pre-install` 脚本的行为。要使用某个选项，将其附加到脚本开头的 `%pre-install` 行中。例如： 					

```
%pre-install --interpreter=/usr/libexec/platform-python
-- Python script omitted --
%end
```

​							请注意，您可以有多个 `%pre-install` 部分，它们具有相同或不同的解析程序。它们按照它们在 Kickstart 文件中的顺序进行评估。 					

- `--interpreter=`

  ​										允许指定不同的脚本语言，如 Python。可使用系统中可用的任意脚本语言 ; 在大多数情况下，它们是 `/usr/bin/sh`、`/usr/bin/bash` 和 `/usr/libexec/platform-python`。 								 									请注意，`platform-python` 解释器使用 Python 版本 3.6。对于新路径和版本，您必须将您的针对以前的 RHEL 版本的 Python 脚本进行更改，以适用于新的路径和版本。另外，`platform-python` 用于系统工具： 使用安装环境之外的 `python36` 软件包。有关 Red Hat Enterprise Linux 8 中 Python 的详情，请查看*配置基本系统设置*中的 [Python 简介](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/using-python3_configuring-basic-system-settings#introduction-to-python_using-python3)。 								

- `--erroronfail`

  ​										显示错误并在脚本失败时暂停安装。错误消息会指示您记录故障原因的位置。 								

- `--log=`

  ​										将脚本的输出记录到指定的日志文件中。例如： 								`%pre-install --log=/mnt/sysimage/root/ks-pre.log`

### A.3.3. %post 脚本

​						%post 脚本是安装后脚本，可在安装完成后运行，但在第一次重启系统前运行。您可以使用这部分来运行任务，比如系统订阅。 				

​						您可以添加系统在安装结束后但在第一次重启该系统之前要运行的命令,。这个部分必须以 `%post` 开头并以 `%end` 结尾。 				

​						`%post` 一节对安装其他软件或配置其他名称服务器等功能很有用。post-install 脚本是一个 `chroot` 环境中运行的，因此,从安装介质中复制脚本或 RPM 软件包等任务在默认情况下不起作用。您可使用 `--nochroot` 选项更改此行为，如下所述。然后 `%post` 脚本将在安装环境中运行，而不是在安装 `chroot` 的目标系统中运行。 				

​						因为安装后脚本在一个 `chroot` 环境中运行，所以大多数 `systemctl` 命令会拒绝执行任何操作。 				

​						请注意，在执行 `%post` 这部分的过程中，安装介质必须仍被插入。 				

#### A.3.3.1. %post 脚本部分选项

​							以下选项可以用来改变安装后脚本的行为。要使用某个选项，请将其附加到脚本开头的 `%post` 行中。例如： 					

```
%post --interpreter=/usr/libexec/platform-python
-- Python script omitted --
%end
```

- `--interpreter=`

  ​										允许指定不同的脚本语言，如 Python。例如： 								`%post --interpreter=/usr/libexec/platform-python` 									可使用系统中可用的任意脚本语言 ; 在大多数情况下，它们是 `/usr/bin/sh`、`/usr/bin/bash` 和 `/usr/libexec/platform-python`。 								 									请注意，`platform-python` 解释器使用 Python 版本 3.6。对于新路径和版本，您必须将您的针对以前的 RHEL 版本的 Python 脚本进行更改，以适用于新的路径和版本。另外，`platform-python` 用于系统工具： 使用安装环境之外的 `python36` 软件包。有关 Red Hat Enterprise Linux 8 中 Python 的详情，请查看*配置基本系统设置*中的 [Python 简介](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/using-python3_configuring-basic-system-settings#introduction-to-python_using-python3)。 								

- `--nochroot`

  ​										允许您指定在 chroot 环境之外运行的命令。 								 									以下示例将 /etc/resolv.conf 文件复制到刚安装的文件系统中。 								`%post --nochroot cp /etc/resolv.conf /mnt/sysimage/etc/resolv.conf %end`

- `--erroronfail`

  ​										显示错误并在脚本失败时暂停安装。错误消息会指示您记录故障原因的位置。 								

- `--log=`

  ​										将脚本的输出记录到指定的日志文件中。请注意，无论您是否使用 `--nochroot` 选项，日志文件的路径都必须考虑它。例如，没有 `--nochroot`: 								`%post --log=/root/ks-post.log` 									并且使用 `--nochroot`: 								`%post --nochroot --log=/mnt/sysimage/root/ks-post.log`

#### A.3.3.2. 示例：在安装后脚本中挂载 NFS

​							这个示例的 `%post` 部分挂载 NFS 共享并执行名为 `runme`，位于 `/usr/new-machines/` 共享中的脚本。请注意，在 Kickstart 模式中不支持 NFS 文件锁定，因此`-o nolock` 选项是必需的。 					

```
# Start of the %post section with logging into /root/ks-post.log
%post --log=/root/ks-post.log

# Mount an NFS share
mkdir /mnt/temp
mount -o nolock 10.10.0.2:/usr/new-machines /mnt/temp
openvt -s -w -- /mnt/temp/runme
umount /mnt/temp

# End of the %post section
%end
```

#### A.3.3.3. 示例：将 subscription-manager 作为安装后脚本运行

​							Kickstart 安装中最常用的安装脚本之一就是使用 Red Hat Subscription Manager 自动注册安装的系统。以下是 `%post` 脚本中的自动订阅示例： 					

```
%post --log=/root/ks-post.log
subscription-manager register --username=admin@example.com --password=secret --auto-attach
%end
```

​							subscription-manager 命令行脚本在红帽订阅管理服务器（客户门户网站订阅管理、Satellite 6 或者  CloudForms System  Engine）中注册系统。这个脚本还可用来自动在该系统中分配或者附加与该系统最匹配的订阅。在客户门户网站中注册时，请使用红帽网络登录证书。当在  Satellite 6 或者 CloudForms System Engine 中注册时，您可能需要指定更多  subscription-manager 选项 `--serverurl` `--org`, `--environment` 以及您的本地管理员提供的凭证。请注意，以 `--org --activationkey` 组合格式的凭证是避免在共享的 kickstart 文件中公开 `--username --password` 值的好方法。 					

​							注册命令中可以使用附加选项为系统设置首选服务等级，并为那些需要在旧流中继续修复的延长更新支持订阅客户限制对特定 RHEL 次要版本的更新和勘误。 					

​							另外，请参阅红帽客户门户网站 [中的如何在 kickstart 文件中使用 subscription-manager?](https://access.redhat.com/solutions/748313)一文 `subscription-manager` 中的有关使用 Kickstart `%post` 部分的附加信息。 					

## A.4. Anaconda 配置部分

​					可在您的 Kickstart 文件 `%anaconda` 部分配置附加安装选项。这部分控制安装系统的用户界面行为。 			

​					这个部分必须处于 Kickstart 文件的最后（在 Kickstart 命令之后），且必须以 `%anaconda` 开头并以 `%end` 结尾。 			

​					目前，这个 `%anaconda` 部分中唯一可以使用的命令是 `pwpolicy`。 			

**例 A.1. `%anaconda` 脚本示例**

​						以下是 %anaconda 部分示例： 				

```
%anaconda
pwpolicy root --minlen=10 --strict
%end
```

​						这个示例 `%anaconda` 部分设定密码策略，即 root 密码至少有 10 个字符，并严格禁止不满足这个要求的密码。 				

## A.5. Kickstart 错误处理部分

​					从 Red Hat Enterprise Linux 7 开始，Kickstart  安装可以包含安装程序遇到致命错误时运行的自定义脚本。例如：已经为安装请求的软件包中有一个错误，指定时无法启动  VNC，或者在扫描存储设备时出错。发生此类错误后安装无法继续。安装程序会按照在 Kickstart 文件中提供的顺序运行所有 `%onerror` 脚本。另外，`%onerror` 脚本还会在回溯事件中运行。 			

​					每个 `%onerror` 脚本都需要以 `%end` 结尾。 			

​					错误处理部分接受以下选项： 			

- `--erroronfail`

  ​								显示错误并在脚本失败时暂停安装。错误消息会指示您记录故障原因的位置。 						

- `--interpreter=`

  ​								允许指定不同的脚本语言，如 Python。例如： 						`%onerror --interpreter=/usr/libexec/platform-python` 							可使用系统中可用的任意脚本语言 ; 在大多数情况下，它们是 `/usr/bin/sh`、`/usr/bin/bash` 和 `/usr/libexec/platform-python`。 						 							请注意，`platform-python` 解释器使用 Python 版本 3.6。对于新路径和版本，您必须将您的针对以前的 RHEL 版本的 Python 脚本进行更改，以适用于新的路径和版本。另外，`platform-python` 用于系统工具： 使用安装环境之外的 `python36` 软件包。有关 Red Hat Enterprise Linux 8 中 Python 的详情，请查看*配置基本系统设置*中的 [Python 简介](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_basic_system_settings/using-python3_configuring-basic-system-settings#introduction-to-python_using-python3)。 						

- `--log=`

  ​								将脚本的输出记录到指定的日志文件中。 						

## A.6. Kickstart 附加组件部分

​					从 Red Hat Enterprise Linux 7 开始，Kickstart 安装支持附加组件。这些附加组件可以在很多方面扩展基本 Kickstart(Anaconda)功能。 			

​					要在 Kickstart 文件中使用附加组件，请使用 `%addon *addon_name* *options*` 命令，并使用 `%end` 语句完成命令，这和预安装和安装后脚本部分类似。例如：如果要使用默认由 Anaconda 分配的 Kdump 附加组件，请使用以下命令： 			

```
%addon com_redhat_kdump --enable --reserve-mb=auto
%end
```

​					该 `%addon` 命令不包含任何其自身的选项 - 所有选项都依赖实际附加组件。 			

## 附录 B. Kickstart 命令和选项参考

​				这个参考是 Red Hat Enterprise Linux 安装程序支持的所有 Kickstart 命令的完整列表。这些命令按字母顺序排序为几个广泛类别。如果某个命令可位于多个类别下，它将列在所有这些类别中。 		

## B.1. Kickstart 的修改

​					以下小节描述了 Red Hat Enterprise Linux 8 中 Kickstart 命令和选项的更改。 			

### B.1.1. 在 RHEL 8 中弃用了 auth 或 authconfig

​						因为已经删除了该 `authconfig` 工具和软件包，所以在 Red Hat Enterprise Linux 8 中弃用了 `auth` 或 `authconfig` Kickstart 命令。 				

​						和命令行中的 `authconfig` 命令类似，Kickstart 脚本中的 `authconfig` 命令现在使用这个 `authselect-compat` 工具来运行新 `authselect` 工具。有关这个兼容性层及其已知问题的描述，请查看手册页 `authselect-migration(7)`。安装程序将自动检测弃用命令的使用并在系统上安装该 `authselect-compat` 软件包以提供兼容性层。 				

### B.1.2. Kickstart 不再支持 Btrfs

​						Red Hat Enterprise Linux 8 不支持 Btrfs 文件系统。因此，图形用户界面(GUI)和 Kickstart 命令不再支持 Btrfs。 				

### B.1.3. 使用之前 RHEL 发行本中的 Kickstart 文件

​						如果您正在使用之前的 RHEL 版本中的 Kickstart 文件,请参阅 [*RHEL 8 文档中*](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/considerations_in_adopting_rhel_8/index/) 的 *Repositories* 部分，以了解有关 Red Hat Enterprise Linux 8 BaseOS 和 AppStream 软件仓库的详情。 				

### B.1.4. 弃用的 Kickstart 命令和选项

​						在Red Hat Enterprise Linux 8 中弃用了以下 Kickstart 命令和选项。 				

​						如果只列出具体选项，则基础命令及其它选项仍可用且没有弃用。 				

- ​								`auth` 或者 `authconfig` - 使用 `authselect instead` 						
- ​								`device` 						
- ​								`deviceprobe` 						
- ​								`dmraid` 						
- ​								`install` - 直接使用子命令或者方法作为命令 						
- ​								`multipath` 						
- ​								`bootloader --upgrade` 						
- ​								`ignoredisk --interactive` 						
- ​								`partition --active` 						
- ​								`reboot --kexec` 						

​						除 `auth` 或 `authconfig` 命令外，使用 Kickstart 文件中的命令在日志中打印警告信息。 				

​						您可以使用 `inst.ksstrict` 引导选项将已弃用的命令警告放入出错信息，但 `auth` 或 `authconfig` 命令除外。 				

### B.1.5. 删除的 Kickstart 命令和选项

​						在 Red Hat Enterprise Linux 8 中完全删除了以下 Kickstart 命令和选项。在 Kickstart 文件中使用它们将导致错误。 				

- ​								`upgrade` （这个命令之前已弃用。） 						
- ​								`btrfs` 						
- ​								`part/partition btrfs` 						
- ​								`part --fstype btrfs` 或者 `partition --fstype btrfs` 						
- ​								`logvol --fstype btrfs` 						
- ​								`raid --fstype btrfs` 						
- ​								`unsupported_hardware` 						

​						如果只列出具体选项和值，则基础命令及其它选项仍可用且没有被删除。 				

### B.1.6. 新的 Kickstart 命令和选项

​						在 Red Hat Enterprise Linux 8.2 中添加了以下命令和选项。 				

**RHEL 8.2**

- ​								`rhsm` 						
- ​								`zipl` 						

​						在 Red Hat Enterprise Linux 8 中添加了以下命令和选项。 				

**RHEL 8.0**

- ​								`authselect` 						
- ​								`module` 						

## B.2. 用于安装程序配置和流量控制的 Kickstart 命令

​					这个列表中的 Kickstart 命令可控制安装模式和安装过程，以及最后发生什么。 			

### B.2.1. cdrom

​						`cdrom` Kickstart 命令是可选的。它使用系统上的第一个光驱执行安装。 				

**语法**

​							

```
cdrom
```



**备注**

- ​								在以前的版本中，`cdrom` 命令必须与 `install` 命令一同使用。该 `install` 命令已弃用，`cdrom` 可以自行使用，因为它代表了 `install`。 						
- ​								这个命令没有选项。 						
- ​								要真正运行安装，指定 `cdrom`、`harddrive`、`hmc`、`nfs`、`liveimg`或 `url` 之一。 						

### B.2.2. cmdline

​						`cmdline` Kickstart 命令是可选的。它以完全非互动的命令行模式执行安装。任何互动提示都会终止安装。 				

**语法**

​							

```
cmdline
```



**备注**

- ​								要进行完全自动安装，您必须在 Kickstart 文件中指定可用模式之一 （`graphical`、`text` 或 `cmdline`），或者必须使用 `console=` 引导选项。如果没有指定模式，系统会尽可能使用图形模式，或者提示您从 VNC 和文本模式中选择。 						
- ​								这个命令没有选项。 						
- ​								这个模式对使用 x3270 终端的 IBM Z 系统有用。 						

### B.2.3. driverdisk

​						`driverdisk` Kickstart 命令是可选的。使用它为安装程序提供额外的驱动程序。 				

​						可在 Kickstart 安装过程中使用驱动程序磁盘提供默认不包括的额外驱动程序。您必须将驱动程序磁盘内容复制到系统的硬盘分区的根目录下。然后，必须使用 `driverdisk` 命令来指定安装程序是否应该寻找驱动程序磁盘及其位置。 				

**语法**

​							

```
driverdisk [partition|--source=url|--biospart=biospart]
```



**选项**

​							您必须以以下一种方式指定驱动程序磁盘的位置： 					

- ​								*partition* - 包含驱动程序磁盘的分区。请注意，必须把分区指定为完整路径（例如 `/dev/sdb1`）， *不能* 只使用分区名称（如 `sdb1`）。 						

- ​								`--source=` - 驱动程序磁盘的 URL。示例包括： 						

  ```
  driverdisk --source=ftp://path/to/dd.img
  driverdisk --source=http://path/to/dd.img
  driverdisk --source=nfs:host:/path/to/dd.img
  ```

- ​								`--biospart=` - BIOS 分区包含驱动程序磁盘（例如： `82p2`）。 						

**备注**

​							还可以从硬盘或者类似的设备载入驱动程序磁盘，而不必通过网络或者从中载入 `initrd`。按照以下步骤操作： 					

1. ​								在硬盘、USB 或者类似设备中载入驱动程序磁盘。 						

2. ​								将标签（如 *DD* ）设置为这个设备。 						

3. ​								在您的 Kickstart 文件中添加以下行： 						

   ```
   driverdisk LABEL=DD:/e1000.rpm
   ```

​						使用特定标签替换 *DD*，并使用具体名称替换 *dd.rpm*。使用该 `inst.repo` 命令支持的任何内容而不是 *LABEL* 指定您的硬盘。 				

### B.2.4. EULA

​						`eula` Kickstart  命令是可选的。使用这个选项在没有用户互动的情况下接受最终用户许可证协议(End User License  Agreement,EULA)。指定这个选项可防止 Initial Setup  在完成安装并第一次重启系统后提示您接受该许可证。如需更多信息，请参阅执*行标准 RHEL 安装* 文档中的 [完成初始设置](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#completing-initial-setup_post-installation-tasks) 部分。 				

**语法**

​							

```
eula
```



**选项**

- ​								`--agreed` （强制）- 接受 EULA。必须总是使用这个选项，否则 `eula` 命令就毫无意义。 						
- ​								这个命令没有选项。 						

### B.2.5. firstboot

​						`firstboot` Kickstart 命令是可选的。它决定了 `Initial Setup` 应用程序是否在第一次引导系统时启动。如果启用，则必须安装 **initial-setup** 软件包。如果没有指定，这个选项默认是禁用的。 				

**语法**

​							

```
firstboot OPTIONS
```



**选项**

- ​								`--enable` 或者 `--enabled` - 系统第一次引导时启动 Initial Setup。 						
- ​								`--disable` 或者 `--disabled` - 系统第一次引导时不会启动 Initial Setup。 						
- ​								`--reconfig` - 在引导时以重新配置模式启用 Initial Setup。这个模式启用了语言、鼠标、键盘、root 密码、安全级别、时区以及默认网络配置之外的网络配置选项。 						

### B.2.6. 图形化

​						`graphical` Kickstart 命令是可选的。它在图形模式下执行安装。这是默认值。 				

**语法**

​							

```
graphical [--non-interactive]
```



**选项**

- ​								`--non-interactive` - 在完全非互动模式下执行安装。这个模式将在用户交互需要时终止安装。 						

**备注**

- ​								要进行完全自动安装，您必须在 Kickstart 文件中指定可用模式之一 （`graphical`、`text` 或 `cmdline`），或者必须使用 `console=` 引导选项。如果没有指定模式，系统会尽可能使用图形模式，或者提示您从 VNC 和文本模式中选择。 						

### B.2.7. halt

​						`halt` Kickstart 命令是可选的。 				

​						在成功完成安装后停止系统。这和手动安装相似，Anaconda 会显示一条信息并等待用户按任意键来重启系统。在 Kickstart 安装过程中，如果没有指定完成方法，将使用这个选项作为默认选项。 				

**语法**

​							

```
halt
```



**备注**

- ​								`halt` 命令等同于 `shutdown -H` 命令。详情请查看 *shutdown(8)* man page。 						
- ​								关于其他的完成方法，请参考 `poweroff`、`reboot` 和 `shutdown` 命令。 						
- ​								这个命令没有选项。 						

### B.2.8. harddrive

​						`harddrive` Kickstart 命令是可选的。它使用红帽安装树或者本地驱动器中的完整安装 ISO 镜像执行安装。驱动器必须包含安装程序可挂载的文件系统： `ext2`、`ext3` `ext4` `vfat`、或 `xfs`。 				

**语法**

​							

```
harddrive OPTIONS
```



**选项**

- ​								`--partition=` - 安装的分区（如 `sdb2`）。 						
- ​								`--dir=` - 包含安装树 `*variant*` 目录或者完整安装 DVD 的 ISO 镜像的目录。 						

**示例**

​							

```
harddrive --partition=hdb2 --dir=/tmp/install-tree
```



**备注**

- ​								在以前的版本中，`harddrive` 命令必须与 `install` 命令一同使用。`install` 命令已弃用，`harddrive` 可以自行使用，因为它代表 `install`。 						
- ​								要真正运行安装，指定 `cdrom`、`harddrive`、`hmc`、`nfs`、`liveimg`或 `url` 之一。 						

### B.2.9. install （已弃用）

重要

​							`install` Kickstart 命令在 Red Hat Enterprise Linux 8 中已弃用。使用它的方法作为单独的命令。 					

​						`install` Kickstart 命令是可选的。它指定了默认的安装模式。 				

**语法**

​							

```
install
installation_method
```



**备注**

- ​								`install` 命令必须跟随一个安装方法命令。安装方法命令必须位于单独的行中。 						

- ​								方法包括： 						

  - ​										`cdrom` 								
  - ​										`harddrive` 								
  - ​										`hmc` 								
  - ​										`nfs` 								
  - ​										`liveimg` 								
  - ​										`url` 								

  ​								有关方法的详情，请查看其独立参考页面。 						

### B.2.10. liveimg

​						`liveimg` Kickstart 命令是可选的。它从磁盘镜像而不是软件包执行安装。 				

**语法**

​							

```
liveimg --url=SOURCE [OPTIONS]
```



**必填选项**

- ​								`--url=` - 从中进行安装的位置。支持的协议有 `HTTP` `HTTPS` `FTP`、和 `file`。 						

**可选选项**

- ​								`--url=` - 从中进行安装的位置。支持的协议有 `HTTP` `HTTPS` `FTP`、和 `file`。 						
- ​								`--proxy=` - 指定安装时要使用的 `HTTP` `HTTPS` 或者 `FTP` 代理。 						
- ​								`--checksum=` - 带有镜像文件的 `SHA256` checksum 的可选参数，用于验证。 						
- ​								`--noverifyssl` - 连接到服务器时禁用 SSL 验证 `HTTPS`。 						

**示例**

​							

```
liveimg --url=file:///images/install/squashfs.img --checksum=03825f567f17705100de3308a20354b4d81ac9d8bed4bb4692b2381045e56197 --noverifyssl
```



**备注**

- ​								该镜像可以是来自 live ISO 镜像的 `squashfs.img` 文件、压缩的 tar 文件（`.tar` `.tbz`、`.tgz`、`.txz` `.tar.bz2`、`.tar.gz` 或 `.tar.xz`），或者安装介质可挂载的任意文件系统。支持的文件系统有 `ext2`、`ext3` `ext4` `vfat`、和 `xfs`。 						
- ​								当在驱动程序磁盘中使用 `liveimg` 安装模式时，磁盘中的驱动程序不会自动包含在安装的系统中。必要时，应该手动安装这些驱动程序，也可以在 kickstart 脚本 `%post` 部分手动安装这些驱动程序。 						
- ​								在以前的版本中，`liveimg` 命令必须与 `install` 命令一同使用。该 `install` 命令已弃用，`liveimg` 可以单独使用，因为它代表了 `install`。 						
- ​								要真正运行安装，指定 `cdrom`、`harddrive`、`hmc`、`nfs`、`liveimg`或 `url` 之一。 						

### B.2.11. logging

​						`logging` Kickstart 命令是可选的。它控制在安装过程中 Anaconda 的错误日志。它对安装的系统没有影响。 				

注意

​							只支持使用 TCP 记录日志。对于远程日志，请确保在远程服务器中打开您在 `--port=` 选项中指定的端口号。默认端口为 514。 					

**语法**

​							

```
logging OPTIONS
```



**可选选项**

- ​								`--host=` - 向给定的远程主机发送日志信息，该主机必须配置了运行 syslogd 进程来接收远程日志。 						
- ​								`--port=` - 如果远程 syslogd 进程使用默认意外的端口，则使用这个选项进行设置。 						
- ​								`--level=` - 指定 tty3 中显示的信息最小等级。无论这个级别是什么，仍会将所有的信息发送到日志文件。可能的值有 `debug`: `info`、`warning` `error`、或 `critical`。 						

### B.2.12. mediacheck

​						`mediacheck` Kickstart 命令是可选的。该命令强制安装程序在开始安装前执行介质检查。因为这个命令需要在执行安装时有人工参与，因此它默认被禁用。 				

**语法**

​							

```
mediacheck
```



**备注**

- ​								这个 Kickstart 命令等同于 `rd.live.check` 引导选项。 						
- ​								这个命令没有选项。 						

### B.2.13. nfs

​						`nfs` Kickstart 命令是可选的。它从指定的 NFS 服务器执行安装。 				

**语法**

​							

```
nfs OPTIONS
```



**选项**

- ​								`--server=` - 要从中安装的服务器（主机名或 IP）。 						
- ​								`--dir=` - 包含安装树目录 `*variant*` 的目录。 						
- ​								`--opts=` - 用于挂载 NFS 导出的挂载选项（可选）。 						

**示例**

​							

```
nfs --server=nfsserver.example.com --dir=/tmp/install-tree
```



**备注**

- ​								在以前的版本中，`nfs` 命令必须与 `install` 命令一同使用。`install` 命令已弃用，`nfs` 可以自行使用，因为它代表了 `install`。 						
- ​								要真正运行安装，指定 `cdrom`、`harddrive`、`hmc`、`nfs`、`liveimg`或 `url` 之一。 						

### B.2.14. ostreesetup

​						`ostreesetup` Kickstart 命令是可选的。它被用来设置基于 OStree 的安装。 				

**语法**

​							

```
ostreesetup --osname=OSNAME [--remote=REMOTE] --url=URL --ref=REF [--nogpg]
```



**必须的选项**

- ​								`--osname=*OSNAME*` - 用于操作系统安装的管理根用户。 						
- ​								`--url=*URL*` - 要从中安装的程序库的 URL。 						
- ​								`--ref=*REF*` - 用于安装的程序库的分支名称。 						

**可选选项：**

- ​								`--remote=*REMOTE*` - 用于操作系统安装的管理根用户。 						
- ​								`--nogpg` - 禁用 GPG 密钥验证。 						

**备注**

- ​								有关 OStree 工具的更多信息，请参阅上游文档： https://ostree.readthedocs.io/en/latest/ 						

### B.2.15. poweroff

​						`poweroff` Kickstart 命令是可选的。它会在安装成功后关闭系统并关闭电源。通常，在手动安装过程中，Anaconda 会显示一条信息并等待用户按任意键来重新引导系统。 				

**语法**

​							

```
poweroff
```



**备注**

- ​								`poweroff` 选项等同于 `shutdown -P` 命令。详情请查看 *shutdown(8)* man page。 						
- ​								有关其他完成方法，请查看 `halt`、`reboot`、`shutdown` Kickstart 命令。如果没有在 Kickstart 文件中明确指定其它方法，则 `halt` 选项是默认的完成方法。 						
- ​								`poweroff` 命令高度依赖所使用的系统硬件。特别是，某些硬件部件如 BIOS、APM（高级电源管理）和 ACPI（高级配置和电源接口）必须能和系统内核交互。有关您系统的 APM/ACPI 功能的更多信息，请参考您的硬件文档。 						
- ​								这个命令没有选项。 						

### B.2.16. reboot

​						`reboot` Kickstart 命令是可选的。它指示安装程序在安装成功（没有参数）后重启。通常，Kickstart 会显示信息并等待用户按任意键来重新引导系统。 				

**语法**

​							

```
reboot OPTIONS
```



**选项**

- ​								`--eject` - 在重启前尝试弹出可引导介质（DVD、USB 或者其它介质）。 						

- ​								`--kexec` - 使用 `kexec` 系统调用而不是执行完全重启，这样可立即将安装的系统载入内存，绕过通常由 BIOS 或者固件执行的硬件初始化。 						

  重要

  ​									这个选项已弃用，仅作为技术预览使用。如需有关红帽对技术预览功能支持范围的信息，请参阅[技术预览功能支持范围文档](https://access.redhat.com/support/offerings/techpreview)。 							

  ​									当使用`kexec` 时，设备注册（通常会在系统完全重启后清除）可能会留下一些数据，这可能会给一些设备驱动程序造成问题。 							

**备注**

- ​								取决于安装介质和方法，使用 `reboot` 选项*可能会*导致安装的死循环。 						
- ​								`reboot` 选项等同于 `shutdown -r` 命令。详情请查看 *shutdown(8)* man page。 						
- ​								`reboot` 在 IBM Z 中使用命令行模式安装时指定要完全自动化安装。 						
- ​								有关其他完成方法，请查看 `halt`、`poweroff`、 `shutdown` Kickstart 选项。如果没有在 Kickstart 文件中明确指定其它方法，则 `halt` 选项是默认的完成方法。 						

### B.2.17. rhsm

​						`rhsm` Kickstart 命令是可选的。它指示安装程序从 CDN 注册并安装 RHEL。 				

注意

​							在注册系统时，`rhsm` Kickstart 命令删除了使用自定义 `%post` 脚本的要求。 					

**选项**

- ​								`--organization=` - 使用机构 id 从 CDN 注册并安装 RHEL。 						
- ​								`--activation-key=` - 使用激活码从 CDN 注册并安装 RHEL。只要在您的订阅中进行了注册，就可以使用多个激活码。 						
- ​								`--connect-to-insights` - 将目标系统连接到 Red Hat Insights。 						
- ​								`--proxy=` - 设置 HTTP 代理。 						
- ​								`--server-hostname=` - 设置服务器主机名。如果您正在运行 Satellite 服务器或者执行内部测试，则使用这个选项。 						
- ​								`--rhsm-baseurl=` - 设定 rhsm baseurl 选项。如果您正在运行 Satellite 服务器或者执行内部测试，则使用这个选项。 						

注意

​							服务器主机名不需要 HTTP 协议,例如 `--server-hostname="nameofhost.com"`。rhsm baseurl 需要 HTTP 或 HTTPS 协议,例如 `--rhsm-baseurl="https://satellite.example.com/pulp/repos"`。 					

### B.2.18. shutdown

​						`shutdown` Kickstart 命令是可选的。它会在安装成功完成后关闭系统。 				

**语法**

​							

```
shutdown
```



**备注**

- ​								`shutdown` Kickstart 选项等同于 `shutdown` 命令。详情请查看 *shutdown(8)* man page。 						
- ​								有关其他完成方法，请查看 `halt`、`poweroff`、`reboot` Kickstart 选项。如果没有在 Kickstart 文件中明确指定其它方法，则 `halt` 选项是默认的完成方法。 						
- ​								这个命令没有选项。 						

### B.2.19. sshpw

​						`sshpw` Kickstart 命令是可选的。 				

​						在安装过程中，您可以与安装程序交互并通过 `SSH` 连接监控其进度。使用 `sshpw` 命令创建登录的临时帐户。该命令的每个实例都会创建一个只存在于安装环境中的单独帐户。这些不会转移到系统里。 				

**语法**

​							

```
sshpw --username=name [OPTIONS] password
```



**必填选项**

- ​								`--username`=*name* - 提供用户名称。这个选项是必需的。 						
- ​								*password* - 用户要使用的密码。这个选项是必需的。 						

**可选选项**

- ​								`--iscrypted` - 如果有这个选项，则假设 password 参数已被加密。这个选项与 `--plaintext` 相互排斥。要生成加密的密码，可以使用 Python: 						

  ```
  $ python3 -c 'import crypt,getpass;pw=getpass.getpass();print(crypt.crypt(pw) if (pw==getpass.getpass("Confirm: ")) else exit())'
  ```

  ​								这会使用随机 salt 为密码生成 sha512 兼容哈希。 						

- ​								`--plaintext` - 如果给出这个选项，则假设 password 参数为明文。这个选项与 `--iscrypted` 相互排斥。 						

- ​								`--lock` - 如果给出这个选项，则默认锁定这个帐户。这意味着用户无法从控制台登录。 						

- ​								`--sshkey` - 如果给出这个选项，*<password>* 字符串被解释为 ssh 密钥值。 						

**备注**

- ​								默认情况下，`ssh` 服务器不会在安装过程中启动。要使 `ssh` 在安装过程中可以，使用内核引导选项 `inst.sshd` 引导系统。 						

- ​								如果您想禁用 root `ssh` 访问，同时允许其他用户进行 `ssh` 访问，使用： 						

  ```
  sshpw --username=example_username example_password --plaintext
  sshpw --username=root example_password --lock
  ```

- ​								要简单地禁用 root `ssh` 访问，使用： 						

  ```
  sshpw --username=root example_password --lock
  ```

### B.2.20. text

​						`text` Kickstart 命令是可选的。它在文本模式下执行 Kickstart 安装。Kickstart 安装默认是以图形模式执行的。 				

**语法**

​							

```
text [--non-interactive]
```



**选项**

- ​								`--non-interactive` - 在完全非互动模式下执行安装。这个模式将在用户交互需要时终止安装。 						

**备注**

- ​								请注意：对于全自动安装，您必须在 Kickstart 文件中指定一个可用模式 (`graphical`、`text` 或 `cmdline`），或者使用 `console=` 引导选项。如果没有指定模式，系统会尽可能使用图形模式，或者提示您从 VNC 和文本模式中选择。 						

### B.2.21. url

​						`url` Kickstart 命令是可选的。它可用来使用 FTP、HTTP 或者 HTTPS 协议从远程服务器中的安装树镜像安装。您只能指定一个 URL。 				

**语法**

​							

```
url --url=FROM [OPTIONS]
```



**必填选项**

- ​								`--url=*FROM*` - 指定要从中安装的 `HTTP`、`HTTPS`、`FTP` 或 `file` 位置。 						

**可选选项**

- ​								`--mirrorlist=` - 指定要从中安装的镜像 URL。 						
- ​								`--proxy=` - 指定在安装过程中要使用的 `HTTP`、`HTTPS` 或一个 `FTP` 代理。 						
- ​								`--noverifyssl` - 连接到 `HTTPS` 服务器时禁用 SSL 验证。 						
- ​								`--metalink=*URL*` - 指定要从中安装的 metalink URL。变量替换在 *URL* 中为 `$releasever` `$basearch` 进行。 						

**示例**

- ​								从 HTTP 服务器安装： 						

  ```
  url --url=http://server/path
  ```

- ​								从 FTP 服务器安装： 						

  ```
  url --url=ftp://username:password@server/path
  ```

- ​								使用本地文件安装： 						

  ```
  liveimg --url=file:///images/install/squashfs.img --noverifyssl
  ```

**备注**

- ​								在以前的版本中，`url` 命令必须与 `install` 命令一同使用。`install` 命令已弃用，`url` 可以自行使用，因为它代表了 `install`。 						
- ​								要真正运行安装，指定 `cdrom`、`harddrive`、`hmc`、`nfs`、`liveimg`或 `url` 之一。 						

### B.2.22. vnc

​						`vnc` Kickstart 命令是可选的。它允许通过 VNC 远程查看图形安装。 				

​						与文本模式相比，这个模式通常是首选模式。因为在文本模式中有某些大小和语言的限制。如果没有附加选项，这个命令将在不需要密码的系统中启动 VNC 服务器，并显示连接它所需要的详情。 				

**语法**

​							

```
vnc [--host=host_name] [--port=port] [--password=password]
```



**选项**

- ​								`--host=` - 连接在给定主机名中侦听的 VNC viewer 进程。 						
- ​								`--port=` - 提供远程 VNC viewer 进程侦听的端口。如果没有提供，Anaconda 将使用 VNC 默认端口 5900。 						
- ​								`--password=` - 设定必须为连接 VNC 会话提供的密码。这是可选的，但推荐使用。 						

**其它资源**

- ​								有关 VNC 安装的详情,包括如何连接到安装系统,请参考 [第 11 章 *使用 VNC 执行远程 RHEL 安装*](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#performing-a-remote-installation-using-vnc_installing-rhel-as-an-experienced-user)。 						

### B.2.23. %include

​						`%include` Kickstart 命令是可选的。 				

​						使用 `%include` 命令可将另一个文件的内容包括在 Kickstart 文件中，就好像这些内容在 Kickstart 文件中 `%include` 命令的位置一样。 				

​						这个包括只在 `%pre` script 部分后评估，因此可用于包括在 `%pre` 部分中生成的文件。要在评估 `%pre` 部分前包括文件，请使用 `%ksappend` 命令。 				

**语法**

​							

```
%include path/to/file
```



### B.2.24. %ksappend

​						`%ksappend` Kickstart 命令是可选的。 				

​						使用 `%ksappend` 命令可将另一个文件的内容包括在 Kickstart 文件中，就好像这些内容在 Kickstart 文件中 `%ksappend` 命令的位置一样。 				

​						这个包括被用来在 `%pre` 脚本部分之前评估，与 `%include` 命令的包含不同。 				

**语法**

​							

```
%ksappend path/to/file
```



## B.3. kickstart 命令进行系统配置

​					这个列表中的 Kickstart 命令配置结果系统的更多详情，比如用户、库或服务。 			

### B.3.1. auth 或 authconfig（已弃用）

重要

​							使用新的 `authselect` 命令而不是已弃用的 `auth` 或 `authconfig` Kickstart 命令。`auth` 和 `authconfig` 只可用于有限的向后兼容性。 					

​						`auth` 或 `authconfig` Kickstart 命令是可选的。它使用 `authconfig` 工具为系统设置验证选项，也可以在安装完成后在命令行中运行该工具。 				

**语法**

​							

```
authconfig [OPTIONS]
```



**备注**

- ​								在以前的版本中，`auth` 或 `authconfig` Kickstart 命令称为 `authconfig` 工具。在 Red Hat Enterprise Linux 8 中已弃用这个工具。这些 Kickstart 命令现在使用 `authselect-compat` 工具，称为 `authselect` 工具。有关兼容性层及其已知问题的描述，请参阅 *authselect-migration(7)* 手册页。安装程序将自动检测弃用命令的使用，并在系统上安装 `authselect-compat` 软件包以提供兼容性层。 						
- ​								默认使用影子密码。 						
- ​								当使用带有 `SSL` 协议的 OpenLDAP 时，请确定在服务器配置中禁用了 `SSLv3` 和 `SSLv2` 协议。这是因为 POODLE SSL 漏洞(CVE-2014-3566)。详情请查看 https://access.redhat.com/solutions/1234843。 						

### B.3.2. authselect

​						`authselect` Kickstart 命令是可选的。它使用 `authselect` 命令为系统设置验证选项，也可以在安装完成后在命令行中运行该命令。 				

**语法**

​							

```
authselect [OPTIONS]
```



**备注**

- ​								这个命令会将所有选项传递给 `authselect` 命令。详情请参考 *authselect(8)* 手册页和 `authselect --help` 命令。 						
- ​								这个命令用于替代 Red Hat Enterprise Linux 8 中已弃用的 `auth` 和 `authconfig` 命令以及 `authconfig` 工具。 						
- ​								默认使用影子密码。 						
- ​								当使用带有 `SSL` 协议的 OpenLDAP 时，请确定在服务器配置中禁用了 `SSLv3` 和 `SSLv2` 协议。这是因为 POODLE SSL 漏洞(CVE-2014-3566)。详情请查看 https://access.redhat.com/solutions/1234843。 						

### B.3.3. firewall

​						`firewall` Kickstart 命令是可选的。它为安装的系统指定防火墙配置。 				

**语法**

​							

```
firewall --enabled|--disabled [incoming] [OPTIONS]
```



**必填选项**

- ​								`--enabled` 或 `--enable` - 拒绝不是响应外向请求（如 DNS 答复或 DHCP 请求）的内向连接。如果需要访问在这个机器中运行的服务，您可以选择允许指定的服务通过防火墙。 						
- ​								`--disabled` 或 `--disable` - 不配置任何 iptables 规则。 						

**可选选项**

- ​								`--trust` - 在这里列出设备，如 `em1`，允许所有来自该设备的流量通过防火墙。要列出多个设备，请多次使用该选项，例如 `--trust em1 --trust em2`:不要使用以逗号分开的格式，如 `--trust em1, em2`。 						

- ​								`--remove-service` - 不允许服务穿过防火墙。 						

- ​								*incoming* - 使用以下服务中的一个或多个来替换，从而允许特定的服务穿过防火墙。 						

  - ​										`--ssh` 								
  - ​										`--smtp` 								
  - ​										`--http` 								
  - ​										`--ftp` 								

- ​								`--port=` - 您可以指定允许通过防火墙的端口，格式为 port:protocal。例如，要允许 IMAP 通过您的防火墙，指定 `imap:tcp`。您还可以具体指定数字端口。例如，要允许 UDP 数据包在端口 1234 通过，指定 `1234:udp`。要指定多个端口，用逗号将它们隔开。 						

- ​								`--service=` - 这个选项提供允许服务通过防火墙的高级方法。有些服务（如 `cups` `avahi`等）需要开放多个端口，或者其他特殊配置方可使服务正常工作。您可以使用 `--port` 选项指定各个端口，或指定 `--service=` 一次全部打开它们。 						

  ​								有效选项是 **firewalld** 软件包中 `firewall-offline-cmd` 可识别的任何选项。如果 `firewalld` 服务正在运行，使用 `firewall-cmd --get-services` 提供已知服务名称列表。 						

- ​								`--use-system-defaults` - 不配置防火墙。这个选项告诉 anaconda 不做任何工作，并允许系统依赖软件包或者 ostree 提供的默认值。如果将这个选项与其它选项一同使用，则将忽略所有其他选项。 						

### B.3.4. group

​						`group` Kickstart 命令是可选的。它在系统中创建新用户组。 				

```
group --name=name [--gid=gid]
```

**必填选项**

- ​								`--name=` - 提供组的名称。 						

**可选选项**

- ​								`--gid=` - 组的 GID。如果没有提供，则默认使用下一个可用的非系统 GID。 						

**备注**

- ​								如果具有指定名称或 GID 的组群已经存在，这个命令会失败。 						
- ​								`user` 命令可以用来为新创建的用户创建新组群。 						

### B.3.5. keyboard（必需）

​						`keyboard` Kickstart 命令是必需的。它为系统设置一个或多个可用的键盘布局。 				

**语法**

​							

```
keyboard --vckeymap|--xlayouts OPTIONS
```



**选项**

- ​								`--vckeymap=` - 指定应使用的 `VConsole` 键映射。有效名称与 `/usr/lib/kbd/keymaps/xkb/` 目录中的文件列表对应，无需 `.map.gz` 扩展名。 						

- ​								`--xlayouts=` - 指定 X 布局列表，该列表应该作为用逗号分开的列表，没有空格。接受与 `setxkbmap(1)` 相同格式的值，可以是 `*layout*` 格式（如 `cz`），或 `*layout* (*variant*)` 格式（比如 `cz (qwerty)`）。 						

  ​								可在 `xkeyboard-config(7)` man page 的 `Layouts` 中查看所有可用布局。 						

- ​								`--switch=` - 指定布局切换选项列表（在多个键盘布局间切换的快捷方式）。必须使用逗号分开多个选项，没有空格。接受与相同格式的值 `setxkbmap(1)`。 						

  ​								您可以在 `xkeyboard-config(7)` man page 的 `Options` 部分查看可用的切换选项 。 						

**备注**

- ​								必须使用 `--vckeymap=` 或 `--xlayouts=` 选项。 						

**示例**

​							以下示例使用 `--xlayouts=` 选项设置了两个键盘布局（`English (US)` 和 `Czech (qwerty)`）,并允许使用 **Alt**+**Shift** 在它们之间进行切换： 					

```
keyboard --xlayouts=us,'cz (qwerty)' --switch=grp:alt_shift_toggle
```

### B.3.6. lang（必需）

​						`lang` Kickstart 命令是必需的。它设置了在安装过程中使用的语言以及系统的默认语言。 				

**语法**

​							

```
lang language [--addsupport=language,...]
```



**必填选项**

- ​								`*language*` - 安装对此语言的支持，并将其设置为系统默认。 						

**可选选项**

- ​								`--addsupport=` - 添加对附加语言的支持。格式为使用逗号分开的列表，无空格。例如： 						

  ```
  lang en_US --addsupport=cs_CZ,de_DE,en_UK
  ```

**备注**

- ​								`locale -a | grep _` 或 `localectl list-locales | grep _` 命令返回支持的区域列表。 						
- ​								文本模式安装中不支持某些语言（比如中文、日语、韩文和印度的语言）。如果用 `lang` 命令指定这些语言中的一种，安装过程仍然会使用英语，但安装的系统会默认使用您选择的语言。 						

**示例**

​							要将语言设置为英语，Kickstart 文件应包含以下行： 					

```
lang en_US
```

### B.3.7. module

​						`module` Kickstart 命令是可选的。使用这个命令在 kickstart 脚本中启用软件包模块流。 				

**语法**

​							

```
module --name=NAME [--stream=STREAM]
```



**必填选项**

- ​								`--name=` - 指定要启用的模块名称。使用实际名称替换 *NAME*。 						

**可选选项**

- ​								`--stream=` - 指定要启用的模块流的名称。将 *STREAM* 替换为实际名称。 						

  ​								您不需要为定义的默认流的模块指定此选项。对于没有默认流的模块，这个选项是强制的，省略它将导致错误。无法多次启用带有不同流的模块。 						

**备注**

- ​								通过这个命令和 `%packages` 节的组合，您可以安装由启用的模块和流组合提供的软件包，而无需明确指定模块和流。安装软件包前必须启用模块。在使用 `module` 命令启用一个模块后，您可以安装这个模块启用的软件包，方法是在 `%packages` 一节中列出它们。 						
- ​								单个 `module` 命令只能启用单个模块和流组合。要启用多个模块，使用多个 `module` 命令。无法多次启用带有不同流的模块。 						
- ​								在 Red Hat Enterprise Linux 8 中，只有 AppStream 软件仓库提供模块。要列出可用的模块，使用安装的、带有有效订阅的 Red Hat Enterprise Linux 8 系统中的 `yum module list` 命令。 						

**其它资源**

- ​								有关模块和流的详情，请参阅[安装、管理和删除用户空间组件文档](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_managing_and_removing_user-space_components/index)。 						

### B.3.8. repo

​						`repo` Kickstart 命令是可选的。它配置了作为软件包安装来源的额外的 yum 仓库。您可以添加多个 `repo` 行。 				

**语法**

​							

```
repo --name=repoid [--baseurl=url|--mirrorlist=url|--metalink=url] [OPTIONS]
```



**必填选项**

- ​								`--name=` - 仓库 ID。这个选项是必需的。如果库的名称与另一个之前添加的库冲突，则会忽略它。因为安装程序使用预设置程序库列表，这意味着您无法添加名称与预先设置的库的名称相同的库。 						

**URL options**

​							这些选项是互斥的，也是可选的。这里不支持 yum 库配置文件中可以使用的变量。您可以使用字符串 `$releasever` 和`$basearch`，它们由 URL 中的相应值替换。 					

- ​								`--baseurl=` - 仓库的 URL。 						
- ​								`--mirrorlist=` - 指向该仓库镜像的 URL。 						
- ​								`--metalink=` - 仓库的 metalink 的 URL。 						

**可选选项**

- ​								`--install` - 将安装的系统中提供的库配置保存在 `/etc/yum.repos.d/` 目录中。如果不使用这个选项，在 Kickstart 文件中配置的程序库将只在安装过程中使用，而无法在安装的系统中使用。 						
- ​								`--cost=` - 为这个库分配一个成本的整数值。如果多个库提供同样的软件包，这个数字就会被用来决定优先使用哪个库。成本低的软件仓库优先于成本高的软件仓库。 						
- ​								`--excludepkgs=` - 逗号分开的软件包名称列表，它们是一定*不能*从这个仓库中提取的软件包名称。如果多个存储库提供同样的软件包，您希望这个软件包来自特定的仓库，可以使用它。可接受完整软件包名称（比如 `publican`）和 globs（比如 `gnome-*`）。 						
- ​								`--includepkgs=` - 用逗号分开的软件包名称列表，以及允许从该仓库中提取的 glob。该程序仓库提供的其他软件包将被忽略。如果您只想从库中安装单个软件包或软件包组而不包括该程序库提供的所有其他软件包，这个选项就很有用了。 						
- ​								`--proxy=[*protocol*://][*username*[:*password*]@]*host*[:*port*]` - 指定仅用于这个仓库的 HTTP/HTTPS/FTP 代理。这个设置不会影响任何其他软件仓库，也不会影响在 HTTP 安装中是如何获取 `install.img` 的。 						
- ​								`--noverifyssl` - 连接到服务器时禁用 SSL 验证 `HTTPS`。 						

**备注**

- ​								用于安装的软件仓库必须是稳定版本。如果在安装完成前修改库，则安装会失败。 						

### B.3.9. rootpw（必需）

​						`rootpw` Kickstart 命令是必需的。它将系统的根密码设置为 *password* 参数的值。 				

**语法**

​							

```
rootpw [--iscrypted|--plaintext] [--lock] password
```



**必填选项**

- ​								*password* - 密码规格。纯文本或者加密字符串。请查看以下的 `--iscrypted` 和 `--plaintext`。 						

**选项**

- ​								`--iscrypted` - 如果有这个选项，则假设 password 参数已被加密。这个选项与 `--plaintext` 相互排斥。要创建一个加密的密码，您可以使用 python: 						

  ```
  $ python -c 'import crypt,getpass;pw=getpass.getpass();print(crypt.crypt(pw) if (pw==getpass.getpass("Confirm: ")) else exit())'
  ```

  ​								这会使用随机 salt 为密码生成 sha512 兼容哈希。 						

- ​								`--plaintext` - 如果给出这个选项，则假设 password 参数为明文。这个选项与 `--iscrypted` 相互排斥。 						

- ​								`--lock` - 如果给出这个选项，则默认锁定 root 帐户。这意味着 root 用户无法从控制台登录。这个选项还在图形和文本手动安装中禁用 **Root 密码** 页面。 						

### B.3.10. selinux

​						`selinux` Kickstart 命令是可选的。它在安装的系统中设定 SELinux 状态。默认 SELinux 策略是 `enforcing`。 				

**语法**

​							

```
selinux [--disabled|--enforcing|--permissive]
```



**选项**

- ​								`--enforcing` - 在默认目标策略中启用 SELinux `enforcing`。 						
- ​								`--permissive` - 根据 SELinux 策略输出警告信息，但并不强制执行该策略。 						
- ​								`--disabled` - 在系统中完全禁用 SELinux。 						

**其它资源**

​							有关 SELinux 的详情，请查看[使用 SElinux 文档](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/using_selinux/)。 					

### B.3.11. services

​						`services` Kickstart 命令是可选的。它修改在默认 systemd 目标下运行的默认服务集合。禁用的服务列表会在启用的服务列表前进行处理。因此，如果服务出现在这两个列表中，它将被启用。 				

**语法**

​							

```
services [--disabled=list] [--enabled=list]
```



**选项**

- ​								`--disabled=` - 禁用在以逗号分开的列表中给出的服务。 						
- ​								`--enabled=` - 启用在以逗号分开的列表中给出的服务。 						

**备注**

- ​								不要在服务列表中包含空格。如果您这样做，Kickstart 将只启用或者禁用在第一个空格前的服务。例如： 						

  ```
  services --disabled=auditd, cups,smartd, nfslock
  ```

  ​								这只禁用 `auditd` 服务。要禁用所有四个服务，这个条目一定不能有空格： 						

  ```
  services --disabled=auditd,cups,smartd,nfslock
  ```

### B.3.12. skipx

​						`skipx` Kickstart 命令是可选的。如果存在，安装的系统上就不会配置 X。 				

​						如果您在软件包选择选项中安装 display manager，这个软件包会创建一个 X 配置，安装的系统会默认使用 `graphical.target`。这会覆盖 `skipx` 选项的效果。 				

**语法**

​							

```
skipx
```



**备注**

- ​								这个命令没有选项。 						

### B.3.13. sshkey

​						`sshkey` Kickstart 命令是可选的。它把 SSH 密钥添加到特定用户在安装系统的 `authorized_keys` 文件中。 				

**语法**

​							

```
sshkey --username=user "ssh_key"
```



**必填选项**

- ​								`--username=` - 安装密钥的用户。 						
- ​								*ssh_key* - 完整的 SSH 密钥指纹。必须使用引号嵌套它。 						

### B.3.14. syspurpose

​						`syspurpose` Kickstart 命令是可选的。使用它来设置系统在安装后的系统目的。这些信息有助于在系统中应用正确的订阅授权。 				

**语法**

​							

```
syspurpose [OPTIONS]
```



**选项**

- ​								`--role=` - 设置系统角色。可用值有： 						
  - ​										Red Hat Enterprise Linux Server 								
  - ​										Red Hat Enterprise Linux Workstation 								
  - ​										Red Hat Enterprise Linux Compute 节点 								
- ​								`--sla=` - 设置服务级别协议。可用值有： 						
  - ​										Premium（高级） 								
  - ​										Standard（标准） 								
  - ​										Self-Support（自助） 								
- ​								`--usage=` - 系统预定的使用情况。可用值有： 						
  - ​										Production 								
  - ​										Disaster Recovery 								
  - ​										Development/Test 								
- ​								`--addon=` - 指定附加层次产品或特性。您可以多次使用这个选项。 						

**备注**

- ​								输入有空格的值，并使用双引号包括它们： 						

  ```
  syspurpose --role="Red Hat Enterprise Linux Server"
  ```

- ​								虽然强烈建议您配置系统目的，但它是 Red Hat Enterprise Linux 安装程序的可选功能。如果要在安装完成后启用系统目的，您可以使用 `syspurpose` 命令行工具完成此操作。 						

### B.3.15. timezone（必需）

​						`timezone` Kickstart 命令是必需的。它设置系统时区。 				

**语法**

​							

```
timezone timezone [OPTIONS]
```



**必填选项**

- ​								*timezone* - 为系统设定的时区。 						

**可选选项**

- ​								`--utc` - 如果存在，系统假定硬件时钟被设置为 UTC（Greenwich Mean）时间。 						
- ​								`--nontp` - 禁止自动启动 NTP 服务。 						
- ​								`--ntpservers=` - 指定要使用的 NTP 服务器列表，该列表使用逗号分开，没有空格。 						

**备注**

​							在 Red Hat Enterprise Linux 8 中，时区名会使用由 **pytz** 软件包提供的 `pytz.all_timezones` 列表进行验证。在以前的版本里，这些名称会使用 `pytz.common_timezones` 进行验证，它是当前验证列表的子集。请注意：图形和文本模式界面仍然使用有更多限制的 `pytz.common_timezones` 列表 ; 您必须使用 Kickstart 文件来使用额外的时区定义。 					

### B.3.16. user

​						`user` Kickstart 命令是可选的。它在系统上创建新用户。 				

**语法**

​							

```
user --name=username [OPTIONS]
```



**必填选项**

- ​								`--name=` - 提供用户名称。这个选项是必需的。 						

**可选选项**

- ​								`--gecos=` - 为用户提供 GECOS 信息。这个字符串包括使用逗号分开的各种具体系统字段。它通常用来指定用户全名、办公室号码等等。详情请查看 `passwd(5)` man page。 						

- ​								`--groups=` - 除默认组群外，还有以逗号分开的该用户所属组群列表。组群必须在创建该用户帐户前就已经存在。请查看 `group` 命令。 						

- ​								`--homedir=` - 用户的主目录。如果没有提供，则默认为 `/home/*username*`。 						

- ​								`--lock` - 如果给出这个选项，则默认锁定这个帐户。这意味着用户无法从控制台登录。这个选项还在图形和文本手动安装中禁用**创建用户** 页面。 						

- ​								`--password=` - 新用户的密码。如果没有提供，则默认锁定该帐户。 						

- ​								`--iscrypted` - 如果有这个选项，则假设 password 参数已被加密。这个选项与 `--plaintext` 相互排斥。要创建一个加密的密码，您可以使用 python: 						

  ```
  $ python -c 'import crypt,getpass;pw=getpass.getpass();print(crypt.crypt(pw) if (pw==getpass.getpass("Confirm: ")) else exit())'
  ```

  ​								这会使用随机 salt 为密码生成 sha512 兼容哈希。 						

- ​								`--plaintext` - 如果给出这个选项，则假设 password 参数为明文。这个选项与 `--iscrypted` 相互排斥。 						

- ​								`--shell=` - 用户的登录 shell。如果没有提供，则使用系统默认。 						

- ​								`--uid=` - 用户的 UID（用户 ID）。如果没有提供，则默认使用下一个可用的非系统 UID。 						

- ​								`--gid=` - 用于用户组的 GID（组 ID）。如果没有提供，则默认使用下一个可用的非系统组群 ID。 						

**备注**

- ​								请考虑使用 `--uid` 和 `--gid` 选项设置常规用户，它们的默认组 ID 从 `5000` 开始而不是从 `1000` 开始。这是因为为系统用户和组群保留的范围（`0`-`999`）将来可能会增加并导致与常规用户 ID 重叠。 						

  ​								有关在安装后更改最小 UID 和 GID 限制，以确保您在创建用户时可以自动应用您选择的 UID 和 GID 范围，请参阅 *配置基本系统设置* 文档中的[使用 umask 为新文件设置默认权限](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_basic_system_settings/#sec-setting-default-permissions-for-new-files-using-umask)部分。 						

- ​								使用不同权限创建的文件和目录，由用来创建文件或目录的应用程序指定。例如：`mkdir` 命令创建启用了所有权限的目录。但是，如 `user file-creation mask` 设置所指定的，应用程序无法为新创建的文件授予某些权限。 						

  ​								`user file-creation mask` 可使用 `umask` 命令控制。新用户的 `user file-creation mask` 的默认设置是由安装的系统的 `/etc/login.defs` 配置文件中的 `UMASK` 变量定义。如果未设置，则默认为 `022`。这意味着，默认情况下，当应用程序创建一个文件时，会防止为该文件所有者以外的用户授予写入权限。不过，这可以被其他设置或脚本覆盖。如需了解更多信息，请参阅*配置基本系统设置*文档中的 [使用 umask 配置基本系统设置](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_basic_system_settings/#sec-setting-default-permissions-for-new-files-using-umask)。 						

### B.3.17. xconfig

​						`xconfig` Kickstart 命令是可选的。它配置 X 窗口系统。 				

**语法**

​							

```
xconfig [--startxonboot]
```



**选项**

- ​								`--startxonboot` - 在安装的系统中使用图形登录。 						

**备注**

- ​								因为 Red Hat Enterprise Linux 8 没有包括 KDE 桌面环境，请不要使用上游 `--defaultdesktop=` 文档。 						

## B.4. kickstart 命令用于网络配置

​					在这个列表中的 Kickstart 命令可让您在系统中配置联网。 			

### B.4.1. network

​						`network` Kickstart 命令是可选的。它为目标系统配置网络信息并在安装环境中激活网络设备。 				

​						在第一个 `network` 命令中指定的设备会自动激活。`--activate` 选项还可明确要求激活该设备。 				

**语法**

​							

```
network OPTIONS
```



**选项**

- ​								`--activate` - 在安装环境中激活该设备。 						

  ​								如果您使用的是已经激活的设备中的 `--activate` 选项（例如：使用引导选项配置的界面以便系统可以检索 Kickstart 文件），那么会重新激活该设备使用在 Kickstart 文件中指定的详情。 						

  ​								使用 `--nodefroute` 选项可防止设备使用默认路由。 						

- ​								`--no-activate` - 不要在安装环境中激活这个设备。 						

  ​								默认情况下，无论 `--activate` 选项是什么，Anaconda 会激活 Kickstart 文件中的第一个网络设备。您可以使用 `--no-activate` 选项禁用默认设置。 						

- ​								`--bootproto=` - `dhcp`、`bootp` `ibft` 或 `static` 之一。默认选项是 `dhcp`; `bootp` 选项和 `dhcp` 选项的效果相同。要禁用设备的 `ipv4` 配置，使用 `--noipv4` 选项。 						

  注意

  ​									这个选项配置设备的 ipv4 配置。对于 ipv6 配置，使用 `--ipv6` 和 `--ipv6gateway` 选项。 							

  ​								DHCP 方法使用 DHCP 服务器系统来获得它的网络配置。BOOTP 方法类似，需要 BOOTP 服务器来提供网络配置。要指示系统使用 DHCP: 						

  ```
  network --bootproto=dhcp
  ```

  ​								要指示机器使用 BOOTP 获取其网络配置，在 Kickstart 文件中使用以下行： 						

  ```
  network --bootproto=bootp
  ```

  ​								要指示机器使用 iBFT 中指定的配置，使用： 						

  ```
  network --bootproto=ibft
  ```

  ​								`static` 方法要求您在 Kickstart 文件中至少指定 IP 地址和子网掩码。这个信息是静态的，并在安装过程中和安装后使用。 						

  ​								所有静态网络配置信息必须在*一行*中指定 ; 您不能象在命令行中换行一样使用反斜杠(`\`)来换行。 						

  ```
  network --bootproto=static --ip=10.0.2.15 --netmask=255.255.255.0 --gateway=10.0.2.254 --nameserver=10.0.2.1
  ```

  ​								您还可以同时配置多个名称服务器。要做到这一点，使用 `--nameserver=` 选项一次，并指定每个 IP 地址，用逗号分开： 						

  ```
  network --bootproto=static --ip=10.0.2.15 --netmask=255.255.255.0 --gateway=10.0.2.254 --nameserver=192.168.2.1,192.168.3.1
  ```

- ​								`--device=` - 使用以下 `network` 命令指定要配置的设备（并最终在 Anaconda 中激活）。 						

  ​								如果在*第一次*使用 `network` 命令时缺少 `--device=` 选项，会使用 `ksdevice=` Anaconda 引导选项。请注意，这个行为被视为已弃用 ; 在大多数情况下，您应该为每个 `network` 命令指定一个 `--device=`。 						

  ​								如果缺少该 `--device=` 选项，则同一 Kickstart 文件中后续 `network` 命令的行为都会被取消指定。请确定您为第一个之后的任何 `network` 命令指定这个选项。 						

  ​								您可以使用以下任一方法指定要激活的设备： 						

  - ​										接口的设备名称，例如 `em1` 								
  - ​										接口的 MAC 地址，例如 `01:23:45:67:89:ab` 								
  - ​										关键字 `link`，指定链接为 `up` 状态的第一个接口 								
  - ​										关键字 `bootif`，使用 pxelinux 在 `BOOTIF` 变量中设置的 MAC 地址。在您的 `pxelinux.cfg` 文件中设置 `IPAPPEND 2` 将 pxelinux 设置 `BOOTIF` 变量。 								

  ​								例如： 						

  ```
  network --bootproto=dhcp --device=em1
  ```

- ​								`--ip=` - 设备的 IP 地址。 						

- ​								`--ipv6=` - 设备的 IPv6 地址，格式为 *address*[/*prefix* *length*] - 例如 `3ffe:ffff:0:1::1/128 `. If *prefix* is omitted, `64` 。您还可以使用 `auto` 用于自动配置，或使用 `dhcp` 用于只使用 DHCPv6 的配置（无路由器广告）。 						

- ​								`--gateway=` - 单一 IPv4 地址的默认网关。 						

- ​								`--ipv6gateway=` - 单一 IPv6 地址的默认网关。 						

- ​								`--nodefroute` - 防止将接口设置为默认路由。当您用这个选项激活附加设备时使用 `--activate=` 选项，例如：用于 iSCSI 目标的单独子网中的 NIC。 						

- ​								`--nameserver=` - DNS 名称服务器作为 IP 地址。要指定一个以上名称服务器，使用这个选项，并使用逗号分隔每个 IP 地址。 						

- ​								`--netmask=` - 安装的系统的网络掩码。 						

- ​								`--hostname=` - 已安装系统的主机名。主机名可以是完全限定域名（FQDN），格式是 `*host_name*.*domainname*`，也可以是没有域名的短主机名。很多网络有动态主机配置协议(DHCP)服务，它可自动提供带域名的连接的系统 ; 要允许 DHCP 分配域名，只指定简短主机名。 						

  重要

  ​									如果您的网络*没有*提供 DHCP 服务，则必须使用 FQDN 作为系统的主机名。 							

- ​								`--ethtool=` - 指定用于网络设备的附加底层设置，可将其传送给 ethtool 程序。 						

- ​								`--onboot=` - 是否在引导时启用该设备。 						

- ​								`--dhcpclass=` - DHCP 类别。 						

- ​								`--mtu=` - 该设备的 MTU。 						

- ​								`--noipv4` - 在这个设备中禁用 IPv4。 						

- ​								`--noipv6` - 在这个设备中禁用 IPv6。 						

- ​								`--bondslaves=` - 使用这个选项时,由 `--device=` 选项指定的绑定设备将使用 `--bondslaves=` 选项中定义的二级设备创建。例如： 						

  ```
  network --device=bond0 --bondslaves=em1,em2
  ```

  ​								以上命令创建了一个名为 `bond0` 的绑定设备,使用 `em1` 和 `em2` 接口作为它的辅助设备。 						

- ​								`--bondopts=` - 绑定接口的可选参数列表，使用 `--device=` 选项和 `--bondslaves=` 选项指定。这个列表中的选项必须以逗号(",")或分号(";")分开。如果某个选项本身包含一个逗号，请使用分号来分隔选项。例如： 						

  ```
  network --bondopts=mode=active-backup,balance-rr;primary=eth1
  ```

  重要

  ​									`--bondopts=mode=` 参数只支持完整模式名称，如 `balance-rr` 或 `broadcast`，而不是它们的数字表示，如 `0` 或 `3`。有关可用模式和支持的模式列表, [请参阅配置和管理网络指南](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_networking/configuring-network-bonding_configuring-and-managing-networking#upstream-switch-configuration-depending-on-the-bonding-modes_configuring-network-bonding)。 							

- ​								`--vlanid=` - 为使用 `--device=` 作为父设备创建的设备指定虚拟 LAN(VLAN)ID 号（802.1q 标签）。例如，`network --device=em1 --vlanid=171` 创建一个虚拟 LAN 设备 `em1.171`。 						

- ​								`--interfacename=` - 为虚拟 LAN 设备指定自定义接口名称。当该选项生成的默认名称不必要时使用 `--vlanid=` 选项。这个选项必须与 `--vlanid=` 选项一起使用。例如： 						

  ```
  network --device=em1 --vlanid=171 --interfacename=vlan171
  ```

  ​								以上命令在 `em1` 设备上创建了 ID 为 `171` 的虚拟 LAN 接口（名为 `vlan171`） 。 						

  ​								接口名称可以是任意名称（例如，`my-vlan`），但在某些情况下，必须遵循以下约定： 						

  - ​										如果名称中包含句点（`.`），它的格式必须是 `*NAME*.*ID*`。*NAME* 是任意的，但 *ID* 必须是 VLAN ID。例如： `em1.171` 或 `my-vlan.171`。 								
  - ​										以 `vlan` 开头的名称必须使用 `vlan*ID*` 格式 - 例如 `vlan171`。 								

- ​								`--teamslaves=` - 使用这个选项中指定的二级设备创建由 `--device=` 选项指定的 team 设备。二级设备用逗号分开。辅助设备可带有其配置,该配置是一个单引号的 JSON 字符串,其中的双引号使用 `\` 字符转义。例如： 						

  ```
  network --teamslaves="p3p1'{\"prio\": -10, \"sticky\": true}',p3p2'{\"prio\": 100}'"
  ```

  ​								另请参阅 `--teamconfig=` 选项。 						

- ​								`--teamconfig=` - 用双引号括起来的 team 设备配置，它是一个 JSON 字符串，其中的双引号使用 `\` 进行转义。该设备名称由 `--device=` 选项指定,其从设备及其配置根据 `--teamslaves=` 选项指定。例如： 						

  ```
  network --device team0 --activate --bootproto static --ip=10.34.102.222 --netmask=255.255.255.0 --gateway=10.34.102.254 --nameserver=10.34.39.2 --teamslaves="p3p1'{\"prio\": -10, \"sticky\": true}',p3p2'{\"prio\": 100}'" --teamconfig="{\"runner\": {\"name\": \"activebackup\"}}"
  ```

- ​								`--bridgeslaves=` - 使用这个选项时，将生成使用这个 `--device=` 选项指定的设备名称的网络桥接，并在 `--bridgeslaves=` 选项中定义的设备添加到网桥中。例如： 						

  ```
  network --device=bridge0 --bridgeslaves=em1
  ```

- ​								`--bridgeopts=` - 桥接接口用逗号分开的可选参数列表。可用值包括 `stp`、`priority`、`forward-delay`、`hello-time`、 `max-age` 和 `ageing-time`。有关这些参数的详情，请参考 https://developer.gnome.org/NetworkManager/0.9/ref-settings.html，或 `nm-settings(5)` man page 中的  *桥接设置*表。 						

  ​								有关网络桥接的常规信息，请参阅[配置和管理网络](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_networking/)文档。 						

- ​								`--bindto=mac` - 在安装的系统中将设备配置（`ifcfg`）文件绑定到设备 MAC 地址（`HWADDR`）而不是默认绑定到接口名称（`DEVICE`）。请注意，这个选项独立于 `--device=` 选项 - `--bindto=mac` 将被应用，即使同一 `network` 命令也指定了一个设备名称，`link` 或 `bootif`。 						

**备注**

- ​								由于命名方案的变化，在 Red Hat Enterprise Linux 8 中 `ethN` 设备名（如 `eth0`）将不再可用。有关设备命名方案的更多信息，请参阅上游文档[可扩展网络接口名称](https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/)。 						
- ​								如果您使用 Kickstart 选项或者引导选项指定网络中的安装程序库，但安装过程开始时无法使用网络，安装程序会在显示 **安装概述**窗口前，显示**网络配置**窗口以用于设置网络连接。如需了解更多详细信息，请参阅执行*标准 RHEL 安装文档*中的[配置网络和主机名选项](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/graphical-installation_graphical-installation#network-hostname_configuring-system-settings)部分。 						

### B.4.2. realm

​						`realm` Kickstart 命令是可选的。使用它加入 Active Directory 或 IPA 域。有关这个命令的详情请参考 `realm(8)` man page 中的 `join` 部分。 				

**语法**

​							

```
realm join [OPTIONS] domain
```



**必填选项**

- ​								`*domain*` - 要加入的域。 						

**选项**

- ​								`--computer-ou=OU=` - 提供可分辨的机构单元名称以便创建计算机帐户。可识别名称的具体格式取决于客户端软件和成员软件。可省略可识别名称的根 DSE 部分。 						
- ​								`--no-password` - 无需密码自动加入。 						
- ​								`--one-time-password=` - 使用一次性密码加入。不是所有域都支持它。 						
- ​								`--client-software=` - 只能加入可运行这个客户端软件的域。有效值包括 `sssd` 和 `winbind`。不是所有域都支持所有值。默认情况下自动选择客户端软件。 						
- ​								`--server-software=` - 只能加入可运行这个服务器软件的域。可能的值包括 `active-directory` 或 `freeipa`。 						
- ​								`--membership-software=` - 加入域时使用这个软件。有效值包括 `samba` 和 `adcli`。不是所有域都支持所有值。默认情况下自动选择成员软件。 						

## B.5. 用于处理存储的 Kickstart 命令

​					这部分中的 Kickstart 命令配置存储的各个方面，比如设备、磁盘、分区、LVM 和文件系统。 			

### B.5.1. device（已弃用）

​						`device` Kickstart 命令是可选的。使用它载入其他内核模块。 				

​						在大多数 PCI 系统中，安装程序会自动探测以太网卡和 SCSI 卡。然而，在老的系统和某些 PCI 系统中，Kickstart 需要提示才能找到正确的设备。`device` 命令用来告诉安装程序安装额外的模块，使用以下格式： 				

**语法**

​							

```
device moduleName --opts=options
```



**选项**

- ​								*moduleName* - 使用应该安装的内核模块的名称替换。 						

- ​								`--opts=` - 传递给内核模块的选项。例如： 						

  ```
  device --opts="aic152x=0x340 io=11"
  ```

### B.5.2. autopart

​						`autopart` Kickstart 命令是可选的。它自动创建分区。 				

​						自动创建的分区包括：一个 root（`/`）分区（1 GB 或更大）、一个 `swap` 分区和一个适合于体系结构的 `/boot` 分区。在足够大的驱动器上（50GB 以上），还会创建一个 `/home` 分区。 				

**语法**

​							

```
autopart OPTIONS
```



**选项**

- ​								`--type=` - 选择您要使用的预定义的自动分区方案之一。可接受以下值： 						

  - ​										`lvm`：LVM 分区方案。 								
  - ​										`plain`：没有 LVM 的常规分区。 								
  - ​										`thinp`：LVM Thin Provisioning 分区方案。 								

  ​								有关可用分区方案的描述请查看 [第 C.1 节 “支持的设备类型”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#supported-device-types_partitioning-reference)。 						

- ​								`--fstype=` - 选择可用文件系统类型之一。可用值有 `ext2`、`ext3`、`ext4` `xfs`、和 `vfat`。默认文件系统是 `xfs`。有关这些文件系统的详情请参考 [第 C.2 节 “支持的文件系统”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#supported-file-systems_partitioning-reference)。 						

- ​								`--nohome` - 禁止自动创建 `/home` 分区。 						

- ​								`--nolvm` - 不要将 LVM 用于自动分区。这个选项等同于 `--type=plain`。 						

- ​								`--noboot` - 不创建 `/boot` 分区。 						

- ​								`--noswap` - 不创建交换分区。 						

- ​								`--encrypted` - 使用 LUKS（Linux Unified Key Setup）加密所有分区。这等同于在手动图形安装的初始分区界面中选择**加密分区**选项。 						

  注意

  ​									在加密一个或多个分区时， Anaconda 会尝试收集 256 字节熵，以保证安全加密分区。收集熵可能需要一些时间 - 无论是否有收集到足够的熵，该过程将在最多 10 分钟后停止。 							

  ​									与安装系统互动（通过键盘输入或移动鼠标）可加速此进程。如果要在虚拟机中安装，也可以在 `virtio-rng` 客户端中添加设备（虚拟随机数生成器）。 							

- ​								`--luks-version=*LUKS_VERSION*` - 指定应该用来加密文件系统的 LUKS 格式版本。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--passphrase=` - 为所有加密设备提供默认的系统范围内的密码短语。 						

- ​								`--escrowcert=*URL_of_X.509_certificate*` - 将所有加密卷的数据加密密钥保存为文件 `/root`，使用来自 *URL_of_X.509_certificate* 指定的 URL 的 X.509 证书进行加密。每个加密卷的密钥都作为单独的文件保存。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--backuppassphrase` - 为每个加密卷添加随机生成的密码短语。将这些密码短语以独立文件形式保存到 `/root`，使用由 `--escrowcert` 指定的 X.509 证书加密。只有在指定了 `--escrowcert` 时这个选项才有意义。 						

- ​								`--cipher=` - 如果无法满足 Anaconda 的默认 `aes-xts-plain64` 设置，则需要指定加密类型。这个选项必须与 `--encrypted` 选项一同使用，单独使用无效。[安全强化](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/)文档中列出了可用加密类型，但红帽强烈推荐您使用 `aes-xts-plain64` 或 `aes-cbc-essiv:sha256`。 						

- ​								`--pbkdf=*PBKDF*` - 为 LUKS keylot 设置 PBKDF（Password-Based Key Derivation Function）算法。另请参阅 man page *cryptsetup(8)*。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--pbkdf-memory=*PBKDF_MEMORY*` - 为 PBKDF 设置内存成本。另请参阅 man page *cryptsetup(8)*。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--pbkdf-time=*PBKDF_TIME*` - 设置 PBKDF 密码处理所消耗的毫秒数。详情请参阅 man page *cryptsetup(8)* 中的 `--iter-time` 部分。这个选项只在指定了 `--encrypted` 时才有意义，并且与 `--pbkdf-iterations` 相互排斥。 						

- ​								`--pbkdf-iterations=*PBKDF_ITERATIONS*` - 设定直接迭代的次数，并避免 PBKDF 基准数据。详情请参阅 man page *cryptsetup(8)* 中的 `--pbkdf-force-iterations` 部分。这个选项只在指定了 `--encrypted` 时才有意义，并且与 `--pbkdf-time` 相互排斥。 						

**备注**

- ​								同一 Kickstart 文件中，`autopart` 选项不能与 `part/partition`、`raid`、`logvol`、`volgroup` 选项一同使用。 						
- ​								`autopart` 命令不是必须的，但如果您的 Kickstart 脚本中没有 `part` 或者 `mount` 命令，则必须包括这个命令。 						
- ​								在 CMS 类型的一个 FBA DASD 中安装时，建议使用 `autopart --nohome` Kickstart 选项。这样可保证安装程序不会创建独立 `/home` 分区。安装过程可以成功进行。 						
- ​								如果您丢失了 LUKS 密码短语，那么就完全无法访问所有加密的分区及其数据。丢失的密码短语是无法找回的。但是，您可以使用 `--escrowcert` 选项保存加密密码短语，并使用 `--backuppassphrase` 生成加密密码短语备份。 						

### B.5.3. bootloader（必需）

​						`bootloader` Kickstart 命令是必需的。它指定引导装载程序的安装方式。 				

**语法**

​							

```
bootloader [OPTIONS]
```



**选项**

- ​								`--append=` - 指定附加内核参数。要指定多个参数，使用空格分隔它们。例如： 						

  ```
  bootloader --location=mbr --append="hdd=ide-scsi ide=nodma"
  ```

  ​								安装 `plymouth` 软件包时会自动添加 `rhgb` 和 `quiet` 参数，即使您在此没有指定它们或者没有使用该 `--append=` 命令。要禁用此行为，请明确禁止安装 `plymouth`: 						

  ```
  %packages
  -plymouth
  %end
  ```

  ​								这个选项可用于禁用在大多数现代处理器中存在的 Meltdown 和 Spectre speculative  安全漏洞（CVE-2017-5754、CVE-2017-5753 和  CVE-2017-5715）。在某些情况下，这些机制可能并不是必需的，启用它们可能会导致性能降低而不会提高安全性。要禁用这些系统，在您的  Kickstart 文件中添加相应的选项 - 例如：在 AMD 64/Intel 64 系统中使用 `bootloader --append="nopti noibrs noibpb"`。 						

  警告

  ​									在禁用任何漏洞缓解机制前，请确定您的系统不会受到安全攻击。有关 Meltdown 和 Spectre 漏洞的详情，请查看[红帽漏洞响应文章](https://access.redhat.com/security/vulnerabilities/speculativeexecution)。 							

- ​								`--boot-drive=` - 指定引导装载程序要写入的驱动器，以及用来引导计算机的驱动器。如果您使用多路径设备作为引导驱动器，使用它的 disk/by-id/dm-uuid-mpath-WWID 名称指定该设备。 						

  重要

  ​									目前在使用 `zipl` 引导装载程序的 IBM Z 系统中的 Red Hat Enterprise Linux 安装中会忽略 `--boot-drive=` 选项。当安装 `zipl` 时，它会自行决定引导驱动器。 							

- ​								`--leavebootorder` - 安装程序会在引导装载程序中安装的系统列表的顶部添加 Red Hat Enterprise Linux 8，并保留所有现有的条目及其顺序。 						

- ​								`--driveorder=` - 指定在 BIOS 引导顺序中的首选驱动器。例如： 						

  ```
  bootloader --driveorder=sda,hda
  ```

- ​								`--location=` - 指定引导记录的写入位置。有效值如下： 						

  - ​										`mbr` - 默认选项。具体要看驱动器是使用主引导记录（MBR）还是 GUID 分区表（GPT）方案： 								

    ​										在 GPT 格式的磁盘中，这个选项会在 BIOS 引导分区中安装 stage 1.5 引导装载程序。 								

    ​										在使用 MBR 格式化的磁盘中，会在 MBR 和第一个分区之间的空白空间中安装 stage 1.5。 								

  - ​										`partition` - 在包含内核的分区的第一个扇区安装引导装载程序。 								

  - ​										`none` - 不安装引导装载程序。 								

  ​								在大多数情况下，不需要指定这个选项。 						

- ​								`--nombr` - 不要在 MBR 中安装引导装载程序。 						

- ​								`--password=` - 如果使用 GRUB2，则将引导装载程序密码设定为这个选项指定的密码。这应该被用来限制对可传入任意内核选项的 GRUB2 shell 的访问。 						

  ​								如果指定密码，GRUB2 还会询问用户名。用户名为 `root`。 						

- ​								`--iscrypted` - 通常当您使用 `--password=` 选项指定引导装载程序密码时，会以明文形式将其保存在 Kickstart 文件中。如果要加密密码，使用这个选项和一个加密的密码。 						

  ​								要生成加密的密码，使用 `grub2-mkpasswd-pbkdf2` 命令，输入要使用的密码，并将该命令的输出结果（以 `grub.pbkdf2` 开始的哈希值）复制到 Kickstart 文件中。附带加密密码的 `bootloader` Kickstart 条目示例类似如下： 						

  ```
  bootloader --iscrypted --password=grub.pbkdf2.sha512.10000.5520C6C9832F3AC3D149AC0B24BE69E2D4FB0DBEEDBD29CA1D30A044DE2645C4C7A291E585D4DC43F8A4D82479F8B95CA4BA4381F8550510B75E8E0BB2938990.C688B6F0EF935701FF9BD1A8EC7FE5BD2333799C98F28420C5CC8F1A2A233DE22C83705BB614EA17F3FDFDF4AC2161CEA3384E56EB38A2E39102F5334C47405E
  ```

- ​								`--timeout=` - 指定引导装载程序引导默认选项前等待的时间（以秒为单位）。 						

- ​								`--default=` - 设置引导装载程序配置里的默认引导镜像。 						

- ​								`--extlinux` - 使用 extlinux 引导装载程序而不是 GRUB2。这个选项只适用于支持 extlinux 的系统。 						

- ​								`--disabled` - 这个选项是 `--location=none` 的一个更强大的版本。`--location=none` 只是简单地禁用引导装载程序安装，而 `--disabled` 禁用引导装载程序安装，同时禁用包含引导装载程序的软件包安装，从而节省了空间。 						

**备注**

- ​								红帽建议在每个系统中设置引导装载程序密码。一个没有保护的引导装载程序可以让潜在的攻击者修改系统的引导选项，并获得对系统的未授权访问。 						

- ​								在某些情况下，需要一个特殊的分区来在 AMD64、Intel 64 和 64 位 ARM  系统上安装引导装载程序。这个分区的类型和大小取决于您要安装引导装载程序的磁盘是否使用主引导记录（MBR）还是 GUID  分区表（GPT）模式。如需更多信息，请参阅执行*标准 RHEL 安装文档*中的[配置引导装载程序](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index#boot-loader-installation_configuring-system-settings)部分。 						

- ​								使用 `sd*X*` （或 `/dev/sd*X*`）格式的设备名称在重启后可能无法保证它们的一致性，这会使一些 Kickstart 命令的使用变得复杂。当某个命令调用设备节点名称时，您可以使用 `/dev/disk` 中的任何项目。例如，改为： 						

  ```
  part / --fstype=xfs --onpart=sda1
  ```

  ​								您可以使用类似以下条目之一： 						

  ```
  part / --fstype=xfs --onpart=/dev/disk/by-path/pci-0000:00:05.0-scsi-0:0:0:0-part1
  ```

  ```
  part / --fstype=xfs --onpart=/dev/disk/by-id/ata-ST3160815AS_6RA0C882-part1
  ```

  ​								这样命令总是以同一存储设备为目标。这在大型存储环境中特别有用。相关详情，请参阅*管理存储设备*文档中的[持久性名称属性概述](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_storage_devices/index#assembly_overview-of-persistent-naming-attributes_managing-storage-devices)部分。 						

- ​								`--upgrade` 选项在 Red Hat Enterprise Linux 8 中已弃用。 						

### B.5.4. zipl

​						`zipl` Kickstart 命令是可选的。它为 IBM Z 指定 ZIPL 配置。 				

**选项**

- ​								`--secure-boot` - 如果安装系统支持则启用安全引导。 						

注意

​							当在 IBM z14 之后的系统中安装时，无法从 IBM z14 或更早的型号引导安装的系统。 					

- ​								`--force-secure-boot` - 无条件启用安全引导。 						

注意

​							IBM z14 及更早的型号不支持安装。 					

- ​								`--no-secure-boot` - 禁用安全引导。 						

注意

​							IBM z14 及更早的型号不支持安全引导。`--no-secure-boot` 如果您打算在 IBM z14 及更早的型号中引导安装的系统，请使用。 					

### B.5.5. clearpart

​						`clearpart` Kickstart 命令是可选的。在创建新分区之前，它会从系统中删除分区。默认情况下不会删除任何分区。 				

**语法**

​							

```
clearpart OPTIONS
```



**选项**

- ​								`--all` - 删除系统中的所有分区。 						

  ​								这个选项将擦除安装程序可以访问的所有磁盘，包括任何附加的网络存储。请小心使用这个选项。 						

  ​								您可以使用 `--drives=` 选项并指定只指定您要清除的驱动器,或在以后附加网络存储（例如：在 Kickstart 文件的 `%post` 部分）,或者阻止将用来访问网络存储的内核模块列入清单,可以防止 `clearpart` 清除您要保留的存储。 						

- ​								`--drives=` - 指定从哪个驱动器中清除分区。例如，下面的命令清除了主 IDE 控制器上前两个驱动器上所有分区： 						

  ```
  clearpart --drives=hda,hdb --all
  ```

  ​								要清除多路径设备，请使用格式 `disk/by-id/scsi-*WWID*`，其中 *WWID* 是该设备的通用识别符。例如：要清除 WWID 为 `58095BEC5510947BE8C0360F604351918` 的磁盘，使用： 						

  ```
  clearpart --drives=disk/by-id/scsi-58095BEC5510947BE8C0360F604351918
  ```

  ​								这个格式是所有多路径设备的首选，但如果出现错误，没有使用逻辑卷管理（LVM）的多路径设备也可以使用`disk/by-id/dm-uuid-mpath-*WWID*` 格式进行清除，其中 *WWID* 是该设备的通用识别符。例如：要清除 WWID 为 `2416CD96995134CA5D787F00A5AA11017` 的磁盘，使用： 						

  ```
  clearpart --drives=disk/by-id/dm-uuid-mpath-2416CD96995134CA5D787F00A5AA11017
  ```

  ​								不要使用类似设备名称指定多路径设备，如 `mpatha`。这样的设备名称并不是特定磁盘特有的。`/dev/mpatha` 在安装过程中命名的磁盘可能不是您期望的磁盘。因此，`clearpart` 命令可能会对错误的磁盘进行操作。 						

- ​								`--initlabel` - 通过为所有磁盘在其对于的架构中创建一个默认的磁盘标签来格式化磁盘（例如： 对于 x86，使用 msdos）。因为 `--initlabel` 可以查看所有磁盘，因此请确保只连接要格式化的驱动器。 						

  ```
  clearpart --initlabel --drives=names_of_disks
  ```

  ​								例如： 						

  ```
  clearpart --initlabel --drives=dasda,dasdb,dasdc
  ```

- ​								`--list=` - 指定要清除哪些分区。这个选项会覆盖 `--all` 和 `--linux` 选项。可在不同的驱动器间使用。例如： 						

  ```
  clearpart --list=sda2,sda3,sdb1
  ```

- ​								`--disklabel=*LABEL*` - 设置要使用的默认 disklabel。只有支持该平台的磁盘标签才会被接受。例如，在 64 位 Intel 和 AMD 构架中，接受 `msdos` 和 `gpt` 磁盘标签，但不接受 `dasd`。 						

- ​								`--linux` - 删除所有 Linux 分区。 						

- ​								`--none` （默认）- 不删除任何分区。 						

- ​								`--cdl` - 重新格式化 LDL DASD 为 CDL 格式。 						

**备注**

- ​								使用 `sd*X*` （或 `/dev/sd*X*`）格式的设备名称在重启后可能无法保证它们的一致性，这会使一些 Kickstart 命令的使用变得复杂。当某个命令调用设备节点名称时，您可以使用 `/dev/disk` 中的任何项目。例如，改为： 						

  ```
  part / --fstype=xfs --onpart=sda1
  ```

  ​								您可以使用类似以下条目之一： 						

  ```
  part / --fstype=xfs --onpart=/dev/disk/by-path/pci-0000:00:05.0-scsi-0:0:0:0-part1
  ```

  ```
  part / --fstype=xfs --onpart=/dev/disk/by-id/ata-ST3160815AS_6RA0C882-part1
  ```

  ​								这样命令总是以同一存储设备为目标。这在大型存储环境中特别有用。相关详情，请参阅*管理存储设备*文档中的[持久性名称属性概述](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_storage_devices/index#assembly_overview-of-persistent-naming-attributes_managing-storage-devices)部分。 						

- ​								如果使用 `clearpart` 命令，则无法在逻辑分区中使用 `part --onpart` 命令。 						

### B.5.6. fcoe

​						`fcoe` Kickstart 命令是可选的。它指定除了由 EDD （Enhanced Disk Drive Services）发现的设备外，还要自动激活哪些 FCoE 设备。 				

**语法**

​							

```
fcoe --nic=name [OPTIONS]
```



**选项**

- ​								`--nic=` （强制）- 要激活的设备名称。 						
- ​								`--dcb=` - 建立 DCB（Data Center Bridging）设置。 						
- ​								`--autovlan` - 自动发现 VLAN。默认启用这个选项。 						

### B.5.7. ignoredisk

​						`ignoredisk` Kickstart 命令是可选的。这会导致安装程序忽略指定的磁盘。 				

​						如果您使用自动分区并希望忽略某些磁盘，这就很有用。例如，没有 `ignoredisk`，如要尝试在 SAN-cluster 中部署，Kickstart 将失败，因为安装程序检测到的到 SAN 的被动路径没有分区表。 				

**语法**

​							

```
ignoredisk --drives=drive1,drive2,... | --only-use=drive
```



**选项**

- ​								`--drives=*driveN*,…` - 使用  *`sda`* 、`sdb`、…、`hda`、… 等之一替换 driveN。 						

- ​								`--only-use=*driveN*,…` - 指定安装程序要使用的磁盘列表。其它磁盘将被忽略。例如：要在安装过程使用磁盘 `sda`，并忽略所有其他磁盘： 						

  ```
  ignoredisk --only-use=sda
  ```

  ​								要包括不使用 LVM 的多路径设备： 						

  ```
  ignoredisk --only-use=disk/by-id/dm-uuid-mpath-2416CD96995134CA5D787F00A5AA11017
  ```

  ​								要包括使用 LVM 的多路径设备： 						

  ```
  ignoredisk --only-use==/dev/disk/by-id/dm-uuid-mpath-
  ```

  ```
  bootloader --location=mbr
  ```

​						您必须只指定 `--drives` `--only-use` 其中之一。 				

**备注**

- ​								该 `--interactive` 选项在 Red Hat Enterprise Linux 8 中已弃用。这个选项允许用户手动在高级存储界面中进行操作。 						

- ​								要忽略不使用逻辑卷管理（LVM）的多路径设备，使用格式 `disk/by-id/dm-uuid-mpath-*WWID*`，其中 *WWID* 是该设备的通用识别符。例如：要忽略 WWID 的磁盘 `2416CD96995134CA5D787F00A5AA11017`，使用： 						

  ```
  ignoredisk --drives=disk/by-id/dm-uuid-mpath-2416CD96995134CA5D787F00A5AA11017
  ```

- ​								不要使用类似设备名称指定多路径设备，如 `mpatha`。这样的设备名称并不是特定磁盘特有的。`/dev/mpatha` 在安装过程中命名的磁盘可能不是您期望的磁盘。因此，`clearpart` 命令可能会对错误的磁盘进行操作。 						

- ​								使用 `sd*X*` （或 `/dev/sd*X*`）格式的设备名称在重启后可能无法保证它们的一致性，这会使一些 Kickstart 命令的使用变得复杂。当某个命令调用设备节点名称时，您可以使用 `/dev/disk` 中的任何项目。例如，改为： 						

  ```
  part / --fstype=xfs --onpart=sda1
  ```

  ​								您可以使用类似以下条目之一： 						

  ```
  part / --fstype=xfs --onpart=/dev/disk/by-path/pci-0000:00:05.0-scsi-0:0:0:0-part1
  ```

  ```
  part / --fstype=xfs --onpart=/dev/disk/by-id/ata-ST3160815AS_6RA0C882-part1
  ```

  ​								这样命令总是以同一存储设备为目标。这在大型存储环境中特别有用。相关详情，请参阅*管理存储设备*文档中的[持久性名称属性概述](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_storage_devices/index#assembly_overview-of-persistent-naming-attributes_managing-storage-devices)部分。 						

### B.5.8. iscsi

​						`iscsi` Kickstart 命令是可选的。它指定了在安装过程中要添加的附加 iSCSI 存储。 				

**语法**

​							

```
iscsi --ipaddr=address [OPTIONS]
```



**必填选项**

- ​								`--ipaddr=` （必需）- 要连接的目标的 IP 地址。 						

**可选选项**

- ​								`--port=` （必需）- 端口号。如果没有存在，默认自动使用 `--port=3260`。 						
- ​								`--target=` - 目标 IQN（iSCSI 限定名称）。 						
- ​								`--iface=` - 绑定到特定网络接口的连接，而不是使用由网络层决定的默认接口。一旦使用，必须在整个 Kickstart 文件的 `iscsi` 命令的所有实例中指定它。 						
- ​								`--user=` - 需要与目标进行验证的用户名 						
- ​								`--password=` - 与为目标指定的用户名对应的密码 						
- ​								`--reverse-user=` - 用于与来自使用反向 CHAP 验证对象的初始程序一同进行验证的用户名 						
- ​								`--reverse-password=` - 与为发起方指定的用户名对应的密码 						

**备注**

- ​								如果使用 `iscsi` 命令，还必须使用 `iscsiname` 命令为 iSCSI 节点分配一个名称。`iscsiname` 命令必须在 Kickstart 文件中的 `iscsi` 命令前出现。 						
- ​								在可能的情况下，在系统 BIOS 或者固件中配置 iSCSI 存储，而不是使用该 `iscsi` 命令。Anaconda 自动检测并使用在 BIOS 或固件中配置的磁盘，且在 Kickstart 文件中不需要特殊配置。 						
- ​								如果您必须使用 `iscsi` 命令，确定在开始安装时激活了网络连接，且在您使用 `clearpart` 或 `ignoredisk` 等类似命令指代 iSCSI 磁盘*前*，`iscsi` 命令出现在 Kickstart 文件中 。 						

### B.5.9. iscsiname

​						`iscsiname` Kickstart 命令是可选的。它为 `iscsi` 命令指定的 iSCSI 节点分配一个名称。 				

**语法**

​							

```
iscsiname iqname
```



**选项**

- ​								`*iqname*` - 分配给 iSCSI 节点的名称。 						

**备注**

- ​								如果您在 Kickstart 文件中使用 `iscsi` 命令，则必须之前在 Kickstart 文件*前面的部分*指定了`iscsiname`。 						

### B.5.10. logvol

​						`logvol` Kickstart 命令是可选的。它为逻辑卷管理（LVM）创建一个逻辑卷。 				

**语法**

​							

```
logvol mntpoint --vgname=name --name=name [OPTIONS]
```



**必填选项**

- ​								`*mntpoint*` - 挂载分区的挂载点。必须是以下格式之一： 						

  - ​										`/*path*` 								

    ​										例如 `/` 或 `/home` 								

  - ​										`swap` 								

    ​										该分区被用作交换空间。 								

    ​										要自动决定 swap 分区的大小，使用 `--recommended`： 								

    ```
    swap --recommended
    ```

    ​										要自动决定交换分区的大小，并允许系统的额外空间可以休眠，使用 `--hibernation` 选项： 								

    ```
    swap --hibernation
    ```

    ​										分配的分区大小为由 `--recommended` 分配的交换分区再加上所在系统上的内存总量。 								

    ​										有关这些命令分配的 swap 大小,请参阅 AMD64、Intel 64 和 64 位 ARM 系统 [第 C.4 节 “推荐的分区方案”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#recommended-partitioning-scheme_partitioning-reference)。 								

- ​								`--vgname=*name*` - 卷组名称。 						

- ​								`--name=*name*` - 逻辑卷的名称。 						

**可选选项**

- ​								`--noformat` - 使用现有逻辑卷且不要对其进行格式化。 						

- ​								`--useexisting` - 使用现有逻辑卷并重新格式化它。 						

- ​								`--fstype=` - 为逻辑卷设置文件系统类型。有效值包括 `xfs`、`ext2`、`ext3`、`ext4`、`swap` 和 `vfat`。 						

- ​								`--fsoptions=` - 指定在挂载文件系统时所用选项的自由格式字符串。这个字符串将被复制到安装的系统的 `/etc/fstab` 文件中，并使用引号括起来。 						

- ​								`--mkfsoptions=` - 指定要传递给在这个分区上创建文件系统的程序的其他参数。没有对参数列表进行任何操作，因此必须以可直接传递给 mkfs 程序的格式提供。这意味着，根据具体文件系统，多个选项应该用逗号分开，或使用双引号分开。 						

- ​								`--fsprofile=` - 指定传递给在这个分区上创建文件系统的程序的使用类型。使用类型定义了创建文件系统时使用的各种微调参数。要使用这个选项，文件系统必须支持使用类型，且必须有一个配置文件来列出有效类型。对于 `ext2`、`ext3` 和 `ext4`，这个配置文件是 `/etc/mke2fs.conf`. 						

- ​								`--label=` - 为逻辑卷设置标签。 						

- ​								`--grow` - 扩展逻辑卷以占据可用空间（若有）,或使用指定的最大值（若有）。只有在磁盘镜像中预分配了最小存储空间时，必须使用该选项，并希望该卷扩展并占据所有可用空间。在物理环境中，这是一次性的操作。但是在虚拟环境中，当虚拟机将任何数据写入虚拟磁盘时，卷大小会增加。 						

- ​								`--size=` - MiB 中的逻辑卷的大小。这个选项不能与 `--percent=` 选项一同使用。 						

- ​								`--percent=` - 考虑任何静态大小逻辑卷时的逻辑卷大小，作为卷组中剩余空间的百分比。这个选项不能与 `--size=` 选项一同使用。 						

  重要

  ​									当创建新逻辑卷时，必须使用 `--size=` 选项静态指定其大小，或使用 `--percent=` 选项指定剩余空间的比例。您不能在同一逻辑卷中同时使用这些选项。 							

- ​								`--maxsize=` - 当将逻辑卷设置为可扩充时 MiB 的最大值。在这里指定一个整数值，如 `500` （不要在数字后面加单位）。 						

- ​								`--recommended` - 创建逻辑卷时使用这个选项，根据您的系统硬件自动决定这个卷的大小。有关推荐方案的详情,请参阅 AMD64、Intel 64 和 64 位 ARM 系统 [第 C.4 节 “推荐的分区方案”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#recommended-partitioning-scheme_partitioning-reference)。 						

- ​								`--resize` - 重新调整逻辑卷大小。如果使用这个选项，必须同时指定 `--useexisting` 和 `--size`。 						

- ​								`--encrypted` - 指定该逻辑卷应该用 LUKS 加密，使用 `--passphrase=` 选项中提供的密码短语。如果您没有指定密码短语，安装程序将使用 `autopart --passphrase` 命令设定的默认系统级密码，或者在未设定默认密码时暂停安装并提示您输入密码短语。 						

  注意

  ​									在加密一个或多个分区时， Anaconda 会尝试收集 256 字节熵，以保证安全加密分区。收集熵可能需要一些时间 - 无论是否有收集到足够的熵，该过程将在最多 10 分钟后停止。 							

  ​									与安装系统互动（通过键盘输入或移动鼠标）可加速此进程。如果要在虚拟机中安装，也可以在 `virtio-rng` 客户端中添加设备（虚拟随机数生成器）。 							

- ​								`--passphrase=` - 指定在加密这个逻辑卷时要使用的密码短语。这个选项必须与 `--encrypted` 选项一同使用，单独使用无效。 						

- ​								`--cipher=` - 如果无法满足 Anaconda 的默认 `aes-xts-plain64` 设置，则需要指定加密类型。这个选项必须与 `--encrypted` 选项一同使用，单独使用无效。[安全强化](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/)文档中列出了可用加密类型，但红帽强烈推荐您使用 `aes-xts-plain64` 或 `aes-cbc-essiv:sha256`。 						

- ​								`--escrowcert=*URL_of_X.509_certificate*` - 将所有加密卷的数据加密密钥保存为文件 `/root`，使用来自 *URL_of_X.509_certificate* 指定的 URL 的 X.509 证书进行加密。每个加密卷的密钥都作为单独的文件保存。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--luks-version=*LUKS_VERSION*` - 指定应该用来加密文件系统的 LUKS 格式版本。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--backuppassphrase` - 为每个加密卷添加随机生成的密码短语。将这些密码短语以独立文件形式保存到 `/root`，使用由 `--escrowcert` 指定的 X.509 证书加密。只有在指定了 `--escrowcert` 时这个选项才有意义。 						

- ​								`--pbkdf=*PBKDF*` - 为 LUKS keylot 设置 PBKDF（Password-Based Key Derivation Function）算法。另请参阅 man page *cryptsetup(8)*。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--pbkdf-memory=*PBKDF_MEMORY*` - 为 PBKDF 设置内存成本。另请参阅 man page *cryptsetup(8)*。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--pbkdf-time=*PBKDF_TIME*` - 设置 PBKDF 密码处理所消耗的毫秒数。详情请参阅 man page *cryptsetup(8)* 中的 `--iter-time` 部分。这个选项只在指定了 `--encrypted` 时才有意义，并且与 `--pbkdf-iterations` 相互排斥。 						

- ​								`--pbkdf-iterations=*PBKDF_ITERATIONS*` - 设定直接迭代的次数，并避免 PBKDF 基准数据。详情请参阅 man page *cryptsetup(8)* 中的 `--pbkdf-force-iterations` 部分。这个选项只在指定了 `--encrypted` 时才有意义，并且与 `--pbkdf-time` 相互排斥。 						

- ​								`--thinpool` - 创建精简池逻辑卷。（使用挂载点 `none`） 						

- ​								`--metadatasize=*size*` - 为新的精简池设备指定元数据大小（单位 MiB）。 						

- ​								`--chunksize=*size*` - 为新的精简池设备指定块大小（单位 KiB）。 						

- ​								`--thin` - 创建精简逻辑卷。（要求使用 `--poolname`） 						

- ​								`--poolname=*name*` - 指定在其中创建精简逻辑卷的精简池名称。需要 `--thin` 选项。 						

- ​								`--profile=*name*` - 指定与精简逻辑卷搭配使用的配置配置集的名称。如果使用，该名称也会包含在给定逻辑卷的元数据中。默认情况下，可用的配置集是 `default` 和 `thin-performance`，且在 `/etc/lvm/profile/` 目录中定义。详情请查看 `lvm(8)` man page。 						

- ​								`--cachepvs=` - 用逗号分开的物理卷列表，它应用作这个卷的缓存。 						

- ​								`--cachemode=` - 指定应该使用哪种模式缓存这个逻辑卷 - `writeback` 或 `writethrough`。 						

  注意

  ​									有关缓存的逻辑卷及其模式的详情，请参考 `lvmcache(7)` man page。 							

- ​								`--cachesize=` - 附加到逻辑卷的缓存大小，以 MiB 为单位。这个选项需要 `--cachepvs=` 选项。 						

**备注**

- ​								在使用 Kickstart 安装 Red Hat Enterprise Linux 时，不要在逻辑卷和卷组名称中使用小横线(`-`)。如果使用这个字符，安装会完成，但 `/dev/mapper/` 目录会列出这些卷和卷组的每个横线都会加倍。例如：名为 `volgrp-01` 的卷组包含一个名为 `logvol-01` 的逻辑卷将会被列出为 `/dev/mapper/volgrp—01-logvol—01`。 						

  ​								这个限制只适用于新创建的逻辑卷和卷组名称。如果您使用 `--noformat` 重新使用现有名称，则它们的名称不会被更改。 						

- ​								如果您丢失了 LUKS 密码短语，那么就完全无法访问所有加密的分区及其数据。丢失的密码短语是无法找回的。但是，您可以使用 `--escrowcert` 选项保存加密密码短语，并使用 `--backuppassphrase` 生成加密密码短语备份。 						

**示例**

- ​								首先创建分区，然后创建逻辑卷组，然后创建逻辑卷： 						

  ```
  part pv.01 --size 3000
  volgroup myvg pv.01
  logvol / --vgname=myvg --size=2000 --name=rootvol
  ```

- ​								首先创建分区，然后创建逻辑卷组，再创建逻辑卷以占据卷组中剩余的 90% 空间： 						

  ```
  part pv.01 --size 1 --grow
  volgroup myvg pv.01
  logvol / --vgname=myvg --name=rootvol --percent=90
  ```

**其它资源**

- ​								有关 LVM 的详情，请参考[配置和管理逻辑卷文档](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_logical_volumes/index)。 						

### B.5.11. mount

​						`mount` Kickstart 命令是可选的。它为现有块设备分配挂载点，并选择性地将其重新格式化为给定格式。 				

**语法**

​							

```
mount [OPTIONS] device mountpoint
```



**必须的选项**

- ​								`*device*` - 要挂载的块设备。 						
- ​								`*mountpoint*` - 在哪里挂载 `*device*`。它必须是有效的挂载点，如 `/` 或 `/usr` 或 `none` 如果该设备是不可卸载的（例如 `swap`）。 						

**可选选项：**

- ​								`--reformat=` - 指定重新格式化该设备的新格式（比如 `ext4`）。 						
- ​								`--mkfsoptions=` - 指定要传递给命令的附加选项，以便生成在其中指定的新文件系统 `--reformat=`。这里提供的选项列表没有被处理，因此必须使用可直接传递给该程序的格式 `mkfs`。根据具体文件系统，选项列表应该用逗号分开，或使用双引号分开。有关具体详情，请查看 `mkfs` man page（例如 `mkfs.ext4(8)` 或 `mkfs.xfs(8)`）。 						
- ​								`--mountoptions=` - 指定包含挂载文件系统时要使用的选项的自由格式字符串。将字符串复制到安装的系统上的 `/etc/fstab` 文件，并使用双引号括起来。挂载选项的完整列表及 `fstab(5)` 基本信息，请查看 `mount(8)` man page。 						

**备注**

- ​								与 Kickstart 中的大多数其它存储配置命令不同，`mount` 不需要在 Kickstart 文件中描述整个存储配置。您只需要确定系统中存在描述的块设备。但是，如果要使用挂载的所有设备*创建*存储堆栈，则必须使用其他命令，比如 `part` 要这样做。 						
- ​								在同一个 Kickstart 文件中，您不能将 `mount` 与其他存储相关的命令，如 `part`、`logvol` 或 `autopart` 一起使用。 						

### B.5.12. nvdimm

​						`nvdimm` Kickstart 命令是可选的。它对非线性内存模块(NVDIMM)设备执行操作。 				

**语法**

​							

```
nvdimm action [OPTIONS]
```



**操作**

- ​								`reconfigure` - 将特定的 NVDIMM 设备重新配置为给定模式。另外，指定的设备被隐式标记为要使用的，因此后续的同一设备 `nvdimm use` 命令就冗余了。这个操作使用以下格式： 						

  ```
  nvdimm reconfigure [--namespace=NAMESPACE] [--mode=MODE] [--sectorsize=SECTORSIZE]
  ```

  - ​										`--namespace=` - 按命名空间的设备规格。例如： 								

    ```
    nvdimm reconfigure --namespace=namespace0.0 --mode=sector --sectorsize=512
    ```

  - ​										`--mode=` - 模式规格。目前，只有 `sector` 值可用。 								

  - ​										`--sectorsize=` - 扇区模式的扇区大小。例如： 								

    ```
    nvdimm reconfigure --namespace=namespace0.0 --mode=sector --sectorsize=512
    ```

    ​										支持的扇区大小为 512 和 4096 字节。 								

- ​								`use` - 将 NVDIMM 设备指定为安装目标。该设备必须已经被配置为扇区模式 `nvdimm reconfigure`。这个操作使用以下格式： 						

  ```
  nvdimm use [--namespace=NAMESPACE|--blockdevs=DEVICES]
  ```

  - ​										`--namespace=` - 按命名空间指定设备。例如： 								

    ```
    nvdimm use --namespace=namespace0.0
    ```

  - ​										`--blockdevs=` - 指定以逗号分隔的与要使用的 NVDIMM 设备对应的块设备列表。支持星号 `*` 通配符。例如： 								

    ```
    nvdimm use --blockdevs=pmem0s,pmem1s
    nvdimm use --blockdevs=pmem*
    ```

**备注**

- ​								默认情况下，安装程序忽略所有 NVDIMM 设备。您必须使用 `nvdimm` 命令在这些设备中启用安装。 						

### B.5.13. part 或 partition

​						`part` 或 `partition` Kickstart 命令是必需的。它在系统上创建一个分区。 				

**语法**

​							

```
part|partition mntpoint --name=name --device=device --rule=rule [OPTIONS]
```



**选项**

- ​								*mntpoint* - 挂载分区的位置。该值必须是以下格式之一： 						

  - ​										`/*path*` 								

    ​										例如，`/`、`/usr`、`/home` 								

  - ​										`swap` 								

    ​										该分区被用作交换空间。 								

    ​										要自动决定 swap 分区的大小，使用 `--recommended`： 								

    ```
    swap --recommended
    ```

    ​										分配的大小将生效，但不会根据您的系统进行精确校准。 								

    ​										使用 `--hibernation` 选项： 								

    ```
    swap --hibernation
    ```

    ​										分配的分区大小为由 `--recommended` 分配的交换分区再加上所在系统上的内存总量。 								

    ​										有关这些命令分配的 swap 大小,请参阅 AMD64、Intel 64 和 64 位 ARM 系统 [第 C.4 节 “推荐的分区方案”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#recommended-partitioning-scheme_partitioning-reference)。 								

  - ​										`raid.*id*` 								

    ​										该分区用于软件 RAID（请查看 `raid`）。 								

  - ​										`pv.*id*` 								

    ​										该分区用于 LVM（请查看 `logvol`）。 								

  - ​										`biosboot` 								

    ​										该分区将用在 BIOS 引导分区中。在使用 BIOS 的 AMD64 和 Intel 64 系统中使用 GUID  分区表(GPT)中需要 1 MiB BIOS 引导分区 ; 引导装载程序将被安装到其中。UEFI 系统中不需要此功能。另请参阅 `bootloader` 命令。 								

  - ​										`/boot/efi` 								

    ​										一个 EFI 系统分区。基于 UEFI 的 AMD64、Intel 64 和 64 位 ARM 上需要 50 MiB EFI 分区。推荐的大小为 200 MiB。它在 BIOS 系统上并不需要。另请参阅 `bootloader` 命令。 								

- ​								`--size=` - MiB 中分区最小值。在这里指定一个整数值，如 `500` （不要在数字后面加单位）。 						

  重要

  ​									如果 `--size` 值太小，则安装会失败。设置 `--size` 值作为要求的最小空间量。有关大小建议,请参阅 [第 C.4 节 “推荐的分区方案”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#recommended-partitioning-scheme_partitioning-reference)。 							

- ​								`--grow` - 告诉分区使用所有可用空间（若有），或使用设置的最大值（如果指定了最大值）。 						

  注意

  ​									如果在一个 swap 分区中使用 `--grow=` 时没有设置 `--maxsize=`，Anaconda 会限制 swap 分区的最大值。对于物理内存小于 2GB 的系统，强制的限制为物理内存的两倍。对于内存大于 2GB 的系统，这个强制限制为物理内存值再加 2GB。 							

- ​								`--maxsize=` - 当分区被设置为可扩充时，MiB 中的最大分区大小。在这里指定一个整数值，如 `500` （不要在数字后面加单位）。 						

- ​								`--noformat` - 指定安装程序不要格式化分区，与 `--onpart` 命令一起使用。 						

- ​								`--onpart=` 或 `--usepart=` - 指定放置分区的设备。使用现有的空白设备并将其格式化到新指定类型。例如： 						

  ```
  partition /home --onpart=hda1
  ```

  ​								在 `/dev/hda1` 中创建 `/home`。 						

  ​								这些选项还可以在逻辑卷中添加分区。例如： 						

  ```
  partition pv.1 --onpart=hda2
  ```

  ​								该设备必须已存在于系统中，`--onpart` 选项不会创建该设备。 						

  ​								在这种情况下， Anaconda 会在不创建分区表的情况下格式化并使用驱动器。但请注意，使用这种方式格式化的设备中不支持 GRUB2 安装，且必须将其放在有分区表的驱动器中。 						

  ```
  partition pv.1 --onpart=hdb
  ```

- ​								`--ondisk=` 或 `--ondrive=` - 在现有磁盘中创建分区（由 `part` 命令指定）。这个命令总是创建一个分区。强制在特定磁盘中创建分区。例如：将分区 `--ondisk=sdb` 置于系统的第二个 SCSI 磁盘中。 						

  ​								要指定不使用逻辑卷管理（LVM）的多路径设备，使用格式 `disk/by-id/dm-uuid-mpath-*WWID*`，其中 *WWID* 是该设备的通用识别符。例如：要指定 WWID 为 `2416CD96995134CA5D787F00A5AA11017` 的磁盘，使用： 						

  ```
  part / --fstype=xfs --grow --asprimary --size=8192 --ondisk=disk/by-id/dm-uuid-mpath-2416CD96995134CA5D787F00A5AA11017
  ```

  警告

  ​									不要使用类似设备名称指定多路径设备，如 `mpatha`。这样的设备名称并不是特定磁盘特有的。`/dev/mpatha` 在安装过程中命名的磁盘可能不是您期望的磁盘。因此，`clearpart` 命令可能会对错误的磁盘进行操作。 							

- ​								`--asprimary` - 强制将该分区分配为*主*分区。如果无法将该分区作为主分区分配（通常是因为已经分配了太多的主分区），则该分区进程会失败。只有使用主引导记录（MBR）时这个选项才有意义。 						

- ​								`--fsprofile=` - 指定传递给在这个分区上创建文件系统的程序的使用类型。使用类型定义了创建文件系统时使用的各种微调参数。要使用这个选项，文件系统必须支持使用类型，且必须有一个配置文件来列出有效类型。对于 `ext2`、`ext3`、`ext4`，这个配置文件是 `/etc/mke2fs.conf`。 						

- ​								`--mkfsoptions=` - 指定要传递给在这个分区上创建文件系统的程序的其他参数。`--fsprofile` 与所有文件系统类似，不仅可用于支持该配置集概念的文件系统。没有对参数列表进行任何操作，因此必须以可直接传递给 mkfs 程序的格式提供。这意味着，根据具体文件系统，多个选项应该用逗号分开，或使用双引号分开。 						

- ​								`--fstype=` - 为分区设置文件系统类型。有效值为 `xfs`、、`ext2`、`ext3` `ext4`、`swap` `vfat`、`efi` 和 `biosboot`。 						

- ​								`--fsoptions` - 指定在挂载文件系统时所用选项的自由格式字符串。这个字符串将被复制到安装的系统的 `/etc/fstab` 文件中，并使用引号括起来。 						

- ​								`--label=` - 为独立分区分配标签。 						

- ​								`--recommended` - 自动决定分区大小。有关推荐方案的详情,请参阅 AMD64、Intel 64 和 64 位 ARM 的 [第 C.4 节 “推荐的分区方案”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#recommended-partitioning-scheme_partitioning-reference)。 						

  重要

  ​									这个选项只能用于创建文件系统的分区，比如 `/boot` 分区和 `swap` 空间。它不能被用来创建 LVM 物理卷或 RAID 成员。 							

- ​								`--onbiosdisk` - 强制在 BIOS 发现的特定磁盘中创建分区。 						

- ​								`--encrypted` - 指定该分区应该用 LUKS 加密，使用 `--passphrase` 选项中提供的密码短语。如果您没有指定密码短语，Anaconda 将使用 `autopart --passphrase` 命令设定的默认系统级密码，或者停止安装并在未设定默认密码短语时提示您输入密码短语。 						

  注意

  ​									在加密一个或多个分区时， Anaconda 会尝试收集 256 字节熵，以保证安全加密分区。收集熵可能需要一些时间 - 无论是否有收集到足够的熵，该过程将在最多 10 分钟后停止。 							

  ​									与安装系统互动（通过键盘输入或移动鼠标）可加速此进程。如果要在虚拟机中安装，也可以在 `virtio-rng` 客户端中添加设备（虚拟随机数生成器）。 							

- ​								`--luks-version=*LUKS_VERSION*` - 指定应该用来加密文件系统的 LUKS 格式版本。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--passphrase=` - 指定在加密这个分区时要使用的密码短语。这个选项必须与 `--encrypted` 选项一同使用，单独使用无效。 						

- ​								`--cipher=` - 如果无法满足 Anaconda 的默认 `aes-xts-plain64` 设置，则需要指定加密类型。这个选项必须与 `--encrypted` 选项一同使用，单独使用无效。[安全强化](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/)文档中列出了可用加密类型，但红帽强烈推荐您使用 `aes-xts-plain64` 或 `aes-cbc-essiv:sha256`。 						

- ​								`--escrowcert=*URL_of_X.509_certificate*` - 将所有加密分区的数据加密密钥保存为文件 `/root`，使用来自 *URL_of_X.509_certificate* 指定的 URL 的 X.509 证书进行加密。每个加密分区的密钥都作为单独的文件保存。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--backuppassphrase` - 为每个加密分区添加随机生成的密码短语。将这些密码短语以独立文件形式保存到 `/root`，使用由 `--escrowcert` 指定的 X.509 证书加密。只有在指定了 `--escrowcert` 时这个选项才有意义。 						

- ​								`--pbkdf=*PBKDF*` - 为 LUKS keylot 设置 PBKDF（Password-Based Key Derivation Function）算法。另请参阅 man page *cryptsetup(8)*。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--pbkdf-memory=*PBKDF_MEMORY*` - 为 PBKDF 设置内存成本。另请参阅 man page *cryptsetup(8)*。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--pbkdf-time=*PBKDF_TIME*` - 设置 PBKDF 密码处理所消耗的毫秒数。详情请参阅 man page *cryptsetup(8)* 中的 `--iter-time` 部分。这个选项只在指定了 `--encrypted` 时才有意义，并且与 `--pbkdf-iterations` 相互排斥。 						

- ​								`--pbkdf-iterations=*PBKDF_ITERATIONS*` - 设定直接迭代的次数，并避免 PBKDF 基准数据。详情请参阅 man page *cryptsetup(8)* 中的 `--pbkdf-force-iterations` 部分。这个选项只在指定了 `--encrypted` 时才有意义，并且与 `--pbkdf-time` 相互排斥。 						

- ​								`--resize=` - 重新定义现有分区大小。使用这个选项时，使用 `--size=` 选项指定目标的大小（单位 MiB），使用 `--onpart=` 指定目标分区。 						

**备注**

- ​								`part` 命令不是强制的，但您必须在 Kickstart 脚本中包含 `part`、`autopart` 或 `mount` 						

- ​								该 `--active` 选项在 Red Hat Enterprise Linux 8 中已弃用。 						

- ​								如果因为某种原因分区失败，虚拟控制台 3 中会显示诊断信息。 						

- ​								所有创建的分区都会作为安装过程的一部分进行格式化，除非 `--noformat` 和 `--onpart` 被使用。 						

- ​								使用 `sd*X*` （或 `/dev/sd*X*`）格式的设备名称在重启后可能无法保证它们的一致性，这会使一些 Kickstart 命令的使用变得复杂。当某个命令调用设备节点名称时，您可以使用 `/dev/disk` 中的任何项目。例如，改为： 						

  ```
  part / --fstype=xfs --onpart=sda1
  ```

  ​								您可以使用类似以下条目之一： 						

  ```
  part / --fstype=xfs --onpart=/dev/disk/by-path/pci-0000:00:05.0-scsi-0:0:0:0-part1
  ```

  ```
  part / --fstype=xfs --onpart=/dev/disk/by-id/ata-ST3160815AS_6RA0C882-part1
  ```

  ​								这样命令总是以同一存储设备为目标。这在大型存储环境中特别有用。相关详情，请参阅*管理存储设备*文档中的[持久性名称属性概述](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_storage_devices/index#assembly_overview-of-persistent-naming-attributes_managing-storage-devices)部分。 						

- ​								如果您丢失了 LUKS 密码短语，那么就完全无法访问所有加密的分区及其数据。丢失的密码短语是无法找回的。但是，您可以使用 `--escrowcert` 选项保存加密密码短语，并使用 `--backuppassphrase` 生成加密密码短语备份。 						

### B.5.14. raid

​						`raid` Kickstart 命令是可选的。它组成一个软件 RAID 设备。 				

**语法**

​							

```
raid mntpoint --level=level --device=device-name partitions*
```



**选项**

- ​								*mntpoint* - 挂载 RAID 文件系统的位置。如果是 `/`，RAID 级别必须是 1，除非引导分区(`/boot`)存在。如果引导分区存在，`/boot` 分区必须是级别 1，root（`/`）分区可以是任何可用的类型。*partitions** （代表多个分区可以被列举）列出了要添加到 RAID 阵列的 RAID 标记。 						

  重要

  ​									在 IBM Power 系统中，如果一个 RAID 设备已经准备好，且在安装过程中没有重新格式化，请确定 RAID 元数据版本是 `0.90` 您要将 RAID 设备 `/boot` 和 `PReP` 分区放在一起。 							

  ​									默认 Red Hat Enterprise Linux 7 `mdadm` 元数据版本不支持引导设备。 							

- ​								`--level=` - 要使用的 RAID 级别（0、1、4、5、6 或者 10）。有关各种可用 RAID 级别的详情请参考 [第 C.3 节 “支持的 RAID 类型”](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#supported-raid-types_partitioning-reference)。 						

- ​								`--device=` - 要使用的 RAID 设备名称 - 例如 `--device=root`: 						

  重要

  ​									不要使用 `md0` 格式的 `mdraid` 名称 - 无法保证这些名称具有持久性。应该使用有意义的名称，比如 `root` 或者 `swap`。使用有含义的名称可生成一个符号链接 `/dev/md/*name*` ，在 `/dev/md*X*` 其间为该阵列分配节点。 							

  ​									如果您有一个无法为其分配名称的旧阵列（v0.90 元数据），您可以使用文件系统标签或者 UUID（例如： `--device=rhel7-root --label=rhel7-root`）指定该阵列。 							

- ​								`--chunksize=` - 以 KiB 为单位设定 RAID 存储的块大小。在某些情况下，使用不同于默认(`512 Kib`)的块大小可提高 RAID 的性能。 						

- ​								`--spares=` - 指定为 RAID 阵列分配的备用驱动器数目。可使用备用驱动器在驱动器失败时重建阵列。 						

- ​								`--fsprofile=` - 指定传递给在这个分区上创建文件系统的程序的使用类型。使用类型定义了创建文件系统时使用的各种微调参数。要使用这个选项，文件系统必须支持使用类型，且必须有一个配置文件来列出有效类型。对于 ext2、ext3 和 ext4,这个配置文件是 `/etc/mke2fs.conf`。 						

- ​								`--fstype=` - 为 RAID 阵列设置文件系统类型。有效值包括 `xfs`、`ext2`、`ext3`、`ext4`、`swap` 和 `vfat`。 						

- ​								`--fsoptions=` - 指定在挂载文件系统时所用选项的自由格式字符串。这个字符串将被复制到安装的系统的 `/etc/fstab` 文件中，并使用引号括起来。 						

- ​								`--mkfsoptions=` - 指定要传递给在这个分区上创建文件系统的程序的其他参数。没有对参数列表进行任何操作，因此必须以可直接传递给 mkfs 程序的格式提供。这意味着，根据具体文件系统，多个选项应该用逗号分开，或使用双引号分开。 						

- ​								`--label=` - 指定要生成的文件系统的标签。如果给定标签已被另一个文件系统使用，则会创建一个新标签。 						

- ​								`--noformat` - 使用现有的 RAID 设备，且不要格式化 RAID 阵列。 						

- ​								`--useexisting` - 使用现有的 RAID 设备并重新格式化它。 						

- ​								`--encrypted` - 指定该 RAID 应该用 LUKS 加密，使用 `--passphrase` 选项中提供的密码短语。如果您没有指定密码短语，Anaconda 将使用 `autopart --passphrase` 命令设定的默认系统级密码，或者停止安装并在未设定默认密码短语时提示您输入密码短语。 						

  注意

  ​									在加密一个或多个分区时， Anaconda 会尝试收集 256 字节熵，以保证安全加密分区。收集熵可能需要一些时间 - 无论是否有收集到足够的熵，该过程将在最多 10 分钟后停止。 							

  ​									与安装系统互动（通过键盘输入或移动鼠标）可加速此进程。如果要在虚拟机中安装，也可以在 `virtio-rng` 客户端中添加设备（虚拟随机数生成器）。 							

- ​								`--luks-version=*LUKS_VERSION*` - 指定应该用来加密文件系统的 LUKS 格式版本。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--cipher=` - 如果无法满足 Anaconda 的默认 `aes-xts-plain64` 设置，则需要指定加密类型。这个选项必须与 `--encrypted` 选项一同使用，单独使用无效。[安全强化](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/security_hardening/)文档中列出了可用加密类型，但红帽强烈推荐您使用 `aes-xts-plain64` 或 `aes-cbc-essiv:sha256`。 						

- ​								`--passphrase=` - 指定在加密这个 RAID 设备时要使用的密码短语。这个选项必须与 `--encrypted` 选项一同使用，单独使用无效。 						

- ​								`--escrowcert=*URL_of_X.509_certificate*` - 将这个设备的数据加密密钥保存在 `/root` 中的一个文件中，使用来自 *URL_of_X.509_certificate* 指定的 URL 的 X.509 证书加密。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--backuppassphrase` - 为这个设备添加随机生成的密码短语。使用由 `--escrowcert` 指定的 X.509 证书进行加密，并保存在 `/root` 的一个文件中。只有在指定了 `--escrowcert` 时这个选项才有意义。 						

- ​								`--pbkdf=*PBKDF*` - 为 LUKS keylot 设置 PBKDF（Password-Based Key Derivation Function）算法。另请参阅 man page *cryptsetup(8)*。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--pbkdf-memory=*PBKDF_MEMORY*` - 为 PBKDF 设置内存成本。另请参阅 man page *cryptsetup(8)*。只有在指定了 `--encrypted` 时这个选项才有意义。 						

- ​								`--pbkdf-time=*PBKDF_TIME*` - 设置 PBKDF 密码处理所消耗的毫秒数。详情请参阅 man page *cryptsetup(8)* 中的 `--iter-time` 部分。这个选项只在指定了 `--encrypted` 时才有意义，并且与 `--pbkdf-iterations` 相互排斥。 						

- ​								`--pbkdf-iterations=*PBKDF_ITERATIONS*` - 设定直接迭代的次数，并避免 PBKDF 基准数据。详情请参阅 man page *cryptsetup(8)* 中的 `--pbkdf-force-iterations` 部分。这个选项只在指定了 `--encrypted` 时才有意义，并且与 `--pbkdf-time` 相互排斥。 						

**示例**

​							下面的例子展示，假定系统里有三个 SCSI 磁，如何为 `/` 创建 RAID 1 分区，为 `/home` 创建 RAID 5。它还创建三个交换分区，每个驱动器都有一个。 					

```
part raid.01 --size=6000 --ondisk=sda
part raid.02 --size=6000 --ondisk=sdb
part raid.03 --size=6000 --ondisk=sdc
part swap --size=512 --ondisk=sda
part swap --size=512 --ondisk=sdb
part swap --size=512 --ondisk=sdc
part raid.11 --size=1 --grow --ondisk=sda
part raid.12 --size=1 --grow --ondisk=sdb
part raid.13 --size=1 --grow --ondisk=sdc
raid / --level=1 --device=rhel8-root --label=rhel8-root raid.01 raid.02 raid.03
raid /home --level=5 --device=rhel8-home --label=rhel8-home raid.11 raid.12 raid.13
```

**备注**

- ​								如果您丢失了 LUKS 密码短语，那么就完全无法访问所有加密的分区及其数据。丢失的密码短语是无法找回的。但是，您可以使用 `--escrowcert` 选项保存加密密码短语，并使用 `--backuppassphrase` 生成加密密码短语备份。 						

### B.5.15. reqpart

​						`reqpart` Kickstart 命令是可选的。它自动创建您的硬件平台所需的分区。这为带有 UEFI 固件的系统包括一个 `/boot/efi` 分区，带有 BIOS 固件和 GPT 的系统包括 `biosboot` 分区，为 IBM Power 系统包括 `PRePBoot` 分区。 				

**语法**

​							

```
reqpart [--add-boot]
```



**选项**

- ​								`--add-boot` - 除使用基本命令创建 `/boot` 的具体平台分区外，还可创建单独的分区。 						

**备注**

- ​								这个命令不能与 `autopart` 命令一同使用，因为`autopart` 会做所有 `reqpart` 命令要做的命令，另外，还创建其他分区或者逻辑卷，比如 `/` 和 `swap`。与 `autopart` 不同，这个命令只创建具体平台的分区，并让驱动器的其它部分留空，以便您创建自定义布局。 						

### B.5.16. snapshot

​						`snapshot` Kickstart 命令是可选的。在安装过程中使用 LVM 精简卷快照来创建 LVM 精简卷快照。这可让您在安装前或安装后备份逻辑卷。 				

​						要创建多个快照，多次添加 `snaphost` Kickstart 命令。 				

**语法**

​							

```
snapshot vg_name/lv_name --name=snapshot_name --when=pre-install|post-install
```



**选项**

- ​								`*vg_name*/*lv_name*` - 设定卷组和逻辑卷的名称以便从中创建快照。 						
- ​								`--name=*snapshot_name*` - 设置快照的名称。这个名称在卷组中必须是唯一的。 						
- ​								`--when=*pre-install|post-install*` - 如果在安装开始前或者安装完成后创建快照，则进行设置。 						

### B.5.17. volgroup

​						`volgroup` Kickstart 命令是可选的。它创建一个逻辑卷管理（LVM）组。 				

**语法**

​							

```
volgroup name [OPTIONS] [partition*]
```



**必填选项**

- ​								*name* - 新卷组的名称。 						

**选项**

- ​								*partition* - 用作卷组存储支持的物理卷分区。 						

- ​								`--noformat` - 使用现有卷组，且不对其进行格式化。 						

- ​								`--useexisting` - 使用现有卷组，重新格式化它。如果使用这个选项，不要指定*分区*。例如： 						

  ```
  volgroup rhel00 --useexisting --noformat
  ```

- ​								`--pesize=` - 以 KiB 为单位设定卷组物理扩展的大小。默认值为 4096（4 MiB），最小值为 1024（1 MiB）。 						

- ​								`--reserved-space=` - 指定 MiB 中卷组中未使用的空间量。只适用于新创建的卷组。 						

- ​								`--reserved-percent=` - 指定卷组保留未使用空间的比例。只适用于新创建的卷组。 						

**备注**

- ​								首先创建分区，然后创建逻辑卷组，然后创建逻辑卷。例如： 						

  ```
  part pv.01 --size 10000
  volgroup my_volgrp pv.01
  logvol / --vgname=my_volgrp --size=2000 --name=root
  ```

- ​								在使用 Kickstart 安装 Red Hat Enterprise Linux 时，不要在逻辑卷和卷组名称中使用小横线(`-`)。如果使用这个字符，安装会完成，但 `/dev/mapper/` 目录会列出这些卷和卷组的每个横线都会加倍。例如：名为 `volgrp-01` 的卷组包含一个名为 `logvol-01` 的逻辑卷将会被列出为 `/dev/mapper/volgrp--01-logvol--01` 。 						

  ​								这个限制只适用于新创建的逻辑卷和卷组名称。如果您使用 `--noformat` 重新使用现有名称，则它们的名称不会被更改。 						

### B.5.18. zerombr

​						`zerombr` Kickstart 命令是可选的。`zerombr` 初始化磁盘上找到的所有无效分区表并销毁有无效分区表的磁盘的所有内容。当在带有未格式化的 Direct Access Storage  Device(DASD)磁盘的 IBM Z 系统中执行安装时，需要这个命令，否则未格式化的磁盘不会被格式化并在安装过程中使用。 				

**语法**

​							

```
zerombr
```



**备注**

- ​								在 IBM Z 上，如果指定了 `zerombr`，安装程序可以看到所有没有低级格式化的直接访问存储设备（DASD）都会使用 dasdfmt 自动进行低级格式化。这个命令还可防止用户在互动安装过程中进行选择。 						
- ​								如果没有指定 `zerombr`，且安装程序至少可以看到一个未格式化的 DASD，非互动的 Kickstart 安装将无法成功退出。 						
- ​								如果没有指定 `zerombr`，且安装程序至少可以看到一个未格式化的 DASD，如果用户同意格式化所有可见和未格式化的 DASD，则会退出互动安装。要绕过这个过程，请只激活那些您要在安装过程中使用的 DASD。您总是可在安装完成后添加更多的 DASD。 						
- ​								这个命令没有选项。 						

### B.5.19. zfcp

​						`zfcp` Kickstart 命令是可选的。它定义了光纤通道设备。 				

​						这个选项仅适用于 IBM Z。必须指定以下所有选项。 				

**语法**

​							

```
zfcp --devnum=devnum --wwpn=wwpn --fcplun=lun
```



**选项**

- ​								`--devnum=` - 设备号（zFCP 适配器设备总线 ID）。 						
- ​								`--wwpn=` - 该设备的全球端口名称(WWPN)。其格式为 16 位数字，在前面使用 `0x`。 						
- ​								`--fcplun=` - 该设备的逻辑单元号（LUN）。其格式为 16 位数字，在前面使用 `0x`。 						

**示例**

​							

```
zfcp --devnum=0.0.4000 --wwpn=0x5005076300C213e9 --fcplun=0x5022000000000000
```



## B.6. RHEL 安装程序提供的附加组件的 Kickstart 命令

​					这部分中的 Kickstart 命令与 Red Hat Enterprise Linux 安装程序默认提供的附加组件相关： Kdump 和 OpenSCAP。 			

### B.6.1. %addon com_redhat_kdump

​						`%addon com_redhat_kdump` Kickstart 命令是可选的。这个命令配置 kdump 内核崩溃转储机制。 				

**语法**

​							

```
%addon com_redhat_kdump [OPTIONS]
%end
```



注意

​							这个命令的语法比较特殊，因为它是一个附加组件,不是内置的 Kickstart 命令。 					

**备注**

​							Kdump 是内核崩溃转储机制，可让您保存系统内存内容，以便稍后进行分析。它依赖于 `kexec`，可用来在不重启系统的情况下从另一个内核上下文引导 Linux 内核，并保留第一个内核内存的内容，否则会丢失第一个内核的内存。 					

​						如果系统崩溃，`kexec` 引导至第二个内核（一个捕获内核）。这个捕获内核位于系统内存的保留部分。然后 Kdump 会捕获崩溃内核的内存（崩溃转储）并将其保存到指定位置。无法用这个 Kickstart 命令配置该位置，必须在安装后编辑 `/etc/kdump.conf` 配置文件配置该位置。 				

​						有关 Kdump 的详情请参考*管理、监控和 更新内核*文档中的[安装和配置 kdump](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/#installing-and-configuring-kdump_managing-monitoring-and-updating-the-kernel) 章节。 				

**选项**

- ​								`--enable` - 在安装的系统中启用 kdump。 						

- ​								`--disable` - 在安装的系统中禁用 kdump。 						

- ​								`--reserve-mb=` - 要为 kdump 保留的内存量，单位为 MiB。例如： 						

  ```
  %addon com_redhat_kdump --enable --reserve-mb=128
  %end
  ```

  ​								您也可以指定`auto`而不是具体的数值。在这种情况下，安装程序将根据 *管理、监控和更新内核* 文档中的 [kdump 内存要求](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/#memory-requirements-for-kdump_supported-kdump-configurations-and-targets)部分中描述的标准自动决定内存量。 						

  ​								如果启用 kdump 但未指定 `--reserve-mb=` 选项，则会使用 `auto` 值。 						

- ​								`--enablefadump` - 在系统中启用固件辅助转储允许它（特别是 IBM Power Systems 服务器）。 						

### B.6.2. %addon org_fedora_oscap

​						`%addon org_fedora_oscap` Kickstart 命令是可选的。 				

​						OpenSCAP 安装程序附加组件是用来在安装的系统中应用 SCAP（安全内容自动化协议）内容 - 安全策略。从 Red Hat  Enterprise Linux 7.2  开始默认启用此附加组件。启用后，会自动安装提供这个功能的软件包。但默认情况下不会强制任何策略。这代表，除非特别指定，在安装过程中或安装后不会执行任何检查。 				

重要

​							不需要在所有系统中应用安全策略。只有在您的机构规则或政府法规强制某种策略时，才使用这个命令。 					

​						与大多数命令不同，这个附加组件不接受常规选项，而是使用 `%addon` 定义主体中的键值对。这些键值对无法验证空白。值可以选择使用单引号(`'`)或者双引号（`"`）括起来。 				

**语法**

​							

```
%addon org_fedora_oscap
key = value
%end
```



**Keys**

​							以下键可以被附加组件识别： 					

- ​								`content-type` - 安全内容的类型。可能的值有 `datastream`、`archive`、`rpm`、和 `scap-security-guide`。 						

  ​								如果 `content-type` 为 `scap-security-guide`，则该附加组件将使用 **scap-security-guide** 软件包提供的内容，这些内容存在于引导介质中。这代表，除 `profile` 此外所有其他键都无效。 						

- ​								`content-url` - 安全内容的位置。必须通过 HTTP、HTTPS 或者 FTP 访问该内容。必须有可用的网络连接方可访问远程位置中的内容定义。 						

- ​								`datastream-id` - 该值中引用的数据流的 ID `content-url`。仅在 `content-type` 是`datastream` 时使用。 						

- ​								`xccdf-id` - 要使用的基准数据的 ID。 						

- ​								`content-path` - 应使用到 datastream 或 XCCDF 文件的路径，在归档中使用相对路径。 						

- ​								`profile` - 要应用的配置集 ID。`default` 用来应用默认配置集。 						

- ​								`fingerprint` - 由 `content-url` 引用的内容的 MD5、SHA1 或 SHA2 校验和。 						

- ​								`tailoring-path` - 应使用的定制文件的路径，在归档中作为相对路径指定。 						

**示例**

- ​								以下是一个 `%addon org_fedora_oscap` 部分的示例，它使用安装介质中的 **scap-security-guide** 中的内容： 						

  **例 B.1. 使用 SCAP 安全指南的 OpenSCAP 附加组件定义示例**

  ```
  %addon org_fedora_oscap
  content-type = scap-security-guide
  profile = pci-dss
  %end
  ```

- ​								以下是从 web 服务器加载自定义配置集的复杂示例： 						

  **例 B.2. 使用 Datastream 的 OpenSCAP 附加组件定义示例**

  ```
  %addon org_fedora_oscap
  content-type = datastream
  content-url = http://www.example.com/scap/testing_ds.xml
  datastream-id = scap_example.com_datastream_testing
  xccdf-id = scap_example.com_cref_xccdf.xml
  profile =  xccdf_example.com_profile_my_profile
  fingerprint = 240f2f18222faa98856c3b4fc50c4195
  %end
  ```

**其它资源**

- ​								有关 OpenSCAP 安装程序附加组件的附加信息，请参考 https://www.open-scap.org/tools/oscap-anaconda-addon/。 						
- ​								有关 SCAP Security Guide 中的可用配置文件及其功能的更多信息，请查看 [OpenSCAP 门户网站](http://www.open-scap.org/security-policies/choosing-policy/)。 						

## B.7. Anaconda 中使用的命令

​					这个 `pwpolicy` 命令是一个 Anaconda UI 特定的命令，它只能用于 kickstart 文件的 `%anaconda` 部分。 			

### B.7.1. pwpolicy

​						`pwpolicy` Kickstart 命令是可选的。在安装过程中使用这个命令强制使用自定义密码策略。策略要求您为 root、用户或 luks 用户帐户创建密码。密码长度和强度等因素决定了密码的有效性。 				

**语法**

​							

```
pwpolicy name [--minlen=length] [--minquality=quality] [--strict|--nostrict] [--emptyok|--noempty] [--changesok|--nochanges]
```



**必填选项**

- ​								*name* - 使用 `root`、`user` 或 `luks` 替换来强制实施对`root` 密码、用户密码或 LUKS 密码短语的安全策略。 						

**可选选项**

- ​								`--minlen=` - 设置允许密码长度的最小值，以字符为单位。默认为 `6`。 						
- ​								`--minquality=` - 设定 `libpwquality` 库定义的最小允许密码质量。默认值为 `1`。 						
- ​								`--strict` - 启用严格的密码强制。不接受没有满足 `--minquality=` 和 `--minlen=` 中指定的要求的密码。默认禁用这个选项。 						
- ​								`--notstrict` - 在 GUI 中点 **完成** 两次后，可以接受*没有*满足 `--minquality=` 和 `-minlen=` 选项中指定的最低质量要求的密码。文本模式界面使用类似的机制。 						
- ​								`--emptyok` - 允许使用空密码。对于用户密码，默认启用。 						
- ​								`--notempty` - 不允许使用空密码。对于 root 密码和 LUKS 密码，默认启用。 						
- ​								`--changesok` - 即使 Kickstart 文件已经指定了密码，也允许在用户界面中更改密码。默认禁用此选项。 						
- ​								`--nochanges` - 不允许更改在 Kickstart 文件中已设定的密码。默认启用此选项。 						

**备注**

- ​								`pwpolicy` 命令是一个 Anaconda-UI 特定的命令，它只能用于 kickstart 文件的 `%anaconda` 部分。 						
- ​								`libpwquality` 程序库用于检查最低密码要求（长度和服务）。您可以使用 **libpwquality** 软件包提供的 `pwscore` `pwmake` 命令检查密码质量得分，或使用给定分数创建随机密码。有关这些命令的详情，请查看 `pwscore(1)` `pwmake(1)` man page。 						

## B.8. kickstart 命令进行系统恢复

​					这部分中的 Kickstart 命令修复安装了的系统。 			

### B.8.1. rescue

​						`rescue` Kickstart 命令是可选的。它提供有 root 特权的 shell 环境，以及一组系统管理工具修复安装以及排除问题，例如： 				

- ​								以只读方式挂载文件系统 						
- ​								blocklist 或添加驱动程序磁盘提供的驱动程序 						
- ​								安装或升级系统软件包 						
- ​								管理分区 						

注意

​							Kickstart 的救援模式与系统的救援模式和紧急模式不同，后者是 systemd 和服务管理器的一部分。 					

​						`rescue` 命令不自行修改该系统。它只能通过在 /mnt/sysimage 下挂载系统的读写模式来设置救援环境。您可以选择不挂载系统，或者将其挂载为只读模式。 				

**语法**

​							

```
rescue [--nomount|--romount]
```



**选项**

- ​								`--nomount` 或者 `--romount` - 控制如何将安装的系统挂载到救援环境中。默认情况下，安装程序会找到您的系统并以读写模式挂载它，同时告知它在什么位置进行挂载。您可以选择不挂载任何系统（使用 `--nomount` 选项），或以只读模式挂载（ 使用 `--romount` 选项）。只能使用这两个选项中的一个。 						

**备注**

​							要运行救援模式，请制作 Kickstart 文件的副本并在其中包含 `rescue` 命令。 					

​						使用该 `rescue` 命令可让安装程序执行以下步骤： 				

1. ​								运行 `%pre` 脚本。 						

2. ​								为救援模式设置环境。 						

   ​								下面的 kickstart 命令生效： 						

   1. ​										updates 								
   2. ​										sshpw 								
   3. ​										logging 								
   4. ​										lang 								
   5. ​										network 								

3. ​								设置高级存储环境。 						

   ​								下面的 kickstart 命令生效： 						

   1. ​										fcoe 								
   2. ​										iscsi 								
   3. ​										iscsiname 								
   4. ​										nvdimm 								
   5. ​										zfcp 								

4. ​								挂载系统 						

   ```
   rescue [--nomount|--romount]
   ```

5. ​								运行 %post 脚本 						

   ​								只有在安装的系统被挂载为读写模式时才运行这一步。 						

6. ​								启动 shell 						

7. ​								重启系统 						

## 附录 C. 分区参考

## C.1. 支持的设备类型

- 标准分区

  ​								标准分区可以包含文件系统或者 swap 空间。标准分区最常用于 `/boot` `BIOS Boot` 以及 `EFI System partitions`。多数其他用途，推荐使用 LVM 逻辑卷。 						

- LVM

  ​								选择 `LVM` （或者逻辑卷管理）作为设备类型会创建一个 LVM  逻辑卷。如果目前没有 LVM 卷组，则会自动生成包含新卷的卷组 ; 如果 LVM 卷组已存在，则会分配该卷。LVM  可在使用物理磁盘时提高性能，并允许高级设置，比如在一个挂载点使用多个物理磁盘，并设置软件 RAID 来提高性能、可靠性或两者。 						

- LVM 精简配置

  ​								使用精简配置，您可以管理一个空闲空间的存储池，称为精简池，可在应用程序需要时将其分配给任意数量的设备。您可以根据需要动态地扩展池，以便有效分配存储空间。 						

警告

​						安装程序不支持超额提供的 LVM 精简池。 				

## C.2. 支持的文件系统

​					这部分论述了 Red Hat Enterprise Linux 中可用的文件系统。 			

- xfs

  ​								`XFS` 它是一个高度可扩展的高性能文件系统，它最多支持 16 EB（大约一千六百万 TB）的文件系统、8 EB 文件（大约八百万 TB）以及包含千百万条目的目录结构。`XFS` 也支持元数据日志，它可提高崩溃恢复速度。单个 XFS 文件系统最多支持 500 TB。`XFS` 是 Red Hat Enterprise Linux 中默认和推荐的文件系统。 						

- ext4

  ​								`ext4` 文件系统基于 `ext3` 文件系统，并做了很多改进。这包括对更大文件系统和更大文件的支持、更快更有效的磁盘空间分配、一个目录中无限的子目录数、更快速的文件系统检查及更强大的日志能力。单个 `ext4` 文件系统最多支持 50 TB。 						

- ext3

  ​								`ext3` 文件系统基于 `ext2` 文件系统，它有一个主要优点 - 日志（journaling）。使用日志记录文件系统可减少在文件系统终止后恢复文件系统所花费的时间，因为不需要每次运行 fsck 程序检查文件系统元数据一致性。 						

- ext2

  ​								`ext2` 文件系统支持标准 Unix 文件类型，包括常规文件、目录或符号链接。它允许分配长文件名，最多 255 个字符。 						

- swap

  ​								交换分区是用来支持虚拟内存的。换句话说，当内存不足以贮存系统正在处理的数据时，数据就会被写入 swap 分区。 						

- vfat

  ​								`VFAT` 文件系统是一个 Linux 文件系统，它与 Microsoft Windows 的 FAT 文件系统中的长文件名兼容。 						注意 								Linux 系统分区不支持 `VFAT` 文件系统。例如 `/`、`/var`、`/usr` 以此类推。 							

- BIOS 引导

  ​								从在 BIOS 系统和 BIOS 兼容模式的 UEFI 系统上使用 GUID 分区表(GPT)引导的设备所需小分区。 						

- EFI 系统分区

  ​								UEFI 系统上引导使用 GUID 分区表(GPT)设备所需小分区。 						

- PReP

  ​								这个小的引导分区位于硬盘的第一个分区中。`PReP` boot 分区包含 GRUB2 引导装载程序,它可允许 IBM Power Systems 服务器引导 Red Hat Enterprise Linux。 						

## C.3. 支持的 RAID 类型

​					RAID 代表独立磁盘冗余阵列，可让您将多个物理磁盘合并为逻辑单元。有些设置的设计思想是以可靠性来换取性能的提高，另一些设备会通过需要更多的磁盘空间来获得高可靠性。 			

​					这部分论述了您可以在 LVM 和 LVM Thin Provisioning 中使用的软件 RAID 类型在安装的系统中设置存储。 			

- 无

  ​								没有设置 RAID 阵列。 						

- RAID 0

  ​								性能： 在多个磁盘间分配数据。RAID 0 提供比标准分区优越的性能，并可用来将多个磁盘的存储池化到一个大的虚拟设备中。请注意，RAID 0 不提供冗余,且阵列中的一个设备失败会破坏整个阵列中的数据。RAID 0 要求至少有两个磁盘。 						

- RAID 1

  ​								冗余： 镜像将所有数据从一个分区复制到一个或多个其他磁盘。阵列中的附加设备提供增大的冗余级别。RAID 1 要求至少有两个磁盘。 						

- RAID 4

  ​								错误检查：  在多个磁盘间分配数据,并使用阵列中的一个磁盘存储奇偶校验信息,这样可在阵列中的任意磁盘失败时保护阵列。因为所有奇偶校验信息都存储在一个磁盘上,访问这个磁盘会为阵列的性能创建一个"bottleneck"。RAID 4 要求至少有三个磁盘。 						

- RAID 5

  ​								分布式错误检查： 在多个磁盘间分配数据和奇偶校验信息。RAID 5 提供在多个磁盘间分布数据的性能优势,但没有 RAID 4 的性能瓶颈,因为也在阵列间发布奇偶校验信息。RAID 5 要求至少有三个磁盘。 						

- RAID 6

  ​								冗余错误检查： RAID 6 与 RAID 5 类似。不同之处是会保存两组奇偶校验数据，而不是一组。RAID 6 要求至少有四个磁盘。 						

- RAID 10

  ​								性能和冗余： RAID 10 是嵌套的或混合的 RAID。它由在磁盘镜像组件中分布的数据组成。例如：一个由四个 RAID 分区组成的 RAID 10 阵列由两对条状分区组成。RAID 10 要求至少有 四 个磁盘。 						

## C.4. 推荐的分区方案

​					红帽建议您在以下挂载点创建单独的文件系统。但是，如果需要您还可以在其中生成文件系统 `/usr` `/var`以及 `/tmp` 挂载点。 			

- ​							`/boot` 					

- ​							`/` (root) 					

- ​							`/home` 					

- ​							`swap` 					

- ​							`/boot/efi` 					

- ​							`PReP` 					

  - `/boot` partition - 建议大小至少为 1 GiB

    ​										挂载的分区 `/boot` 包含操作系统内核，它可允许您的系统引导  Red Hat Enterprise Linux 8,以及在 bootstrap  过程中使用的文件。鉴于多数固件的限制，推荐创建一个较小的分区来容纳这些文件。在大多数情况下，1 GiB 引导分区足够了。和其它挂载点不同，`/boot` 不能使用 LVM 卷进行 - `/boot` 必须位于独立的磁盘分区中。 								警告 										通常情况下，`/boot` 分区由安装程序自动创建。但是，如果 `/` （根）分区大于 2 TiB，且(U)EFI 用于引导，您需要创建一个小于 2 TiB 的独立 `/boot` 分区才能成功引导机器。 									注意 										如果有一张 RAID 卡，请注意某些 BIOS 类型不支持从 RAID 卡中引导。在这种情况下，`/boot` 分区必须在 RAID 阵列之外被创建，比如在一个单独的硬盘驱动器上创建。 									

  - `root` - 建议大小为 10 GiB

    ​										这是"`/`"或根目录的位置。root 目录是目录结构的最顶层。默认情况下，所有文件都会被写入这个文件系统，除非在要写入的路径中挂载了不同的文件系统，例如： `/boot` 或 `/home`。 								 									虽然 5 GiB 根文件系统允许您最小安装，但建议至少分配 10 GiB，以便可以尽可能安装您想要的软件包组。 								重要 										不要将 `/` 目录与 `/root` 目录混淆。`/root` 目录是 root 用户的主目录。`/root` 目录有时被称为 *斜杠 root*，将其与 root 目录区分开。 									

  - `/home` - 建议大小至少为 1 GiB

    ​										要将用户数据与系统数据分开存储，请为该 `/home`  目录创建一个专用的文件系统。文件系统大小基于本地存储的数据大小、用户数量等。您可以在不删除用户数据文件的情况下，升级或重新安装 Red Hat  Enterprise Linux 8。如果您选择自动分区，则建议至少有 55 GiB 磁盘空间可用于安装，以确保创建了 `/home` 文件系统。 								

  - `swap` 分区 - 建议大小至少为 1 GB

    ​										swap 文件系统支持虚拟内存 ; 当内存不足以贮存系统正在处理的数据时，数据就会被写入 swap 文件系统。swap  大小是系统内存负载的一个功能，而不是系统内存总量，因此不等于系统内存总量。务必要分析系统将要运行的应用程序以及那些应用程序将服务的负载，以确定系统内存工作负载。应用程序供应商和开发人员可提供支持。 								 									当系统没有 swap 空间时，内核会终止进程，因为系统 RAM 内存已耗尽。配置太多 swap  空间会导致存储设备被分配但处于闲置状态，因此资源使用不足。太多 swap 空间也会隐藏内存泄漏的问题。swap 分区的最大值以及其它附加信息可在 `mkswap(8)` 手册页中找到。 								 									下表根据系统中的 RAM 量以及需要足够的内存以便系统休眠提供推荐的 swap  分区大小。如果您让安装程序自动为系统分区，则使用这个指南建立 swap 分区大小。自动分区设置假设不使用休眠功能。swap  分区的最大大小为硬盘总容量的 10%,且安装程序无法创建大于 1TiB 的交换分区。要设置足够的 swap 空间来允许休眠功能,或者想将  swap 分区大小设定为超过系统的存储空间 10%,或者大于 1TiB,您必须手动编辑分区布局。 								

  - `/boot/efi` 分区 - 建议大小为 200 MiB

    ​										基于 UEFI 的 AMD64、Intel 64 和 64 位 ARM 需要 200 MiB EFI 系统分区。推荐的最小值是 200 MiB，默认大小为 600 MiB，最大为 600 MiB。BIOS 系统不需要 EFI 系统分区。 								

**表 C.1. 推荐的系统 swap 空间**

| 系统中的 RAM 量 | 推荐的 swap 空间        | 如果允许休眠则推荐使用 swap 空间 |
| --------------- | ----------------------- | -------------------------------- |
| 低于 2 GB       | RAM 量的 2 倍           | RAM 量的 3 倍                    |
| 2 GB - 8 GB     | 与 RAM 量相等           | RAM 量的 2 倍                    |
| 8 GB - 64 GB    | 4 GB 到 RAM 量的 0.5 倍 | RAM 量的 1.5 倍                  |
| 64 GB 以上      | 独立负载（至少 4GB）    | 不推荐休眠                       |

​					例如，一个有 2GB、8 GB 或 64 GB 系统 RAM 的系统。可根据所选 swap 空间和休眠支持自由裁量。如果您的系统资源允许此操作，增加 swap 空间可提高性能。 			

​					将 swap 空间分布到多个存储设备中 - 特别是对于那些使用高速驱动器、控制程序和接口的系统，还可提高 swap 空间性能。 			

​					很多系统的分区和卷超过了最低要求。根据具体系统需要选择分区。 			

注意

- ​								只为那些您需要的分区立即分配存储容量。您可以在任何时间分配空闲空间来满足需要。 						
- ​								如果您不确定如何配置分区，使用安装程序提供的自动默认分区布局。 						

- `PReP` 引导分区 - 建议大小为 4 到 8 MiB

  ​								当在 IBM Power System 服务器中安装 Red Hat Enterprise Linux 时，硬盘的第一个分区应该包括一个 `PReP` 引导分区。它包含 GRUB2 引导装载程序，可允许 IBM Power Systems 服务器引导 Red Hat Enterprise Linux。 						

## C.5. 分区建议

​					无法为每个系统分区最佳方法; 最理想的设置取决于您计划如何使用要安装的系统。然而,下面的提示可能帮助您找到最合适的布局以满足您的需要： 			

- ​							首先创建具有特定要求的分区，例如，某个分区必须位于特定磁盘中。 					

- ​							考虑加密任何可能包含敏感数据的分区和卷。加密可防止未授权的人访问分区中的数据，即使他们可以访问物理存储设备。在大多数情况下，您应该至少为包含用户数据的 `/home` 分区进行加密。 					

- ​							在某些情况下,为 `/`、`/boot` 和 `/home` 以外的目录创建独立挂载点可能很有用。例如,在运行 `MySQL` 数据库的服务器中,拥有一个单独的 `/var/lib/mysql` 挂载点允许您在重新安装的过程中保留数据库,而无需之后从备份中恢复它。但是，使用不必要的挂载点使存储管理更为困难。 					

- ​							一些特殊的限制适用于某些可以放置分区布局的目录。值得注意的是，`/boot` 目录必须总是位于物理分区（不能在 LVM 卷中）。 					

- ​							如果您对 Linux 不熟悉,请考虑查看 [Linux Filesystem Hierarchy Standard](http://refspecs.linuxfoundation.org/FHS_2.3/fhs-2.3.html) 以了解有关各种系统目录及其内容的信息。 					

- ​							每个安装在您系统的内核都需要大约 56 MB `/boot` 分区： 					

  - ​									32 MB initramfs 							

  - ​									14 MB kdump initramfs 							

  - ​									3.5 MB 系统映射 							

  - ​									6.6 MB vmlinuz 							

    注意

    ​										对于救援模式 `initramfs` 和 `vmlinuz` 需要 80 MB。 								

    ​									`/boot` 的默认大小为 1 GB，这可以满足大多数常用用例的需要。但如果您计划保留多个内核发行本或者勘误内核，则建议您增大这个分区的大小。 							

- ​							`/var` 目录保存了大量应用程序的内容,包括 Apache web 服务器, YUM 软件包管理器使用它暂时存储下载的软件包更新。确定包含 `/var` 的分区或卷至少有 3 GB。 					

- ​							`/var` 目录中的内容通常会经常改变。这可能会导致较旧的固态驱动器(SSD)出现问题,因为它们在变得不可用前可处理较少的读/写循环。如果系统 root 位于 SSD 上，请考虑在一般的 HDD 中为 `/var` 创建一个单独的挂载点。 					

- ​							该 `/usr` 目录包含典型 Red Hat Enterprise Linux 安装中的主要软件。因此，包含这个目录的分区或卷应该至少 5 GB 用于最小安装，使用图形环境的安装需要至少 10 GB。 					

- ​							如果 `/usr` 或 `/var` 是独立于剩余 root 卷的分区，引导过程会变得非常复杂，因为这些目录包含了对引导极为重要的组件。在某些情况下，比如这些目录位于 iSCSI 驱动器或 FCoE 位置，系统可能无法引导，或者在关机或重启时挂起并出现 `Device is busy` 出错信息。 					

  ​							这个限制只适用于 `/usr` 或 `/var`,不适用于它们下的目录。例如：为 `/var/www` 使用一个独立的分区可以正常工作。 					

  重要

  ​								有些安全策略需要分离 `/usr` 和 `/var`,即使它使管理更为复杂。 						

- ​							考虑在 LVM 卷组中保留一部分空间不分配。如果您的空间要求改变，但您不希望从其他卷中删除数据，这个未分配空间为您提供了灵活性。您还可以为分区选择 `LVM Thin Provisioning` 设备类型，以便让卷自动处理未使用的空间。 					

- ​							不能缩小 XFS 文件系统的大小 - 如果您需要使这个文件系统的分区或卷更小,您必须备份数据,销毁文件系统,然后创建一个新的、较小的文件系统。因此,如果您计划在以后更改分区布局,则需要使用 ext4 文件系统。 					

- ​							如果您希望在安装完成后通过添加更多硬盘或增加虚拟机硬盘来扩展存储，请使用逻辑卷管理（LVM）。通过使用 LVM，您可以在新驱动器中创建物理卷，然后将其分配给任何您认为适合的卷组和逻辑卷 - 例如，您可以轻松地扩展您的系统 `/home` （或者其它位于逻辑卷的目录）。 					

- ​							取决于系统的固件、引导驱动器大小以及引导驱动器磁盘标签，可能需要创建 BIOS 引导分区或者 EFI 系统分区。有关这些 [分区的详情,请参阅推荐](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/8/html-single/performing_an_advanced_rhel_installation/index#recommended-partitioning-scheme_partitioning-reference) 的分区方案。请注意,如果您的系统不 **需要**,则无法在图形安装中创建 BIOS 引导或者 EFI 系统分区 - 在这种情况下,在菜单中隐藏它们。 					

- ​							如果您需要在安装后更改存储配置，Red Hat Enterprise Linux 程序库会提供几个不同的工具来帮助您完成此操作。如果您希望使用命令行工具,请尝试 `system-storage-manager`。 					

## 附录 D. UEFI 安全引导和 RHEL Beta 发行版本

​				UEFI 安全引导要求操作系统内核使用一个可识别的私钥签名,可使用对应的公钥验证。 		

​				在 Red Hat Enterprise Linux Beta 版本中,内核使用特定于 Red Hat Beta 的私钥签名。UEFI  安全引导使用对应的公钥验证签名,但因为硬件不识别 Beta 私钥,Red Hat Enterprise Linux Beta 发行系统无法引导。 		

​				因此,要在 Beta 发行版本中使用 UEFI 安全引导,请使用 Machine Owner Key(MOK)功能将 Red Hat Beta 公钥添加到系统中。 		

## D.1. 为 UEFI 安全引导添加 Beta 公钥

​					这部分包含如何为 UEFI 安全引导添加 Red Hat Enterprise Linux Beta 公钥的信息。 			

**先决条件**

- ​							在系统上禁用 UEFI 安全引导。 					
- ​							安装 Red Hat Enterprise Linux Beta 发行版本,即使系统重启后仍禁用安全引导机制。 					
- ​							您已登录到该系统, **Initial Setup** 窗口中的任务已完成。 					

**流程**

1. ​							在系统的 Machine Owner Key(MOK)列表中开始注册 Red Hat Beta 公钥： 					

   ```
   # kr=$(uname -r)
   # mokutil --import /usr/share/doc/kernel-keys/${kr%}/kernel-signing-ca.cer
   ```

   ​							${KR%} 替换为字符串 - 例如 **4.18.0-80.el8.x86_64**。 					

2. ​							提示时输入密码。 					

3. ​							重启系统并按任意密钥继续启动。在系统启动过程中启动 Shim UEFI 密钥管理工具。 					

4. ​							选择 **Enroll MOK**。 					

5. ​							选择 **Continue**。 					

6. ​							选择 **Yes** 并输入密码。密钥导入到系统的固件中。 					

7. ​							**选择 Reboot**。 					

8. ​							在系统中启用安全引导。 					

## D.2. 删除 Beta 公钥

​					如果您计划删除 Red Hat Enterprise Linux Beta 发行版本,并安装 Red Hat Enterprise Linux General Availability(GA)发行版本,或者不同的操作系统,请删除 Beta 公钥。 			

​					这个步骤描述了如何删除 Beta 公钥。 			

**流程**

1. ​							开始从系统的 Machine Owner Key(MOK)列表中删除 Red Hat Beta 公钥： 					

   ```
   # mokutil --reset
   ```

2. ​							提示时输入密码。 					

3. ​							重启系统并按任意密钥继续启动。在系统启动过程中启动 Shim UEFI 密钥管理工具。 					

4. ​							选择 **Reset MOK**。 					

5. ​							选择 **Continue**。 					

6. ​							选择 **Yes** 并输入您在第 2 步中指定的密码。密钥已从系统的固件中删除。 					

7. ​							**选择 Reboot**。 					

