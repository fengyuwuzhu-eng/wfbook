# 安装

[TOC]

> 注意：
> 在 Stein 发布之前，Placement 代码与 compute REST API 代码 （nova-api） 一起位于 Nova 中。请确保此文档的发布版本与要部署的发布版本匹配。

## 步骤概述

1. 部署 API 服务

   Placement provides a `placement-api` WSGI script for running the service with Apache, nginx or other WSGI-capable web servers. Depending on what packaging solution is used to deploy OpenStack, the WSGI script may be in `/usr/bin` or `/usr/local/bin`.
   Placement 提供了一个 `placement-api` WSGI 脚本，用于在 Apache、nginx 或其他支持 WSGI 的 Web 服务器上运行服务。根据用于部署 OpenStack 的打包解决方案，WSGI 脚本可能位于 `/usr/bin` 或 `/usr/local/bin` 中。

   `placement-api`, as a standard WSGI script, provides a module level `application` attribute that most WSGI servers expect to find. This means it is possible to run it with lots of different servers, providing flexibility in the face of different deployment scenarios. Common scenarios include:
    `placement-api` ，作为标准的 WSGI 脚本，它提供了大多数 WSGI 服务器都希望找到的模块级 `application` 属性。这意味着可以在许多不同的服务器上运行它，从而在面对不同的部署方案时提供灵活性。常见方案包括：

   - [apache2](http://httpd.apache.org/) with [mod_wsgi](https://modwsgi.readthedocs.io/) 带有 mod_wsgi 的 apache2
   - apache2 with [mod_proxy_uwsgi](http://uwsgi-docs.readthedocs.io/en/latest/Apache.html)
     具有 mod_proxy_uwsgi 的 apache2
   - [nginx](http://nginx.org/) with [uwsgi](http://uwsgi-docs.readthedocs.io/en/latest/Nginx.html) 使用 UWSGI 的 NGINX
   - nginx with [gunicorn](http://gunicorn.org/) Nginx 与 Gunicorn

   In all of these scenarios the host, port and mounting path (or prefix) of the application is controlled in the web server’s configuration, not in the configuration (`placement.conf`) of the placement application.
   在所有这些方案中，应用程序的主机、端口和挂载路径（或前缀）在 Web 服务器的配置中控制，而不是在放置应用程序的配置 （ `placement.conf` ） 中控制。

   When placement was [first added to DevStack](https://review.opendev.org/#/c/342362/) it used the `mod_wsgi` style. Later it [was updated](https://review.opendev.org/#/c/456717/) to use [mod_proxy_uwsgi](http://uwsgi-docs.readthedocs.io/en/latest/Apache.html). Looking at those changes can be useful for understanding the relevant options.
   当 placement 首次添加到 DevStack 时，它使用了这种 `mod_wsgi` 样式。后来它被更新为使用 mod_proxy_uwsgi。查看这些更改有助于了解相关选项。

   DevStack is configured to host placement at `/placement` on either the default port for http or for https (`80` or `443`) depending on whether TLS is being used. Using a default port is desirable.
   DevStack 配置为在 http 或 https（ `80` 或 `443` ）的默认端口 `/placement` 上托管放置，具体取决于是否使用 TLS。最好使用默认端口。

   By default, the placement application will get its configuration for settings such as the database connection URL from `/etc/placement/placement.conf`. The directory the configuration file will be found in can be changed by setting `OS_PLACEMENT_CONFIG_DIR` in the environment of the process that starts the application. With recent releases of `oslo.config`, configuration options may also be set in the [environment](https://docs.openstack.org/oslo.config/latest/reference/drivers.html#environment).
   默认情况下，放置应用程序将从 获取其设置（如数据库连接 URL）的配置 `/etc/placement/placement.conf` 。可以通过在启动应用程序的进程环境中进行设置 `OS_PLACEMENT_CONFIG_DIR` 来更改配置文件所在的目录。对于最新版本的 `oslo.config` ，还可以在环境中设置配置选项。

   

    

   Note 注意

   

   When using uwsgi with a front end (e.g., apache2 or nginx) something needs to ensure that the uwsgi process is running. In DevStack this is done with [systemd](https://review.opendev.org/#/c/448323/). This is one of many different ways to manage uwsgi.
   当将 uwsgi 与前端（例如 apache2 或 nginx）一起使用时，需要确保 uwsgi 进程正在运行。在 DevStack 中，这是使用 systemd 完成的。这是管理 uwsgi 的众多不同方法之一。

   This document refrains from declaring a set of installation instructions for the placement service. This is because a major point of having a WSGI application is to make the deployment as flexible as possible. Because the placement API service is itself stateless (all state is in the database), it is possible to deploy as many servers as desired behind a load balancing solution for robust and simple scaling. If you familiarize yourself with installing generic WSGI applications (using the links in the common scenarios list, above), those techniques will be applicable here.
   本文档避免声明放置服务的一组安装说明。这是因为拥有 WSGI 应用程序的一个要点是使部署尽可能灵活。由于放置 API  服务本身是无状态的（所有状态都在数据库中），因此可以在负载平衡解决方案后面部署任意数量的服务器，以实现可靠且简单的扩展。如果您熟悉安装通用  WSGI 应用程序（使用上面常见场景列表中的链接），这些技术将适用于此处。

2. 同步数据库

   The placement service uses its own database, defined in the [`placement_database`](https://docs.openstack.org/placement/latest/configuration/config.html#placement_database) section of configuration. The [`placement_database.connection`](https://docs.openstack.org/placement/latest/configuration/config.html#placement_database.connection) option **must** be set or the service will not start. The command line tool [placement-manage](https://docs.openstack.org/placement/latest/cli/placement-manage.html) can be used to migrate the database tables to their correct form, including creating them. The database described by the `connection` option must already exist and have appropriate access controls defined.
   放置服务使用自己的数据库，该数据库在配置 `placement_database` 部分中定义。必须设置该 `placement_database.connection` 选项，否则服务将无法启动。命令行工具 placement-manage 可用于将数据库表迁移到其正确的形式，包括创建它们。该 `connection` 选项描述的数据库必须已存在，并且定义了适当的访问控制。

   Another option for synchronization is to set [`placement_database.sync_on_startup`](https://docs.openstack.org/placement/latest/configuration/config.html#placement_database.sync_on_startup) to `True` in configuration. This will perform any missing database migrations as the placement web service starts. Whether you choose to sync automaticaly or use the command line tool depends on the constraints of your environment and deployment tooling.
   同步的另一个选项是设置为 `placement_database.sync_on_startup`  `True` “在配置中”。这将在放置 Web 服务启动时执行任何缺失的数据库迁移。是选择自动同步还是使用命令行工具，取决于环境和部署工具的约束。

   

    

   Warning 警告

   

   In the Stein release, the placement code was extracted from nova. If you are upgrading to use the extracted placement you will need to migrate your placement data from the `nova_api` database to the `placement` database. You can find sample scripts that may help with this in the [placement repository](https://opendev.org/openstack/placement): [mysql-migrate-db.sh](https://opendev.org/openstack/placement/raw/branch/master/tools/mysql-migrate-db.sh) and [postgresql-migrate-db.sh](https://opendev.org/openstack/placement/raw/branch/master/tools/postgresql-migrate-db.sh). See also [Upgrade Notes](https://docs.openstack.org/placement/latest/admin/upgrade-notes.html).
   在 Stein 版本中，放置代码是从 nova 中提取的。如果要升级以使用提取的展示位置，则需要将展示位置数据从 `nova_api` 数据库迁移到 `placement` 数据库。您可以在放置存储库中找到可能有助于解决此问题的示例脚本：mysql-migrate-db.sh 和 postgresql-migrate-db.sh。另请参阅升级说明。

   

    

   Note 注意

   

   Upgrading to the extracted placement at the same time as the other OpenStack services when upgrading to Stein is an option but *is not required*. The nova code will continue to have a copy of the placement service in its Stein release. However this copy **will** be deleted in Train and switching to the extracted version before upgrading to Train (potentially with the help of the scripts above) will be required.
   在升级到 Stein 时，可以选择与其他 OpenStack 服务同时升级到提取的位置，但不是必需的。nova 代码将继续在其 Stein  版本中拥有放置服务的副本。但是，此副本将在 Train 中删除，并且需要在升级到 Train 之前切换到提取的版本（可能借助上述脚本）。

3. 创建帐户并更新服务目录

   Create a **placement** service user with an **admin** role in Keystone.
   在 Keystone 中创建具有管理员角色的安置服务用户。

   The placement API is a separate service and thus should be registered under a **placement** service type in the service catalog. Clients of placement, such as the resource tracker in the nova-compute node, will use the service catalog to find the placement endpoint.
   放置 API 是一项单独的服务，因此应在服务目录中的放置服务类型下注册。放置客户端（例如 nova-compute 节点中的资源跟踪器）将使用服务目录来查找放置端点。

   See [Configure User and Endpoints](https://docs.openstack.org/placement/latest/install/from-pypi.html#configure-endpoints-pypi) for examples of creating the service user and catalog entries.
   有关创建服务用户和目录条目的示例，请参阅配置用户和端点。

   Devstack sets up the placement service on the default HTTP port (80) with a `/placement` prefix instead of using an independent port.
   Devstack 在默认的 HTTP 端口 （80） 上设置放置服务，并使用 `/placement` 前缀，而不是使用独立端口。

## 安装包

Warning 警告

These installation documents are a work in progress. Some of the distribution packages mentioned are not yet available so the instructions **will not work**.
这些安装文档正在进行中。提到的某些分发包尚不可用，因此说明将不起作用。

The placement service provides an [HTTP API](https://docs.openstack.org/api-ref/placement/) used to track resource provider inventories and usages. More detail can be found at the [placement overview](https://docs.openstack.org/placement/latest/index.html).
放置服务提供了一个 HTTP API，用于跟踪资源提供程序清单和使用情况。更多细节可以在展示位置概述中找到。

Placement operates as a web service over a data model. Installation involves creating the necessary database and installing and configuring the web service. This is a straightforward process, but there are quite a few steps to integrate placement with the rest of an OpenStack cloud.
放置作为数据模型上的 Web 服务运行。安装涉及创建必要的数据库以及安装和配置 Web 服务。这是一个简单的过程，但需要很多步骤才能将放置与OpenStack云的其余部分集成。



 

Note 注意



Placement is required by some of the other OpenStack services, notably nova, therefore it should be installed before those other services but after Identity (keystone).
其他一些OpenStack服务（特别是nova）需要放置，因此它应该安装在其他服务之前，但在Identity（keystone）之后。

### 从 PyPI 安装和配置放置

​                                          

The section describes how to install and configure the placement service using packages from [PyPI](https://pypi.org). Placement works with Python version 2.7, but version 3.6 or higher is recommended.
本节介绍如何使用 PyPI 中的包安装和配置放置服务。放置适用于 Python 版本 2.7，但建议使用版本 3.6 或更高版本。

This document assumes you have a working MySQL server and a working Python environment, including the [pip](https://docs.openstack.org/placement/latest/install/from-pypi.html#about-pip) package installer. Depending on your environment, you may wish to install placement in a [virtualenv](https://pypi.org/project/virtualenv/).
本文档假设您有一个正常工作的 MySQL 服务器和一个有效的 Python 环境，包括 pip 包安装程序。根据您的环境，您可能希望在 virtualenv 中安装放置。

This document describes how to run placement with [uwsgi](https://uwsgi-docs.readthedocs.io/en/latest/WSGIquickstart.html) as its web server. This is but one of many different ways to host the service. Placement is a well-behaved [WSGI](https://www.python.org/dev/peps/pep-3333/) application so should be straightforward to host with any WSGI server.
本文档介绍如何使用 uwsgi 作为其 Web 服务器来运行放置。这只是托管服务的众多不同方式之一。放置是一个行为良好的 WSGI 应用程序，因此应该可以直接托管在任何 WSGI 服务器上。

If using placement in an OpenStack environment, you will need to ensure it is up and running before starting services that use it but after services it uses. That means after [Keystone](https://docs.openstack.org/keystone/latest/), but before anything else.
如果在 OpenStack 环境中使用放置，则需要确保它在启动使用它的服务之前启动并运行，但在使用它的服务之后。这意味着在Keystone之后，但在其他任何事情之前。

## Prerequisites 先决条件 ¶

Before installing the service, you will need to create the database, service credentials, and API endpoints, as described in the following sections.
在安装服务之前，需要创建数据库、服务凭据和 API 终结点，如以下部分所述。



### pip 点数 ¶

Install [pip](https://pypi.org/project/pip/) from [PyPI](https://pypi.org). 从 PyPI 安装 pip。



 

Note 注意



Examples throughout this reference material use the `pip` command. This may need to be pathed or spelled differently (e.g. `pip3`) depending on your installation and Python version.
本参考资料中的示例都使用该 `pip` 命令。这可能需要以不同的方式进行路径或拼写（例如）， `pip3` 具体取决于您的安装和 Python 版本。

### python-openstackclient python-openstack客户端 ¶

If not already installed, install the `openstack` command line tool:
如果尚未安装，请安装 `openstack` 命令行工具：

```
pip install python-openstackclient
```



### Create Database 创建数据库 ¶

Placement is primarily tested with MySQL/MariaDB so that is what is described here. It also works well with PostgreSQL and likely with many other databases supported by [sqlalchemy](https://www.sqlalchemy.org).
放置主要使用 MySQL/MariaDB 进行测试，因此这就是此处描述的内容。它也适用于 PostgreSQL，并且可能适用于 sqlalchemy 支持的许多其他数据库。

To create the database, complete these steps:
若要创建数据库，请完成以下步骤：

1. Use the database access client to connect to the database server as the `root` user or by using `sudo` as appropriate:
   使用数据库访问客户端以 `root` 用户身份连接到数据库服务器，或根据需要使用 `sudo` ：

1. ```
   mysql
   ```

2. Create the `placement` database:
   创建 `placement` 数据库：

   ```
   MariaDB [(none)]> CREATE DATABASE placement;
   ```

3. Grant proper access to the database:
   授予对数据库的适当访问权限：

   ```
   MariaDB [(none)]> GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'localhost' \
     IDENTIFIED BY 'PLACEMENT_DBPASS';
   MariaDB [(none)]> GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'%' \
     IDENTIFIED BY 'PLACEMENT_DBPASS';
   ```

   Replace `PLACEMENT_DBPASS` with a suitable password.
   替换 `PLACEMENT_DBPASS` 为合适的密码。

4. Exit the database access client.
   退出数据库访问客户端。



### Configure User and Endpoints 配置用户和端点 ¶



 

Note 注意



If you are not using Keystone, you can skip the steps below but will need to configure the [`api.auth_strategy`](https://docs.openstack.org/placement/latest/configuration/config.html#api.auth_strategy) setting with a value of `noauth2`. See also [Quick Placement Development](https://docs.openstack.org/placement/latest/contributor/quick-dev.html).
如果您未使用 Keystone，则可以跳过以下步骤，但需要将 `api.auth_strategy` 设置配置为值 `noauth2` 。另请参阅快速放置开发。



 

Note 注意



You will need to authenticate to Keystone as an `admin` before making these calls. There are many different ways to do this, depending on how your system was set up. If you do not have an `admin-openrc` file, you will have something similar.
 `admin` 在进行这些调用之前，您需要向 Keystone 进行身份验证。有许多不同的方法可以做到这一点，具体取决于您的系统设置方式。如果你没有 `admin-openrc` 文件，你会有类似的东西。



 

Important 重要



These documents use an endpoint URL of `http://controller:8778/` as an example only. You should configure placement to use whatever hostname and port works best for your environment. Using SSL on the default port, with either a domain or path specific to placement, is recommended. For example: `https://mygreatcloud.com/placement` or `https://placement.mygreatcloud.com/`.
这些文档仅使用终结点 URL `http://controller:8778/` 作为示例。您应将放置配置为使用最适合您的环境的任何主机名和端口。建议在默认端口上使用 SSL，并具有特定于放置的域或路径。例如： `https://mygreatcloud.com/placement` 或 `https://placement.mygreatcloud.com/` .

1. Source the `admin` credentials to gain access to admin-only CLI commands:
   获取 `admin` 凭据以获取对仅限管理员的 CLI 命令的访问权限：

```
. admin-openrc
```

Create a Placement service user using your chosen `PLACEMENT_PASS`:
使用您选择 `PLACEMENT_PASS` 的 Placement Service 用户创建：

```
openstack user create --domain default --password-prompt placement

User Password:
Repeat User Password:
+---------------------+----------------------------------+
| Field               | Value                            |
+---------------------+----------------------------------+
| domain_id           | default                          |
| enabled             | True                             |
| id                  | fa742015a6494a949f67629884fc7ec8 |
| name                | placement                        |
| options             | {}                               |
| password_expires_at | None                             |
+---------------------+----------------------------------+
```

Add the Placement user to the service project with the admin role:
将放置用户添加到具有管理员角色的服务项目：

```
openstack role add --project service --user placement admin
```



 

Note 注意



This command provides no output.
此命令不提供任何输出。

Create the Placement API entry in the service catalog:
在服务目录中创建放置 API 条目：

```
openstack service create --name placement \
  --description "Placement API" placement

+-------------+----------------------------------+
| Field       | Value                            |
+-------------+----------------------------------+
| description | Placement API                    |
| enabled     | True                             |
| id          | 2d1a27022e6e4185b86adac4444c495f |
| name        | placement                        |
| type        | placement                        |
+-------------+----------------------------------+
```

Create the Placement API service endpoints:
创建放置 API 服务端点：



 

Note 注意



Depending on your environment, the URL for the endpoint will vary by port (possibly 8780 instead of 8778, or no port at all) and hostname. You are responsible for determining the correct URL.
根据您的环境，端点的 URL 将因端口（可能是 8780 而不是 8778，或者根本没有端口）和主机名而异。您负责确定正确的 URL。

```
openstack endpoint create --region RegionOne \
  placement public http://controller:8778

+--------------+----------------------------------+
| Field        | Value                            |
+--------------+----------------------------------+
| enabled      | True                             |
| id           | 2b1b2637908b4137a9c2e0470487cbc0 |
| interface    | public                           |
| region       | RegionOne                        |
| region_id    | RegionOne                        |
| service_id   | 2d1a27022e6e4185b86adac4444c495f |
| service_name | placement                        |
| service_type | placement                        |
| url          | http://controller:8778           |
+--------------+----------------------------------+
openstack endpoint create --region RegionOne \
  placement internal http://controller:8778

+--------------+----------------------------------+
| Field        | Value                            |
+--------------+----------------------------------+
| enabled      | True                             |
| id           | 02bcda9a150a4bd7993ff4879df971ab |
| interface    | internal                         |
| region       | RegionOne                        |
| region_id    | RegionOne                        |
| service_id   | 2d1a27022e6e4185b86adac4444c495f |
| service_name | placement                        |
| service_type | placement                        |
| url          | http://controller:8778           |
+--------------+----------------------------------+
```

1. ```
   openstack endpoint create --region RegionOne \
     placement admin http://controller:8778
   
   +--------------+----------------------------------+
   | Field        | Value                            |
   +--------------+----------------------------------+
   | enabled      | True                             |
   | id           | 3d71177b9e0f406f98cbff198d74b182 |
   | interface    | admin                            |
   | region       | RegionOne                        |
   | region_id    | RegionOne                        |
   | service_id   | 2d1a27022e6e4185b86adac4444c495f |
   | service_name | placement                        |
   | service_type | placement                        |
   | url          | http://controller:8778           |
   +--------------+----------------------------------+
   ```



## Install and configure components 安装和配置组件 ¶

The default location of the placement configuration file is `/etc/placement/placement.conf`. A different directory may be chosen by setting `OS_PLACEMENT_CONFIG_DIR` in the environment. It is also possible to run the service with a partial or no configuration file and set some options in [the environment](https://docs.openstack.org/oslo.config/latest/reference/drivers.html#module-oslo_config.sources._environment). See [Configuration Guide](https://docs.openstack.org/placement/latest/configuration/index.html) for additional configuration settings not mentioned here.
放置配置文件的默认位置是 `/etc/placement/placement.conf` 。可以通过在环境中设置 `OS_PLACEMENT_CONFIG_DIR` 来选择不同的目录。也可以使用部分配置文件或没有配置文件来运行服务，并在环境中设置一些选项。有关此处未提及的其他配置设置，请参阅配置指南。



 

Note 注意



In the steps below, `controller` is used as a stand in for the hostname of the hosts where keystone, mysql, and placement are running. These may be distinct. The keystone host (used for `auth_url` and `www_authenticate_uri`) should be the unversioned public endpoint for the Identity service.
在下面的步骤中， `controller` 用作运行 keystone、mysql 和 placement 的主机的主机名的替代。这些可能是不同的。Keystone 主机（用于 `auth_url` 和 `www_authenticate_uri` ）应是 Identity 服务的未版本控制公共终结点。

1. Install placement and required database libraries:
   安装放置和所需的数据库库：

```
pip install openstack-placement pymysql
```

Create the `/etc/placement/placement.conf` file and complete the following actions:
创建 `/etc/placement/placement.conf` 文件并完成以下操作：

- Create a `[placement_database]` section and configure database access:
  创建 `[placement_database]` 分区并配置数据库访问权限：

  ```
  [placement_database]
  connection = mysql+pymysql://placement:PLACEMENT_DBPASS@controller/placement
  ```

  Replace `PLACEMENT_DBPASS` with the password you chose for the placement database.
  替换 `PLACEMENT_DBPASS` 为您为放置数据库选择的密码。

- Create `[api]` and `[keystone_authtoken]` sections, configure Identity service access:
  创建 `[api]` 和 `[keystone_authtoken]` 部分，配置身份服务访问：

  ```
  [api]
  auth_strategy = keystone  # use noauth2 if not using keystone
  
  [keystone_authtoken]
  www_authenticate_uri = http://controller:5000/
  auth_url = http://controller:5000/
  memcached_servers = controller:11211
  auth_type = password
  project_domain_name = Default
  user_domain_name = Default
  project_name = service
  username = placement
  password = PLACEMENT_PASS
  ```

  Replace `PLACEMENT_PASS` with the password you chose for the `placement` user in the Identity service.
  替换 `PLACEMENT_PASS` 为您在 Identity 服务中为用户选择的 `placement` 密码。

  

   

  Note 注意

  

  The value of `user_name`, `password`, `project_domain_name` and `user_domain_name` need to be in sync with your keystone config.
   `user_name` 、 `password` `project_domain_name` 和 的 `user_domain_name` 值需要与 keystone 配置同步。

- You may wish to set the [`debug`](https://docs.openstack.org/placement/latest/configuration/config.html#DEFAULT.debug) option to `True` to produce more verbose log output.
  您可能希望将 `debug` 该选项 `True` 设置为生成更详细的日志输出。

Populate the `placement` database:
填充 `placement` 数据库：

1. ```
   placement-manage db sync
   ```

   

    

   Note 注意

   

   An alternative is to use the [`placement_database.sync_on_startup`](https://docs.openstack.org/placement/latest/configuration/config.html#placement_database.sync_on_startup) option.
   另一种方法是使用该 `placement_database.sync_on_startup` 选项。

## Finalize installation 完成安装 ¶

Now that placement itself has been installed we need to launch the service in a web server. What follows provides a very basic web server that, while relatively performant, is not set up to be easy to manage. Since there are many web servers and many ways to manage them, such things are outside the scope of this document.
现在放置本身已经安装完毕，我们需要在 Web 服务器中启动该服务。下面提供了一个非常基本的 Web 服务器，虽然性能相对较好，但并未设置为易于管理。由于有许多 Web 服务器和管理它们的方法，因此此类内容超出了本文档的范围。

Install and run the web server:
安装并运行 Web 服务器：

1. Install the `uwsgi` package (these instructions are against version 2.0.18):
   安装 `uwsgi` 软件包（这些说明针对版本 2.0.18）：

```
pip install uwsgi
```

Run the server with the placement WSGI application in a terminal window:
在终端窗口中使用放置 WSGI 应用程序运行服务器：



 

Warning 警告



Make sure you are using the correct `uwsgi` binary. It may be in multiple places in your path. The wrong version will fail and complain about bad arguments.
确保您使用的是正确的 `uwsgi` 二进制文件。它可能在您路径中的多个位置。错误的版本将失败并抱怨错误的论点。

```
uwsgi -M --http :8778 --wsgi-file /usr/local/bin/placement-api \
        --processes 2 --threads 10
```

In another terminal confirm the server is running using `curl`. The URL should match the public endpoint set in [Configure User and Endpoints](https://docs.openstack.org/placement/latest/install/from-pypi.html#configure-endpoints-pypi).
在另一个终端中，使用 `curl` 确认服务器正在运行。URL 应与配置用户和终结点中设置的公共终结点匹配。

```
curl http://controller:8778/
```

The output will look something like this:
输出将如下所示：

```
{
   "versions" : [
      {
         "id" : "v1.0",
         "max_version" : "1.31",
         "links" : [
            {
               "href" : "",
               "rel" : "self"
            }
         ],
         "min_version" : "1.0",
         "status" : "CURRENT"
      }
   ]
}
```

Further interactions with the system can be made with [osc-placement](https://docs.openstack.org/osc-placement/latest/).
可以通过 osc-placement 与系统进行进一步的交互。

# 安装和配置 openSUSE 和 SUSE Linux Enterprise 的 Placement

​                                          

This section describes how to install and configure the placement service when using openSUSE or SUSE Linux Enterprise packages.
本节介绍在使用 openSUSE 或 SUSE Linux Enterprise 软件包时如何安装和配置放置服务。

## Prerequisites 先决条件 ¶

Before you install and configure the placement service, you must create a database, service credentials, and API endpoints.
在安装和配置放置服务之前，必须创建数据库、服务凭据和 API 端点。

### Create Database 创建数据库 ¶

1. To create the database, complete these steps:
   若要创建数据库，请完成以下步骤：
   - Use the database access client to connect to the database server as the `root` user:
     使用数据库访问客户端以 `root` 用户身份连接到数据库服务器：

1. - ```
     mysql -u root -p
     ```

   - Create the `placement` database:
     创建 `placement` 数据库：

     ```
     MariaDB [(none)]> CREATE DATABASE placement;
     ```

   - Grant proper access to the database:
     授予对数据库的适当访问权限：

     ```
     MariaDB [(none)]> GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'localhost' \
       IDENTIFIED BY 'PLACEMENT_DBPASS';
     MariaDB [(none)]> GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'%' \
       IDENTIFIED BY 'PLACEMENT_DBPASS';
     ```

     Replace `PLACEMENT_DBPASS` with a suitable password.
     替换 `PLACEMENT_DBPASS` 为合适的密码。

   - Exit the database access client.
     退出数据库访问客户端。

### Configure User and Endpoints 配置用户和端点 ¶

1. Source the `admin` credentials to gain access to admin-only CLI commands:
   获取 `admin` 凭据以获取对仅限管理员的 CLI 命令的访问权限：

```
. admin-openrc
```

Create a Placement service user using your chosen `PLACEMENT_PASS`:
使用您选择 `PLACEMENT_PASS` 的 Placement Service 用户创建：

```
openstack user create --domain default --password-prompt placement

User Password:
Repeat User Password:
+---------------------+----------------------------------+
| Field               | Value                            |
+---------------------+----------------------------------+
| domain_id           | default                          |
| enabled             | True                             |
| id                  | fa742015a6494a949f67629884fc7ec8 |
| name                | placement                        |
| options             | {}                               |
| password_expires_at | None                             |
+---------------------+----------------------------------+
```

Add the Placement user to the service project with the admin role:
将放置用户添加到具有管理员角色的服务项目：

```
openstack role add --project service --user placement admin
```



 

Note 注意



This command provides no output.
此命令不提供任何输出。

Create the Placement API entry in the service catalog:
在服务目录中创建放置 API 条目：

```
openstack service create --name placement \
  --description "Placement API" placement

+-------------+----------------------------------+
| Field       | Value                            |
+-------------+----------------------------------+
| description | Placement API                    |
| enabled     | True                             |
| id          | 2d1a27022e6e4185b86adac4444c495f |
| name        | placement                        |
| type        | placement                        |
+-------------+----------------------------------+
```

Create the Placement API service endpoints:
创建放置 API 服务端点：



 

Note 注意



Depending on your environment, the URL for the endpoint will vary by port (possibly 8780 instead of 8778, or no port at all) and hostname. You are responsible for determining the correct URL.
根据您的环境，端点的 URL 将因端口（可能是 8780 而不是 8778，或者根本没有端口）和主机名而异。您负责确定正确的 URL。

```
openstack endpoint create --region RegionOne \
  placement public http://controller:8778

+--------------+----------------------------------+
| Field        | Value                            |
+--------------+----------------------------------+
| enabled      | True                             |
| id           | 2b1b2637908b4137a9c2e0470487cbc0 |
| interface    | public                           |
| region       | RegionOne                        |
| region_id    | RegionOne                        |
| service_id   | 2d1a27022e6e4185b86adac4444c495f |
| service_name | placement                        |
| service_type | placement                        |
| url          | http://controller:8778           |
+--------------+----------------------------------+
openstack endpoint create --region RegionOne \
  placement internal http://controller:8778

+--------------+----------------------------------+
| Field        | Value                            |
+--------------+----------------------------------+
| enabled      | True                             |
| id           | 02bcda9a150a4bd7993ff4879df971ab |
| interface    | internal                         |
| region       | RegionOne                        |
| region_id    | RegionOne                        |
| service_id   | 2d1a27022e6e4185b86adac4444c495f |
| service_name | placement                        |
| service_type | placement                        |
| url          | http://controller:8778           |
+--------------+----------------------------------+
```

1. ```
   openstack endpoint create --region RegionOne \
     placement admin http://controller:8778
   
   +--------------+----------------------------------+
   | Field        | Value                            |
   +--------------+----------------------------------+
   | enabled      | True                             |
   | id           | 3d71177b9e0f406f98cbff198d74b182 |
   | interface    | admin                            |
   | region       | RegionOne                        |
   | region_id    | RegionOne                        |
   | service_id   | 2d1a27022e6e4185b86adac4444c495f |
   | service_name | placement                        |
   | service_type | placement                        |
   | url          | http://controller:8778           |
   +--------------+----------------------------------+
   ```

## Install and configure components 安装和配置组件 ¶



 

Note 注意



Default configuration files vary by distribution. You might need to add these sections and options rather than modifying existing sections and options. Also, an ellipsis (`...`) in the configuration snippets indicates potential default configuration options that you should retain.
默认配置文件因发行版而异。您可能需要添加这些部分和选项，而不是修改现有部分和选项。此外，配置代码段中的省略号 （ `...` ） 表示应保留的潜在默认配置选项。



 

Note 注意



As of the Newton release, SUSE OpenStack packages are shipped with the upstream default configuration files. For example, `/etc/placement/placement.conf` has customizations in `/etc/placement/placement.conf.d/010-placement.conf`. While the following instructions modify the default configuration file, adding a new file in `/etc/placement/placement.conf.d` achieves the same result.
从 Newton 版本开始，SUSE OpenStack 软件包随上游默认配置文件一起提供。例如， `/etc/placement/placement.conf` 在 中 `/etc/placement/placement.conf.d/010-placement.conf` 具有自定义项。虽然以下说明修改了默认配置文件，但添加 `/etc/placement/placement.conf.d` 新文件会获得相同的结果。

1. Install the packages: 安装软件包：

```
zypper install openstack-placement
```

Edit the `/etc/placement/placement.conf` file and complete the following actions:
编辑 `/etc/placement/placement.conf` 文件并完成以下操作：

- In the `[placement_database]` section, configure database access:
  在 `[placement_database]` “配置数据库访问”部分中：

  ```
  [placement_database]
  # ...
  connection = mysql+pymysql://placement:PLACEMENT_DBPASS@controller/placement
  ```

  Replace `PLACEMENT_DBPASS` with the password you chose for the placement database.
  替换 `PLACEMENT_DBPASS` 为您为放置数据库选择的密码。

- In the `[api]` and `[keystone_authtoken]` sections, configure Identity service access:
  在 `[api]` and `[keystone_authtoken]` 部分中，配置 Identity service 访问权限：

  ```
  [api]
  # ...
  auth_strategy = keystone
  
  [keystone_authtoken]
  # ...
  auth_url = http://controller:5000/v3
  memcached_servers = controller:11211
  auth_type = password
  project_domain_name = Default
  user_domain_name = Default
  project_name = service
  username = placement
  password = PLACEMENT_PASS
  ```

  Replace `PLACEMENT_PASS` with the password you chose for the `placement` user in the Identity service.
  替换 `PLACEMENT_PASS` 为您在 Identity 服务中为用户选择的 `placement` 密码。

  

   

  Note 注意

  

  Comment out or remove any other options in the `[keystone_authtoken]` section.
  注释掉或删除该 `[keystone_authtoken]` 部分中的任何其他选项。

  

   

  Note 注意

  

  The value of `user_name`, `password`, `project_domain_name` and `user_domain_name` need to be in sync with your keystone config.
   `user_name` 、 `password` `project_domain_name` 和 的 `user_domain_name` 值需要与 keystone 配置同步。

Populate the `placement` database:
填充 `placement` 数据库：

1. ```
   su -s /bin/sh -c "placement-manage db sync" placement
   ```

   

    

   Note 注意

   

   Ignore any deprecation messages in this output.
   忽略此输出中的任何弃用消息。

## Finalize installation 完成安装 ¶

- Enable the placement API Apache vhost:
  启用放置 API Apache vhost：

```
mv /etc/apache2/vhosts.d/openstack-placement-api.conf.sample \
  /etc/apache2/vhosts.d/openstack-placement-api.conf
```

- ```
  systemctl reload apache2.service
  ```

​                      

# 安装和配置适用于 Red Hat Enterprise Linux 和 CentOS 的 Placement

​                                          

This section describes how to install and configure the placement service when using Red Hat Enterprise Linux or CentOS packages.
本节介绍在使用 Red Hat Enterprise Linux 或 CentOS 软件包时如何安装和配置放置服务。

## Prerequisites 先决条件 ¶

Before you install and configure the placement service, you must create a database, service credentials, and API endpoints.
在安装和配置放置服务之前，必须创建数据库、服务凭据和 API 端点。

### Create Database 创建数据库 ¶

1. To create the database, complete these steps:
   若要创建数据库，请完成以下步骤：
   - Use the database access client to connect to the database server as the `root` user:
     使用数据库访问客户端以 `root` 用户身份连接到数据库服务器：

1. - ```
     mysql -u root -p
     ```

   - Create the `placement` database:
     创建 `placement` 数据库：

     ```
     MariaDB [(none)]> CREATE DATABASE placement;
     ```

   - Grant proper access to the database:
     授予对数据库的适当访问权限：

     ```
     MariaDB [(none)]> GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'localhost' \
       IDENTIFIED BY 'PLACEMENT_DBPASS';
     MariaDB [(none)]> GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'%' \
       IDENTIFIED BY 'PLACEMENT_DBPASS';
     ```

     Replace `PLACEMENT_DBPASS` with a suitable password.
     替换 `PLACEMENT_DBPASS` 为合适的密码。

   - Exit the database access client.
     退出数据库访问客户端。

### Configure User and Endpoints 配置用户和端点 ¶

1. Source the `admin` credentials to gain access to admin-only CLI commands:
   获取 `admin` 凭据以获取对仅限管理员的 CLI 命令的访问权限：

```
. admin-openrc
```

Create a Placement service user using your chosen `PLACEMENT_PASS`:
使用您选择 `PLACEMENT_PASS` 的 Placement Service 用户创建：

```
openstack user create --domain default --password-prompt placement

User Password:
Repeat User Password:
+---------------------+----------------------------------+
| Field               | Value                            |
+---------------------+----------------------------------+
| domain_id           | default                          |
| enabled             | True                             |
| id                  | fa742015a6494a949f67629884fc7ec8 |
| name                | placement                        |
| options             | {}                               |
| password_expires_at | None                             |
+---------------------+----------------------------------+
```

Add the Placement user to the service project with the admin role:
将放置用户添加到具有管理员角色的服务项目：

```
openstack role add --project service --user placement admin
```



 

Note 注意



This command provides no output.
此命令不提供任何输出。

Create the Placement API entry in the service catalog:
在服务目录中创建放置 API 条目：

```
openstack service create --name placement \
  --description "Placement API" placement

+-------------+----------------------------------+
| Field       | Value                            |
+-------------+----------------------------------+
| description | Placement API                    |
| enabled     | True                             |
| id          | 2d1a27022e6e4185b86adac4444c495f |
| name        | placement                        |
| type        | placement                        |
+-------------+----------------------------------+
```

Create the Placement API service endpoints:
创建放置 API 服务端点：



 

Note 注意



Depending on your environment, the URL for the endpoint will vary by port (possibly 8780 instead of 8778, or no port at all) and hostname. You are responsible for determining the correct URL.
根据您的环境，端点的 URL 将因端口（可能是 8780 而不是 8778，或者根本没有端口）和主机名而异。您负责确定正确的 URL。

```
openstack endpoint create --region RegionOne \
  placement public http://controller:8778

+--------------+----------------------------------+
| Field        | Value                            |
+--------------+----------------------------------+
| enabled      | True                             |
| id           | 2b1b2637908b4137a9c2e0470487cbc0 |
| interface    | public                           |
| region       | RegionOne                        |
| region_id    | RegionOne                        |
| service_id   | 2d1a27022e6e4185b86adac4444c495f |
| service_name | placement                        |
| service_type | placement                        |
| url          | http://controller:8778           |
+--------------+----------------------------------+
openstack endpoint create --region RegionOne \
  placement internal http://controller:8778

+--------------+----------------------------------+
| Field        | Value                            |
+--------------+----------------------------------+
| enabled      | True                             |
| id           | 02bcda9a150a4bd7993ff4879df971ab |
| interface    | internal                         |
| region       | RegionOne                        |
| region_id    | RegionOne                        |
| service_id   | 2d1a27022e6e4185b86adac4444c495f |
| service_name | placement                        |
| service_type | placement                        |
| url          | http://controller:8778           |
+--------------+----------------------------------+
```

1. ```
   openstack endpoint create --region RegionOne \
     placement admin http://controller:8778
   
   +--------------+----------------------------------+
   | Field        | Value                            |
   +--------------+----------------------------------+
   | enabled      | True                             |
   | id           | 3d71177b9e0f406f98cbff198d74b182 |
   | interface    | admin                            |
   | region       | RegionOne                        |
   | region_id    | RegionOne                        |
   | service_id   | 2d1a27022e6e4185b86adac4444c495f |
   | service_name | placement                        |
   | service_type | placement                        |
   | url          | http://controller:8778           |
   +--------------+----------------------------------+
   ```

## Install and configure components 安装和配置组件 ¶



 

Note 注意



Default configuration files vary by distribution. You might need to add these sections and options rather than modifying existing sections and options. Also, an ellipsis (`...`) in the configuration snippets indicates potential default configuration options that you should retain.
默认配置文件因发行版而异。您可能需要添加这些部分和选项，而不是修改现有部分和选项。此外，配置代码段中的省略号 （ `...` ） 表示应保留的潜在默认配置选项。

1. Install the packages: 安装软件包：

```
yum install openstack-placement-api
```

Edit the `/etc/placement/placement.conf` file and complete the following actions:
编辑 `/etc/placement/placement.conf` 文件并完成以下操作：

- In the `[placement_database]` section, configure database access:
  在 `[placement_database]` “配置数据库访问”部分中：

  ```
  [placement_database]
  # ...
  connection = mysql+pymysql://placement:PLACEMENT_DBPASS@controller/placement
  ```

  Replace `PLACEMENT_DBPASS` with the password you chose for the placement database.
  替换 `PLACEMENT_DBPASS` 为您为放置数据库选择的密码。

- In the `[api]` and `[keystone_authtoken]` sections, configure Identity service access:
  在 `[api]` and `[keystone_authtoken]` 部分中，配置 Identity service 访问权限：

  ```
  [api]
  # ...
  auth_strategy = keystone
  
  [keystone_authtoken]
  # ...
  auth_url = http://controller:5000/v3
  memcached_servers = controller:11211
  auth_type = password
  project_domain_name = Default
  user_domain_name = Default
  project_name = service
  username = placement
  password = PLACEMENT_PASS
  ```

  Replace `PLACEMENT_PASS` with the password you chose for the `placement` user in the Identity service.
  替换 `PLACEMENT_PASS` 为您在 Identity 服务中为用户选择的 `placement` 密码。

  

   

  Note 注意

  

  Comment out or remove any other options in the `[keystone_authtoken]` section.
  注释掉或删除该 `[keystone_authtoken]` 部分中的任何其他选项。

  

   

  Note 注意

  

  The value of `user_name`, `password`, `project_domain_name` and `user_domain_name` need to be in sync with your keystone config.
   `user_name` 、 `password` `project_domain_name` 和 的 `user_domain_name` 值需要与 keystone 配置同步。

Populate the `placement` database:
填充 `placement` 数据库：

1. ```
   su -s /bin/sh -c "placement-manage db sync" placement
   ```

   

    

   Note 注意

   

   Ignore any deprecation messages in this output.
   忽略此输出中的任何弃用消息。

## Finalize installation 完成安装 ¶

- Restart the httpd service:
  重新启动 httpd 服务：


```
systemctl restart httpd
```

# nstall and configure Placement for Ubuntu 安装和配置 Ubuntu 的 Placement

​                                          

This section describes how to install and configure the placement service when using Ubuntu packages.
本节介绍如何在使用 Ubuntu 软件包时安装和配置放置服务。

## Prerequisites 先决条件 ¶

Before you install and configure the placement service, you must create a database, service credentials, and API endpoints.
在安装和配置放置服务之前，必须创建数据库、服务凭据和 API 端点。

### Create Database 创建数据库 ¶

1. To create the database, complete these steps:
   若要创建数据库，请完成以下步骤：
   - Use the database access client to connect to the database server as the `root` user:
     使用数据库访问客户端以 `root` 用户身份连接到数据库服务器：

1. - ```
     mysql
     ```

   - Create the `placement` database:
     创建 `placement` 数据库：

     ```
     MariaDB [(none)]> CREATE DATABASE placement;
     ```

   - Grant proper access to the database:
     授予对数据库的适当访问权限：

     ```
     MariaDB [(none)]> GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'localhost' \
       IDENTIFIED BY 'PLACEMENT_DBPASS';
     MariaDB [(none)]> GRANT ALL PRIVILEGES ON placement.* TO 'placement'@'%' \
       IDENTIFIED BY 'PLACEMENT_DBPASS';
     ```

     Replace `PLACEMENT_DBPASS` with a suitable password.
     替换 `PLACEMENT_DBPASS` 为合适的密码。

   - Exit the database access client.
     退出数据库访问客户端。

### Configure User and Endpoints 配置用户和端点 ¶

1. Source the `admin` credentials to gain access to admin-only CLI commands:
   获取 `admin` 凭据以获取对仅限管理员的 CLI 命令的访问权限：

```
. admin-openrc
```

Create a Placement service user using your chosen `PLACEMENT_PASS`:
使用您选择 `PLACEMENT_PASS` 的 Placement Service 用户创建：

```
openstack user create --domain default --password-prompt placement

User Password:
Repeat User Password:
+---------------------+----------------------------------+
| Field               | Value                            |
+---------------------+----------------------------------+
| domain_id           | default                          |
| enabled             | True                             |
| id                  | fa742015a6494a949f67629884fc7ec8 |
| name                | placement                        |
| options             | {}                               |
| password_expires_at | None                             |
+---------------------+----------------------------------+
```

Add the Placement user to the service project with the admin role:
将放置用户添加到具有管理员角色的服务项目：

```
openstack role add --project service --user placement admin
```



 

Note 注意



This command provides no output.
此命令不提供任何输出。

Create the Placement API entry in the service catalog:
在服务目录中创建放置 API 条目：

```
openstack service create --name placement \
  --description "Placement API" placement

+-------------+----------------------------------+
| Field       | Value                            |
+-------------+----------------------------------+
| description | Placement API                    |
| enabled     | True                             |
| id          | 2d1a27022e6e4185b86adac4444c495f |
| name        | placement                        |
| type        | placement                        |
+-------------+----------------------------------+
```

Create the Placement API service endpoints:
创建放置 API 服务端点：



 

Note 注意



Depending on your environment, the URL for the endpoint will vary by port (possibly 8780 instead of 8778, or no port at all) and hostname. You are responsible for determining the correct URL.
根据您的环境，端点的 URL 将因端口（可能是 8780 而不是 8778，或者根本没有端口）和主机名而异。您负责确定正确的 URL。

```
openstack endpoint create --region RegionOne \
  placement public http://controller:8778

+--------------+----------------------------------+
| Field        | Value                            |
+--------------+----------------------------------+
| enabled      | True                             |
| id           | 2b1b2637908b4137a9c2e0470487cbc0 |
| interface    | public                           |
| region       | RegionOne                        |
| region_id    | RegionOne                        |
| service_id   | 2d1a27022e6e4185b86adac4444c495f |
| service_name | placement                        |
| service_type | placement                        |
| url          | http://controller:8778           |
+--------------+----------------------------------+
openstack endpoint create --region RegionOne \
  placement internal http://controller:8778

+--------------+----------------------------------+
| Field        | Value                            |
+--------------+----------------------------------+
| enabled      | True                             |
| id           | 02bcda9a150a4bd7993ff4879df971ab |
| interface    | internal                         |
| region       | RegionOne                        |
| region_id    | RegionOne                        |
| service_id   | 2d1a27022e6e4185b86adac4444c495f |
| service_name | placement                        |
| service_type | placement                        |
| url          | http://controller:8778           |
+--------------+----------------------------------+
```

1. ```
   openstack endpoint create --region RegionOne \
     placement admin http://controller:8778
   
   +--------------+----------------------------------+
   | Field        | Value                            |
   +--------------+----------------------------------+
   | enabled      | True                             |
   | id           | 3d71177b9e0f406f98cbff198d74b182 |
   | interface    | admin                            |
   | region       | RegionOne                        |
   | region_id    | RegionOne                        |
   | service_id   | 2d1a27022e6e4185b86adac4444c495f |
   | service_name | placement                        |
   | service_type | placement                        |
   | url          | http://controller:8778           |
   +--------------+----------------------------------+
   ```

## Install and configure components 安装和配置组件 ¶



 

Note 注意



Default configuration files vary by distribution. You might need to add these sections and options rather than modifying existing sections and options. Also, an ellipsis (`...`) in the configuration snippets indicates potential default configuration options that you should retain.
默认配置文件因发行版而异。您可能需要添加这些部分和选项，而不是修改现有部分和选项。此外，配置代码段中的省略号 （ `...` ） 表示应保留的潜在默认配置选项。

1. Install the packages: 安装软件包：

```
apt install placement-api
```

Edit the `/etc/placement/placement.conf` file and complete the following actions:
编辑 `/etc/placement/placement.conf` 文件并完成以下操作：

- In the `[placement_database]` section, configure database access:
  在 `[placement_database]` “配置数据库访问”部分中：

  ```
  [placement_database]
  # ...
  connection = mysql+pymysql://placement:PLACEMENT_DBPASS@controller/placement
  ```

  Replace `PLACEMENT_DBPASS` with the password you chose for the placement database.
  替换 `PLACEMENT_DBPASS` 为您为放置数据库选择的密码。

- In the `[api]` and `[keystone_authtoken]` sections, configure Identity service access:
  在 `[api]` and `[keystone_authtoken]` 部分中，配置 Identity service 访问权限：

  ```
  [api]
  # ...
  auth_strategy = keystone
  
  [keystone_authtoken]
  # ...
  auth_url = http://controller:5000/v3
  memcached_servers = controller:11211
  auth_type = password
  project_domain_name = Default
  user_domain_name = Default
  project_name = service
  username = placement
  password = PLACEMENT_PASS
  ```

  Replace `PLACEMENT_PASS` with the password you chose for the `placement` user in the Identity service.
  替换 `PLACEMENT_PASS` 为您在 Identity 服务中为用户选择的 `placement` 密码。

  

   

  Note 注意

  

  Comment out or remove any other options in the `[keystone_authtoken]` section.
  注释掉或删除该 `[keystone_authtoken]` 部分中的任何其他选项。

  

   

  Note 注意

  

  The value of `user_name`, `password`, `project_domain_name` and `user_domain_name` need to be in sync with your keystone config.
   `user_name` 、 `password` `project_domain_name` 和 的 `user_domain_name` 值需要与 keystone 配置同步。

Populate the `placement` database:
填充 `placement` 数据库：

1. ```
   su -s /bin/sh -c "placement-manage db sync" placement
   ```

   

    

   Note 注意

   

   Ignore any deprecation messages in this output.
   忽略此输出中的任何弃用消息。

## Finalize installation 完成安装 ¶

- Reload the web server to adjust to get new configuration settings for placement.
  重新加载 Web 服务器进行调整，以获取用于放置的新配置设置。

```
service apache2 restart
```

# Verify Installation 验证安装

​                                          

Verify operation of the placement service.
验证放置服务的运行情况。



 

Note 注意



You will need to authenticate to the identity service as an `admin` before making these calls. There are many different ways to do this, depending on how your system was set up. If you do not have an `admin-openrc` file, you will have something similar.
 `admin` 在进行这些调用之前，您需要向标识服务进行身份验证。有许多不同的方法可以做到这一点，具体取决于您的系统设置方式。如果你没有 `admin-openrc` 文件，你会有类似的东西。

1. Source the `admin` credentials to gain access to admin-only CLI commands:
   获取 `admin` 凭据以获取对仅限管理员的 CLI 命令的访问权限：

```
. admin-openrc
```

Perform status checks to make sure everything is in order:
执行状态检查以确保一切正常：

```
placement-status upgrade check
+----------------------------------+
| Upgrade Check Results            |
+----------------------------------+
| Check: Missing Root Provider IDs |
| Result: Success                  |
| Details: None                    |
+----------------------------------+
| Check: Incomplete Consumers      |
| Result: Success                  |
| Details: None                    |
+----------------------------------+
```

The output of that command will vary by release. See [placement-status upgrade check](https://docs.openstack.org/placement/latest/cli/placement-status.html#placement-status-checks) for details.
该命令的输出将因版本而异。有关详细信息，请参阅展示位置状态升级检查。

Run some commands against the placement API:
针对放置 API 运行一些命令：

- Install the [osc-placement](https://docs.openstack.org/osc-placement/latest/) plugin:
  安装 osc-placement 插件：

  

   

  Note 注意

  

  This example uses [PyPI](https://pypi.org) and [pip](https://docs.openstack.org/placement/latest/install/from-pypi.html#about-pip) but if you are using distribution packages you can install the package from their repository. With the move to python3 you will need to specify **pip3** or install **python3-osc-placement** from your distribution.
  此示例使用 PyPI 和 pip，但如果使用的是分发包，则可以从其存储库安装包。迁移到 python3 后，您需要指定 pip3 或从您的发行版安装 python3-osc-placement。

```
pip3 install osc-placement
```

List available resource classes and traits:
列出可用的资源类和特征：

```
openstack --os-placement-api-version 1.2 resource class list --sort-column name
+----------------------------+
| name                       |
+----------------------------+
| DISK_GB                    |
| IPV4_ADDRESS               |
| ...                        |
openstack --os-placement-api-version 1.6 trait list --sort-column name
+---------------------------------------+
| name                                  |
+---------------------------------------+
| COMPUTE_DEVICE_TAGGING                |
| COMPUTE_NET_ATTACH_INTERFACE          |
| ...                                   |
```