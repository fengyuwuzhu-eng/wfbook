# 启动一个实例

[TOC]

本部分创建支持启动实例所需的虚拟网络。网络选项 1 包括一个提供程序（外部）网络和一个使用它的实例。网络选项 2 包括一个提供商网络和一个使用它的实例和一个自助服务（专用）网络和一个使用它的实例。

The instructions in this section use command-line interface (CLI) tools on the controller node. However, you can follow the instructions on any host that the tools are installed.
本节中的说明使用控制器节点上的命令行界面 （CLI） 工具。但是，您可以按照安装了这些工具的任何主机上的说明进行操作。

For more information on the CLI tools, see the [OpenStackClient documentation for Pike](https://docs.openstack.org/python-openstackclient/pike/cli/command-objects/server.html#server-create), the [OpenStackClient documentation for Queens](https://docs.openstack.org/python-openstackclient/queens/cli/command-objects/server.html#server-create), or the [OpenStackClient documentation for Rocky](https://docs.openstack.org/python-openstackclient/rocky/cli/command-objects/server.html#server-create).
有关 CLI 工具的更多信息，请参阅 Pike 的 OpenStackClient 文档、Queens 的 OpenStackClient 文档或 Rocky 的 OpenStackClient 文档。

To use the dashboard, see the [Dashboard User Documentation for Pike](https://docs.openstack.org/horizon/pike/user/), the [Dashboard User Documentation for Queens](https://docs.openstack.org/horizon/queens/user/), or the [Dashboard User Documentation for Rocky](https://docs.openstack.org/horizon/rocky/user/).
要使用仪表板，请参阅 Pike 的仪表板用户文档、Queens 的仪表板用户文档或 Rocky 的仪表板用户文档。



## Create virtual networks[¶](https://docs.openstack.org/install-guide/launch-instance.html#create-virtual-networks) 创建虚拟网络 ¶

Create virtual networks for the networking option that you chose when configuring Neutron. If you chose option 1, create only the provider network. If you chose option 2, create the provider and self-service networks.
为配置 Neutron 时选择的网络选项创建虚拟网络。如果选择选项 1，请仅创建提供商网络。如果选择选项 2，请创建提供商和自助服务网络。

- [Provider network 提供商网络](https://docs.openstack.org/install-guide/launch-instance-networks-provider.html)
- [Self-service network 自助服务网络](https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html)

After creating the appropriate networks for your environment, you can continue preparing the environment to launch an instance.
为您的环境创建适当的网络后，您可以继续准备环境以启动实例。

## Create m1.nano flavor[¶](https://docs.openstack.org/install-guide/launch-instance.html#create-m1-nano-flavor) 创建 m1.nano 风格 ¶

The smallest default flavor consumes 512 MB memory per instance. For environments with compute nodes containing less than 4 GB memory, we recommend creating the `m1.nano` flavor that only requires 64 MB per instance. Only use this flavor with the CirrOS image for testing purposes.
最小的默认风格每个实例消耗 512 MB 内存。对于计算节点包含少于 4 GB 内存的环境，我们建议创建每个实例只需要 64 MB `m1.nano` 的实例。仅将此风格用于 CirrOS 映像以进行测试。

```
$ openstack flavor create --id 0 --vcpus 1 --ram 64 --disk 1 m1.nano

+----------------------------+---------+
| Field                      | Value   |
+----------------------------+---------+
| OS-FLV-DISABLED:disabled   | False   |
| OS-FLV-EXT-DATA:ephemeral  | 0       |
| disk                       | 1       |
| id                         | 0       |
| name                       | m1.nano |
| os-flavor-access:is_public | True    |
| properties                 |         |
| ram                        | 64      |
| rxtx_factor                | 1.0     |
| swap                       |         |
| vcpus                      | 1       |
+----------------------------+---------+
```

## Generate a key pair[¶](https://docs.openstack.org/install-guide/launch-instance.html#generate-a-key-pair) 生成密钥对 ¶

Most cloud images support [public key authentication](https://docs.openstack.org/install-guide/common/glossary.html#term-public-key-authentication) rather than conventional password authentication. Before launching an instance, you must add a public key to the Compute service.
大多数云镜像都支持公钥认证，而不是传统的密码认证。在启动实例之前，您必须向计算服务添加公钥。

1. Source the `demo` project credentials:
   获取 `demo` 项目凭据：

   ```
   $ . demo-openrc
   ```

2. Generate a key pair and add a public key:
   生成密钥对并添加公钥：

   ```
   $ ssh-keygen -q -N ""
   $ openstack keypair create --public-key ~/.ssh/id_rsa.pub mykey
   
   +-------------+-------------------------------------------------+
   | Field       | Value                                           |
   +-------------+-------------------------------------------------+
   | fingerprint | ee:3d:2e:97:d4:e2:6a:54:6d:0d:ce:43:39:2c:ba:4d |
   | name        | mykey                                           |
   | user_id     | 58126687cbcc4888bfa9ab73a2256f27                |
   +-------------+-------------------------------------------------+
   ```

   

    

   Note 注意

   

   Alternatively, you can skip the `ssh-keygen` command and use an existing public key.
   或者，您可以跳过该 `ssh-keygen` 命令并使用现有的公钥。

3. Verify addition of the key pair:
   验证密钥对的添加：

   ```
   $ openstack keypair list
   
   +-------+-------------------------------------------------+
   | Name  | Fingerprint                                     |
   +-------+-------------------------------------------------+
   | mykey | ee:3d:2e:97:d4:e2:6a:54:6d:0d:ce:43:39:2c:ba:4d |
   +-------+-------------------------------------------------+
   ```

## Add security group rules[¶](https://docs.openstack.org/install-guide/launch-instance.html#add-security-group-rules) 添加安全组规则 ¶

By default, the `default` security group applies to all instances and includes firewall rules that deny remote access to instances. For Linux images such as CirrOS, we recommend allowing at least ICMP (ping) and secure shell (SSH).
默认情况下， `default` 安全组适用于所有实例，并包含拒绝对实例进行远程访问的防火墙规则。对于 CirrOS 等 Linux 映像，我们建议至少允许 ICMP （ping） 和安全外壳 （SSH）。

- Add rules to the `default` security group:
  向 `default` 安全组添加规则：

  - Permit [ICMP](https://docs.openstack.org/install-guide/common/glossary.html#term-Internet-Control-Message-Protocol-ICMP) (ping): 允许 ICMP （ping）：

    ```
    $ openstack security group rule create --proto icmp default
    
    +-------------------+--------------------------------------+
    | Field             | Value                                |
    +-------------------+--------------------------------------+
    | created_at        | 2017-03-30T00:46:43Z                 |
    | description       |                                      |
    | direction         | ingress                              |
    | ether_type        | IPv4                                 |
    | id                | 1946be19-54ab-4056-90fb-4ba606f19e66 |
    | name              | None                                 |
    | port_range_max    | None                                 |
    | port_range_min    | None                                 |
    | project_id        | 3f714c72aed7442681cbfa895f4a68d3     |
    | protocol          | icmp                                 |
    | remote_group_id   | None                                 |
    | remote_ip_prefix  | 0.0.0.0/0                            |
    | revision_number   | 1                                    |
    | security_group_id | 89ff5c84-e3d1-46bb-b149-e621689f0696 |
    | updated_at        | 2017-03-30T00:46:43Z                 |
    +-------------------+--------------------------------------+
    ```

  - Permit secure shell (SSH) access:
    允许安全外壳 （SSH） 访问：

    ```
    $ openstack security group rule create --proto tcp --dst-port 22 default
    
    +-------------------+--------------------------------------+
    | Field             | Value                                |
    +-------------------+--------------------------------------+
    | created_at        | 2017-03-30T00:43:35Z                 |
    | description       |                                      |
    | direction         | ingress                              |
    | ether_type        | IPv4                                 |
    | id                | 42bc2388-ae1a-4208-919b-10cf0f92bc1c |
    | name              | None                                 |
    | port_range_max    | 22                                   |
    | port_range_min    | 22                                   |
    | project_id        | 3f714c72aed7442681cbfa895f4a68d3     |
    | protocol          | tcp                                  |
    | remote_group_id   | None                                 |
    | remote_ip_prefix  | 0.0.0.0/0                            |
    | revision_number   | 1                                    |
    | security_group_id | 89ff5c84-e3d1-46bb-b149-e621689f0696 |
    | updated_at        | 2017-03-30T00:43:35Z                 |
    +-------------------+--------------------------------------+
    ```

## Launch an instance[¶](https://docs.openstack.org/install-guide/launch-instance.html#id1) 启动实例 ¶

If you chose networking option 1, you can only launch an instance on the provider network. If you chose networking option 2, you can launch an instance on the provider network and the self-service network.
如果您选择了联网选项 1，则只能在提供商网络上启动实例。如果您选择联网选项 2，则可以在提供商网络和自助服务网络上启动实例。

- [Launch an instance on the provider network
  在提供商网络上启动实例](https://docs.openstack.org/install-guide/launch-instance-provider.html)
- [Launch an instance on the self-service network
  在自助服务网络上启动实例](https://docs.openstack.org/install-guide/launch-instance-selfservice.html)



## Block Storage[¶](https://docs.openstack.org/install-guide/launch-instance.html#block-storage) 区块存储 ¶

If your environment includes the Block Storage service, you can create a volume and attach it to an instance.
如果您的环境包含块存储服务，您可以创建卷并将其附加到实例。

- [Block Storage 块存储](https://docs.openstack.org/install-guide/launch-instance-cinder.html)

## Orchestration[¶](https://docs.openstack.org/install-guide/launch-instance.html#orchestration) 编排 ¶

If your environment includes the Orchestration service, you can create a stack that launches an instance.
如果您的环境包含 Orchestration 服务，则可以创建用于启动实例的堆栈。

For more information, see the [Orchestration installation guide for Pike](https://docs.openstack.org/heat/pike/install/), the [Orchestration installation guide for Queens](https://docs.openstack.org/heat/queens/install/), or the [Orchestration installation guide for Rocky](https://docs.openstack.org/heat/rocky/install/).
有关更多信息，请参阅 Pike 的 Orchestration 安装指南、Queens 的 Orchestration 安装指南或 Rocky 的 Orchestration 安装指南。

## Shared File Systems[¶](https://docs.openstack.org/install-guide/launch-instance.html#shared-file-systems) 共享文件系统 ¶

If your environment includes the Shared File Systems service, you can create a share and mount it in an instance.
如果您的环境包含共享文件系统服务，则可以创建共享并将其挂载到实例中。

For more information, see the [Shared File Systems installation guide for Pike](https://docs.openstack.org/manila/pike/install/), the [Shared File Systems installation guide for Queens](https://docs.openstack.org/manila/queens/install/), or the [Shared File Systems installation guide for Rocky](https://docs.openstack.org/manila/rocky/install/).
有关更多信息，请参阅 Pike 的共享文件系统安装指南、Queens 的共享文件系统安装指南或 Rocky 的共享文件系统安装指南。

# Provider network 提供商网络

​                                          



Before launching an instance, you must create the necessary virtual network infrastructure. For networking option 1, an instance uses a provider (external) network that connects to the physical network infrastructure via layer-2 (bridging/switching). This network includes a DHCP server that provides IP addresses to instances.
在启动实例之前，必须创建必要的虚拟网络基础结构。对于联网选项 1，实例使用提供商（外部）网络，该网络通过第 2 层（桥接/交换）连接到物理网络基础设施。此网络包括一个 DHCP 服务器，用于向实例提供 IP 地址。

The `admin` or other privileged user must create this network because it connects directly to the physical network infrastructure.
 `admin` 或其他特权用户必须创建此网络，因为它直接连接到物理网络基础结构。



 

Note 注意



The following instructions and diagrams use example IP address ranges. You must adjust them for your particular environment.
以下说明和图表使用示例 IP 地址范围。您必须根据特定环境调整它们。

![Networking Option 1: Provider networks - Overview](https://docs.openstack.org/install-guide/_images/network1-overview.png)

**Networking Option 1: Provider networks - Overview**[¶](https://docs.openstack.org/install-guide/launch-instance-networks-provider.html#id1)
网络选项 1：提供商网络 - 概述 ¶

![Networking Option 1: Provider networks - Connectivity](https://docs.openstack.org/install-guide/_images/network1-connectivity.png)

**Networking Option 1: Provider networks - Connectivity**[¶](https://docs.openstack.org/install-guide/launch-instance-networks-provider.html#id2)
网络选项 1：提供商网络 - 连接 ¶

## Create the provider network[¶](https://docs.openstack.org/install-guide/launch-instance-networks-provider.html#create-the-provider-network) 创建提供商网络 ¶

1. On the controller node, source the `admin` credentials to gain access to admin-only CLI commands:
   在控制器节点上，获取 `admin` 凭据以获取对仅限管理员的 CLI 命令的访问权限：

   ```
   $ . admin-openrc
   ```

2. Create the network: 创建网络：

   ```
   $ openstack network create  --share --external \
     --provider-physical-network provider \
     --provider-network-type flat provider
   
   Created a new network:
   
   +---------------------------+--------------------------------------+
   | Field                     | Value                                |
   +---------------------------+--------------------------------------+
   | admin_state_up            | UP                                   |
   | availability_zone_hints   |                                      |
   | availability_zones        |                                      |
   | created_at                | 2017-03-14T14:37:39Z                 |
   | description               |                                      |
   | dns_domain                | None                                 |
   | id                        | 54adb94a-4dce-437f-a33b-e7e2e7648173 |
   | ipv4_address_scope        | None                                 |
   | ipv6_address_scope        | None                                 |
   | is_default                | None                                 |
   | mtu                       | 1500                                 |
   | name                      | provider                             |
   | port_security_enabled     | True                                 |
   | project_id                | 4c7f48f1da5b494faaa66713686a7707     |
   | provider:network_type     | flat                                 |
   | provider:physical_network | provider                             |
   | provider:segmentation_id  | None                                 |
   | qos_policy_id             | None                                 |
   | revision_number           | 3                                    |
   | router:external           | External                             |
   | segments                  | None                                 |
   | shared                    | True                                 |
   | status                    | ACTIVE                               |
   | subnets                   |                                      |
   | updated_at                | 2017-03-14T14:37:39Z                 |
   +---------------------------+--------------------------------------+
   ```

   The `--share` option allows all projects to use the virtual network.
   该 `--share` 选项允许所有项目使用虚拟网络。

   The `--external` option defines the virtual network to be external. If you wish to create an internal network, you can use `--internal` instead. Default value is `internal`.
   该 `--external` 选项将虚拟网络定义为外部虚拟网络。如果要创建内部网络，可以改用 `--internal` 。默认值为 `internal` 。

   The `--provider-physical-network provider` and `--provider-network-type flat` options connect the flat virtual network to the flat (native/untagged) physical network on the `eth1` interface on the host using information from the following files:
    `--provider-physical-network provider` 和 `--provider-network-type flat` 选项使用以下文件中的信息将平面虚拟网络连接到主机 `eth1` 上接口上的平面（本机/未标记）物理网络：

   `ml2_conf.ini`:

   ```
   [ml2_type_flat]
   flat_networks = provider
   ```

   `linuxbridge_agent.ini`:

   ```
   [linux_bridge]
   physical_interface_mappings = provider:eth1
   ```

3. Create a subnet on the network:
   在网络上创建子网：

   ```
   $ openstack subnet create --network provider \
     --allocation-pool start=START_IP_ADDRESS,end=END_IP_ADDRESS \
     --dns-nameserver DNS_RESOLVER --gateway PROVIDER_NETWORK_GATEWAY \
     --subnet-range PROVIDER_NETWORK_CIDR provider
   ```

   Replace `PROVIDER_NETWORK_CIDR` with the subnet on the provider physical network in CIDR notation.
   替换 `PROVIDER_NETWORK_CIDR` 为提供商物理网络上的子网，采用 CIDR 表示法。

   Replace `START_IP_ADDRESS` and `END_IP_ADDRESS` with the first and last IP address of the range within the subnet that you want to allocate for instances. This range must not include any existing active IP addresses.
   将 和 `END_IP_ADDRESS` 替换 `START_IP_ADDRESS` 为要为实例分配的子网中范围的第一个和最后一个 IP 地址。此范围不得包含任何现有的活动 IP 地址。

   Replace `DNS_RESOLVER` with the IP address of a DNS resolver. In most cases, you can use one from the `/etc/resolv.conf` file on the host.
   替换 `DNS_RESOLVER` 为 DNS 解析程序的 IP 地址。在大多数情况下，您可以使用主机上 `/etc/resolv.conf` 文件中的一个。

   Replace `PROVIDER_NETWORK_GATEWAY` with the gateway IP address on the provider network, typically the “.1” IP address.
   替换 `PROVIDER_NETWORK_GATEWAY` 为提供商网络上的网关 IP 地址，通常为“.1”IP 地址。

   **Example 例**

   The provider network uses 203.0.113.0/24 with a gateway on 203.0.113.1. A DHCP server assigns each instance an IP address from 203.0.113.101 to 203.0.113.250. All instances use 8.8.4.4 as a DNS resolver.
   提供商网络使用 203.0.113.0/24，网关位于 203.0.113.1。DHCP 服务器为每个实例分配一个从 203.0.113.101 到 203.0.113.250 的 IP 地址。所有实例都使用 8.8.4.4 作为 DNS 解析程序。

   ```
   $ openstack subnet create --network provider \
     --allocation-pool start=203.0.113.101,end=203.0.113.250 \
     --dns-nameserver 8.8.4.4 --gateway 203.0.113.1 \
     --subnet-range 203.0.113.0/24 provider
   
   Created a new subnet:
   +-------------------+--------------------------------------+
   | Field             | Value                                |
   +-------------------+--------------------------------------+
   | allocation_pools  | 203.0.113.101-203.0.113.250          |
   | cidr              | 203.0.113.0/24                       |
   | created_at        | 2017-03-29T05:48:29Z                 |
   | description       |                                      |
   | dns_nameservers   | 8.8.4.4                              |
   | enable_dhcp       | True                                 |
   | gateway_ip        | 203.0.113.1                          |
   | host_routes       |                                      |
   | id                | e84b4972-c7fc-4ce9-9742-fdc845196ac5 |
   | ip_version        | 4                                    |
   | ipv6_address_mode | None                                 |
   | ipv6_ra_mode      | None                                 |
   | name              | provider                             |
   | network_id        | 1f816a46-7c3f-4ccf-8bf3-fe0807ddff8d |
   | project_id        | 496efd248b0c46d3b80de60a309177b5     |
   | revision_number   | 2                                    |
   | segment_id        | None                                 |
   | service_types     |                                      |
   | subnetpool_id     | None                                 |
   | updated_at        | 2017-03-29T05:48:29Z                 |
   +-------------------+--------------------------------------+
   ```

Return to [Launch an instance - Create virtual networks](https://docs.openstack.org/install-guide/launch-instance.html#launch-instance-networks).
返回到启动实例 - 创建虚拟网络。



# Self-service network 自助服务网络

​                                          



If you chose networking option 2, you can also create a self-service (private) network that connects to the physical network infrastructure via NAT. This network includes a DHCP server that provides IP addresses to instances. An instance on this network can automatically access external networks such as the Internet. However, access to an instance on this network from external networks such as the Internet requires a [floating IP address](https://docs.openstack.org/install-guide/common/glossary.html#term-floating-IP-address).
如果选择网络选项 2，则还可以创建通过 NAT 连接到物理网络基础结构的自助服务（专用）网络。此网络包括一个 DHCP 服务器，用于向实例提供 IP  地址。该网络上的实例可以自动访问外部网络，例如 Internet。但是，从外部网络（如 Internet）访问此网络上的实例需要浮动 IP  地址。

The `demo` or other unprivileged user can create this network because it provides connectivity to instances within the `demo` project only.
或其他 `demo` 非特权用户可以创建此网络，因为它仅提供与项目中实例的 `demo` 连接。



 

Warning 警告



You must [create the provider network](https://docs.openstack.org/install-guide/launch-instance-networks-provider.html#launch-instance-networks-provider) before the self-service network.
您必须先创建提供商网络，然后再创建自助服务网络。



 

Note 注意



The following instructions and diagrams use example IP address ranges. You must adjust them for your particular environment.
以下说明和图表使用示例 IP 地址范围。您必须根据特定环境调整它们。

![Networking Option 2: Self-service networks - Overview](https://docs.openstack.org/install-guide/_images/network2-overview.png)

**Networking Option 2: Self-service networks - Overview**[¶](https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html#id1)
网络选项 2：自助服务网络 - 概述 ¶

![Networking Option 2: Self-service networks - Connectivity](https://docs.openstack.org/install-guide/_images/network2-connectivity.png)

**Networking Option 2: Self-service networks - Connectivity**[¶](https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html#id2)
网络选项 2：自助服务网络 - 连接 ¶

## Create the self-service network[¶](https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html#create-the-self-service-network) 创建自助服务网络 ¶

1. On the controller node, source the `demo` credentials to gain access to user-only CLI commands:
   在控制器节点上，获取 `demo` 凭据以访问仅限用户的 CLI 命令：

   ```
   $ . demo-openrc
   ```

2. Create the network: 创建网络：

   ```
   $ openstack network create selfservice
   
   Created a new network:
   +-------------------------+--------------------------------------+
   | Field                   | Value                                |
   +-------------------------+--------------------------------------+
   | admin_state_up          | UP                                   |
   | availability_zone_hints |                                      |
   | availability_zones      |                                      |
   | created_at              | 2016-11-04T18:20:59Z                 |
   | description             |                                      |
   | headers                 |                                      |
   | id                      | 7c6f9b37-76b4-463e-98d8-27e5686ed083 |
   | ipv4_address_scope      | None                                 |
   | ipv6_address_scope      | None                                 |
   | mtu                     | 1450                                 |
   | name                    | selfservice                          |
   | port_security_enabled   | True                                 |
   | project_id              | 3828e7c22c5546e585f27b9eb5453788     |
   | project_id              | 3828e7c22c5546e585f27b9eb5453788     |
   | revision_number         | 3                                    |
   | router:external         | Internal                             |
   | shared                  | False                                |
   | status                  | ACTIVE                               |
   | subnets                 |                                      |
   | tags                    | []                                   |
   | updated_at              | 2016-11-04T18:20:59Z                 |
   +-------------------------+--------------------------------------+
   ```

   Non-privileged users typically cannot supply additional parameters to this command. The service automatically chooses parameters using information from the following files:
   非特权用户通常无法为此命令提供其他参数。该服务使用以下文件中的信息自动选择参数：

   `ml2_conf.ini`:

   ```
   [ml2]
   tenant_network_types = vxlan
   
   [ml2_type_vxlan]
   vni_ranges = 1:1000
   ```

3. Create a subnet on the network:
   在网络上创建子网：

   ```
   $ openstack subnet create --network selfservice \
     --dns-nameserver DNS_RESOLVER --gateway SELFSERVICE_NETWORK_GATEWAY \
     --subnet-range SELFSERVICE_NETWORK_CIDR selfservice
   ```

   Replace `DNS_RESOLVER` with the IP address of a DNS resolver. In most cases, you can use one from the `/etc/resolv.conf` file on the host.
   替换 `DNS_RESOLVER` 为 DNS 解析程序的 IP 地址。在大多数情况下，您可以使用主机上 `/etc/resolv.conf` 文件中的一个。

   Replace `SELFSERVICE_NETWORK_GATEWAY` with the gateway you want to use on the self-service network, typically the “.1” IP address.
   替换 `SELFSERVICE_NETWORK_GATEWAY` 为要在自助服务网络上使用的网关，通常为“.1”IP 地址。

   Replace `SELFSERVICE_NETWORK_CIDR` with the subnet you want to use on the self-service network. You can use any arbitrary value, although we recommend a network from [RFC 1918](https://tools.ietf.org/html/rfc1918).
   替换 `SELFSERVICE_NETWORK_CIDR` 为要在自助服务网络上使用的子网。您可以使用任意值，但我们建议使用 RFC 1918 中的网络。

   **Example 例**

   The self-service network uses 172.16.1.0/24 with a gateway on 172.16.1.1. A DHCP server assigns each instance an IP address from 172.16.1.2 to 172.16.1.254. All instances use 8.8.4.4 as a DNS resolver.
   自助服务网络使用 172.16.1.0/24，网关位于 172.16.1.1。DHCP 服务器为每个实例分配一个从 172.16.1.2 到 172.16.1.254 的 IP 地址。所有实例都使用 8.8.4.4 作为 DNS 解析程序。

   ```
   $ openstack subnet create --network selfservice \
     --dns-nameserver 8.8.4.4 --gateway 172.16.1.1 \
     --subnet-range 172.16.1.0/24 selfservice
   
   Created a new subnet:
   +-------------------+--------------------------------------+
   | Field             | Value                                |
   +-------------------+--------------------------------------+
   | allocation_pools  | 172.16.1.2-172.16.1.254              |
   | cidr              | 172.16.1.0/24                        |
   | created_at        | 2016-11-04T18:30:54Z                 |
   | description       |                                      |
   | dns_nameservers   | 8.8.4.4                              |
   | enable_dhcp       | True                                 |
   | gateway_ip        | 172.16.1.1                           |
   | headers           |                                      |
   | host_routes       |                                      |
   | id                | 5c37348e-e7da-439b-8c23-2af47d93aee5 |
   | ip_version        | 4                                    |
   | ipv6_address_mode | None                                 |
   | ipv6_ra_mode      | None                                 |
   | name              | selfservice                          |
   | network_id        | b9273876-5946-4f02-a4da-838224a144e7 |
   | project_id        | 3828e7c22c5546e585f27b9eb5453788     |
   | project_id        | 3828e7c22c5546e585f27b9eb5453788     |
   | revision_number   | 2                                    |
   | service_types     | []                                   |
   | subnetpool_id     | None                                 |
   | updated_at        | 2016-11-04T18:30:54Z                 |
   +-------------------+--------------------------------------+
   ```

## Create a router[¶](https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html#create-a-router) 创建路由器 ¶

Self-service networks connect to provider networks using a virtual router that typically performs bidirectional NAT. Each router contains an interface on at least one self-service network and a gateway on a provider network.
自助服务网络使用通常执行双向 NAT 的虚拟路由器连接到提供商网络。每个路由器在至少一个自助服务网络上包含一个接口，在提供商网络上包含一个网关。

The provider network must include the `router:external` option to enable self-service routers to use it for connectivity to external networks such as the Internet. The `admin` or other privileged user must include this option during network creation or add it later. In this case, the `router:external` option was set by using the `--external` parameter when creating the `provider` network.
提供商网络必须包含使自助服务路由器能够将其用于连接到外部网络（如 Internet）的 `router:external` 选项。 `admin` 或其他特权用户必须在网络创建期间包含此选项，或者稍后添加此选项。在本例中，该 `router:external` 选项是在创建 `provider` 网络时使用参数 `--external` 设置的。

1. On the controller node, source the `demo` credentials to gain access to user-only CLI commands:
   在控制器节点上，获取 `demo` 凭据以访问仅限用户的 CLI 命令：

   ```
   $ . demo-openrc
   ```

2. Create the router: 创建路由器：

   ```
   $ openstack router create router
   
   Created a new router:
   +-------------------------+--------------------------------------+
   | Field                   | Value                                |
   +-------------------------+--------------------------------------+
   | admin_state_up          | UP                                   |
   | availability_zone_hints |                                      |
   | availability_zones      |                                      |
   | created_at              | 2016-11-04T18:32:56Z                 |
   | description             |                                      |
   | external_gateway_info   | null                                 |
   | flavor_id               | None                                 |
   | headers                 |                                      |
   | id                      | 67324374-396a-4db6-9443-c70be167a42b |
   | name                    | router                               |
   | project_id              | 3828e7c22c5546e585f27b9eb5453788     |
   | project_id              | 3828e7c22c5546e585f27b9eb5453788     |
   | revision_number         | 2                                    |
   | routes                  |                                      |
   | status                  | ACTIVE                               |
   | updated_at              | 2016-11-04T18:32:56Z                 |
   +-------------------------+--------------------------------------+
   ```

3. Add the self-service network subnet as an interface on the router:
   将自助服务网络子网添加为路由器上的接口：

   ```
   $ openstack router add subnet router selfservice
   ```

4. Set a gateway on the provider network on the router:
   在路由器上的提供商网络上设置网关：

   ```
   $ openstack router set router --external-gateway provider
   ```

## Verify operation[¶](https://docs.openstack.org/install-guide/launch-instance-networks-selfservice.html#verify-operation) 验证操作 ¶

We recommend that you verify operation and fix any issues before proceeding. The following steps use the IP address ranges from the network and subnet creation examples.
我们建议您在继续操作之前验证操作并修复任何问题。以下步骤使用网络和子网创建示例中的 IP 地址范围。

1. On the controller node, source the `admin` credentials to gain access to admin-only CLI commands:
   在控制器节点上，获取 `admin` 凭据以获取对仅限管理员的 CLI 命令的访问权限：

   ```
   $ . admin-openrc
   ```

2. List network namespaces. You should see one `qrouter` namespace and two `qdhcp` namespaces.
   列出网络命名空间。您应该看到一个 `qrouter` 命名空间和两个 `qdhcp` 命名空间。

   ```
   $ ip netns
   
   qrouter-89dd2083-a160-4d75-ab3a-14239f01ea0b
   qdhcp-7c6f9b37-76b4-463e-98d8-27e5686ed083
   qdhcp-0e62efcd-8cee-46c7-b163-d8df05c3c5ad
   ```

3. List ports on the router to determine the gateway IP address on the provider network:
   列出路由器上的端口以确定提供商网络上的网关 IP 地址：

   ```
   $ openstack port list --router router
   
   +--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+
   | ID                                   | Name | MAC Address       | Fixed IP Addresses                                                            | Status |
   +--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+
   | bff6605d-824c-41f9-b744-21d128fc86e1 |      | fa:16:3e:2f:34:9b | ip_address='172.16.1.1', subnet_id='3482f524-8bff-4871-80d4-5774c2730728'     | ACTIVE |
   | d6fe98db-ae01-42b0-a860-37b1661f5950 |      | fa:16:3e:e8:c1:41 | ip_address='203.0.113.102', subnet_id='5cc70da8-4ee7-4565-be53-b9c011fca011'  | ACTIVE |
   +--------------------------------------+------+-------------------+-------------------------------------------------------------------------------+--------+
   ```

4. Ping this IP address from the controller node or any host on the physical provider network:
   从控制器节点或物理提供商网络上的任何主机 ping 此 IP 地址：

   ```
   $ ping -c 4 203.0.113.102
   
   PING 203.0.113.102 (203.0.113.102) 56(84) bytes of data.
   64 bytes from 203.0.113.102: icmp_req=1 ttl=64 time=0.619 ms
   64 bytes from 203.0.113.102: icmp_req=2 ttl=64 time=0.189 ms
   64 bytes from 203.0.113.102: icmp_req=3 ttl=64 time=0.165 ms
   64 bytes from 203.0.113.102: icmp_req=4 ttl=64 time=0.216 ms
   
   --- 203.0.113.102 ping statistics ---
   rtt min/avg/max/mdev = 0.165/0.297/0.619/0.187 ms
   ```

Return to [Launch an instance - Create virtual networks](https://docs.openstack.org/install-guide/launch-instance.html#launch-instance-networks).
返回到启动实例 - 创建虚拟网络。

# Launch an instance on the provider network 在提供商网络上启动实例

​                                          



## Determine instance options[¶](https://docs.openstack.org/install-guide/launch-instance-provider.html#determine-instance-options) 确定实例选项 ¶

To launch an instance, you must at least specify the flavor, image name, network, security group, key, and instance name.
要启动实例，您至少必须指定实例、映像名称、网络、安全组、密钥和实例名称。

1. On the controller node, source the `demo` credentials to gain access to user-only CLI commands:
   在控制器节点上，获取 `demo` 凭据以访问仅限用户的 CLI 命令：

   ```
   $ . demo-openrc
   ```

2. A flavor specifies a virtual resource allocation profile which includes processor, memory, and storage.
   特定实例指定虚拟资源分配配置文件，其中包括处理器、内存和存储。

   List available flavors: 列出可用口味：

   ```
   $ openstack flavor list
   
   +----+---------+-----+------+-----------+-------+-----------+
   | ID | Name    | RAM | Disk | Ephemeral | VCPUs | Is Public |
   +----+---------+-----+------+-----------+-------+-----------+
   | 0  | m1.nano |  64 |    1 |         0 |     1 | True      |
   +----+---------+-----+------+-----------+-------+-----------+
   ```

   

    

   Note 注意

   

   You can also reference a flavor by ID.
   您还可以按 ID 引用变种。

3. List available images: 列出可用图像：

   ```
   $ openstack image list
   
   +--------------------------------------+--------+--------+
   | ID                                   | Name   | Status |
   +--------------------------------------+--------+--------+
   | 390eb5f7-8d49-41ec-95b7-68c0d5d54b34 | cirros | active |
   +--------------------------------------+--------+--------+
   ```

   This instance uses the `cirros` image.
   此实例使用该 `cirros` 映像。

4. List available networks:
   列出可用的网络：

   ```
   $ openstack network list
   
   +--------------------------------------+--------------+--------------------------------------+
   | ID                                   | Name         | Subnets                              |
   +--------------------------------------+--------------+--------------------------------------+
   | 4716ddfe-6e60-40e7-b2a8-42e57bf3c31c | selfservice  | 2112d5eb-f9d6-45fd-906e-7cabd38b7c7c |
   | b5b6993c-ddf9-40e7-91d0-86806a42edb8 | provider     | 310911f6-acf0-4a47-824e-3032916582ff |
   +--------------------------------------+--------------+--------------------------------------+
   ```

   This instance uses the `provider` provider network. However, you must reference this network using the ID instead of the name.
   此实例使用 `provider` 提供商网络。但是，您必须使用 ID 而不是名称来引用此网络。

   

    

   Note 注意

   

   If you chose option 2, the output should also contain the `selfservice` self-service network.
   如果选择选项 2，则输出还应包含 `selfservice` 自助服务网络。

5. List available security groups:
   列出可用的安全组：

   ```
   $ openstack security group list
   
   +--------------------------------------+---------+------------------------+----------------------------------+
   | ID                                   | Name    | Description            | Project                          |
   +--------------------------------------+---------+------------------------+----------------------------------+
   | dd2b614c-3dad-48ed-958b-b155a3b38515 | default | Default security group | a516b957032844328896baa01e0f906c |
   +--------------------------------------+---------+------------------------+----------------------------------+
   ```

   This instance uses the `default` security group.
   此实例使用 `default` 安全组。

## Launch the instance[¶](https://docs.openstack.org/install-guide/launch-instance-provider.html#launch-the-instance) 启动实例 ¶

1. Launch the instance: 启动实例：

   Replace `PROVIDER_NET_ID` with the ID of the `provider` provider network.
   替换 `PROVIDER_NET_ID` 为 `provider` 提供商网络的 ID。

   

    

   Note 注意

   

   If you chose option 1 and your environment contains only one network, you can omit the `--nic` option because OpenStack automatically chooses the only network available.
   如果您选择了选项 1，并且您的环境只包含一个网络，则可以省略该 `--nic` 选项，因为 OpenStack 会自动选择唯一可用的网络。

   ```
   $ openstack server create --flavor m1.nano --image cirros \
     --nic net-id=PROVIDER_NET_ID --security-group default \
     --key-name mykey provider-instance
   
   +-----------------------------+-----------------------------------------------+
   | Field                       | Value                                         |
   +-----------------------------+-----------------------------------------------+
   | OS-DCF:diskConfig           | MANUAL                                        |
   | OS-EXT-AZ:availability_zone |                                               |
   | OS-EXT-STS:power_state      | NOSTATE                                       |
   | OS-EXT-STS:task_state       | scheduling                                    |
   | OS-EXT-STS:vm_state         | building                                      |
   | OS-SRV-USG:launched_at      | None                                          |
   | OS-SRV-USG:terminated_at    | None                                          |
   | accessIPv4                  |                                               |
   | accessIPv6                  |                                               |
   | addresses                   |                                               |
   | adminPass                   | PwkfyQ42K72h                                  |
   | config_drive                |                                               |
   | created                     | 2017-03-30T00:59:44Z                          |
   | flavor                      | m1.nano (0)                                   |
   | hostId                      |                                               |
   | id                          | 36f3130e-cf1b-42f8-a80b-ebd63968940e          |
   | image                       | cirros (97e06b44-e9ed-4db4-ba67-6e9fc5d0a203) |
   | key_name                    | mykey                                         |
   | name                        | provider-instance                             |
   | progress                    | 0                                             |
   | project_id                  | 3f714c72aed7442681cbfa895f4a68d3              |
   | properties                  |                                               |
   | security_groups             | name='default'                                |
   | status                      | BUILD                                         |
   | updated                     | 2017-03-30T00:59:44Z                          |
   | user_id                     | 1a421c69342348248c7696e3fd6d4366              |
   | volumes_attached            |                                               |
   +-----------------------------+-----------------------------------------------+
   ```

2. Check the status of your instance:
   检查实例的状态：

   ```
   $ openstack server list
   
   +--------------------------------------+-------------------+--------+------------------------+------------+
   | ID                                   | Name              | Status | Networks               | Image Name |
   +--------------------------------------+-------------------+--------+------------------------+------------+
   | 181c52ba-aebc-4c32-a97d-2e8e82e4eaaf | provider-instance | ACTIVE | provider=203.0.113.103 | cirros     |
   +--------------------------------------+-------------------+--------+------------------------+------------+
   ```

   The status changes from `BUILD` to `ACTIVE` when the build process successfully completes.
    `ACTIVE` 当生成过程成功完成时，状态将更改 `BUILD` 为 。

## Access the instance using the virtual console[¶](https://docs.openstack.org/install-guide/launch-instance-provider.html#access-the-instance-using-the-virtual-console) 使用虚拟控制台访问实例 ¶

1. Obtain a [Virtual Network Computing (VNC)](https://docs.openstack.org/install-guide/common/glossary.html#term-Virtual-Network-Computing-VNC) session URL for your instance and access it from a web browser:
   获取实例的虚拟网络计算 （VNC） 会话 URL，并从 Web 浏览器访问它：

   ```
   $ openstack console url show provider-instance
   
   +-------+---------------------------------------------------------------------------------+
   | Field | Value                                                                           |
   +-------+---------------------------------------------------------------------------------+
   | type  | novnc                                                                           |
   | url   | http://controller:6080/vnc_auto.html?token=5eeccb47-525c-4918-ac2a-3ad1e9f1f493 |
   +-------+---------------------------------------------------------------------------------+
   ```

   

    

   Note 注意

   

   If your web browser runs on a host that cannot resolve the `controller` host name, you can replace `controller` with the IP address of the management interface on your controller node.
   如果您的 Web 浏览器在无法解析主机名的 `controller` 主机上运行，则可以替换 `controller` 为控制器节点上管理接口的 IP 地址。

   The CirrOS image includes conventional user name/password authentication and provides these credentials at the login prompt. After logging into CirrOS, we recommend that you verify network connectivity using `ping`.
   CirrOS 映像包括常规用户名/密码身份验证，并在登录提示符下提供这些凭据。登录 CirrOS 后，我们建议您使用 `ping` 验证网络连接。

2. Verify access to the provider physical network gateway:
   验证对提供商物理网络网关的访问：

   ```
   $ ping -c 4 203.0.113.1
   
   PING 203.0.113.1 (203.0.113.1) 56(84) bytes of data.
   64 bytes from 203.0.113.1: icmp_req=1 ttl=64 time=0.357 ms
   64 bytes from 203.0.113.1: icmp_req=2 ttl=64 time=0.473 ms
   64 bytes from 203.0.113.1: icmp_req=3 ttl=64 time=0.504 ms
   64 bytes from 203.0.113.1: icmp_req=4 ttl=64 time=0.470 ms
   
   --- 203.0.113.1 ping statistics ---
   4 packets transmitted, 4 received, 0% packet loss, time 2998ms
   rtt min/avg/max/mdev = 0.357/0.451/0.504/0.055 ms
   ```

3. Verify access to the internet:
   验证对 Internet 的访问：

   ```
   $ ping -c 4 openstack.org
   
   PING openstack.org (174.143.194.225) 56(84) bytes of data.
   64 bytes from 174.143.194.225: icmp_req=1 ttl=53 time=17.4 ms
   64 bytes from 174.143.194.225: icmp_req=2 ttl=53 time=17.5 ms
   64 bytes from 174.143.194.225: icmp_req=3 ttl=53 time=17.7 ms
   64 bytes from 174.143.194.225: icmp_req=4 ttl=53 time=17.5 ms
   
   --- openstack.org ping statistics ---
   4 packets transmitted, 4 received, 0% packet loss, time 3003ms
   rtt min/avg/max/mdev = 17.431/17.575/17.734/0.143 ms
   ```

## Access the instance remotely[¶](https://docs.openstack.org/install-guide/launch-instance-provider.html#access-the-instance-remotely) 远程访问实例 ¶

1. Verify connectivity to the instance from the controller node or any host on the provider physical network:
   验证从控制器节点或提供商物理网络上的任何主机到实例的连接：

   ```
   $ ping -c 4 203.0.113.103
   
   PING 203.0.113.103 (203.0.113.103) 56(84) bytes of data.
   64 bytes from 203.0.113.103: icmp_req=1 ttl=63 time=3.18 ms
   64 bytes from 203.0.113.103: icmp_req=2 ttl=63 time=0.981 ms
   64 bytes from 203.0.113.103: icmp_req=3 ttl=63 time=1.06 ms
   64 bytes from 203.0.113.103: icmp_req=4 ttl=63 time=0.929 ms
   
   --- 203.0.113.103 ping statistics ---
   4 packets transmitted, 4 received, 0% packet loss, time 3002ms
   rtt min/avg/max/mdev = 0.929/1.539/3.183/0.951 ms
   ```

2. Access your instance using SSH from the controller node or any host on the provider physical network:
   使用 SSH 从控制器节点或提供商物理网络上的任何主机访问您的实例：

   ```
   $ ssh cirros@203.0.113.103
   
   The authenticity of host '203.0.113.102 (203.0.113.102)' can't be established.
   RSA key fingerprint is ed:05:e9:e7:52:a0:ff:83:68:94:c7:d1:f2:f8:e2:e9.
   Are you sure you want to continue connecting (yes/no)? yes
   Warning: Permanently added '203.0.113.102' (RSA) to the list of known hosts.
   ```

If your instance does not launch or seem to work as you expect, see the [Troubleshoot Compute documentation for Pike](https://docs.openstack.org/nova/pike/admin/support-compute.html), the [Troubleshoot Compute documentation for Queens](https://docs.openstack.org/nova/queens/admin/support-compute.html), or the [Troubleshoot Compute documentation for Rocky](https://docs.openstack.org/nova/rocky/admin/support-compute.html) for more information or use one of the [many other options](https://docs.openstack.org/install-guide/common/app-support.html) to seek assistance. We want your first installation to work!
如果您的实例未启动或似乎按预期工作，请参阅 Pike 的计算疑难解答文档、Queens 的计算疑难解答文档或 Rocky 的计算疑难解答文档以了解更多信息，或使用许多其他选项之一寻求帮助。我们希望您的第一次安装能够正常工作！

Return to [Launch an instance](https://docs.openstack.org/install-guide/launch-instance.html#launch-instance-complete).
返回到启动实例。

# Launch an instance on the self-service network 在自助服务网络上启动实例

​                                          



## Determine instance options[¶](https://docs.openstack.org/install-guide/launch-instance-selfservice.html#determine-instance-options) 确定实例选项 ¶

To launch an instance, you must at least specify the flavor, image name, network, security group, key, and instance name.
要启动实例，您至少必须指定实例、映像名称、网络、安全组、密钥和实例名称。

1. On the controller node, source the `demo` credentials to gain access to user-only CLI commands:
   在控制器节点上，获取 `demo` 凭据以访问仅限用户的 CLI 命令：

   ```
   $ . demo-openrc
   ```

2. A flavor specifies a virtual resource allocation profile which includes processor, memory, and storage.
   特定实例指定虚拟资源分配配置文件，其中包括处理器、内存和存储。

   List available flavors: 列出可用口味：

   ```
   $ openstack flavor list
   
   +----+---------+-----+------+-----------+-------+-----------+
   | ID | Name    | RAM | Disk | Ephemeral | VCPUs | Is Public |
   +----+---------+-----+------+-----------+-------+-----------+
   | 0  | m1.nano |  64 |    1 |         0 |     1 | True      |
   +----+---------+-----+------+-----------+-------+-----------+
   ```

   

    

   Note 注意

   

   You can also reference a flavor by ID.
   您还可以按 ID 引用变种。

3. List available images: 列出可用图像：

   ```
   $ openstack image list
   
   +--------------------------------------+--------+--------+
   | ID                                   | Name   | Status |
   +--------------------------------------+--------+--------+
   | 390eb5f7-8d49-41ec-95b7-68c0d5d54b34 | cirros | active |
   +--------------------------------------+--------+--------+
   ```

   This instance uses the `cirros` image.
   此实例使用该 `cirros` 映像。

4. List available networks:
   列出可用的网络：

   ```
   $ openstack network list
   
   +--------------------------------------+-------------+--------------------------------------+
   | ID                                   | Name        | Subnets                              |
   +--------------------------------------+-------------+--------------------------------------+
   | 4716ddfe-6e60-40e7-b2a8-42e57bf3c31c | selfservice | 2112d5eb-f9d6-45fd-906e-7cabd38b7c7c |
   | b5b6993c-ddf9-40e7-91d0-86806a42edb8 | provider    | 310911f6-acf0-4a47-824e-3032916582ff |
   +--------------------------------------+-------------+--------------------------------------+
   ```

   This instance uses the `selfservice` self-service network. However, you must reference this network using the ID instead of the name.
   此实例使用 `selfservice` 自助服务网络。但是，您必须使用 ID 而不是名称来引用此网络。

5. List available security groups:
   列出可用的安全组：

   ```
   $ openstack security group list
   
   +--------------------------------------+---------+------------------------+
   | ID                                   | Name    | Description            |
   +--------------------------------------+---------+------------------------+
   | dd2b614c-3dad-48ed-958b-b155a3b38515 | default | Default security group |
   +--------------------------------------+---------+------------------------+
   ```

   This instance uses the `default` security group.
   此实例使用 `default` 安全组。

6. Launch the instance: 启动实例：

   Replace `SELFSERVICE_NET_ID` with the ID of the `selfservice` network.
   替换 `SELFSERVICE_NET_ID` 为 `selfservice` 网络的 ID。

   ```
   $ openstack server create --flavor m1.nano --image cirros \
     --nic net-id=SELFSERVICE_NET_ID --security-group default \
     --key-name mykey selfservice-instance
   
   +--------------------------------------+---------------------------------------+
   | Field                                | Value                                 |
   +--------------------------------------+---------------------------------------+
   | OS-DCF:diskConfig                    | MANUAL                                |
   | OS-EXT-AZ:availability_zone          |                                       |
   | OS-EXT-STS:power_state               | 0                                     |
   | OS-EXT-STS:task_state                | scheduling                            |
   | OS-EXT-STS:vm_state                  | building                              |
   | OS-SRV-USG:launched_at               | None                                  |
   | OS-SRV-USG:terminated_at             | None                                  |
   | accessIPv4                           |                                       |
   | accessIPv6                           |                                       |
   | addresses                            |                                       |
   | adminPass                            | 7KTBYHSjEz7E                          |
   | config_drive                         |                                       |
   | created                              | 2016-02-26T14:52:37Z                  |
   | flavor                               | m1.nano                               |
   | hostId                               |                                       |
   | id                                   | 113c5892-e58e-4093-88c7-e33f502eaaa4  |
   | image                                | cirros (390eb5f7-8d49-41ec-95b7-68c0d |
   |                                      | 5d54b34)                              |
   | key_name                             | mykey                                 |
   | name                                 | selfservice-instance                  |
   | os-extended-volumes:volumes_attached | []                                    |
   | progress                             | 0                                     |
   | project_id                           | ed0b60bf607743088218b0a533d5943f      |
   | properties                           |                                       |
   | security_groups                      | [{u'name': u'default'}]               |
   | status                               | BUILD                                 |
   | updated                              | 2016-02-26T14:52:38Z                  |
   | user_id                              | 58126687cbcc4888bfa9ab73a2256f27      |
   +--------------------------------------+---------------------------------------+
   ```

7. Check the status of your instance:
   检查实例的状态：

   ```
   $ openstack server list
   
   +--------------------------------------+----------------------+--------+------------------------+
   | ID                                   | Name                 | Status | Networks               |
   +--------------------------------------+----------------------+--------+------------------------+
   | 113c5892-e58e-4093-88c7-e33f502eaaa4 | selfservice-instance | ACTIVE | selfservice=172.16.1.3 |
   | 181c52ba-aebc-4c32-a97d-2e8e82e4eaaf | provider-instance    | ACTIVE | provider=203.0.113.103 |
   +--------------------------------------+----------------------+--------+------------------------+
   ```

   The status changes from `BUILD` to `ACTIVE` when the build process successfully completes.
    `ACTIVE` 当生成过程成功完成时，状态将更改 `BUILD` 为 。

## Access the instance using a virtual console[¶](https://docs.openstack.org/install-guide/launch-instance-selfservice.html#access-the-instance-using-a-virtual-console) 使用虚拟控制台访问实例 ¶

1. Obtain a [Virtual Network Computing (VNC)](https://docs.openstack.org/install-guide/common/glossary.html#term-Virtual-Network-Computing-VNC) session URL for your instance and access it from a web browser:
   获取实例的虚拟网络计算 （VNC） 会话 URL，并从 Web 浏览器访问它：

   ```
   $ openstack console url show selfservice-instance
   
   +-------+---------------------------------------------------------------------------------+
   | Field | Value                                                                           |
   +-------+---------------------------------------------------------------------------------+
   | type  | novnc                                                                           |
   | url   | http://controller:6080/vnc_auto.html?token=5eeccb47-525c-4918-ac2a-3ad1e9f1f493 |
   +-------+---------------------------------------------------------------------------------+
   ```

   

    

   Note 注意

   

   If your web browser runs on a host that cannot resolve the `controller` host name, you can replace `controller` with the IP address of the management interface on your controller node.
   如果您的 Web 浏览器在无法解析主机名的 `controller` 主机上运行，则可以替换 `controller` 为控制器节点上管理接口的 IP 地址。

   The CirrOS image includes conventional user name/password authentication and provides these credentials at the login prompt. After logging into CirrOS, we recommend that you verify network connectivity using `ping`.
   CirrOS 映像包括常规用户名/密码身份验证，并在登录提示符下提供这些凭据。登录 CirrOS 后，我们建议您使用 `ping` 验证网络连接。

2. Verify access to the self-service network gateway:
   验证对自助服务网络网关的访问：

   ```
   $ ping -c 4 172.16.1.1
   
   PING 172.16.1.1 (172.16.1.1) 56(84) bytes of data.
   64 bytes from 172.16.1.1: icmp_req=1 ttl=64 time=0.357 ms
   64 bytes from 172.16.1.1: icmp_req=2 ttl=64 time=0.473 ms
   64 bytes from 172.16.1.1: icmp_req=3 ttl=64 time=0.504 ms
   64 bytes from 172.16.1.1: icmp_req=4 ttl=64 time=0.470 ms
   
   --- 172.16.1.1 ping statistics ---
   4 packets transmitted, 4 received, 0% packet loss, time 2998ms
   rtt min/avg/max/mdev = 0.357/0.451/0.504/0.055 ms
   ```

3. Verify access to the internet:
   验证对 Internet 的访问：

   ```
   $ ping -c 4 openstack.org
   
   PING openstack.org (174.143.194.225) 56(84) bytes of data.
   64 bytes from 174.143.194.225: icmp_req=1 ttl=53 time=17.4 ms
   64 bytes from 174.143.194.225: icmp_req=2 ttl=53 time=17.5 ms
   64 bytes from 174.143.194.225: icmp_req=3 ttl=53 time=17.7 ms
   64 bytes from 174.143.194.225: icmp_req=4 ttl=53 time=17.5 ms
   
   --- openstack.org ping statistics ---
   4 packets transmitted, 4 received, 0% packet loss, time 3003ms
   rtt min/avg/max/mdev = 17.431/17.575/17.734/0.143 ms
   ```

## Access the instance remotely[¶](https://docs.openstack.org/install-guide/launch-instance-selfservice.html#access-the-instance-remotely) 远程访问实例 ¶

1. Create a [floating IP address](https://docs.openstack.org/install-guide/common/glossary.html#term-floating-IP-address) on the provider virtual network:
   在提供程序虚拟网络上创建浮动 IP 地址：Create a floating IP address on the provider virtual network：

   ```
   $ openstack floating ip create provider
   
   +---------------------+--------------------------------------+
   | Field               | Value                                |
   +---------------------+--------------------------------------+
   | created_at          | 2017-01-20T17:29:16Z                 |
   | description         |                                      |
   | fixed_ip_address    | None                                 |
   | floating_ip_address | 203.0.113.104                        |
   | floating_network_id | b5b6993c-ddf9-40e7-91d0-86806a42edb8 |
   | headers             |                                      |
   | id                  | 88b4d06a-d794-4406-affd-6ffa2bcf1e2a |
   | port_id             | None                                 |
   | project_id          | ed0b60bf607743088218b0a533d5943f     |
   | revision_number     | 1                                    |
   | router_id           | None                                 |
   | status              | DOWN                                 |
   | updated_at          | 2017-01-20T17:29:16Z                 |
   +---------------------+--------------------------------------+
   ```

2. Associate the floating IP address with the instance:
   将浮动 IP 地址与实例关联：

   ```
   $ openstack server add floating ip selfservice-instance 203.0.113.104
   ```

   

    

   Note 注意

   

   This command provides no output.
   此命令不提供任何输出。

3. Check the status of your floating IP address:
   检查浮动 IP 地址的状态：

   ```
   $ openstack server list
   
   +--------------------------------------+----------------------+--------+---------------------------------------+
   | ID                                   | Name                 | Status | Networks                              |
   +--------------------------------------+----------------------+--------+---------------------------------------+
   | 113c5892-e58e-4093-88c7-e33f502eaaa4 | selfservice-instance | ACTIVE | selfservice=172.16.1.3, 203.0.113.104 |
   | 181c52ba-aebc-4c32-a97d-2e8e82e4eaaf | provider-instance    | ACTIVE | provider=203.0.113.103                |
   +--------------------------------------+----------------------+--------+---------------------------------------+
   ```

4. Verify connectivity to the instance via floating IP address from the controller node or any host on the provider physical network:
   通过浮动 IP 地址从控制器节点或提供商物理网络上的任何主机验证与实例的连接：

   ```
   $ ping -c 4 203.0.113.104
   
   PING 203.0.113.104 (203.0.113.104) 56(84) bytes of data.
   64 bytes from 203.0.113.104: icmp_req=1 ttl=63 time=3.18 ms
   64 bytes from 203.0.113.104: icmp_req=2 ttl=63 time=0.981 ms
   64 bytes from 203.0.113.104: icmp_req=3 ttl=63 time=1.06 ms
   64 bytes from 203.0.113.104: icmp_req=4 ttl=63 time=0.929 ms
   
   --- 203.0.113.104 ping statistics ---
   4 packets transmitted, 4 received, 0% packet loss, time 3002ms
   rtt min/avg/max/mdev = 0.929/1.539/3.183/0.951 ms
   ```

5. Access your instance using SSH from the controller node or any host on the provider physical network:
   使用 SSH 从控制器节点或提供商物理网络上的任何主机访问您的实例：

   ```
   $ ssh cirros@203.0.113.104
   
   The authenticity of host '203.0.113.104 (203.0.113.104)' can't be established.
   RSA key fingerprint is ed:05:e9:e7:52:a0:ff:83:68:94:c7:d1:f2:f8:e2:e9.
   Are you sure you want to continue connecting (yes/no)? yes
   Warning: Permanently added '203.0.113.104' (RSA) to the list of known hosts.
   ```

If your instance does not launch or seem to work as you expect, see the [Troubleshoot Compute documentation for Pike](https://docs.openstack.org/nova/pike/admin/support-compute.html), the [Troubleshoot Compute documentation for Queens](https://docs.openstack.org/nova/queens/admin/support-compute.html), or the [Troubleshoot Compute documentation for Rocky](https://docs.openstack.org/nova/rocky/admin/support-compute.html) for more information or use one of the [many other options](https://docs.openstack.org/install-guide/common/app-support.html) to seek assistance. We want your first installation to work!
如果您的实例未启动或似乎按预期工作，请参阅 Pike 的计算疑难解答文档、Queens 的计算疑难解答文档或 Rocky 的计算疑难解答文档以了解更多信息，或使用许多其他选项之一寻求帮助。我们希望您的第一次安装能够正常工作！

Return to [Launch an instance](https://docs.openstack.org/install-guide/launch-instance.html#launch-instance-complete).
返回到启动实例。

# Block Storage 块存储

​                                          



## Create a volume[¶](https://docs.openstack.org/install-guide/launch-instance-cinder.html#create-a-volume) 创建卷 ¶

1. Source the `demo` credentials to perform the following steps as a non-administrative project:
   获取 `demo` 凭据以作为非管理项目执行以下步骤：

   ```
   $ . demo-openrc
   ```

2. Create a 1 GB volume:
   创建一个 1 GB 的卷：

   ```
   $ openstack volume create --size 1 volume1
   
   +---------------------+--------------------------------------+
   | Field               | Value                                |
   +---------------------+--------------------------------------+
   | attachments         | []                                   |
   | availability_zone   | nova                                 |
   | bootable            | false                                |
   | consistencygroup_id | None                                 |
   | created_at          | 2016-03-08T14:30:48.391027           |
   | description         | None                                 |
   | encrypted           | False                                |
   | id                  | a1e8be72-a395-4a6f-8e07-856a57c39524 |
   | multiattach         | False                                |
   | name                | volume1                              |
   | properties          |                                      |
   | replication_status  | disabled                             |
   | size                | 1                                    |
   | snapshot_id         | None                                 |
   | source_volid        | None                                 |
   | status              | creating                             |
   | type                | None                                 |
   | updated_at          | None                                 |
   | user_id             | 684286a9079845359882afc3aa5011fb     |
   +---------------------+--------------------------------------+
   ```

3. After a short time, the volume status should change from `creating` to `available`:
   短时间后，卷状态应从 更改为 `creating` `available` ：

   ```
   $ openstack volume list
   
   +--------------------------------------+--------------+-----------+------+-------------+
   | ID                                   | Display Name | Status    | Size | Attached to |
   +--------------------------------------+--------------+-----------+------+-------------+
   | a1e8be72-a395-4a6f-8e07-856a57c39524 | volume1      | available |    1 |             |
   +--------------------------------------+--------------+-----------+------+-------------+
   ```

## Attach the volume to an instance[¶](https://docs.openstack.org/install-guide/launch-instance-cinder.html#attach-the-volume-to-an-instance) 将卷附加到实例 ¶

1. Attach a volume to an instance:
   将卷附加到实例：

   ```
   $ openstack server add volume INSTANCE_NAME VOLUME_NAME
   ```

   Replace `INSTANCE_NAME` with the name of the instance and `VOLUME_NAME` with the name of the volume you want to attach to it.
   替换 `INSTANCE_NAME` 为实例的名称以及 `VOLUME_NAME` 要附加到实例的卷的名称。

   **Example 例**

   Attach the `volume1` volume to the `provider-instance` instance:
   将 `volume1` 卷附加到 `provider-instance` 实例：

   ```
   $ openstack server add volume provider-instance volume1
   ```

   

    

   Note 注意

   

   This command provides no output.
   此命令不提供任何输出。

2. List volumes: 列出卷：

   ```
   $ openstack volume list
   
   +--------------------------------------+--------------+--------+------+--------------------------------------------+
   | ID                                   | Display Name | Status | Size | Attached to                                |
   +--------------------------------------+--------------+--------+------+--------------------------------------------+
   | a1e8be72-a395-4a6f-8e07-856a57c39524 | volume1      | in-use |    1 | Attached to provider-instance on /dev/vdb  |
   +--------------------------------------+--------------+--------+------+--------------------------------------------+
   ```

3. Access your instance using SSH and use the `fdisk` command to verify presence of the volume as the `/dev/vdb` block storage device:
   使用 SSH 访问您的实例，并使用以下 `fdisk` 命令验证卷是否作为 `/dev/vdb` 块存储设备：

   ```
    $ sudo fdisk -l
   
    Disk /dev/vda: 1073 MB, 1073741824 bytes
    255 heads, 63 sectors/track, 130 cylinders, total 2097152 sectors
    Units = sectors of 1 * 512 = 512 bytes
    Sector size (logical/physical): 512 bytes / 512 bytes
    I/O size (minimum/optimal): 512 bytes / 512 bytes
    Disk identifier: 0x00000000
   
       Device Boot      Start         End      Blocks   Id  System
   /dev/vda1   *       16065     2088449     1036192+  83  Linux
   
    Disk /dev/vdb: 1073 MB, 1073741824 bytes
    16 heads, 63 sectors/track, 2080 cylinders, total 2097152 sectors
    Units = sectors of 1 * 512 = 512 bytes
    Sector size (logical/physical): 512 bytes / 512 bytes
    I/O size (minimum/optimal): 512 bytes / 512 bytes
    Disk identifier: 0x00000000
   
    Disk /dev/vdb doesn't contain a valid partition table
   ```

   

    

   Note 注意

   

   You must create a file system on the device and mount it to use the volume.
   您必须在设备上创建文件系统并挂载它才能使用卷。

For more information about how to manage volumes, see the [python-openstackclient documentation for Pike](https://docs.openstack.org/python-openstackclient/pike/cli/command-objects/volume.html), the [python-openstackclient documentation for Queens](https://docs.openstack.org/python-openstackclient/queens/cli/command-objects/volume.html), or the [python-openstackclient documentation for Rocky](https://docs.openstack.org/python-openstackclient/rocky/cli/command-objects/volume.html).
有关如何管理卷的更多信息，请参阅 Pike 的 python-openstackclient 文档、Queens 的 python-openstackclient 文档或 Rocky 的 python-openstackclient 文档。

Return to [Launch an instance](https://docs.openstack.org/install-guide/launch-instance.html#launch-instance).
返回到启动实例。