# 变量

[TOC]

## 概述

变量是存储在内存中的数据，创建一个变量即会在内存上开辟一个空间。

解释器会根据变量的类型来决定其在内存中的存储空间，因此可以为变量分配不同的数据类型，如整型、浮点型、字符串等。

- 标量 $ 开始， 如 $a $b 是两个标量。
- 数组 @ 开始 ， 如 @a @b 是两个数组。
- 哈希 % 开始 ，如 %a  %b 是两个哈希。

Perl 为每个变量类型设置了独立的命令空间，所以不同类型的变量可以使用相同的名称，不用担心会发生冲突。例如 $foo 和 @foo 是两个不同的变量。

## 创建变量

变量不需要显式声明类型，在变量赋值后，解释器会自动分配匹配的类型空间。

变量使用等号 (=) 来赋值。

> 可以在程序中使用 `use strict` 语句让所有变量需要强制声明类型。

等号左边为变量，右边为值，实例如下：

```perl
$age = 25;             # 整型
$name = "runoob";      # 字符串
$salary = 1445.50;     # 浮点数
```

以上代码中 25, "runoob" 和  1445.50 分别赋值给 *$age*, *$name* 和 *$salary* 变量。

## 标量变量

标量是一个单一的数据单元。 数据可以是整数，浮点数，字符，字符串，段落等。简单的说它可以是任何东西。以下是标量的简单应用：

```perl
#!/usr/bin/perl

$age = 25;             # 整型
$name = "runoob";      # 字符串
$salary = 1445.50;     # 浮点数

print "Age = $age\n";
print "Name = $name\n";
print "Salary = $salary\n";
```

以上程序执行输出结果为：

```bash
Age = 25
Name = runoob
Salary = 1445.5
```

## 数组变量

数组是用于存储一个有序的标量值的变量。

数组 @ 开始。

要访问数组的变量，可以使用美元符号($)+变量名，并指定下标来访问，实例如下所示：

```perl
#!/usr/bin/perl

@ages = (25, 30, 40);
@names = ("google", "runoob", "taobao");

print "\$ages[0] = $ages[0]\n";
print "\$ages[1] = $ages[1]\n";
print "\$ages[2] = $ages[2]\n";
print "\$names[0] = $names[0]\n";
print "\$names[1] = $names[1]\n";
print "\$names[2] = $names[2]\n";
```

以上程序执行输出结果为：

```bash
$ages[0] = 25
$ages[1] = 30
$ages[2] = 40
$names[0] = google
$names[1] = runoob
$names[2] = taobao
```

程序中在 $ 标记前使用了转义字符 (`\`) ，这样才能输出字符 $ 。

## 哈希变量

哈希是一个 **key/value** 对的集合。

哈希 % 开始。

如果要访问哈希值，可以使用 **$ + {key}** 格式来访问：

```perl
#!/usr/bin/perl

%data = ('google', 45, 'runoob', 30, 'taobao', 40);

print "\$data{'google'} = $data{'google'}\n";
print "\$data{'runoob'} = $data{'runoob'}\n";
print "\$data{'taobao'} = $data{'taobao'}\n";
```

以上程序执行输出结果为：

```bash
$data{'google'} = 45
$data{'runoob'} = 30
$data{'taobao'} = 40
```

## 变量上下文

所谓上下文：指的是表达式所在的位置。

上下文是由等号左边的变量类型决定的，等号左边是标量，则是标量上下文，等号左边是列表，则是列表上下文。

Perl 解释器会根据上下文来决定变量的类型。实例如下：

```perl
#!/usr/bin/perl

@names = ('google', 'runoob', 'taobao');

@copy = @names;   # 复制数组
$size = @names;   # 数组赋值给标量，返回数组元素个数

print "名字为 : @copy\n";
print "名字数为 : $size\n";
```

以上程序执行输出结果为：

```bash
名字为 : google runoob taobao
名字数为 : 3
```

代码中 @names 是一个数组，它应用在了两个不同的上下文中。第一个将其复制给另外一个数组，所以它输出了数组的所有元素。第二个将数组赋值给一个标量，它返回了数组的元素个数。

以下列出了多种不同的上下文：

| 上下文 | 描述                                                         |
| ------ | ------------------------------------------------------------ |
| 标量   | 赋值给一个标量变量，在标量上下文的右侧计算                   |
| 列表   | 赋值给一个数组或哈希，在列表上下文的右侧计算。               |
| 布尔   | 布尔上下文是一个简单的表达式计算，查看是否为 true 或 false。 |
| Void   | 这种上下文不需要关系返回什么值，一般不需要返回值。           |
| 插值   | 这种上下文只发生在引号内。                                   |

# 特殊变量

Perl 语言中定义了一些特殊的变量，通常以 $, @, 或 % 作为前缀，例如：$_。

很多特殊的变量有一个很长的英文名，操作系统变量 $! 可以写为 $OS_ERROR。

如果你想使用英文名的特殊变量需要在程序头部添加 **use English;**。这样就可以使用具有描述性的英文特殊变量。

最常用的特殊变量为 $_，该变量包含了默认输入和模式匹配内容。实例如下：

## 实例

\#!/usr/bin/perl  foreach ('Google','Runoob','Taobao') {    print $_;    print "\n"; }

执行以上程序，输出结果为：

```
Google
Runoob
Taobao
```

以下实例我们不使用  $_ 来输出内容：

## 实例

\#!/usr/bin/perl  foreach ('Google','Runoob','Taobao') {    print;    print "\n"; }

执行以上程序，输出结果为：

```
Google
Runoob
Taobao
```

实例中，首先输出 "Google" ，接着输出 "Runoob" ，最后输出 "Taobao" 。

在迭代循环中，当前循环的字符串会放在 $_ 中, 然后 通过 print 输出。另外 print 在不指定输出变量，默认情况下使用的也是 $_。 

以下是几处即使没有写明 Perl 也会假定使用 $_ 的地方：

- 各种单目函数，包括像 ord() 和 int() 这样的函数以及除 "-t"以外所有的文件 测试操作 ("-f"，"-d")，"-t" 默认操作 STDIN。
- 各种列表函数，例如 print() 和 unlink()。
- 没有使用 "=~" 运算符时的模式匹配操作 "m//"、"s///" 和"tr///"。
- 在没有给出其他变量时是 "foreach" 循环的默认迭代变量。
- grep() 和 map() 函数的隐含迭代变量。
- 当 "while" 仅有唯一条件，且该条件是对 ""操作的结果进行测试时，$_ 就是存放输入记录的默认位置。除了"while" 测试条件之外不会发生这种情况。(助记：下划线在特定操作中是可以省略的。)

------

## 特殊变量类型

根据特殊的变量的使用性质，可以分为以下几类：

- 全局标量特殊变量。
- 全局数组特殊变量。
- 全局哈希特殊变量。
- 全局特殊文件句柄。
- 全局特殊常量。
- 正则表达式特殊变量。
- 文件句柄特殊变量。

### 全局标量特殊变量

以下列出了所有的标量特殊变量，包含了特殊字符与英文形式的变量：

| $_                            | 默认输入和模式匹配内容。                                     |
| ----------------------------- | ------------------------------------------------------------ |
| $ARG                          |                                                              |
| $.                            | 前一次读的文件句柄的当前行号                                 |
| $NR                           |                                                              |
| $/                            | 输入记录分隔符,默认是新行字符。如用undef这个变量,将读到文件结尾。 |
| $RS                           |                                                              |
| $,                            | 输出域分隔符                                                 |
| $OFS                          |                                                              |
| $\                            | 输出记录分隔符                                               |
| $ORS                          |                                                              |
| $"                            | 该变量同 $,类似，但应用于向双引号引起的字符串(或类似的内插字符串)中内插数组和切片值的场合。默认为一个空格。 |
| $LIST_SEPARATOR               |                                                              |
| $;                            | 在仿真多维数组时使用的分隔符。默认为 "\034"。                |
| $SUBSCRIPT_SEPARATOR          |                                                              |
| $^L                           | 发送到输出通道的走纸换页符。默认为 "\f".                     |
| $FORMAT_FORMFEED              |                                                              |
| $:                            | The current set of characters after which a string may be broken to fill continuation fields (starting with ^) in a format. Default is "\n"". |
| $FORMAT_LINE_BREAK_CHARACTERS |                                                              |
| $^A                           | 打印前用于保存格式化数据的变量                               |
| $ACCUMULATOR                  |                                                              |
| $#                            | 打印数字时默认的数字输出格式（已废弃）。                     |
| $OFMT                         |                                                              |
| $?                            | 返回上一个外部命令的状态                                     |
| $CHILD_ERROR                  |                                                              |
| $!                            | 这个变量的数字值是errno的值,字符串值是对应的系统错误字符串   |
| $OS_ERROR or $ERRNO           |                                                              |
| $@                            | 命令eval的错误消息.如果为空,则表示上一次eval命令执行成功     |
| $EVAL_ERROR                   |                                                              |
| $$                            | 运行当前Perl脚本程序的进程号                                 |
| $PROCESS_ID or $PID           |                                                              |
| $<                            | 当前进程的实际用户号                                         |
| $REAL_USER_ID or $UID         |                                                              |
| $>                            | 当前进程的有效用户号                                         |
| $EFFECTIVE_USER_ID or $EUID   |                                                              |
| $(                            | 当前进程的实际组用户号                                       |
| $REAL_GROUP_ID or $GID        |                                                              |
| $)                            | 当前进程的有效组用户号                                       |
| $EFFECTIVE_GROUP_ID or $EGID  |                                                              |
| $0                            | 包含正在执行的脚本的文件名                                   |
| $PROGRAM_NAME                 |                                                              |
| $[                            | 数组的数组第一个元素的下标,默认是 0。                        |
|                               |                                                              |
| $]                            | Perl的版本号                                                 |
| $PERL_VERSION                 |                                                              |
| $^D                           | 调试标志的值                                                 |
| $DEBUGGING                    |                                                              |
| $^E                           | 在非UNIX环境中的操作系统扩展错误信息                         |
| $EXTENDED_OS_ERROR            |                                                              |
| $^F                           | 最大的文件捆述符数值                                         |
| $SYSTEM_FD_MAX                |                                                              |
| $^H                           | 由编译器激活的语法检查状态                                   |
|                               |                                                              |
| $^I                           | 内置控制编辑器的值                                           |
| $INPLACE_EDIT                 |                                                              |
| $^M                           | 备用内存池的大小                                             |
|                               |                                                              |
| $^O                           | 操作系统名                                                   |
| $OSNAME                       |                                                              |
| $^P                           | 指定当前调试值的内部变量                                     |
| $PERLDB                       |                                                              |
| $^T                           | 从新世纪开始算起,脚步本以秒计算的开始运行的时间              |
| $BASETIME                     |                                                              |
| $^W                           | 警告开关的当前值                                             |
| $WARNING                      |                                                              |
| $^X                           | Perl二进制可执行代码的名字                                   |
| $EXECUTABLE_NAME              |                                                              |
| $ARGV                         | 从默认的文件句柄中读取时的当前文件名                         |
|                               |                                                              |

### 全局数组特殊变量

| @ARGV | 传给脚本的命令行参数列表       |
| ----- | ------------------------------ |
| @INC  | 在导入模块时需要搜索的目录列表 |
| @F    | 命令行的数组输入               |

### 全局哈希特殊变量

| %INC | 散列表%INC包含所有用do或require语句包含的文件.关键字是文件名,值是这个文件的路径 |
| ---- | ------------------------------------------------------------ |
| %ENV | 包含当前环境变量                                             |
| %SIG | 信号列表及其处理方式                                         |

### 全局特殊文件句柄

| ARGV       | 遍历数组变量@ARGV中的所有文件名的特殊文件句柄                |
| ---------- | ------------------------------------------------------------ |
| STDERR     | 标准错误输出句柄                                             |
| STDIN      | 标准输入句柄                                                 |
| STDOUT     | 标准输出句柄                                                 |
| DATA       | 特殊文件句柄引用了在文件中 __END__ 标志后的任何内容包含脚本内容。或者引用一个包含文件中__DATA__ 标志后的所有内容，只要你在同一个包有读取数据，__DATA__ 就存在。 |
| _ (下划线) | 特殊的文件句柄用于缓存文件信息(fstat、stat和lstat)。         |

### 全局特殊常量

| __END__     | 脚本的逻辑结束，忽略后面的文本。 |
| ----------- | -------------------------------- |
| __FILE__    | 当前文件名                       |
| __LINE__    | 当前行号                         |
| __PACKAGE__ | 当前包名，默认的包名是main。     |

### 正则表达式特殊变量

| $n                | 包含上次模式匹配的第n个子串                                  |
| ----------------- | ------------------------------------------------------------ |
| $&                | 前一次成功模式匹配的字符串                                   |
| $MATCH            |                                                              |
| $`                | 前次匹配成功的子串之前的内容                                 |
| $PREMATCH         |                                                              |
| $'                | 前次匹配成功的子串之后的内容                                 |
| $POSTMATCH        |                                                              |
| $+                | 与上个正则表达式搜索格式匹配的最后一个括号。例如： `/Version: (.*)|Revision: (.*)/ && ($rev = $+);` |
| $LAST_PAREN_MATCH |                                                              |

### 文件句柄特殊变量

| $\|                    | 如果设置为零,在每次调用函数write或print后，自动调用函数fflush,将所写内容写回文件 |
| ---------------------- | ------------------------------------------------------------ |
| $OUTPUT_AUTOFLUSH      |                                                              |
| $%                     | 当前输出页号                                                 |
| $FORMAT_PAGE_NUMBER    |                                                              |
| $=                     | 当前每页长度。默认为 60。                                    |
| $FORMAT_LINES_PER_PAGE |                                                              |
| $-                     | 当前页剩余的行数                                             |
| $FORMAT_LINES_LEFT     |                                                              |
| $~                     | 当前报表输出格式的名称。默认值是文件句柄名。                 |
| $FORMAT_NAME           |                                                              |
| $^                     | 当前报表输出表头格式的名称。默认值是带后缀"_TOP"的文件句柄名。 |
| $FORMAT_TOP_NAME       |                                                              |

 [Perl 错误处理](https://www.runoob.com/perl/perl-error-handling.html) 

[Perl 正则表达式](https://www.runoob.com/perl/perl-regular-expressions.html) 

<iframe id="aswift_2" name="aswift_2" style="left: 0px; top: 0px; border: 0px; width: 847px; height: 0px; min-height: auto; max-height: none; min-width: auto; max-width: none;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="847" height="0" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-5751451760833794&amp;output=html&amp;h=280&amp;slotname=1691338467&amp;adk=2377280972&amp;adf=342612028&amp;pi=t.ma~as.1691338467&amp;w=847&amp;abgtt=6&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1753770429&amp;rafmt=1&amp;format=847x280&amp;url=https%3A%2F%2Fwww.runoob.com%2Fperl%2Fperl-special-variables.html&amp;fwr=0&amp;fwrattr=true&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;dt=1753770402759&amp;bpp=1&amp;bdt=407&amp;idt=336&amp;shv=r20250724&amp;mjsv=m202507220101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D3aa81bb6bde61f08%3AT%3D1752463956%3ART%3D1753770403%3AS%3DALNI_MZvE77nlQaP0TQJGMUXXc7r1coxNQ&amp;gpic=UID%3D0000116049a303d5%3AT%3D1752463956%3ART%3D1753770403%3AS%3DALNI_MblZa2LgM8NtZx64UEoV9WWJCa-vg&amp;eo_id_str=ID%3D744f0a35a6bbe975%3AT%3D1752463956%3ART%3D1753770403%3AS%3DAA-AfjbZI2kdxrLKEhZ78-5aruWN&amp;prev_fmts=0x0%2C728x90%2C160x600&amp;nras=1&amp;correlator=4967719205410&amp;frm=20&amp;pv=1&amp;u_tz=480&amp;u_his=18&amp;u_h=1080&amp;u_w=1920&amp;u_ah=1032&amp;u_aw=1920&amp;u_cd=24&amp;u_sd=1&amp;adx=549&amp;ady=6651&amp;biw=1920&amp;bih=947&amp;scr_x=0&amp;scr_y=2863&amp;eid=95362655%2C95364961%2C95366913%2C95344791%2C95359266%2C95367166&amp;oid=2&amp;pvsid=2570790658291597&amp;tmod=475486581&amp;uas=3&amp;nvt=1&amp;ref=https%3A%2F%2Fwww.runoob.com%2Fperl%2Fperl-error-handling.html&amp;fc=1920&amp;brdim=-1928%2C-8%2C-1928%2C-8%2C1920%2C0%2C1936%2C1048%2C1920%2C947&amp;vis=1&amp;rsz=%7C%7CoEebr%7C&amp;abl=CS&amp;pfx=0&amp;fu=128&amp;bc=31&amp;bz=1.01&amp;ifi=3&amp;uci=a!3&amp;btvi=1&amp;fsb=1&amp;dtd=26881" data-google-container-id="a!3" tabindex="0" title="Advertisement" aria-label="Advertisement" data-google-query-id="CJWLhvy34Y4DFTJjDwIdgi8y4A" data-load-complete="true"></iframe>

##      	    	    	        1  篇笔记   写笔记    

1. 

     rnistake

    147***9022@qq.com

    [ 参考地址](http://blog.sina.com.cn/s/blog_14cce7aed0102vq8l.html)

    13

   ### Perl 读取 .ini 风格配置文件之 Config::IniFiles

   如果一个 Perl 脚本中有太多参数需要配置，使用命令行参数的方式就不太合适了。我们可以使用配置文件的方式来配置这些参数，刚好 Config::IniFiles 模块给我们提供了解析 **.ini** 风格配置文件的方法。重要的是其他语言，如 Python，也有 **.ini** 风格配置文件解析的包，所以用该方法，便于程序的通用性。

   **Config::IniFiles**

   先看一看 .ini 风格配置文件格式：

   ```
   [section]          #参数模块
   Parameter=Value    #该模块某参数的值。配置文件使用'#'或者';'注释
   ```

   使用方法：

   ```
   use Config::IniFiles; #加载模块
   my $cfg = new Config::IniFiles( -file => "/path/configfile.ini" ); #读取配置文件
   my $value = $cfg->val('Section', 'Parameter'); #读取参数
   ```

   一个更加方便的读取方式：

   ```
   my %ini
   tie %ini, 'Config::IniFiles', ( -file => "/path/configfile.ini" );
   #该方法把参数读进了二维哈希（引用的引用），即$ini{Section}{Parameter}
   ```

   详细用法请参考： http://search.cpan.org/~wadg/Config-IniFiles-2.38/IniFiles.pm

   [rnistake](https://www.runoob.com/note/46610)

     rnistake

    147***9022@qq.com

    [ 参考地址](http://blog.sina.com.cn/s/blog_14cce7aed0102vq8l.html)

   6年前 (2019-09-10)