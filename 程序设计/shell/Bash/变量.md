# 变量

[TOC]

在Bash中，每个变量的值都是字符串。

## 定义变量

```bash
var_name="xxx"
# 显式地直接赋值
# 变量名和等号之间不能有空格。
# var_name = "xxx"	是相等操作。

# 用语句赋值
for file in `ls /etc`
for file in $(ls /etc)

# 只读变量
# 使用 readonly 命令可以将变量定义为只读变量，只读变量的值不能被改变。
readonly var_name
```

**变量名命名规则：** 

-  命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。
-  中间不能有空格，可以使用下划线（_）。
-  不能使用标点符号。
-  不能使用bash里的关键字。

## 使用变量

```bash
var_name="xxxx"
echo $var_name
echo ${var_name}
```

 变量名外面的花括号是可选的，加花括号是为了帮助解释器识别变量的边界，比如下面这种情况： 

```bash
for skill in Ada Coffe Action Java;
do
    echo "I am good at ${skill}Script"
done 
```

**删除变量**

```bash
unset var_name
```

变量被删除后不能再次使用。unset 命令不能删除只读变量。

**变量类型**

-  **局部变量**  局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量。
-  **环境变量**  所有的程序，包括shell启动的程序，都能访问环境变量，有些程序需要环境变量来保证其正常运行。必要的时候shell脚本也可以定义环境变量。
-  **shell变量**  shell变量是由shell程序设置的特殊变量。shell变量中有一部分是环境变量，有一部分是局部变量，这些变量保证了shell的正常运行

## 环境变量

在终端中查看所有与此终端进程相关的环境变量：

```bash
env
```

对于每个进程，查看在其运行时的环境变量：

```bash
cat /proc/$PID/environ
cat /proc/$PID/environ | tr '\0' '\n'	#格式化
```

设置环境变量：

```bash
export var_name
```

### PATH

通常定义在 /etc/environment 或 /etc/profile 或 ~/.bashrc 中。

添加一个新路径：

```bash
export PATH="$PATH:/home/user/bin"

PATH="$PATH:/home/user/bin"
export PATH
```

## 补充内容

1. 获取字符串长度

   ```bash
   length=${#var}
   
   var=12345678901234567890
   echo ${#var}
   ```

2. 识别当前的shell版本

   ```bash
   echo $SHELL
   echo $0
   ```

3. 检查是否为超级用户

   ```bash
   if [ $UID -ne 0 ]; then
   echo Non root user.Please run as root.
   else
   echo "Root user"
   fi
   ```

4. 修改Bash提示字符串（username@hostname:~$）

   ```bash
   # 查看PS1设置
   cat ~/.bashrc | grep PS1
   
   # 设置提示符
   PS1="PROMPT>"
   PROMPT>
   
   设置彩色提示符 
   \e[1;31
   
   \u	用户名
   \h	主机名
   \w	当前工作目录
   ```

   

