# C

[TOC]

## 概述

C 语言是一种通用的、面向过程式的计算机程序设计语言。为了移植与开发 UNIX 操作系统，丹尼斯·里奇在贝尔实验室设计开发了 C 语言。最开始于 1972 年在 DEC PDP-11 计算机上被首次实现。

截至 1973 年，UNIX 操作系统完全使用 C 语言编写。

C 语言是以 B 语言为基础的，B 语言大概是在 1970 年被引进的。

在 1978 年，布莱恩·柯林汉（Brian Kernighan）和丹尼斯·里奇（Dennis Ritchie）制作了 C 的第一个公开可用的描述，现在被称为 K&R 标准。、

C 语言标准是于 1988 年由美国国家标准协会（ANSI，全称 American National Standard Institute）制定的。当前最新的 C 语言标准为 C18 ，在它之前的 C 语言标准有 C17、C11...C99 等。

CPL --> BCPL --> B --> C

UNIX 操作系统，C编译器，和几乎所有的 UNIX 应用程序都是用 C 语言编写的。由于各种原因，C 语言现在已经成为一种广泛使用的专业语言。

- 易于学习。
- 结构化语言。
- 它产生高效率的程序。
- 它可以处理底层的活动。
- 它可以在多种计算机平台上编译。

## 为什么要使用 C？

C 语言最初是用于系统开发工作，特别是组成操作系统的程序。由于 C 语言所产生的代码运行速度与汇编语言编写的代码运行速度几乎一样，所以采用 C 语言作为系统开发语言。下面列举几个使用 C 的实例：

- 操作系统
- 语言编译器
- 汇编器
- 文本编辑器
- 打印机
- 网络驱动器
- 现代程序
- 数据库
- 语言解释器
- 实体工具

## 基本结构

C 程序主要包括以下部分：

- 预处理器指令
- 函数
- 变量
- 语句 & 表达式
- 注释

```c
#include <stdio.h>

int main()
{
    /* 我的第一个 C 程序 */ 
    printf("Hello, World! \n");
    return 0;
}
```

**实例解析：**

- 所有的 C 语言程序都需要包含 **main()** 函数。 代码从 **main()** 函数开始执行。
- **/\* ... \*/** 用于注释说明，会被编译器忽略。
- **printf()** 用于格式化输出到屏幕。**printf()** 函数在 **"stdio.h"** 头文件中声明。
- **stdio.h** 是一个头文件 (标准输入输出头文件) , **#include** 是一个预处理器指令，告诉 C 编译器在实际编译之前要包含头文件。当编译器遇到 **printf()** 函数时，如果没有找到 **stdio.h** 头文件，会发生编译错误。
- **return 0;** 语句用于表示退出程序，并返回值 0 。

## 编译 & 执行

1. 打开一个文本编辑器，添加上述代码。

2. 保存文件为 *hello.c* 。

3. 打开命令提示符，进入到保存文件所在的目录。

4. 键入 *gcc hello.c* ，输入回车，编译代码。

5. 如果代码中没有错误，命令提示符会跳到下一行，并生成 *a.out（Windows 生成 a.exe）* 可执行文件。

6. 现在，键入 *a.out* 来执行程序。

7. 您可以看到屏幕上显示 *"Hello World"*。

   ```bash
   $ gcc hello.c
   $ ./a.out
   Hello, World!
   ```

请确保路径中已包含 gcc 编译器，并确保在包含源文件 hello.c 的目录中运行它。

如果是多个 c 代码的源码文件，编译方法如下：

```bash
$ gcc test1.c test2.c -o main.out
$ ./main.out
```

test1.c 与 test2.c 是两个源代码文件。

## C11

C11（也被称为 C1X ）指 ISO 标准 ISO/IEC 9899:2011。在它之前的 C 语言标准为 C99 。

### 新特性

- 对齐处理（Alignment）的标准化（包括_Alignas标志符，alignof运算符，aligned_alloc函数以及<stdalign.h>头文件）。
- _Noreturn 函数标记，类似于 gcc 的 __attribute__((noreturn))。
- _Generic 关键字。
- 多线程（Multithreading）支持，包括：
   _Thread_local存储类型标识符，<threads.h>头文件，里面包含了线程的创建和管理函数。
   _Atomic类型修饰符和<stdatomic.h>头文件。
- 增强的Unicode的支持。基于C Unicode技术报告ISO/IEC TR  19769:2004，增强了对Unicode的支持。包括为UTF-16/UTF-32编码增加了char16_t和char32_t数据类型，提供了包含unicode字符串转换函数的头文件<uchar.h>。
- 删除了 gets() 函数，使用一个新的更安全的函数gets_s()替代。
- 增加了边界检查函数接口，定义了新的安全的函数，例如 fopen_s()，strcat_s() 等等。
- 增加了更多浮点处理宏(宏)。
- 匿名结构体/联合体支持。这个在gcc早已存在，C11将其引入标准。
- 静态断言（Static assertions），_Static_assert()，在解释 #if 和 #error 之后被处理。
- 新的 fopen() 模式，("…x")。类似 POSIX 中的 O_CREAT|O_EXCL，在文件锁中比较常用。
- 新增 quick_exit() 函数作为第三种终止程序的方式。当 exit()失败时可以做最少的清理工作。

## 分隔符

分隔符用于分隔语句和表达式，常见的分隔符包括：

- **逗号 ,**      用于分隔变量声明或函数参数。
- **分号 ;**      用于结束语句。
- 括号：
  - 圆括号 `()` 用于分组表达式、函数调用。
  - 花括号 `{}` 用于定义代码块。
  - 方括号 `[]` 用于数组下标。

在 C 程序中，分号 `;` 是语句结束符，也就是说，每个语句必须以分号结束，它表明一个逻辑实体的结束。

例如，下面是两个不同的语句：

```c
printf("Hello, World! \n");
return 0;
```

个单独的分号也可以作为一个空语句，表示什么都不做。例如：

```c
;
```

## 注释

C 语言有两种注释方式：

```c
// 单行注释
```

以 `//` 开始的单行注释，这种注释可以单独占一行。

```c
/* 单行注释 */
/* 
 多行注释
 多行注释
 多行注释
 */
```

` /* */ ` 这种格式的注释可以单行或多行。

不能在注释内嵌套注释，注释也不能出现在字符串或字符值中。

## 标识符

标识符是程序中变量、函数、数组等的名字。标识符由字母（大写 A-Z 或小写 a-z ）、数字（0-9）和下划线 `_` 组成，但第一个字符必须是字母或下划线，不能是数字。

C 标识符内不允许出现标点字符，比如 @、$ 和 % 。C 是**区分大小写**的编程语言。因此，在 C 中，*Manpower* 和 *manpower* 是两个不同的标识符。下面列出几个有效的标识符：

```c
mohd       zara    abc   move_name  a_123
myname50   _temp   j     a23b9      retVal
```

## 常量

常量是固定值，在程序执行期间不会改变。

常量可以是整型常量、浮点型常量、字符常量、枚举常量等。

```c
const int MAX = 100;  // 整型常量
const float PI = 3.14;  // 浮点型常量
const char NEWLINE = '\n';  // 字符常量
```

## 字符串字面量

字符串字面量是由双引号括起来的字符序列。

字符串末尾会自动添加一个空字符 `\0` 。

```c
char greeting[] = "Hello, World!";
```

## 运算符（Operators）

运算符用于执行各种操作，如算术运算、逻辑运算、比较运算等。

C 语言中的运算符种类繁多，常见的包括：

- **算术运算符**：`+`, `-`, `*`, `/`, `%`
- **关系运算符**：`==`, `!=`, `>`, `<`, `>=`, `<=`
- **逻辑运算符**：`&&`, `||`, `!`
- **位运算符**：`&`, `|`, `^`, `~`, `<<`, `>>`
- **赋值运算符**：`=`, `+=`, `-=`, `*=`, `/=`, `%=`
- **其他运算符**：`sizeof`, `?:`, `&`, `*`, `->`, `.`

```c
int a = 5, b = 10;
int sum = a + b;         // 使用算术运算符 +
int isEqual = (a == b);  // 使用关系运算符 ==
```

## 关键字

下表列出了 C 中的保留字。这些保留字不能作为常量名、变量名或其他标识符名称。

| 关键字   | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| auto     | 声明自动变量                                                 |
| break    | 跳出当前循环                                                 |
| case     | 开关语句分支                                                 |
| char     | 声明字符型变量或函数返回值类型                               |
| const    | 定义常量，如果一个变量被 const 修饰，那么它的值就不能再被改变 |
| continue | 结束当前循环，开始下一轮循环                                 |
| default  | 开关语句中的"其它"分支                                       |
| do       | 循环语句的循环体                                             |
| double   | 声明双精度浮点型变量或函数返回值类型                         |
| else     | 条件语句否定分支（与 if 连用）                               |
| enum     | 声明枚举类型                                                 |
| extern   | 声明变量或函数是在其它文件或本文件的其他位置定义             |
| float    | 声明浮点型变量或函数返回值类型                               |
| for      | 一种循环语句                                                 |
| goto     | 无条件跳转语句                                               |
| if       | 条件语句                                                     |
| int      | 声明整型变量或函数                                           |
| long     | 声明长整型变量或函数返回值类型                               |
| register | 声明寄存器变量                                               |
| return   | 子程序返回语句（可以带参数，也可不带参数）                   |
| short    | 声明短整型变量或函数                                         |
| signed   | 声明有符号类型变量或函数                                     |
| sizeof   | 计算数据类型或变量长度（即所占字节数）                       |
| static   | 声明静态变量                                                 |
| struct   | 声明结构体类型                                               |
| switch   | 用于开关语句                                                 |
| typedef  | 用以给数据类型取别名                                         |
| unsigned | 声明无符号类型变量或函数                                     |
| union    | 声明共用体类型                                               |
| void     | 声明函数无返回值或无参数，声明无类型指针                     |
| volatile | 说明变量在程序执行中可被隐含地改变                           |
| while    | 循环语句的循环条件                                           |



| 1        | 2              | 3         | 4             |
| -------- | -------------- | --------- | ------------- |
| auto     | else           | long      | switch        |
| break    | enum           | register  | typedef       |
| case     | extern         | return    | union         |
| char     | float          | short     | unsigned      |
| const    | for            | signed    | void          |
| continue | goto           | sizeof    | volatile      |
| default  | if             | static    | while         |
| do       | inline         | struct    | _Packed       |
| double   | int            | restrict  | _Bool         |
| _Complex | _Imaginary     | _Alignas  | _Alignof      |
| _Atomic  | _Static_assert | _Noreturn | _Thread_local |
| _Generic |                |           |               |

### C99 新增关键字

| `_Bool` | `_Complex` | `_Imaginary` | `inline` | `restrict` |
| ------- | ---------- | ------------ | -------- | ---------- |
|         |            |              |          |            |

### C11 新增关键字

| `_Alignas`       | `_Alignof`      | `_Atomic` | `_Generic` | `_Noreturn` |
| ---------------- | --------------- | --------- | ---------- | ----------- |
| `_Static_assert` | `_Thread_local` |           |            |             |

## 空格

只包含空格的行，被称为空白行，可能带有注释，C 编译器会完全忽略它。

在 C 中，空格用于描述空白符、制表符、换行符和注释。空格分隔语句的各个部分，让编译器能识别语句中的某个元素（比如 int）在哪里结束，下一个元素在哪里开始。因此，在下面的语句中：

```c
int age;
```

在这里，int 和 age 之间必须至少有一个空格字符（通常是一个空白符），这样编译器才能够区分它们。另一方面，在下面的语句中：

```c
fruit = apples + oranges;   // 获取水果的总数
```

`fruit` 和 `=`，或者 `=` 和 `apples` 之间的空格字符不是必需的，但是为了增强可读性，可以根据需要适当增加一些空格。

## 数据类型

在 C 语言中，数据类型指的是用于声明不同类型的变量或函数的一个广泛的系统。变量的类型决定了变量存储占用的空间，以及如何解释存储的位模式。

C 中的类型可分为以下几种：

| 类型         | 描述                                                         |
| ------------ | ------------------------------------------------------------ |
| 基本数据类型 | 它们是算术类型，包括整型（int）、字符型（char）、浮点型（float）和双精度浮点型（double）。 |
| 枚举类型     | 它们也是算术类型，被用来定义在程序中只能赋予其一定的离散整数值的变量。 |
| void 类型    | 类型说明符 *void* 表示没有值的数据类型，通常用于函数返回值。 |
| 派生类型     | 包括数组类型、指针类型和结构体类型。                         |

数组类型和结构类型统称为聚合类型。函数的类型指的是函数返回值的类型。

### 整数类型

下表列出了关于标准整数类型的存储大小和值范围的细节：

| 类型           | 存储大小    | 值范围                                               |
| -------------- | ----------- | ---------------------------------------------------- |
| char           | 1 字节      | -128 到 127 或 0 到 255                              |
| unsigned char  | 1 字节      | 0 到 255                                             |
| signed char    | 1 字节      | -128 到 127                                          |
| int            | 2 或 4 字节 | -32,768 到 32,767 或 -2,147,483,648 到 2,147,483,647 |
| unsigned int   | 2 或 4 字节 | 0 到 65,535 或 0 到 4,294,967,295                    |
| short          | 2 字节      | -32,768 到 32,767                                    |
| unsigned short | 2 字节      | 0 到 65,535                                          |
| long           | 4 字节      | -2,147,483,648 到 2,147,483,647                      |
| unsigned long  | 4 字节      | 0 到 4,294,967,295                                   |

> 注意，各种类型的存储大小与系统位数有关，但目前通用的以64位系统为主。
>
> 以下列出了32位系统与64位系统的存储大小的差别（windows 相同）：
>
> ![img](https://www.runoob.com/wp-content/uploads/2014/09/32-64.jpg)

为了得到某个类型或某个变量在特定平台上的准确大小，您可以使用 **sizeof** 运算符。表达式 *sizeof(type)* 得到对象或类型的存储字节大小。下面的实例演示了获取 int 类型的大小：

## 实例

\#include <stdio.h> #include <limits.h>  int main() {   printf("int 存储大小 : %lu \n", sizeof(int));      return 0; }

**%lu** 为 32 位无符号整数，详细说明查看 [C 库函数 - printf()](https://www.runoob.com/cprogramming/c-function-printf.html)。

当您在 Linux 上编译并执行上面的程序时，它会产生下列结果：

```
int 存储大小 : 4 
```

### 浮点类型

下表列出了关于标准浮点类型的存储大小、值范围和精度的细节：

| 类型        | 存储大小 | 值范围                 | 精度        |
| ----------- | -------- | ---------------------- | ----------- |
| float       | 4 字节   | 1.2E-38 到 3.4E+38     | 6 位有效位  |
| double      | 8 字节   | 2.3E-308 到 1.7E+308   | 15 位有效位 |
| long double | 16 字节  | 3.4E-4932 到 1.1E+4932 | 19 位有效位 |

头文件 float.h 定义了宏，在程序中可以使用这些值和其他有关实数二进制表示的细节。下面的实例将输出浮点类型占用的存储空间以及它的范围值：

## 实例

\#include <stdio.h> #include <float.h>  int main() {   printf("float 存储最大字节数 : %lu \n", sizeof(float));   printf("float 最小值: %E\n", FLT_MIN );   printf("float 最大值: %E\n", FLT_MAX );   printf("精度值: %d\n", FLT_DIG );      return 0; }

**%E** 为以指数形式输出单、双精度实数，详细说明查看 [C 库函数 - printf()](https://www.runoob.com/cprogramming/c-function-printf.html)。

当您在 Linux 上编译并执行上面的程序时，它会产生下列结果：

```
float 存储最大字节数 : 4 
float 最小值: 1.175494E-38
float 最大值: 3.402823E+38
精度值: 6
```

### void 类型

void 类型指定没有可用的值。它通常用于以下三种情况下：

| 序号 | 类型与描述                                                   |
| ---- | ------------------------------------------------------------ |
| 1    | **函数返回为空** C 中有各种函数都不返回值，或者您可以说它们返回空。不返回值的函数的返回类型为空。例如 **void exit (int status);** |
| 2    | **函数参数为空** C 中有各种函数不接受任何参数。不带参数的函数可以接受一个 void。例如 **int rand(void);** |
| 3    | **指针指向 void** 类型为 void * 的指针代表对象的地址，而不是类型。例如，内存分配函数 **void \*malloc( size_t size );** 返回指向 void 的指针，可以转换为任何数据类型。 |

如果现在您还是无法完全理解 void 类型，不用太担心，在后续的章节中我们将会详细讲解这些概念。

### 类型转换

类型转换是将一个数据类型的值转换为另一种数据类型的值。

C 语言中有两种类型转换：

- **隐式类型转换：**隐式类型转换是在表达式中自动发生的，无需进行任何明确的指令或函数调用。它通常是将一种较小的类型自动转换为较大的类型，例如，将int类型转换为long类型或float类型转换为double类型。隐式类型转换也可能会导致数据精度丢失或数据截断。
- **显式类型转换：**显式类型转换需要使用强制类型转换运算符（type casting operator），它可以将一个数据类型的值强制转换为另一种数据类型的值。强制类型转换可以使程序员在必要时对数据类型进行更精确的控制，但也可能会导致数据丢失或截断。

隐式类型转换实例：

## 实例

int i = 10;
 float f = 3.14;
 double d = i + f; *// 隐式将int类型转换为double类型*

显式类型转换实例：

## 实例

double d = 3.14159;
 int i = (int)d; *// 显式将double类型转换为int类型*

​			
