# Creating flow 创建流

[TOC]

## 概述

介绍 Node-RED 编辑器，并创建一个流程来演示 Inject、Increte 和 Function 节点。

### 1.访问编辑器

在 Node-RED [运行时](https://nodered.org/docs/getting-started)，在 Web 浏览器中打开编辑器。

如果在运行 Node-RED 的同一台计算机上使用浏览器，则可以使用 URL 访问它：[http://localhost:1880](http://localhost:1880)。

如果在另一台计算机上使用浏览器，则需要使用运行 Node-RED 的计算机的 IP 地址：`http://ip-address:1880` 。

### 2.添加 Inject 节点

The Inject node allows you to inject messages into a flow, either by clicking the button on the node, or setting a time interval between injects.
Inject 节点允许通过单击节点上的按钮或设置注入之间的时间间隔将消息注入流。

Drag one onto the [workspace](https://nodered.org/docs/user-guide/editor/workspace/) from the [palette](https://nodered.org/docs/user-guide/editor/palette/).
将其中一个从 [调色板](https://nodered.org/docs/user-guide/editor/palette/)。

Select the newly added Inject node to see information about its properties and a description of what it does in the [Information sidebar pane](https://nodered.org/docs/user-guide/editor/sidebar/info).
选择新添加的 Inject 节点，以查看有关其属性的信息以及在“[信息”侧边栏窗格](https://nodered.org/docs/user-guide/editor/sidebar/info)中对其功能的描述。

### 3.添加 Debug 节点

The Debug node causes any message to be displayed in the [Debug sidebar](https://nodered.org/docs/user-guide/editor/sidebar/debug). 
该节点使任何消息都显示在 [侧边栏](https://nodered.org/docs/user-guide/editor/sidebar/debug)。默认情况下，它只显示消息的有效负载，但也可以显示整个消息对象。

### 4.把这两个连接起来

Connect the Inject and Debug nodes together by [dragging between](https://nodered.org/docs/user-guide/editor/workspace/wires) the output port of one to the input port of the other.
通过在“Inject”和“Debug”节点[之间拖动，将](https://nodered.org/docs/user-guide/editor/workspace/wires)它们连接在一起 一个的输出端口到另一个的输入端口。

### 5.部署

此时，节点只存在于编辑器中，必须部署到服务器。

单击 Deploy 按钮。

### 6. Inject 注入

With the Debug sidebar tab selected, click the Inject button (the small square button next to your inject node). You should see numbers appear in the sidebar. By default, the Inject node uses the number of milliseconds since January 1st, 1970 as its payload.
在选择了Inject侧边栏选项卡的情况下，单击Inject按钮（inject节点旁边的小方形按钮）。您应该会看到数字出现在侧边栏中。默认情况下，Inject节点使用自1970年1月1日以来的毫秒数作为其有效负载。

### 7.添加函数节点

函数节点允许通过 JavaScript 函数传递每条消息。

删除现有焊线（选择它并按键盘上的 delete ）。

Wire a Function node in between the Inject and Debug nodes.
在Inject和Inject节点之间连接一个Function节点。

双击 Function 节点以打开编辑对话框。将以下代码复制到函数字段中：

```javascript
// Create a Date object from the payload
var date = new Date(msg.payload);
// Change the payload to be a formatted Date string
msg.payload = date.toString();
// Return the message so it can be sent on
return msg;
```

单击“完成”关闭编辑对话框，然后单击“部署”按钮。

现在当点击注入按钮时，侧边栏中的消息将被格式化为可读的时间戳。

### 总结

这个流程演示了创建流程的基本概念。它展示了如何使用 Inject 节点手动触发流，以及 Inject 节点如何在侧边栏中显示消息。它还展示了如何使用 Function 节点编写自定义的 JavaScript 来针对消息运行。

### 源

本教程中创建的流由以下 json 表示。要将其导入到编辑器中，请将其复制到剪贴板，然后粘贴到“导入”对话框中。

```json
[{"id":"58ffae9d.a7005","type":"debug","name":"","active":true,"complete":false,"x":640,"y":200,"wires":[]},{"id":"17626462.e89d9c","type":"inject","name":"","topic":"","payload":"","repeat":"","once":false,"x":240,"y":200,"wires":[["2921667d.d6de9a"]]},{"id":"2921667d.d6de9a","type":"function","name":"Format timestamp","func":"// Create a Date object from the payload\nvar date = new Date(msg.payload);\n// Change the payload to be a formatted Date string\nmsg.payload = date.toString();\n// Return the message so it can be sent on\nreturn msg;","outputs":1,"x":440,"y":200,"wires":[["58ffae9d.a7005"]]}]
```