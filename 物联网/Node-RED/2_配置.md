# 配置

[TOC]

## 配置文件

You can configure Node-RED using a settings file.
您可以使用设置文件配置Node-RED。

### Where is my settings file? 我的设置文件在哪里？

When Node-RED starts, it looks for a file called `settings.js` in your Node-RED user directory, `~/.node-red`. If it does not find one there, it will copy in a default settings file to that directory and use it.
当Node-RED启动时，它会在Node-RED用户目录`~/.node-red`中查找一个名为`settings.js的`文件。如果没有找到，它会将默认设置文件复制到该目录并使用它。

Alternatively, the `--settings` command-line argument can be used when starting Node-RED to point at a different file.
或者，在启动Node-RED时可以使用`--settings`命令行参数指向不同的文件。

If you have not yet run Node-RED and want to edit the settings file, you can copy the default settings file in manually from [here](https://github.com/node-red/node-red/blob/master/packages/node_modules/node-red/settings.js).
如果您尚未运行Node-RED并希望编辑设置文件，则可以从[此处](https://github.com/node-red/node-red/blob/master/packages/node_modules/node-red/settings.js)手动复制默认设置文件。

If you are not sure which settings file Node-RED is using, you should check the log output when Node-RED starts up. It will log the full path to the file:
如果您不确定Node-RED正在使用哪个设置文件，则应在Node-RED启动时检查日志输出。它将记录文件的完整路径：

```
22 Jun 12:34:56 - [info] Settings file  : /Users/nol/.node-red/settings.js
```

### Editing the settings file 编辑设置文件

The settings file is loaded into the runtime as a Node.js module that exports a JavaScript object of key/value pairs.
设置文件作为Node.js模块加载到运行时中，该模块导出键/值对的JavaScript对象。

The default settings file comes with many options commented out. For example, the option to format your flow file to make it easier to read:
默认设置文件中有许多选项已被注释掉。例如，格式化流文件以使其更易于阅读的选项：

```
//flowFilePretty: true,
```

To enable that option, remove the `//` at the start of the line.
要启用该选项，请删除行首`的//`。

If you add a new option to the file, be sure to add a comma to separate it from any options before or after it.
如果向文件中添加新选项，请确保添加逗号将其与之前或之后的任何选项分隔开。

If there is a syntax error in the file, Node-RED will not be able to start. The log output will indicate where the error is.
如果文件中存在语法错误，Node-RED将无法启动。日志输出将指示错误的位置。

The following properties can be used to configure Node-RED.
以下属性可用于配置Node-RED。

When running as a normal application, it loads its configuration from a settings file. For more information about the settings file and where it is, read [this guide](https://nodered.org/docs/user-guide/runtime/settings-file).
当作为普通应用程序运行时，它从设置文件加载其配置。有关设置文件及其所在位置的详细信息，请阅读[本指南](https://nodered.org/docs/user-guide/runtime/settings-file)。

When running as an [embedded application](https://nodered.org/docs/user-guide/runtime/embedding), the configuration options are passed in the call to `RED.init()`. However, when run in this mode, certain properties are ignored and are left to the embedding application to implement.
当作为[嵌入式应用程序](https://nodered.org/docs/user-guide/runtime/embedding)运行时，配置选项在对`RED.init（）`的调用中传递。但是，在此模式下运行时，某些属性将被忽略，并留给嵌入应用程序来实现。

## Runtime Configuration 运行时配置

- flowFile

  the file used to store the flows. Default: `flows_<hostname>.json` 用于存储流的文件。默认值：`flows_<hostname>.json`

- userDir

  the directory to store all user data, such as flow and credential files and all library data. Default: `$HOME/.node-red` 用于存储所有用户数据（如流和凭据文件以及所有库数据）的目录。默认值：`$HOME/.node-red`

- nodesDir

  a directory to search for additional installed nodes. Node-RED searches the `nodes` directory under the *userDir* directory. This property allows an additional directory to be searched, so that nodes can be installed outside of the Node-RED install structure. Default: `$HOME/.node-red/nodes` 用于搜索其他已安装节点的目录。Node-RED搜索`节点` *userDir*目录下的目录。此属性允许搜索其他目录，以便可以在Node-RED安装结构之外安装节点。默认值：`$HOME/.node-red/nodes`

- uiHost

  the interface to listen for connections on. Default: `0.0.0.0` - *all IPv4 interfaces*.      监听连接的接口。默认值：`0.0.0.0`- *所有IPv4接口*。*Standalone only*. *仅限单机*。  

- uiPort

  the port used to serve the editor UI. Default: `1880`.      用于提供编辑器UI的端口。默认值：`1880`年。*Standalone only*. *仅限单机*。  

- httpAdminRoot

  the root url for the editor UI. If set to `false`, all admin endpoints are disabled. This includes both API endpoints and the editor UI. To disable just the editor UI, see the `disableEditor` property below. Default: `/` 编辑器UI的根URL。如果设置为`false`，则禁用所有管理终结点。这包括API端点和编辑器UI。要仅禁用编辑器UI，请参阅下面的`disableEditor`属性。默认值：`/`

- httpAdminAuth

  *Deprecated*: see `adminAuth`.      *已弃用*：参见`adminAuth`。enables HTTP Basic Authentication on the editor UI: 在编辑器UI上启用HTTP基本身份验证：     `httpAdminAuth: {user:"nol", pass:"5f4dcc3b5aa765d61d8327deb882cf99"} `         The `pass` property is the md5 hash of the actual password. The following command can be used to generate the hash: `pass`属性是实际密码的md5哈希值。可以使用以下命令生成哈希：     `node -e "console.log(require('crypto').createHash('md5').update('YOUR PASSWORD HERE','utf8').digest('hex'))" `         *Standalone only*. *仅限单机*。  

- httpAdminMiddleware

  an HTTP middleware function, or array of functions, that is added to all admin routes. The format of the middleware function is documented [here](http://expressjs.com/guide/using-middleware.html#middleware.application).      HTTP中间件功能或功能阵列，添加到所有管理路由。 中间件函数的格式记录在[这里](http://expressjs.com/guide/using-middleware.html#middleware.application)。`httpAdminMiddleware: function(req,res,next) {    // Perform any processing on the request.    // Be sure to call next() if the request should be passed on } `      

- httpAdminCookieOptions

  when Admin Autentication is enabled, this can be used to customise the options used when setting the session cookie used as part of the OAuth authentication flow. The available options are documented [here](https://www.npmjs.com/package/cookie#options-1). 当Admin Autentication被启用时，这可以用来自定义设置作为OAuth身份验证流的一部分使用的会话cookie时使用的选项。可用选项记录在[此处](https://www.npmjs.com/package/cookie#options-1)。

- httpNodeRoot

  the root url for nodes that provide HTTP endpoints. If set to `false`, all node-based HTTP endpoints are disabled. Default: `/` 提供HTTP端点的节点的根URL。如果设置为`false`，则禁用所有基于节点的HTTP端点。默认值：`/`

- httpNodeAuth

  enables HTTP Basic Authentication. See `httpAdminAuth` for format. 启用HTTP基本身份验证。有关格式，请参阅`httpAdminAuth`。

- httpRoot

  this sets the root url for both admin and node endpoints. It overrides the values set by `httpAdminRoot` and `httpNodeRoot`. 这将为管理和节点端点设置根URL。它覆盖由`httpAdminRoot`和`httpNodeRoot`设置的值。

- https

  enables https, with the specified options object, as defined [here](http://nodejs.org/api/https.html#https_https_createserver_options_requestlistener).      根据定义，使用指定的选项对象启用https [这里](http://nodejs.org/api/https.html#https_https_createserver_options_requestlistener).*Standalone only*. *仅限单机*。  

- disableEditor 禁用编辑器

  if set to `true`, prevents the editor UI from being served by the runtime. The admin api endpoints remain active. Default: `false`. 如果设置为`true`，则阻止运行库提供编辑器UI。管理API端点保持活动状态。预设值：`false`。

- httpStatic

  a local directory from which to serve static web content from. This content is served from the top level url, `/`. When this property is used, `httpAdminRoot` must also be used to make editor UI available at a path other than `/`.      本地目录，从中提供静态Web内容。此内容是 从顶级URL`/`提供服务。使用此属性时，还必须使用`httpAdminRoot`使编辑器UI在`/`以外的路径上可用。This property can also be set as an Array to support multiple static directories, each with its own set of options. The options include the path to the local directory to serve content from, the root url to serve them from, an optional custom middleware function and an optional CORS configuration. 此属性也可以设置为Array以支持多个静态目录，每个目录都有自己的一组选项。这些选项包括提供内容的本地目录的路径、提供内容的根URL、可选的自定义中间件功能和可选的CORS配置。     For example: 举例来说：     `httpStatic: [  {      path: '/opt/static/',      root: '/private/',      middleware: myCustomHttpMiddleware,      cors: {       }  } ] `         *Standalone only*. *仅限单机*。  

- httpStaticAuth

  enabled HTTP Basic Authentication on the static content. See `httpAdminAuth` for format. 已对静态内容启用HTTP基本身份验证。格式见`httpAdminAuth`。

- httpStaticCors

  enables cross-origin resource sharing for the httpStatic endpoints as defined [here](https://github.com/troygoode/node-cors#configuration-options) [为此处](https://github.com/troygoode/node-cors#configuration-options)定义的httpStatic端点启用跨域资源共享

- httpNodeCors

  enables cross-origin resource sharing for the nodes that provide HTTP endpoints, as defined [here](https://github.com/troygoode/node-cors#configuration-options) 为提供HTTP端点的节点启用跨源资源共享，如[此处所](https://github.com/troygoode/node-cors#configuration-options)定义

- httpNodeMiddleware httpNode中间件

  an HTTP middleware function, or array of functions, that is added to all HTTP In nodes. This allows whatever custom processing, such as authentication, is needed for the nodes. The format of the middleware function is documented [here](http://expressjs.com/guide/using-middleware.html#middleware.application).      HTTP中间件函数或函数阵列，添加到所有HTTP In节点。 这允许进行所需的任何自定义处理（如身份验证）， 节点。中间件函数的格式是 记录[在这里](http://expressjs.com/guide/using-middleware.html#middleware.application)。`httpNodeMiddleware: function(req,res,next) {    // Perform any processing on the request.    // Be sure to call next() if the request should be passed    // to the relevant HTTP In node. } `      

- logging 测井

  currently only console logging is supported. Various levels of logging can be specified. Options are: 当前仅支持控制台日志记录。可以指定各种级别的日志记录。选项包括：

- **fatal** - only those errors which make the application unusable should be recorded
  **致命错误**-只记录那些使应用程序不可用的错误
- **error** - record errors which are deemed fatal for a particular request + fatal errors
  **错误**-记录对于特定请求被视为致命的错误+致命错误
- **warn** - record problems which are non fatal + errors + fatal errors
  **warn**-记录非致命错误+致命错误的问题
- **info** - record information about the general running of the application + warn + error + fatal errors
  **info**-记录应用程序的一般运行信息+ warn + error + fatal errors
- **debug** - record information which is more verbose than info + info + warn + error + fatal errors
  **debug**-记录比info + info + warn + error + fatal errors更详细的信息
- **trace** - record very detailed logging + debug + info + warn + error + fatal errors
  **trace**-记录非常详细的日志记录+ debug + info + warn + error + fatal errors

The default level is `info`. For embedded devices with limited flash storage you may wish to set this to `fatal` to minimise writes to “disk”.
默认级别为`info`。对于具有有限闪存的嵌入式设备，您可能希望将此设置为`致命`，以最大限度地减少对“磁盘”的写入。

- externalModules 外部模块

  Configure how the runtime will handle external npm modules. This covers:     配置运行时如何处理外部npm模块。这包括：      whether the editor will allow new node modules to be installed 编辑器是否允许安装新的节点模块      whether nodes, such as the Function node are allowed to have their own dynamically configured dependencies. 是否允许节点（如Function节点）具有其自己的动态配置依赖关系。         The allow/denyList options can be used to limit what modules the runtime will install/load. It can use `*` as a wildcard that matches anything. allow/denyList选项可用于限制运行时将安装/加载哪些模块。它可以使用`*`作为匹配任何内容的后缀。     `externalModules: {   autoInstall: false,   autoInstallRetry: 30,   palette: {      allowInstall: true,      allowUpload: true,      allowList: [],      denyList: []   },   modules: {      allowInstall: true,      allowList: [],      denyList: []   } } `      

## Editor Configuration 编辑器配置

- adminAuth

  enables user-level security in the editor and admin API. See [Securing Node-RED](https://nodered.org/docs/user-guide/runtime/securing-node-red) for more information. 在编辑器和管理API中启用用户级安全性。请参阅[保护Node-RED](https://nodered.org/docs/user-guide/runtime/securing-node-red) for more information.

- paletteCategories palette分类

  defines the order of categories in the palette. If a node’s category is not in the list, the category will get added to the end of the palette. If not set, the following default order is used:      定义调色板中类别的顺序。如果节点的类别不在 列表中，类别将被添加到调色板的末尾。如果不设置， 使用以下默认顺序：`['subflows', 'common', 'function', 'network', 'sequence', 'parser', 'storage'], `         *Note*: Until the user creates a subflow the subflow category will be empty and will not be visible in the palette. *注意*：在用户创建子流之前，子流类别将为空，并且在调色板中不可见。  

## Editor Themes 编辑器主题

The theme of the editor can be changed by using the following settings object. All parts are optional.
编辑器的主题可以通过使用以下设置对象来更改。所有部件都是可选的。

```
editorTheme: {
    page: {
        title: "Node-RED",
        favicon: "/absolute/path/to/theme/icon",
        css: "/absolute/path/to/custom/css/file",
        scripts: [ "/absolute/path/to/custom/script/file", "/another/script/file"]
    },
    header: {
        title: "Node-RED",
        image: "/absolute/path/to/header/image", // or null to remove image
        url: "http://nodered.org" // optional url to make the header text/image a link to this url
    },
    deployButton: {
        type:"simple",
        label:"Save",
        icon: "/absolute/path/to/deploy/button/image" // or null to remove image
    },
    menu: { // Hide unwanted menu items by id. see packages/node_modules/@node-red/editor-client/src/js/red.js:loadEditor for complete list
        "menu-item-import-library": false,
        "menu-item-export-library": false,
        "menu-item-keyboard-shortcuts": false,
        "menu-item-help": {
            label: "Alternative Help Link Text",
            url: "http://example.com"
        }
    },
    tours: false, // disable the Welcome Tour for new users
    userMenu: false, // Hide the user-menu even if adminAuth is enabled
    login: {
        image: "/absolute/path/to/login/page/big/image" // a 256x256 image
    },
    logout: {
        redirect: "http://example.com"
    },
    palette: {
        editable: true, // *Deprecated* - use externalModules.palette.allowInstall instead
        catalogues: [   // Alternative palette manager catalogues
            'https://catalogue.nodered.org/catalogue.json'
        ],
        theme: [ // Override node colours - rules test against category/type by RegExp.
            { category: ".*", type: ".*", color: "#f0f" }
        ]
    },
    projects: {
        enabled: false // Enable the projects feature
    },
    theme: "", // Select a color theme for the editor. See https://github.com/node-red-contrib-themes/theme-collection for a collection of themes to choose from
    codeEditor: {
        lib: "ace", // Select the text editor component used by the editor. Defaults to "ace", but can be set to "ace" or "monaco"
        options: {
            // The following only apply if the editor is set to "monaco"
            theme: "vs", // Select a color theme for the text editor component. Must match the file name of a theme in packages/node_modules/@node-red/editor-client/src/vendor/monaco/dist/theme
        }
    },
    mermaid: {
        theme: "default" // Select a color theme for the Mermaid diagramming and charting tool. Must match the name of a theme in https://mermaid.js.org/config/theming.html#available-themes
    }
},
```

## Dashboard 仪表板

- ui

  The home path for the Node-RED-Dashboard add-on nodes can specified. This is relative to any already defined **httpNodeRoot** 可以指定Node-RED-Dashboard附加节点的主路径。这是相对于任何已经定义的httpNodeRoot     ui : { path: “mydashboard” }, ui：{ path：“mydashboard”}，  

## Node Configuration 节点配置

Any node type can define its own settings to be provided in the file.
任何节点类型都可以定义要在文件中提供的自己的设置。

- functionGlobalContext 函数GlobalContext

  Function Nodes - a collection of objects to attach to the global function context. For example,      函数节点-要附加到全局函数的对象集合 上下文比如说，`functionGlobalContext: { osModule:require('os') } `         can be accessed in a function node as: 可以在功能节点中访问为：     `var myos = global.get('osModule'); `      

*Note* : Prior to Node-RED v0.13, the documented way to use global context was to access it as a sub-property of `context`: 

```
context.global.foo = "bar";
 var osModule = context.global.osModule;
```

 This method is still supported, but deprecated in favour of the `global.get`/`global.set` functions. Any data stored using this method will not be persisted  across restarts and will not be visible in the sidebar context viewer. 
*注意*：在Node-RED v0.13之前， 使用全局上下文的方法是将其作为`上下文`的子属性访问：  该方法仍然受支持，但已被弃用，取而代之的是`global.get`/`global.set` 功能协调发展的使用此方法存储的任何数据在重新启动时都不会持久化，并且在侧边栏上下文查看器中不可见。

- functionExternalModules functional外部模块

  if set to `true`, the Function node’s Setup tab will allow adding additional modules that will become available to the function. See [Writing Functions](https://nodered.org/docs/user-guide/writing-functions#using-the-functionexternalmodules-option) for more information. Default: `false`. 如果设置为`true`，则Function节点的Setup选项卡将允许添加将对该函数可用的其他模块。有关更多信息，请参见[编写函数](https://nodered.org/docs/user-guide/writing-functions#using-the-functionexternalmodules-option)。预设值：`false`。

- functionTimeout 功能性

  Function Nodes - the default timeout, in seconds, to apply to newly configured Function nodes. Default: 0 - meaning no timeout. 功能节点-应用于新配置的功能节点的默认超时（以秒为单位）。默认值：0 -表示没有超时。

- debugMaxLength

  Debug Nodes - the maximum length, in characters, of any message sent to the debug sidebar tab. Default: 1000 发送到调试侧边栏选项卡的任何消息的最大长度（以字符为单位）。默认值：1000

- mqttReconnectTime mqtt重新连接时间

  MQTT Nodes - if the connection is lost, how long to wait, in milliseconds, before attempting to reconnect. Default: 5000 MQTT节点-如果连接丢失，在尝试重新连接之前等待多长时间（以毫秒为单位）。默认值：5000

- serialReconnectTime

  Serial Nodes - how long to wait, in milliseconds, before attempting to reopen a serial port. Default: 5000 串行节点-在尝试重新打开串行端口之前等待的时间（毫秒）。默认值：5000

- socketReconnectTime 套接字重新连接时间

  TCP Nodes - how long to wait, in milliseconds, before attempting to reconnect. Default: 10000 TCP节点-在尝试重新连接之前等待的时间（毫秒）。默认值：10000

- socketTimeout 插座

  TCP Nodes - how long to wait, in milliseconds, before timing out a socket. Default: 120000 TCP节点-在套接字超时之前等待的时间，以毫秒为单位。默认值：120000

## Securing Node-RED 保护Node-RED

By default, the Node-RED editor is not secured - anyone who can access its IP address can access the editor and deploy changes.
默认情况下，Node-RED编辑器不受保护-任何可以访问其IP地址的人都可以访问编辑器并部署更改。

This is only suitable if you are running on a trusted network.
这仅适用于在可信网络上运行的情况。

This guide describes how you can secure Node-RED. The security is split into three parts:
本指南介绍如何保护Node-RED。安全性分为三个部分：

- [Enabling HTTPS access 启用HTTPS访问](https://nodered.org/docs/user-guide/runtime/securing-node-red#enabling-https-access)
- [Securing the editor and admin API
  保护编辑器和管理API](https://nodered.org/docs/user-guide/runtime/securing-node-red#editor--admin-api-security)
- [Securing the HTTP Nodes and Node-RED Dashboard
  保护HTTP节点和Node-RED仪表板](https://nodered.org/docs/user-guide/runtime/securing-node-red#http-node-security)

### Enabling HTTPS Access 启用HTTPS访问

To enable access to the Node-RED Editor over HTTPS, rather than the default HTTP, you can use the `https` configuration option in your [settings file](https://nodered.org/docs/user-guide/runtime/settings-file).
要通过HTTPS而不是默认HTTP访问Node-RED编辑器，您可以使用[设置文件](https://nodered.org/docs/user-guide/runtime/settings-file)中的`https`配置选项。

The `https` option can be either a static set of configuration options, or, since Node-RED 1.1.0, a function that returns the options.
`https`选项可以是一组静态配置选项，也可以是一个返回选项的函数（自Node-RED 1.1.0起）。

The full set of options are [documented here](https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options).
[这里记录](https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options)了全套选项。

As a minimum, the options should include:
至少，选项应包括：

- `key` - Private key in PEM format, provided as a `String` or `Buffer`
  `key`-PEM格式的私钥，作为`字符串`或`缓冲区`提供
- `cert` - Cert chain in PEM format, provided as a `String` or `Buffer`
  `cert`-PEM格式的证书链，以`字符串`或`缓冲区形式`提供

For a guide on how to generate certificates, you can follow [this guide](https://it.knightnet.org.uk/kb/nr-qa/https-valid-certificates/). 
有关如何生成证书的指南，您可以遵循[此指南](https://it.knightnet.org.uk/kb/nr-qa/https-valid-certificates/)。

The default Node-RED settings file includes a commented out `https` section that can be used to load the certificates from local files.
默认的Node-RED设置文件包括一个注释掉的`https`部分，可用于从本地文件加载证书。

```
https: {
    key: require("fs").readFileSync('privkey.pem'),
    cert: require("fs").readFileSync('cert.pem')
},
```

*Since Node-RED 1.1.0 自Node-RED 1.1.0起*

If the `https` property is a function, it can be used to return the options object. The function can optionally return a Promise that will resolve to the options object, allowing it to complete asynchronously.
如果`https`属性是一个函数，它可以用来返回选项对象。该函数可以选择返回一个Promise，它将解析为选项对象，允许它异步完成。

```
https: function() {
    return new Promise((resolve, reject) => {
        var key, cert;
        // Do some work to obtain valid certificates
        // ...
        resolve({
            key: key
            cert: cert
        })
    });
}
```

#### Refreshing HTTPS certificates 正在刷新HTTPS证书

*Since Node-RED 1.1.0 自Node-RED 1.1.0起*

It is possible to configure Node-RED to periodically refresh its HTTPS certificates without having to restart Node-RED. To do this:
可以将Node-RED配置为定期刷新其HTTPS证书，而无需重新启动Node-RED。为此：

1. You *must* be using Node.js 11 or later
   您*必须*使用Node.js 11或更高版本
2. The `https` setting *must* be a Function that can be called to get the updated certificates
   `https`设置*必须*是可调用以获取更新证书的函数
3. Set the `httpsRefreshInterval` to how often (in hours) Node-RED should call the `https` function to get updated details.
   将`httpsRefreshInterval`设置为Node-RED应调用`https`函数以获取更新详细信息的频率（以小时为单位）。

The `https` function should determine if the current certificates will expire within the next `httpsRefreshInterval` period, and if so, generate a new set of certificates. If no update is required, the function can return `undefined` or `null`.
`https`函数应确定当前证书是否会在下一个 `httpsRefreshInterval`周期，如果是，则生成一组新证书。如果不需要更新，函数可以返回`undefined`或`null`。

### Editor & Admin API security 编辑和管理API安全性

The Editor and Admin API supports two types of authentication:
编辑器和管理员API支持两种类型的身份验证：

- username/password credential based authentication
  基于用户名/密码凭证的身份验证
- authentication against any OAuth/OpenID provider such as Twitter or GitHub
  针对任何OAuth/OpenID提供商（如Twitter或GitHub）的身份验证

#### Username/password based authentication 基于密码/密码的身份验证

To enable user authentication on the Editor and Admin API, uncomment the `adminAuth` property in your [settings file](https://nodered.org/docs/user-guide/runtime/settings-file):
要在编辑器和管理员API上启用用户身份验证，请取消对`adminAuth` [设置文件](https://nodered.org/docs/user-guide/runtime/settings-file)中的属性：

```
adminAuth: {
    type: "credentials",
    users: [
        {
            username: "admin",
            password: "$2a$08$zZWtXTja0fB1pzD4sHCMyOCMYz2Z6dNbM6tl8sJogENOMcxWV9DN.",
            permissions: "*"
        },
        {
            username: "george",
            password: "$2b$08$wuAqPiKJlVN27eF5qJp.RuQYuy6ZYONW7a/UWYxDTtwKFCdB8F19y",
            permissions: "read"
        }
    ]
}
```

The `users` property is an array of user objects. This allows you to define multiple users, each of whom can have different permissions.
`users`属性是用户对象的数组。这允许您定义多个用户，每个用户可以有不同的权限。

This example configuration above defines two users. One called `admin` who has permission to do everything within the editor and has a password of `password`. The other called `george` who is given read-only access.
上面的示例配置定义了两个用户。一个叫`管理员`谁有权做编辑器内的一切，并有一个`密码`的密码。另一个叫`乔治`，他被授予只读访问权限。

Note that the passwords are securely hashed using the bcrypt algorithm.
请注意，密码是使用bcrypt算法安全地散列的。

*Note* : in previous releases of Node-RED, the setting `httpAdminAuth` could be used to enable HTTP Basic Authentication on the editor. This option is deprecated and should not be used. 
*注意*：在Node-RED的早期版本中，设置`httpAdminAuth` 可用于在编辑器上启用HTTP基本身份验证。此选项 已弃用，不应使用。

#### Generating the password hash 生成密码哈希

If you are using Node-RED 1.1.0 or later, you can use the command:
如果您使用的是Node-RED 1.1.0或更高版本，则可以使用以下命令：

```
node-red admin hash-pw
```

For older versions of Node-RED, you can either:
对于旧版本的Node-RED，您可以：

- Install the separate [`node-red-admin` command-line tool](https://nodered.org/docs/user-guide/node-red-admin) and use the command:
  安装单独的node-red-admin命令行工具并使用命令：[``](https://nodered.org/docs/user-guide/node-red-admin)

  ```
   node-red-admin hash-pw
  ```

- Or, locate the directory Node-RED has been installed to and use the command:
  或者，找到安装Node-RED的目录并使用命令：

  ```
   node -e "console.log(require('bcryptjs').hashSync(process.argv[1], 8));" your-password-here
  ```

In all cases, you will get back the hashed version of your password which you can then paste into your settings file.
在所有情况下，您都将获得密码的散列版本，然后您可以将其粘贴到设置文件中。

#### OAuth/OpenID based authentication 基于OAuth/OpenID的认证

To use an external authentication source, Node-RED can take use a wide range of the strategies provided by [Passport](http://passportjs.org/).
要使用外部身份验证源，Node-RED可以使用Passport提供的各种策略。

Node-RED authentication modules are available for both [Twitter](https://www.npmjs.com/package/node-red-auth-twitter) and [GitHub](https://www.npmjs.com/package/node-red-auth-github). They wrap up some of the strategy-specific detail to make it easier to use. But they can also be used as a template for authenticating with other similar strategies.
Node-RED认证模块可用于Twitter和 和GitHub。他们总结了一些特定于策略的细节，使其更容易使用。但它们也可以用作其他类似策略的身份验证模板。

The following example shows how to configure to authenticate against Twitter *without* using the auth module we provide.
以下示例显示如何配置以针对Twitter进行身份验证 *不使用我们提供的auth模块。*

```
adminAuth: {
    type:"strategy",
    strategy: {
        name: "twitter",
        label: 'Sign in with Twitter',
        icon:"fa-twitter",
        strategy: require("passport-twitter").Strategy,
        options: {
            consumerKey: TWITTER_APP_CONSUMER_KEY,
            consumerSecret: TWITTER_APP_CONSUMER_SECRET,
            callbackURL: "http://example.com/auth/strategy/callback",
            verify: function(token, tokenSecret, profile, done) {
                done(null, profile);
            }
        },
    },
    users: [
       { username: "knolleary",permissions: ["*"]}
    ]
}
```

The `strategy` property takes the following options:
strategy属性接受以下选项：``

- `name` - the name of the passport strategy being used
  `name`-正在使用的passport策略的名称
- `strategy` - the passport strategy module
  `战略`-护照战略模块
- `label`/`icon` - used on the login page. `icon` can be any FontAwesome icon name.
  `标签`/`图标`-用于登录页面。`icon`可以是任何FontAwesome icon名称。
- `options` - an options object passed to the passport strategy when it is created. Refer to the strategy’s own documentation for what it requires. See below for a note on the `callbackURL` and `callbackMethod`.
  `options`-在创建passport策略时传递给passport策略的选项对象。请参阅该战略自己的文档了解其要求。请参阅下面关于`callbackURL`和`callbackMethod`的说明。
- `verify` - the verify function used by the strategy. It must call `done` with a user profile as the second argument if the user is valid. This is expected to have a `username` property that is used to check against the list of valid users. Passport attempts to standardize the user profile object, so most strategies provide this property.
  `verify`-策略使用的verify函数。如果用户是有效的，它必须使用用户配置文件作为第二个参数调用`done`。这应该有一个`username`属性，用于检查有效用户的列表。Passport试图标准化用户配置文件对象，因此大多数策略都提供此属性。
- `autoLogin` - boolean, when `true` will automatically redirect to the authentication provider rather than asking the user to click a button.
  `autoLogin`- boolean，当`为true时`，将自动重定向到身份验证提供者，而不是要求用户单击按钮。

The `callbackURL` used by a strategy is where the authentication provider will redirect to following an auth attempt. It must be the URL of your Node-RED editor with `/auth/strategy/callback` added to the path. For example, if you access the editor at `http://localhost:1880`, you would use `http://localhost:1880/auth/strategy/callback`.
策略所使用的`回调URL`是身份验证提供程序在进行身份验证尝试后将重定向到的位置。它必须是Node-RED编辑器的URL，并将`/auth/strategy/callback`添加到路径中。例如，如果您在`http：//localhost：1880`访问编辑器，则应使用 `http://localhost:1880/auth/strategy/callback` 。

By default, the `callbackURL` will listen for `GET` requests. To use `POST` requests instead, set `callbackMethod` to `POST`.
默认情况下，`callbackURL`将侦听`GET`请求。要使用`POST`请求，请将`callbackMethod`设置为`POST`。

#### Setting a default user 设置默认用户

The example configuration above will prevent anyone from accessing the editor unless they log in.
上面的示例配置将阻止任何人访问编辑器，除非他们登录。

In some cases, it is desirable to allow everyone some level of access. Typically, this will be giving read-only access to the editor. To do this, the `default` property can be added to the `adminAuth` setting to define the default user:
在某些情况下，允许每个人都有某种程度的访问是可取的。通常情况下，这将提供对编辑器的只读访问权限。为此，可以将`default`属性添加到`adminAuth`设置中以定义默认用户：

```
adminAuth: {
    type: "credentials",
    users: [ /* list of users */ ],
    default: {
        permissions: "read"
    }
}
```

#### User permissions 用户权限

Prior to Node-RED 0.14, users could have one of two permissions:
在Node-RED 0.14之前，用户可以拥有以下两种权限之一：

- `*` - full access
  `*`-完全访问
- `read` - read-only access
  `read`-只读访问

From Node-RED 0.14 the permissions can be much finer grained and to support that, the property can either be a single string as before, or an array containing multiple permissions.
从Node-RED 0.14开始，权限的粒度可以更细，为了支持这一点，属性可以像以前一样是单个字符串，也可以是包含多个权限的数组。

Each method of the [Admin API](https://nodered.org/docs/api/admin) defines what permission level is needed to access it. The permission model is resource based. For example, to get the current flow configuration, a user will require the `flows.read` permission. But to update the flows they will require the `flows.write` permission.
[Admin API](https://nodered.org/docs/api/admin)的每个方法都定义了访问它所需的权限级别。权限模型是基于资源的。例如，要获取当前的流配置，用户将需要`flows.read`权限。但是要更新流，它们需要`flows.write`权限。

#### Token expiration 令牌有效

By default, access tokens expire after 7 days after they are created. We do not currently support refreshing the token to extend this period.
默认情况下，访问令牌在创建后7天后过期。我们目前不支持刷新令牌以延长此期限。

The expiration time can be customised by setting the `sessionExpiryTime` property of the `adminAuth` setting. This defines, in seconds, how long a token is valid for. For example, to set the tokens to expire after 1 day:
可以通过设置`adminAuth`设置的`sessionExpiryTime`属性来自定义过期时间。它以秒为单位定义令牌的有效期。例如，要将令牌设置为1天后过期：

```
adminAuth: {
    sessionExpiryTime: 86400,
    ...
}
```

#### Accessing the Admin API 禁用Admin API

With the `adminAuth` property set, the [Admin API documentation](https://nodered.org/docs/api/admin/oauth) describes how to access the API.
设置了`adminAuth`属性后，[Admin API文档](https://nodered.org/docs/api/admin/oauth) 介绍了如何访问API。

#### Custom user authentication 自定义用户鉴定

Rather than hardcode users into the settings file, it is also possible to plug in custom code to authenticate users. This makes it possible to integrate with existing authentication schemes.
也可以插入自定义代码来验证用户，而不是将用户硬编码到设置文件中。这使得它可以与现有的认证方案集成。

The following example shows how an external module can be used to provide the custom authentication code.
下面的示例演示如何使用外部模块提供自定义身份验证代码。

- Save the following in a file called `<node-red>/user-authentication.js`
  将以下内容保存到名为 `<node-red>/user-authentication.js` 的文件中

```
module.exports = {
   type: "credentials",
   users: function(username) {
       return new Promise(function(resolve) {
           // Do whatever work is needed to check username is a valid
           // user.
           if (valid) {
               // Resolve with the user object. It must contain
               // properties 'username' and 'permissions'
               var user = { username: "admin", permissions: "*" };
               resolve(user);
           } else {
               // Resolve with null to indicate this user does not exist
               resolve(null);
           }
       });
   },
   authenticate: function(username,password) {
       return new Promise(function(resolve) {
           // Do whatever work is needed to validate the username/password
           // combination.
           if (valid) {
               // Resolve with the user object. Equivalent to having
               // called users(username);
               var user = { username: "admin", permissions: "*" };
               resolve(user);
           } else {
               // Resolve with null to indicate the username/password pair
               // were not valid.
               resolve(null);
           }
       });
   },
   default: function() {
       return new Promise(function(resolve) {
           // Resolve with the user object for the default user.
           // If no default user exists, resolve with null.
           resolve({anonymous: true, permissions:"read"});
       });
   }
}
```

- Set the `adminAuth` property in settings.js to load this module:
  在settings.js中设置`adminAuth`属性以加载此模块：

```
adminAuth: require("./user-authentication")
```

#### Custom authentication tokens 自定义身份验证令牌

*Since Node-RED 1.1.0 自Node-RED 1.1.0起*

In some circumstances you may need to use your own authentication tokens and not use those generated by Node-RED. For example:
在某些情况下，您可能需要使用自己的身份验证令牌，而不是使用Node-RED生成的令牌。举例来说：

- You want to use OAuth based user authentication, but you also require automated access to the admin API which cannot perform the interactive authentication steps OAuth requires
  您希望使用基于OAuth的用户身份验证，但还需要自动访问管理API，而管理API无法执行OAuth所需的交互式身份验证步骤
- You want to integrate Node-RED into an existing system where the users will already be logged in and you don’t want them to have to log in again when accessing the editor
  您希望将Node-RED集成到用户已经登录的现有系统中，并且您不希望他们在访问编辑器时再次登录

The `adminAuth` setting can include a `tokens` function. This function will be called if a request to the admin api does not contain an authentication token that Node-RED recognises as one of its own. It is passed the token provided in the request and should return a Promise that resolves with either the authenticated user, or `null` if the token is not valid.
`adminAuth`设置可以包括`令牌`功能。如果对admin API的请求不包含Node-RED识别为自己的身份验证令牌，则将调用此函数。它被传递请求中提供的令牌，并且应该返回一个Promise，该Promise使用经过身份验证的用户进行解析，或者如果令牌无效，则返回`null`。

```
adminAuth: {
    ...
    tokens: function(token) {
        return new Promise(function(resolve, reject) {
            // Do whatever work is needed to check token is valid
            if (valid) {
                // Resolve with the user object. It must contain
                // properties 'username' and 'permissions'
                var user = { username: 'admin', permissions: '*' };
                resolve(user);
            } else {
                // Resolve with null as this user does not exist
                resolve(null);
            }
        });
    },
    ...
}
```

By default, it will use the `Authorization` http header and expect a `Bearer` type token - passing in just the value of the token to the function. If it is not a `Bearer` type token, then the full value of the `Authorization` header will be passed to the function, containing both type and value.
默认情况下，它将使用`Authorization`http标头并期望`Bearer`类型 token -仅将token的值传递给函数。如果不是 `承载`类型标记，则`Authorization`头的完整值将被传递给函数，其中包含类型和值。

To use a different HTTP header, the `tokenHeader` setting can be used to identify which header to use:
要使用不同的HTTP标头，可以使用`tokenHeader`设置来标识要使用的标头：用途：

```
adminAuth: {
    ...
    tokens: function(token) {
        ...
    },
    tokenHeader: "x-my-custom-token"
}
```

##### Accessing the editor with a custom token 使用自定义标记重新启动编辑器

To access the editor using a custom token without the login prompt, add `?access_token=<ACCESS_TOKEN>` to the URL. The editor will store that token locally and use it for all future requests.
要使用自定义标记访问编辑器而不使用登录提示，请添加`？access_token=<ACCESS_TOKEN>` 到URL。编辑器将在本地存储该令牌，并将其用于所有未来的请求。

### HTTP Node security HTTP节点安全

The routes exposed by the HTTP In nodes can be secured using basic authentication.
可以使用基本身份验证来保护HTTP In节点公开的路由。

The `httpNodeAuth` property in your `settings.js` file can be used to define a single username and password that will be allowed to access the routes.
`settings.js`文件中的`httpNodeAuth`属性可用于定义允许访问路由的单个用户名和密码。

```
httpNodeAuth: {user:"user",pass:"$2a$08$zZWtXTja0fB1pzD4sHCMyOCMYz2Z6dNbM6tl8sJogENOMcxWV9DN."},
```

The `pass` property uses the same format as `adminAuth`. See [Generating the password hash](https://nodered.org/docs/user-guide/runtime/securing-node-red#generating-the-password-hash) for more information.
`pass`属性使用与`adminAuth`相同的格式。有关详细信息，请参阅[生成密码哈希](https://nodered.org/docs/user-guide/runtime/securing-node-red#generating-the-password-hash)。

Access to any static content defined by the `httpStatic` property can be secured using the `httpStaticAuth` property, which uses the same format.
可以使用`httpStaticAuth`属性保护对httpStatic属性定义的任何静态内容的访问``

*Note* : in previous releases of Node-RED, the `pass` property was expected to be an MD5 hash. This is cryptographically insecure, so has been superseded with bcrypt, as used by `adminAuth`. For backwards compatibility, MD5 hashes are still supported - but they are not recommended. 
*注意*：在以前的Node-RED版本中，`pass`属性应该是MD5哈希。这在密码学上是不安全的，因此已被bcrypt取代，如`adminAuth`所使用的。为了向后兼容，仍然支持MD5哈希，但不推荐使用。

### Custom Middleware 自定义中间件

It is possible to provide custom HTTP middleware that will be added in front of all `HTTP In` nodes and, since Node-RED 1.1.0, in front of all admin/editor routes.
可以提供自定义HTTP中间件，将其添加到所有`HTTP In`节点的前面，并且从Node-RED 1.1.0开始，添加到所有admin/editor路由的前面。

##### Custom Middleware for http-in nodes 用于http-in节点的自定义中间件

For the `HTTP In` nodes, the middleware is provided as the `httpNodeMiddleware` setting.
对于`HTTPIn`节点，中间件作为`httpNodeMiddleware`设置提供。

The following setting is an example to limit the HTTP access rate in http-in nodes.
以下设置是限制http-in节点中的HTTP访问速率的示例。

```
// Run `npm install express-rate-limit` on `~/.node-red/` directory in advance
var rateLimit = require("express-rate-limit");
module.exports = {
    httpNodeMiddleware: rateLimit({
        windowMs: 1000, // 1000 milliseconds is set as the window time.
        max: 10 // limit access rate to 10 requests/second
    })
}
```

Using this configuration, the Node-RED process can avoid memory exhaustions  even if the flows which start with the http-in node take time to  process. When reaching the limitation, the endpoints will return the default  message, “Too many requests, please try again later.”.
使用此配置，Node-RED进程可以避免内存耗尽，即使从http-in节点开始的流需要时间处理。当达到限制时，端点将返回默认消息“请求太多，请稍后再试。”。

##### Custom Middleware for Admin API 用于管理API的自定义中间件

For the admin/editor routes, the middleware is provided as the `httpAdminMiddleware` setting.
对于admin/editor路由，中间件作为`httpAdminMiddleware`设置提供。

For example, the following middleware could be used to set the `X-Frame-Options` http header on all admin/editor requests. This can be used to control how the editor is embedded on other pages.
例如，可以使用以下中间件在所有管理/编辑器请求上设置`X-Frame-Options`http标头。这可以用来控制编辑器如何嵌入到其他页面上。

```
httpAdminMiddleware: function(req, res, next) {
    // Set the X-Frame-Options header to limit where the editor
    // can be embedded
    res.set('X-Frame-Options', 'sameorigin');
    next();
},
```

Other possible uses would be to add additional layers of security or request verification to the routes.
其他可能的用途是添加额外的安全层或请求对路由进行验证。

## Logging 测井

Node-RED uses a logger that writes its output to the console. It also supports the use of custom logger modules to allow the output to be sent elsewhere.
Node-RED使用记录器将其输出写入控制台。它还支持使用自定义日志记录器模块，以允许将输出发送到其他地方。

*Note* : if you are running as a service on the Raspberry Pi using our [install script](https://nodered.org/docs/hardware/raspberrypi), you can use the `node-red-log` command to view the service log. 
*注意*：如果您在Raspberry Pi上使用我们的 [安装脚本](https://nodered.org/docs/hardware/raspberrypi)，您可以使用 `node-red-log`命令查看服务日志。

### Console logger 控制台记录器

The console logger can be configured under the `logging` property in your [settings file](https://nodered.org/docs/user-guide/runtime/settings-file).
控制台记录器可以在`` [设置文件](https://nodered.org/docs/user-guide/runtime/settings-file)。

```
// Configure the logging output
logging: {
    // Console logging
    console: {
        level: "info",
        metrics: false,
        audit: false
    }
}
```

There are 3 properties used to configure the logger’s behaviour:
有3个属性用于配置记录器的行为：

#### `level` `水平`

Level of logging to be recorded. Options are:
要记录的日志记录级别。选项包括：

- `fatal` - only those errors which make the application unusable should be recorded
  `致命错误`-只记录那些使应用程序不可用的错误
- `error` - record errors which are deemed fatal for a particular request
  `error`-记录对于特定请求被认为是致命的错误
- `warn` - record problems which are non fatal
  `警告`-记录非致命问题
- `info` - record information about the general running of the application
  `info`-记录应用程序的一般运行信息
- `debug` - record information which is more verbose than info
  `debug`-记录比info更详细的信息
- `trace` - record very detailed logging
  `跟踪`-记录非常详细的日志
- `off` - no log messages at all
  `off`-根本没有日志消息

Other than `off`, each level includes messages at higher levels - for example, `warn` level will include `error` and `fatal` level messages. You can find the API reference for how to log to these different logging levels in the [Writing Functions Section](https://nodered.org/docs/user-guide/writing-functions#node)
除了`关闭`，每个级别都包括更高级别的消息-例如，`警告`级别将包括`错误`和`致命`级别消息。您可以在[编写函数部分](https://nodered.org/docs/user-guide/writing-functions#node)找到有关如何记录到这些不同日志级别的API参考

#### `metrics` `度量`

When set to `true`, the Node-RED runtime outputs flow execution and memory usage information.
当设置为`true`时，Node-RED运行时输出流执行和内存使用信息。

Received and sent events in each node are output into the log. For example, the following logs are output from the flow which has inject and debug nodes.
每个节点中接收和发送的事件都输出到日志中。例如，以下日志是具有注入和调试节点的流的输出。

```
9 Mar 13:57:53 - [metric] {"level":99,"nodeid":"8bd04b10.813f58","event":"node.inject.receive","msgid":"86c8212c.4ef45","timestamp":1489067873391}
9 Mar 13:57:53 - [metric] {"level":99,"nodeid":"8bd04b10.813f58","event":"node.inject.send","msgid":"86c8212c.4ef45","timestamp":1489067873392}
9 Mar 13:57:53 - [metric] {"level":99,"nodeid":"4146d01.5707f3","event":"node.debug.receive","msgid":"86c8212c.4ef45","timestamp":1489067873393}
```

Memory usage is logged every 15 seconds.
每15秒记录一次内存使用情况。

```
9 Mar 13:56:24 - [metric] {"level":99,"event":"runtime.memory.rss","value":97517568,"timestamp":1489067784815}
9 Mar 13:56:24 - [metric] {"level":99,"event":"runtime.memory.heapTotal","value":81846272,"timestamp":1489067784817}
9 Mar 13:56:24 - [metric] {"level":99,"event":"runtime.memory.heapUsed","value":59267432,"timestamp":1489067784817}
```

#### `audit` `审计`

When set to `true`, the Admin HTTP API access events are logged. The event includes additional information such as the end point being accessed, IP address and time stamp.
设置为`true`时，将记录Admin HTTP API访问事件。该事件包括其他信息，如正在访问的端点、IP地址和时间戳。

If `adminAuth` is enabled, the events include information about the requesting user.
如果启用`了adminAuth`，则事件包括有关请求用户的信息。

```
9 Mar 13:49:42 - [audit] {"event":"library.get.all","type":"flow","level":98,"path":"/library/flows","ip":"127.0.0.1","timestamp":1489067382686}
9 Mar 14:34:22 - [audit] {"event":"flows.set","type":"full","version":"v2","level":98,"user":{"username":"admin","permissions":"write"},"path":"/flows","ip":"127.0.0.1","timestamp":1489070062519}
```

### Custom logging module 自定义日志记录模块

A custom logging module can also be used. For example, the `metrics` output may get sent to a separate system for monitoring the performance of the system.
还可以使用自定义日志记录模块。例如，`度量`输出可以被发送到单独的系统以用于监视系统的性能。

To use a custom logger, add a new block in the logging property of your [settings file](https://nodered.org/docs/user-guide/runtime/settings-file):
若要使用自定义记录器，请在 [设置文件](https://nodered.org/docs/user-guide/runtime/settings-file)：

```
// Configure the logging output
logging: {
    // Console logging
    console: {
        level: "info",
        metrics: false,
        audit: false
    },
    // Custom logger
    myCustomLogger: {
        level: 'debug',
        metrics: true,
        handler: function(settings) {
            // Called when the logger is initialised

            // Return the logging function
            return function(msg) {
                console.log(msg.timestamp, msg.event);
            }
        }
    }
}
```

The `level`, `metrics` and `audit` properties are the same as console logging.
`级别`、`度量`和`审核`属性与控制台日志记录相同。

The `handler` property defines the custom logging handler. It is a function that is called once at start-up, passing in the logger’s configuration. It must return a function that will get called with log messages.
`handler`属性定义自定义日志记录处理程序。它是一个在启动时调用一次的函数，传递记录器的配置。它必须返回一个将使用日志消息调用的函数。

Multiple custom loggers can be configured - the only reserved name is `console`.
可以配置多个自定义记录器-唯一保留的名称是`console`。

#### Example logger 示例记录器

The following example adds a custom logger that sends metrics events to a [Logstash](https://www.elastic.co/products/logstash) instance over a TCP connection.
下面的示例添加一个自定义记录器，该记录器将度量事件发送到 TCP连接上[的Logstash](https://www.elastic.co/products/logstash)实例。

It is a very quick and simple example - with no error handling or reconnect logic.
这是一个非常快速和简单的例子-没有错误处理或重新连接逻辑。

```
logging: {
    console: {
        level: "info",
        metrics: false,
        audit: false
    },
    logstash: {
        level:'off',
        metrics:true,
        handler: function(conf) {
            var net = require('net');
            var logHost = '192.168.99.100',logPort = 9563;
            var conn = new net.Socket();
            conn.connect(logPort,logHost)
                .on('connect',function() {
                    console.log("Logger connected")
                })
                .on('error', function(err) {
                    // Should attempt to reconnect in a real env
                    // This example just exits...
                    process.exit(1);
                });
            // Return the function that will do the actual logging
            return function(msg) {
                var message = {
                    '@tags': ['node-red', 'test'],
                    '@fields': msg,
                    '@timestamp': (new Date(msg.timestamp)).toISOString()
                }
                try {
                    conn.write(JSON.stringify(message)+"\n");
                }catch(err) { console.log(err);}
            }
        }
    }
}
```









# Configuration 配置

The following properties can be used to configure Node-RED.
以下属性可用于配置Node-RED。

When running as a normal application, it loads its configuration from a settings file. For more information about the settings file and where it is, read [this guide](https://nodered.org/docs/user-guide/runtime/settings-file).
当作为普通应用程序运行时，它从设置文件加载其配置。有关设置文件及其所在位置的详细信息，请阅读[本指南](https://nodered.org/docs/user-guide/runtime/settings-file)。

When running as an [embedded application](https://nodered.org/docs/user-guide/runtime/embedding), the configuration options are passed in the call to `RED.init()`. However, when run in this mode, certain properties are ignored and are left to the embedding application to implement.
当作为[嵌入式应用程序](https://nodered.org/docs/user-guide/runtime/embedding)运行时，配置选项在对`RED.init（）`的调用中传递。但是，在此模式下运行时，某些属性将被忽略，并留给嵌入应用程序来实现。

### Runtime Configuration 运行时配置

- flowFile

  the file used to store the flows. Default: `flows_<hostname>.json` 用于存储流的文件。默认值：`flows_<hostname>.json`

- userDir

  the directory to store all user data, such as flow and credential files and all library data. Default: `$HOME/.node-red` 用于存储所有用户数据（如流和凭据文件以及所有库数据）的目录。默认值：`$HOME/.node-red`

- nodesDir

  a directory to search for additional installed nodes. Node-RED searches the `nodes` directory under the *userDir* directory. This property allows an additional directory to be searched, so that nodes can be installed outside of the Node-RED install structure. Default: `$HOME/.node-red/nodes` 用于搜索其他已安装节点的目录。Node-RED搜索`节点` *userDir*目录下的目录。此属性允许搜索其他目录，以便可以在Node-RED安装结构之外安装节点。默认值：`$HOME/.node-red/nodes`

- uiHost

  the interface to listen for connections on. Default: `0.0.0.0` - *all IPv4 interfaces*.      监听连接的接口。默认值：`0.0.0.0`- *所有IPv4接口*。*Standalone only*. *仅限单机*。  

- uiPort

  the port used to serve the editor UI. Default: `1880`.      用于提供编辑器UI的端口。默认值：`1880`年。*Standalone only*. *仅限单机*。  

- httpAdminRoot

  the root url for the editor UI. If set to `false`, all admin endpoints are disabled. This includes both API endpoints and the editor UI. To disable just the editor UI, see the `disableEditor` property below. Default: `/` 编辑器UI的根URL。如果设置为`false`，则禁用所有管理终结点。这包括API端点和编辑器UI。要仅禁用编辑器UI，请参阅下面的`disableEditor`属性。默认值：`/`

- httpAdminAuth

  *Deprecated*: see `adminAuth`.      *已弃用*：参见`adminAuth`。enables HTTP Basic Authentication on the editor UI: 在编辑器UI上启用HTTP基本身份验证：     `httpAdminAuth: {user:"nol", pass:"5f4dcc3b5aa765d61d8327deb882cf99"} `         The `pass` property is the md5 hash of the actual password. The following command can be used to generate the hash: `pass`属性是实际密码的md5哈希值。可以使用以下命令生成哈希：     `node -e "console.log(require('crypto').createHash('md5').update('YOUR PASSWORD HERE','utf8').digest('hex'))" `         *Standalone only*. *仅限单机*。  

- httpAdminMiddleware

  an HTTP middleware function, or array of functions, that is added to all admin routes. The format of the middleware function is documented [here](http://expressjs.com/guide/using-middleware.html#middleware.application).      HTTP中间件功能或功能阵列，添加到所有管理路由。 中间件函数的格式记录在[这里](http://expressjs.com/guide/using-middleware.html#middleware.application)。`httpAdminMiddleware: function(req,res,next) {    // Perform any processing on the request.    // Be sure to call next() if the request should be passed on } `      

- httpAdminCookieOptions

  when Admin Autentication is enabled, this can be used to customise the options used when setting the session cookie used as part of the OAuth authentication flow. The available options are documented [here](https://www.npmjs.com/package/cookie#options-1). 当Admin Autentication被启用时，这可以用来自定义设置作为OAuth身份验证流的一部分使用的会话cookie时使用的选项。可用选项记录在[此处](https://www.npmjs.com/package/cookie#options-1)。

- httpNodeRoot

  the root url for nodes that provide HTTP endpoints. If set to `false`, all node-based HTTP endpoints are disabled. Default: `/` 提供HTTP端点的节点的根URL。如果设置为`false`，则禁用所有基于节点的HTTP端点。默认值：`/`

- httpNodeAuth

  enables HTTP Basic Authentication. See `httpAdminAuth` for format. 启用HTTP基本身份验证。有关格式，请参阅`httpAdminAuth`。

- httpRoot

  this sets the root url for both admin and node endpoints. It overrides the values set by `httpAdminRoot` and `httpNodeRoot`. 这将为管理和节点端点设置根URL。它覆盖由`httpAdminRoot`和`httpNodeRoot`设置的值。

- https

  enables https, with the specified options object, as defined [here](http://nodejs.org/api/https.html#https_https_createserver_options_requestlistener).      根据定义，使用指定的选项对象启用https [这里](http://nodejs.org/api/https.html#https_https_createserver_options_requestlistener).*Standalone only*. *仅限单机*。  

- disableEditor 禁用编辑器

  if set to `true`, prevents the editor UI from being served by the runtime. The admin api endpoints remain active. Default: `false`. 如果设置为`true`，则阻止运行库提供编辑器UI。管理API端点保持活动状态。预设值：`false`。

- httpStatic

  a local directory from which to serve static web content from. This content is served from the top level url, `/`. When this property is used, `httpAdminRoot` must also be used to make editor UI available at a path other than `/`.      本地目录，从中提供静态Web内容。此内容是 从顶级URL`/`提供服务。使用此属性时，还必须使用`httpAdminRoot`使编辑器UI在`/`以外的路径上可用。This property can also be set as an Array to support multiple static directories, each with its own set of options. The options include the path to the local directory to serve content from, the root url to serve them from, an optional custom middleware function and an optional CORS configuration. 此属性也可以设置为Array以支持多个静态目录，每个目录都有自己的一组选项。这些选项包括提供内容的本地目录的路径、提供内容的根URL、可选的自定义中间件功能和可选的CORS配置。     For example: 举例来说：     `httpStatic: [  {      path: '/opt/static/',      root: '/private/',      middleware: myCustomHttpMiddleware,      cors: {       }  } ] `         *Standalone only*. *仅限单机*。  

- httpStaticAuth

  enabled HTTP Basic Authentication on the static content. See `httpAdminAuth` for format. 已对静态内容启用HTTP基本身份验证。格式见`httpAdminAuth`。

- httpStaticCors

  enables cross-origin resource sharing for the httpStatic endpoints as defined [here](https://github.com/troygoode/node-cors#configuration-options) [为此处](https://github.com/troygoode/node-cors#configuration-options)定义的httpStatic端点启用跨域资源共享

- httpNodeCors

  enables cross-origin resource sharing for the nodes that provide HTTP endpoints, as defined [here](https://github.com/troygoode/node-cors#configuration-options) 为提供HTTP端点的节点启用跨源资源共享，如[此处所](https://github.com/troygoode/node-cors#configuration-options)定义

- httpNodeMiddleware httpNode中间件

  an HTTP middleware function, or array of functions, that is added to all HTTP In nodes. This allows whatever custom processing, such as authentication, is needed for the nodes. The format of the middleware function is documented [here](http://expressjs.com/guide/using-middleware.html#middleware.application).      HTTP中间件函数或函数阵列，添加到所有HTTP In节点。 这允许进行所需的任何自定义处理（如身份验证）， 节点。中间件函数的格式是 记录[在这里](http://expressjs.com/guide/using-middleware.html#middleware.application)。`httpNodeMiddleware: function(req,res,next) {    // Perform any processing on the request.    // Be sure to call next() if the request should be passed    // to the relevant HTTP In node. } `      

- logging 测井

  currently only console logging is supported. Various levels of logging can be specified. Options are: 当前仅支持控制台日志记录。可以指定各种级别的日志记录。选项包括：

- **fatal** - only those errors which make the application unusable should be recorded
  **致命错误**-只记录那些使应用程序不可用的错误
- **error** - record errors which are deemed fatal for a particular request + fatal errors
  **错误**-记录对于特定请求被视为致命的错误+致命错误
- **warn** - record problems which are non fatal + errors + fatal errors
  **warn**-记录非致命错误+致命错误的问题
- **info** - record information about the general running of the application + warn + error + fatal errors
  **info**-记录应用程序的一般运行信息+ warn + error + fatal errors
- **debug** - record information which is more verbose than info + info + warn + error + fatal errors
  **debug**-记录比info + info + warn + error + fatal errors更详细的信息
- **trace** - record very detailed logging + debug + info + warn + error + fatal errors
  **trace**-记录非常详细的日志记录+ debug + info + warn + error + fatal errors

The default level is `info`. For embedded devices with limited flash storage you may wish to set this to `fatal` to minimise writes to “disk”.
默认级别为`info`。对于具有有限闪存的嵌入式设备，您可能希望将此设置为`致命`，以最大限度地减少对“磁盘”的写入。

- externalModules 外部模块

  Configure how the runtime will handle external npm modules. This covers:     配置运行时如何处理外部npm模块。这包括：      whether the editor will allow new node modules to be installed 编辑器是否允许安装新的节点模块      whether nodes, such as the Function node are allowed to have their own dynamically configured dependencies. 是否允许节点（如Function节点）具有其自己的动态配置依赖关系。         The allow/denyList options can be used to limit what modules the runtime will install/load. It can use `*` as a wildcard that matches anything. allow/denyList选项可用于限制运行时将安装/加载哪些模块。它可以使用`*`作为匹配任何内容的后缀。     `externalModules: {   autoInstall: false,   autoInstallRetry: 30,   palette: {      allowInstall: true,      allowUpload: true,      allowList: [],      denyList: []   },   modules: {      allowInstall: true,      allowList: [],      denyList: []   } } `      

### Editor Configuration 编辑器配置

- adminAuth

  enables user-level security in the editor and admin API. See [Securing Node-RED](https://nodered.org/docs/user-guide/runtime/securing-node-red) for more information. 在编辑器和管理API中启用用户级安全性。请参阅[保护Node-RED](https://nodered.org/docs/user-guide/runtime/securing-node-red) for more information.

- paletteCategories palette分类

  defines the order of categories in the palette. If a node’s category is not in the list, the category will get added to the end of the palette. If not set, the following default order is used:      定义调色板中类别的顺序。如果节点的类别不在 列表中，类别将被添加到调色板的末尾。如果不设置， 使用以下默认顺序：`['subflows', 'common', 'function', 'network', 'sequence', 'parser', 'storage'], `         *Note*: Until the user creates a subflow the subflow category will be empty and will not be visible in the palette. *注意*：在用户创建子流之前，子流类别将为空，并且在调色板中不可见。  

### Editor Themes 编辑器主题

The theme of the editor can be changed by using the following settings object. All parts are optional.
编辑器的主题可以通过使用以下设置对象来更改。所有部件都是可选的。

```
editorTheme: {
    page: {
        title: "Node-RED",
        favicon: "/absolute/path/to/theme/icon",
        css: "/absolute/path/to/custom/css/file",
        scripts: [ "/absolute/path/to/custom/script/file", "/another/script/file"]
    },
    header: {
        title: "Node-RED",
        image: "/absolute/path/to/header/image", // or null to remove image
        url: "http://nodered.org" // optional url to make the header text/image a link to this url
    },
    deployButton: {
        type:"simple",
        label:"Save",
        icon: "/absolute/path/to/deploy/button/image" // or null to remove image
    },
    menu: { // Hide unwanted menu items by id. see packages/node_modules/@node-red/editor-client/src/js/red.js:loadEditor for complete list
        "menu-item-import-library": false,
        "menu-item-export-library": false,
        "menu-item-keyboard-shortcuts": false,
        "menu-item-help": {
            label: "Alternative Help Link Text",
            url: "http://example.com"
        }
    },
    tours: false, // disable the Welcome Tour for new users
    userMenu: false, // Hide the user-menu even if adminAuth is enabled
    login: {
        image: "/absolute/path/to/login/page/big/image" // a 256x256 image
    },
    logout: {
        redirect: "http://example.com"
    },
    palette: {
        editable: true, // *Deprecated* - use externalModules.palette.allowInstall instead
        catalogues: [   // Alternative palette manager catalogues
            'https://catalogue.nodered.org/catalogue.json'
        ],
        theme: [ // Override node colours - rules test against category/type by RegExp.
            { category: ".*", type: ".*", color: "#f0f" }
        ]
    },
    projects: {
        enabled: false // Enable the projects feature
    },
    theme: "", // Select a color theme for the editor. See https://github.com/node-red-contrib-themes/theme-collection for a collection of themes to choose from
    codeEditor: {
        lib: "ace", // Select the text editor component used by the editor. Defaults to "ace", but can be set to "ace" or "monaco"
        options: {
            // The following only apply if the editor is set to "monaco"
            theme: "vs", // Select a color theme for the text editor component. Must match the file name of a theme in packages/node_modules/@node-red/editor-client/src/vendor/monaco/dist/theme
        }
    },
    mermaid: {
        theme: "default" // Select a color theme for the Mermaid diagramming and charting tool. Must match the name of a theme in https://mermaid.js.org/config/theming.html#available-themes
    }
},
```

### Dashboard 仪表板

- ui

  The home path for the Node-RED-Dashboard add-on nodes can specified. This is relative to any already defined **httpNodeRoot** 可以指定Node-RED-Dashboard附加节点的主路径。这是相对于任何已经定义的httpNodeRoot     ui : { path: “mydashboard” }, ui：{ path：“mydashboard”}，  

### Node Configuration 节点配置

Any node type can define its own settings to be provided in the file.
任何节点类型都可以定义要在文件中提供的自己的设置。

- functionGlobalContext 函数GlobalContext

  Function Nodes - a collection of objects to attach to the global function context. For example,      函数节点-要附加到全局函数的对象集合 上下文比如说，`functionGlobalContext: { osModule:require('os') } `         can be accessed in a function node as: 可以在功能节点中访问为：     `var myos = global.get('osModule'); `      

*Note* : Prior to Node-RED v0.13, the documented way to use global context was to access it as a sub-property of `context`: 

```
context.global.foo = "bar";
 var osModule = context.global.osModule;
```

 This method is still supported, but deprecated in favour of the `global.get`/`global.set` functions. Any data stored using this method will not be persisted  across restarts and will not be visible in the sidebar context viewer. 
*注意*：在Node-RED v0.13之前， 使用全局上下文的方法是将其作为`上下文`的子属性访问：  该方法仍然受支持，但已被弃用，取而代之的是`global.get`/`global.set` 功能协调发展的使用此方法存储的任何数据在重新启动时都不会持久化，并且在侧边栏上下文查看器中不可见。

- functionExternalModules functional外部模块

  if set to `true`, the Function node’s Setup tab will allow adding additional modules that will become available to the function. See [Writing Functions](https://nodered.org/docs/user-guide/writing-functions#using-the-functionexternalmodules-option) for more information. Default: `false`. 如果设置为`true`，则Function节点的Setup选项卡将允许添加将对该函数可用的其他模块。有关更多信息，请参见[编写函数](https://nodered.org/docs/user-guide/writing-functions#using-the-functionexternalmodules-option)。预设值：`false`。

- functionTimeout 功能性

  Function Nodes - the default timeout, in seconds, to apply to newly configured Function nodes. Default: 0 - meaning no timeout. 功能节点-应用于新配置的功能节点的默认超时（以秒为单位）。默认值：0 -表示没有超时。

- debugMaxLength

  Debug Nodes - the maximum length, in characters, of any message sent to the debug sidebar tab. Default: 1000 发送到调试侧边栏选项卡的任何消息的最大长度（以字符为单位）。默认值：1000

- mqttReconnectTime mqtt重新连接时间

  MQTT Nodes - if the connection is lost, how long to wait, in milliseconds, before attempting to reconnect. Default: 5000 MQTT节点-如果连接丢失，在尝试重新连接之前等待多长时间（以毫秒为单位）。默认值：5000

- serialReconnectTime

  Serial Nodes - how long to wait, in milliseconds, before attempting to reopen a serial port. Default: 5000 串行节点-在尝试重新打开串行端口之前等待的时间（毫秒）。默认值：5000

- socketReconnectTime 套接字重新连接时间

  TCP Nodes - how long to wait, in milliseconds, before attempting to reconnect. Default: 10000 TCP节点-在尝试重新连接之前等待的时间（毫秒）。默认值：10000

- socketTimeout 插座

  TCP Nodes - how long to wait, in milliseconds, before timing out a socket. Default: 120000 TCP节点-在套接字超时之前等待的时间，以毫秒为单位。默认值：120000